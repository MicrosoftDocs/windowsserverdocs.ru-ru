---
title: Добавление элементов в ссылки УСТАНОВКИ, НАДСТРОЕК, КРАТКОГО СОСТОЯНИЯ и СПРАВКИ
description: Описание использования Windows Server Essentials
ms.date: 10/03/2016
ms.topic: article
ms.assetid: c0a8f10d-fd85-4c8d-b9bb-176cb1db1f46
author: nnamuhcs
ms.author: coreyp
manager: dongill
ms.openlocfilehash: fe7bcc54ab342ae1df4299db9585e0656a7ba5c8
ms.sourcegitcommit: d99bc78524f1ca287b3e8fc06dba3c915a6e7a24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87181600"
---
# <a name="add-entries-to-setup-add-ins-quick-status-and-help-links"></a>Добавление элементов в ссылки УСТАНОВКИ, НАДСТРОЕК, КРАТКОГО СОСТОЯНИЯ и СПРАВКИ

>Область применения: Windows Server 2016 Essentials, Windows Server 2012 R2 Essentials, Windows Server 2012 Essentials

Пользователи могут добавлять задачи в списки **УСТАНОВКА**, **НАДСТРОЙКИ**, **КРАТКАЯ ИНФОРМАЦИЯ О СОСТОЯНИИ**, а также ссылки в раздел "Ссылки сообщества" на домашней странице панели мониторинга. Для добавления задач и ссылок в указанные списки и раздел необходимо поместить XML-файл с именем OEMHomePageContent.home или файл внедренных ресурсов OEMHomePageContent.dll в папку %ProgramFiles%\Windows Server\Bin\Addins\Home. Файл внедренных ресурсов можно использовать для локализации текста в добавляемых задачах и ссылках. Файл .home содержит определения XML для задач и ссылок.

## <a name="adding-tasks-to-the-setup-add-ins-quick-status-task-lists-and-adding-links-to-help-task"></a>Добавление задач в списки УСТАНОВКА, НАДСТРОЙКИ, КРАТКАЯ ИНФОРМАЦИЯ О СОСТОЯНИИ, а также ссылок в задачу СПРАВКА.
 Для добавления задач в списки **УСТАНОВКА**, **НАДСТРОЙКИ**, **КРАТКАЯ ИНФОРМАЦИЯ О СОСТОЯНИИ** и ссылок в задачу **СПРАВКА** требуется определить задачи и ссылки с использованием XML, создать файл внедренных ресурсов (если это необходимо) и установить файл на сервере. Если файл XML устанавливается на сервер без файла ресурсов, ему необходимо присвоить имя OEMHomePageContent.home. Если для установки файла XML и файла ресурсов применяется сборка, она должна называться OEMHomePageContent.dll и должна быть подписана с помощью Authenticode.

### <a name="define-the-tasks-and-links"></a>Определение задач и ссылок
 Для создания HOME-файла можно использовать текстовый редактор, например Блокнот. Если одновременно создается файл внедренных ресурсов, то для определения файлов можно использовать версию Visual Studio 2010 или выше. Ниже представлена процедура создания файлов с использованием среды Visual Studio 2010 или более высокой версии.

##### <a name="to-define-the-tasks-and-links"></a>Определение задач и ссылок

1. Откройте Visual Studio 2010 или более высокой версии с правами администратора, щелкнув эту программу правой кнопкой мыши в меню Пуск и выбрав команду **Запуск от имени администратора**.

2. В меню **Файл** выберите команду **Создать** и щелкните пункт **Проект**.

3. В области **Шаблоны** выберите пункт **Библиотека классов**, введите **OEMHomePageContent** в поле **Имя** и нажмите кнопку **OK**.

4. Удалите файл Class1.cs.

5. Щелкните правой кнопкой мыши новый проект, выберите команду **Добавить** и щелкните пункт **Новый элемент**.

6. В области **Шаблоны** щелкните пункт **Файл XML**, введите **OEMHomePageContent.home** в поле **Имя** и нажмите кнопку **Добавить**.

   > [!NOTE]
   >  Если файл XML устанавливается без файла ресурсов, ему необходимо присвоить имя OEMHomePageContent.home. Если он входит в сборку, имя может быть любым (расширение должно быть HOME).

7. Добавьте следующий код XML в файл OEMHomePageContent.home:

   ```

   <Tasks version=?2.0? xmlns=?https://schemas.microsoft.com/WindowsServerSolutions/2010/01/Dashboard>
      <SetupMyServerTasks>
         <Task name="MyTask"
            description="MyTaskDescription"
            id="GUID">
                 <Action
                 name=?MyAction1Name?
                 image=?IconForAction1?
                 type=?TaskType?
                 exelocation=?ActionExeLocation? />
                 <Action
                 name=?MyAction2Name?
                 image=?IconForAction2?
                 type=?TaskType?
                 exelocation=?ActionExeLocation? />
                  ¦
          </Task>
                  ¦
       </SetupMyServerTasks>
   <MailServiceTasks>
        <!-- Same schema as in œSetupMyServerTasks? but the tasks are shown in œConnect to Email Service? category. -->
   </MailServiceTasks>
   <LineOfBusinessTasks>
        <!-- Same schema as in œSetupMyServerTasks? but the tasks are shown in œAdd-ins? category. -->

   <GetQuickStatusTasks>
         <Task name="MyQuickStatusTask1"
            description="MyQuickStatusTask1Desc   "
            id="GUID"
            assembly="AssemblyName of quick status query implementation"
            class="ClassName of quick status query implementation"
            replaceid="GUID"/>
              <!--  Same schema as Actions in œSetupMyServerTasks? -->
            </Task>
   </GetQuickStatusTasks>
      <Links>
         <Link
            ID=?GUID?
            Title="Displayed text of the link"
            Description="A very short description"
            ShellExecPath="Path to the application or URL"/>
      </Links>
   </Tasks>
   ```

    Где:

   |attribute|Описание|
   |---------------|-----------------|
   |Имя (задача)|Имя, которое отображается для задачи в списке. При создании файла внедренных ресурсов значением этого атрибута является строковый ресурс.|
   |описание (задача)|Описание задачи. При создании файла внедренных ресурсов значением этого атрибута является строковый ресурс.|
   |ИД (задача)|Идентификатор задачи. Этот идентификатор должен представлять собой идентификатор GUID. Для задачи **exe** создается новый идентификатор GUID, но для **глобальной** задачи используется идентификатор GUID, созданный при определении задачи для области задач на подчиненной вкладке. Дополнительные сведения о создании GUID см. в разделе [CREATE GUID (guidgen.exe)](https://go.microsoft.com/fwlink/?LinkId=116098).|
   |Изображение|Это поле будет пропущено.|
   |Имя (действие)|Отображение названия задачи.|
   |Тип (действие)|Описание типа задачи. Задача может быть одной из следующих: **глобальная** задача, **exe** или URL-задача. **Глобальная** задача — это та же глобальная задача, которая была создана при определении задач для области задач на подчиненной вкладке. Дополнительные сведения о создании глобальной задачи, которую можно использовать как в области задачи вложенной вкладки, так и в списках начало работы задач или общих задач на домашней странице, см. в разделе Œкреатинг the support classes? в разделе: создание подвкладки? [пакета SDK для Windows Server Solutions](https://go.microsoft.com/fwlink/?LinkID=248648). Задача **exe** может использоваться для запуска приложений из списка "Задачи перед началом работы" или "Стандартные задачи".|
   |exelocation|Путь к приложению, связанному с задачей. Этот атрибут используется только для задач **exe**.|
   |replaceid|Идентификатор задачи, которая заменяется этой задачей.|
   |сборка|Имя сборки, содержащее класс для реализации быстрого запроса состояния. Сборка должна находиться в папке Program Files \ Windows server\bin. \\ .|
   |class|Имя класса обеспечивает реализацию быстрого запроса состояния. Класс должен реализовывать интерфейс **ITaskStatusQuery**.|
   |Заголовок (ссылка)|Текст, отображаемый для ссылки. При создании файла внедренных ресурсов значением этого атрибута является строковый ресурс.|
   |Описание (ссылка)|Описание назначения ссылки. При создании файла внедренных ресурсов значением этого атрибута является строковый ресурс.|
   |ShellExecPath|Путь к приложению или URL-адрес.<br /><br /> **Примечание.** Переменные среды поддерживаются в атрибуте Шеллексекпас.|

    В следующем примере кода показан способ определения ссылки на приложение.

   ```
   <Links>
      <Link Title="Calc" Description="Launches Calc" ShellExecPath="%windir%\system32\calc.exe" />
   </Links>
   ```

    В следующем примере кода показан способ определения ссылки на веб-страницу.

   ```
   <Links>
      <Link Title="Browser" Description="Open browser" ShellExecPath="http://www.adventureworks.com/" />
   </Links>
   ```

8. Измените значения атрибутов для представления задачи или ссылки.

9. В **обозревателе решений** щелкните правой кнопкой мыши файл **OEMHomePageContent.home**, затем нажмите кнопку **Свойства**.  В области **Свойства** перейдите к опции **Действие построения** и выберите **Внедренный ресурс**.

10. Сохраните файл OEMHomePageContent.home.

    Для получения сведений о реализации быстрого запроса состояния обращайтесь к документам и примерам в [пакете SDK для решений Windows Server](https://go.microsoft.com/fwlink/?LinkID=248648).

#### <a name="change-the-status-of-a-setupadd-ins-task"></a>Изменение состояния задачи УСТАНОВКА / НАДСТРОЙКИ
 Состояние задач, указанных в списках УСТАНОВКА И НАДСТРОЙКИ, можно менять: завершенные (настроенные для надстроек) и незавершенные (не настроенные для надстроек).

 При определении приложения, связанного с новой задачей, для изменения состояния задачи можно использовать метод SetTaskStatus из пространства имен Microsoft.WindowsServerSolutions.Administration.ObjectModel.TaskStatusHelper (этот метод включен в пакет SDK для решений Windows Server, но не описан в документации). Например, для изменения цвета флажка с серого на зеленый можно вызвать метод SetTaskStatus со значением перечисления TaskStatus.Complete: (SetTaskStatus(id, TaskStatus.Complete), где **id** - идентификатор задачи). Можно использовать следующие значения перечисления: TaskStatus.Complete, TaskStatus.Incomplete и TaskStatus.Hidden.

##### <a name="replace-tasks"></a>Замена задач
 Задачи, предварительно определенные в списках "Задачи перед началом работы" и "Стандартные задачи", можно заменить путем добавления GUID задачи в атрибут replaceid определения задачи. В следующей таблице перечислены задачи и соответствующие им идентификаторы, которые можно заменить на панели администрирования.

|Имя задачи|Идентификатор|
|---------------|----------------|
|Получение обновлений для других продуктов Майкрософт|8412D35A-13EE-4112-AE0B-F7DBC83EA83D|
|Настройка архивации сервера|F68B3F3F-19DE-499D-9ACB-4BB41B8FF420|
|Настройка повсеместного доступа|8991302D-676A-4A7C-B244-D1E08AE0EFEA|
|Настройка уведомления по электронной почте|DE6F2B36-F19C-4FAF-998B-9772300E3530|
|Добавление учетных записей пользователя|6D5B5D5F-2EC7-4B1F-9580-4DB084B278B1|
|Добавление папок сервера|03F1F438-D94E-439B-A9F7-0C817C37D625|
|Повсеместный доступ - краткая информация о состоянии|6093B462-1F04-4212-8804-9BC823070FAD|
|Архивация данных сервера - краткая информация о состоянии|156947D8-21DC-45FE-A9A8-2F80AE304191|
|Папки сервера - краткая информация о состоянии|C657E8AB-AC1F-4AA1-8E80-5AF6BB27C314|
|Учетные записи активного пользователя - краткая информация о состоянии|68BCB125-CE8F-467F-B65B-56AD45A614B5|
|Уведомление по электронной почте - краткая информация о состоянии|75AB06E7-A679-4D62-A5EC-65362FE4F9DB|
|Компьютеры – краткая информация о состоянии|7966A974-D52D-4F5D-B37F-05C1B73CEEF3|

##### <a name="optional-create-the-resource-file"></a>(Необязательно) Создание файла ресурсов
 При необходимости локализовать текст в задачах, добавляемых в списки "Задачи перед началом работы" и "Стандартные задачи", и ссылках, добавляемых в раздел "Ссылки сообщества", необходимо создать сборку, содержащую файл с расширением HOME и файл с расширением HOME.RESX, в котором определены текстовые строки.

###### <a name="to-create-the-resource-file"></a>Создание файла ресурсов

1.  Щелкните правой кнопкой мыши проект, созданный для задач, выберите команду **Добавить** и щелкните пункт **Новый элемент**.

2.  В области **Шаблоны** щелкните пункт **Файл ресурсов**, введите **OEMHomePageContent.home.resx** в поле **Имя** и нажмите кнопку **Добавить**.

    > [!NOTE]
    >  Файлу ресурсов можно присвоить любое имя с расширением HOME.RESX.

3.  Для каждой добавляемой задачи или ссылки в файл OEMHomePageContent.home.resx необходимо добавить строки и значения, которые соответствуют элементам Task и Link, определенным в файле OEMHomePageContent.home. В следующем коде показан пример файла Tasks.xml, структура которого соответствует файлу ресурсов.

    ```

    <Tasks version=?2.0? xmlns=?https://schemas.microsoft.com/WindowsServerSolutions/2010/01/Dashboard>
       <SetupMyServerTasks>
          <Task name="MyTask"
             description="MyDescription"
             id="GUID">
             <Action
             name="MyActionname"
             image="IconForAction"
             type="TaskType"
             exelocation="ActionExeLocation" />
          </Task>
       </SetupMyServerTasks>
    </Tasks>

    ```

    > [!NOTE]
    >  Идентификаторы в атрибутах, используемых для локализации, не должны содержать пробелы.

4.  Добавьте в RESX-файл имена ресурсов MyTask, MyTaskDescription, MyActionName и IconForAction с соответствующими значениями.

5.  Сохраните файл OEMHomePageContent.home.resx и выполните построение решения.

#####  <a name="sign-the-assembly-with-an-authenticode-signature"></a><a name="BKMK_SignAssembly"></a>Подписать сборку с помощью подписи Authenticode
 Чтобы сборку можно было использовать в операционной системе, на ней должна быть подпись Authenticode. Дополнительные сведения о подписи сборки см. в разделе [Подпись и проверка кода с помощью Authenticode](https://msdn.microsoft.com/library/ms537364\(VS.85\).aspx#SignCode).

##### <a name="install-the-task-files"></a>Установка файлов задач
 После создания HOME- и HOME.RESX-файлов необходимо установить их на сервере.

###### <a name="to-install-the-task-files"></a>Установка файлов задач

1.  Убедитесь, что при построении решения не возникает ошибок.

2.  Если файл внедренных ресурсов не создавался, скопируйте файл OEMHomePageContent.home в папку **%ProgramFiles%\Windows Server\Bin\Addins\Home** на сервере. В случае создания файла внедренных ресурсов скопируйте файл OEMHomePageContent.dll в папку **%ProgramFiles%\Windows Server\Bin\Addins\Home** на сервере.

## <a name="see-also"></a>См. также
 [Создание и Настройка образа](Creating-and-Customizing-the-Image.md) [Дополнительные настройки](Additional-Customizations.md) [Подготовка образа для развертывания](Preparing-the-Image-for-Deployment.md) [Тестирование взаимодействия с пользователем](Testing-the-Customer-Experience.md)