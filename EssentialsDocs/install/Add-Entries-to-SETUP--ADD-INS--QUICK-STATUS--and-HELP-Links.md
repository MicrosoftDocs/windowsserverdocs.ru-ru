---
title: "Добавление элементов в Установка, Надстройки, КРАТКАЯ информация о состоянии и ссылки на СПРАВКУ"
description: "Описывается, как использовать Windows Server Essentials"
ms.custom: na
ms.date: 10/03/2016
ms.prod: windows-server-2016-essentials
ms.reviewer: na
ms.suite: na
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: c0a8f10d-fd85-4c8d-b9bb-176cb1db1f46
author: nnamuhcs
ms.author: coreyp
manager: dongill
ms.openlocfilehash: 6d3303f2c6d84932ad9d5dee8a547cd478447732
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="add-entries-to-setup-add-ins-quick-status-and-help-links"></a>Добавление элементов в Установка, Надстройки, КРАТКАЯ информация о состоянии и ссылки на СПРАВКУ

>Область применения: Windows Server 2016 Essentials, Windows Server 2012 R2 Essentials, Windows Server 2012 Essentials

Пользователи могут добавлять задачи в **установки**, **Надстройки**, **КРАТКАЯ информация о состоянии** списков, задач и "ссылки сообщества" на домашней странице панели мониторинга можно добавлять связи. Задачи и ссылки будут добавлены в указанные списки и раздел, поместив XML-файл с именем файла OEMHomePageContent.home или файл внедренного ресурса с именем OEMHomePageContent.dll в папку %ProgramFiles%\Windows Server\Bin\Addins\Home. Файл внедренных ресурсов можно использовать для локализации текста в задачах и ссылки, которые необходимо добавить. Файл .home содержит определения XML для задач и ссылок.  
  
## <a name="adding-tasks-to-the-setup-add-ins-quick-status-task-lists-and-adding-links-to-help-task"></a>Добавление задач в списки установка, Надстройки, КРАТКАЯ информация о состоянии задач и добавив ссылки на задачу СПРАВКА.  
 Могут добавлять задачи в **установки**, **Надстройки**, **КРАТКАЯ информация о состоянии** задач, списки и ссылки на **помочь** требуется определить задачи и ссылки с использованием XML, создать файл внедренных ресурсов и установить файл на сервере. Если XML-файл устанавливается на сервере без файла ресурсов, он должен быть назван OEMHomePageContent.home. Если сборка используется для установки в XML-файл и файл ресурсов, он должен быть назван OEMHomePageContent.dll, и он должен иметь подпись Authenticode.  
  
### <a name="define-the-tasks-and-links"></a>Определение задач и ссылок  
 Для создания Home-файл можно использовать текстовый редактор, например Блокнот, или если вы уже создали файл внедренных ресурсов можно использовать Visual Studio 2010 или выше для определения файлов. Ниже показано, как с помощью Visual Studio 2010 или выше для создания файлов.  
  
##### <a name="to-define-the-tasks-and-links"></a>Чтобы определить задачи и ссылки  
  
1.  Откройте Visual Studio 2010 или более позднюю версию от имени администратора, щелкнув правой кнопкой мыши программы в меню «Пуск» и выбрав **Запуск от имени администратора**.  
  
2.  Нажмите кнопку **файл**, нажмите кнопку **New**, а затем нажмите кнопку **проекта**.  
  
3.  В **шаблоны** панели, щелкните **библиотека классов**, тип **OEMHomePageContent** в **имя**, а затем щелкните **ОК**.  
  
4.  Удалите файл Class1.cs.  
  
5.  Щелкните правой кнопкой мыши новый проект, нажмите кнопку **добавить**, а затем нажмите кнопку **новый элемент**.  
  
6.  В **шаблоны** панели, щелкните **XML-файл**, тип **OEMHomePageContent.home** в **имя**, а затем щелкните **добавить**.  
  
    > [!NOTE]
    >  Если XML-файл устанавливается без файла ресурсов, он должен быть назван OEMHomePageContent.home. Если он включен в сборку, его можно предоставить любое имя, пока он имеет расширение .home.  
  
7.  Добавьте следующий XML-код в файл OEMHomePageContent.home:  
  
    ```  
  
    <Tasks version=?2.0? xmlns=?https://schemas.microsoft.com/WindowsServerSolutions/2010/01/Dashboard>  
       <SetupMyServerTasks>  
          <Task name="MyTask"  
             description="MyTaskDescription"  
             id="GUID">  
                  <Action   
                  name=?MyAction1Name?   
                  image=?IconForAction1?  
                  type=?TaskType?  
                  exelocation=?ActionExeLocation? />  
                  <Action   
                  name=?MyAction2Name?   
                  image=?IconForAction2?  
                  type=?TaskType?  
                  exelocation=?ActionExeLocation? />  
                   ¦  
           </Task>  
                   ¦  
        </SetupMyServerTasks>  
    <MailServiceTasks>  
         <!-- Same schema as in œSetupMyServerTasks? but the tasks are shown in œConnect to Email Service? category. -->  
    </MailServiceTasks>  
    <LineOfBusinessTasks>  
         <!-- Same schema as in œSetupMyServerTasks? but the tasks are shown in œAdd-ins? category. -->  
  
    <GetQuickStatusTasks>  
          <Task name="MyQuickStatusTask1"  
             description="MyQuickStatusTask1Desc   "  
             id="GUID"  
             assembly="AssemblyName of quick status query implementation"  
             class="ClassName of quick status query implementation"           
             replaceid="GUID"/>  
               <!--  Same schema as Actions in œSetupMyServerTasks? -->   
             </Task>  
    </GetQuickStatusTasks>  
       <Links>  
          <Link  
             ID=?GUID?  
             Title="Displayed text of the link"  
             Description="A very short description"  
             ShellExecPath="Path to the application or URL"/>  
       </Links>  
    </Tasks>  
    ```  
  
     Где:  
  
    |Атрибут|Описание|  
    |---------------|-----------------|  
    |Имя (задача)|Имя, которое отображается для задачи в списке. Если вы создаете файл внедренных ресурсов, значение этого атрибута является строковый ресурс.|  
    |Описание (задача)|Описание задачи. Если вы создаете файл внедренных ресурсов, значение этого атрибута является строковый ресурс.|  
    |ИД (задача)|Идентификатор задачи. Этот идентификатор необходимо использовать GUID. Создать новый идентификатор GUID для **exe** задач, но для **глобального** задач, используйте идентификатор GUID, созданный при определенных задач для области задач на подчиненной вкладке. Дополнительные сведения о создании GUID см. в разделе [(guidgen.exe) создать Guid](https://go.microsoft.com/fwlink/?LinkId=116098).|  
    |изображение|Это поле не будет выполняться.|  
    |Имя (действие)|Отображение имени задачи.|  
    |Тип (действие)|Описание типа создаваемой задачи. Задача может принимать одно из следующих:- **глобального** задачи **exe**, или задачу URL-адрес. A **глобального** будет же глобального задача, созданный при определении задачи по панели задач на подчиненной вкладке. Дополнительные сведения о создании глобальной задачи, которая может использоваться в обоих панели задач на подчиненной вкладке, а также списки задачи перед началом работы или задач на домашней странице см. в разделе œCreating вспомогательных классов? в œHow для: Создание подчиненной вкладки? из [пакет SDK для решений Windows Server](https://go.microsoft.com/fwlink/?LinkID=248648). **Exe** задачу можно использовать для запуска приложения из задачи перед началом работы или перечислены общие задачи.|  
    |exelocation|Путь к приложению, связанный с данной задачей. Этот атрибут используется только для **exe** задачи.|  
    |replaceid|Идентификатор задачу, которая заменяется этой задачи.|  
    |сборки|AssemblyName сборки, который содержит класс для реализации быстрого запроса о состоянии. Сборка должна находиться в server\bin\\ windows files\ программы.|  
    |класс|Имя класса, реализующего быстрого запроса о состоянии. Необходимо реализовать класс **ITaskStatusQuery** интерфейса.|  
    |Заголовок (ссылка)|Текст, отображаемый для ссылки. Если вы создаете файл внедренных ресурсов, значение этого атрибута является строковый ресурс.|  
    |Описание (ссылка)|Описание назначения ссылку. Если вы создаете файл внедренных ресурсов, значение этого атрибута является строковый ресурс.|  
    |ShellExecPath|Путь или URL-адрес приложения.<br /><br /> **Примечание:** в атрибуте ShellExecPath поддерживаются переменные среды.|  
  
     В следующем примере кода показано, как определить ссылку на приложение:  
  
    ```  
    <Links>  
       <Link Title="Calc" Description="Launches Calc" ShellExecPath="%windir%\system32\calc.exe" />  
    </Links>  
    ```  
  
     В следующем примере кода показано, как определить ссылку на веб-странице:  
  
    ```  
    <Links>  
       <Link Title="Browser" Description="Open browser" ShellExecPath="http://www.adventureworks.com/" />  
    </Links>  
    ```  
  
8.  Измените значения атрибутов для представления задач или ссылка.  
  
9. В **обозревателе решений**, щелкните правой кнопкой мыши **OEMHomePageContent.home**, а затем нажмите кнопку **свойства**.  В **свойства** области в разделе **действие при сборке**выберите **внедренных ресурсов**.  
  
10. Сохраните файл OEMHomePageContent.home.  
  
 Инструкции о реализации быстрого запроса состояния обращайтесь к документам и примерам в [пакет SDK для решений Windows Server](https://go.microsoft.com/fwlink/?LinkID=248648).  
  
#### <a name="change-the-status-of-a-setupadd-ins-task"></a>Изменение состояния задач установки-Надстройки  
 Задачи, которые указаны в программе установки и Надстройки можно включить в состояние завершения (настраивается для Add-ins) и незавершенные (не настроенные для Add-ins).  
  
 При определении приложения, связанный с новой задачей, можно использовать метод SetTaskStatus из пространства имен Microsoft.windowsserversolutions.Administration.ObjectModel.taskstatushelper (включен, но не документирован в Windows Server Solutions SDK) для изменения состояния задачи. Например, можно изменить флажок из grey на зеленый, вызвав метод SetTaskStatus со значением перечисления TaskStatus.Complete (SetTaskStatus (идентификатор, TaskStatus.Complete), где **идентификатор** идентификатор задачи). Значения перечисления, которые могут использоваться являются TaskStatus.Complete, TaskStatus.Incomplete или TaskStatus.Hidden.  
  
##### <a name="replace-tasks"></a>Замените задачи  
 Вы можете заменить задачи, которые предварительно определены в задачи перед началом работы или в списке общих задач, добавив GUID для задачи в атрибут replaceid определение задачи. В следующей таблице перечислены задачи и соответствующие идентификаторы, которые можно заменить на панели мониторинга:  
  
|Имя задачи|Идентификатор|  
|---------------|----------------|  
|Получить обновления для других продуктов Майкрософт|8412D35A-13EE-4112-AE0B-F7DBC83EA83D|  
|Настройка архивации сервера|F68B3F3F-19DE-499D-9ACB-4BB41B8FF420|  
|Настройка повсеместного доступа|8991302D-676A-4A7C-B244-D1E08AE0EFEA|  
|Настройка уведомлений по электронной почте|DE6F2B36-F19C-4FAF-998B-9772300E3530|  
|Добавление учетных записей пользователей|6D5B5D5F-2EC7-4B1F-9580-4DB084B278B1|  
|Добавление папки сервера|03F1F438-D94E-439B-A9F7-0C817C37D625|  
|Повсеместный доступ - краткая информация о состоянии|6093B462-1F04-4212-8804-9BC823070FAD|  
|Резервное копирование сервера - краткая информация о состоянии|156947D8-21DC-45FE-A9A8-2F80AE304191|  
|Папки сервера - краткая информация о состоянии|C657E8AB-AC1F-4AA1-8E80-5AF6BB27C314|  
|Активных учетных записей пользователей - краткая информация о состоянии|68BCB125-CE8F-467F-B65B-56AD45A614B5|  
|По электронной почте уведомления о предупреждениях - краткая информация о состоянии|75AB06E7-A679-4D62-A5EC-65362FE4F9DB|  
|Компьютеры - краткая информация о состоянии|7966A974-D52D-4F5D-B37F-05C1B73CEEF3|  
  
##### <a name="optional-create-the-resource-file"></a>(Необязательно) Создание файлового ресурса  
 Если вы хотите выполнить локализацию текста в задачах, добавляемых задачи перед началом работы "," Общие задачи "и" ссылки сообщества, необходимо создать сборку, содержащую Home-файл и. home.resx-файл, который определяет текстовые строки.  
  
###### <a name="to-create-the-resource-file"></a>Чтобы создать файл ресурсов  
  
1.  Щелкните правой кнопкой мыши проект, который вы создали для выполнения задач, щелкните **добавить**, а затем нажмите кнопку **новый элемент**.  
  
2.  В **шаблоны** панели, щелкните **файл ресурсов**, тип **OEMHomePageContent.home.resx** в **имя**, а затем щелкните **добавить**.  
  
    > [!NOTE]
    >  Файл ресурсов могут предоставляться любое имя, пока он имеет. home.resx расширения.  
  
3.  Для каждой задачи или ссылку, можно добавить файл OEMHomePageContent.home.resx, который соответствует элементы задачи и ссылки, которые определены в файле OEMHomePageContent.home необходимо добавить строки и значения. В следующем примере кода показан пример файла Tasks.xml, структурированных файла ресурсов:  
  
    ```  
  
    <Tasks version=?2.0? xmlns=?https://schemas.microsoft.com/WindowsServerSolutions/2010/01/Dashboard>  
       <SetupMyServerTasks>  
          <Task name="MyTask"  
             description="MyDescription"  
             id="GUID">  
             <Action  
             name="MyActionname"  
             image="IconForAction"  
             type="TaskType"  
             exelocation="ActionExeLocation" />  
          </Task>  
       </SetupMyServerTasks>  
    </Tasks>  
  
    ```  
  
    > [!NOTE]
    >  Идентификаторы в атрибуты, которые используются для локализации не могут содержать пробелов.  
  
4.  Добавьте имена ресурсов MyTask, MyTaskDescription, MyActionName и IconForAction RESX-файл с соответствующими значениями.  
  
5.  Сохраните файл OEMHomePageContent.home.resx, а затем построить решение.  
  
#####  <a name="BKMK_SignAssembly"></a>Подпишите сборку подпись Authenticode  
 Вы должны будете подпись Authenticode сборки, он должен использоваться в операционной системе. Дополнительные сведения о подписи сборки см. в разделе [подпись и проверка кода с помощью Authenticode](https://msdn.microsoft.com/library/ms537364\(VS.85\).aspx#SignCode).  
  
##### <a name="install-the-task-files"></a>Установка файлов задач  
 После создания .home и. файлы с расширением home.resx, необходимо установить их на сервере.  
  
###### <a name="to-install-the-task-files"></a>Чтобы установить файлы задач  
  
1.  Убедитесь, что решение сборки без ошибок.  
  
2.  Если вы не создали файл внедренных ресурсов, скопируйте файл OEMHomePageContent.home в **%ProgramFiles%\Windows Server\Bin\Addins\Home** на сервере. Если вы создали файл внедренных ресурсов, скопируйте файл OEMHomePageContent.dll в **%ProgramFiles%\Windows Server\Bin\Addins\Home** на сервере.  
  
## <a name="see-also"></a>См. также:  
 [Создание и настройка образа](Creating-and-Customizing-the-Image.md)   
 [Дополнительные настройки](Additional-Customizations.md)   
 [Подготовка образа для развертывания](Preparing-the-Image-for-Deployment.md)   
 [Тестирование работы пользователей](Testing-the-Customer-Experience.md)