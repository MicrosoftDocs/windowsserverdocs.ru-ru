---
title: Настройка и управление им в отказоустойчивом кластере
description: Подробные сведения об управлении кворума кластера в отказоустойчивом кластере Windows Server.
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 01/18/2019
ms.localizationpriority: medium
ms.openlocfilehash: 21f99362205e0a6aa90ebd26cef8f3a779bdc1dc
ms.sourcegitcommit: 28dc7c7f1e44fee7ab2112228af329a9ce0e02ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2019
ms.locfileid: "9024000"
---
# Настройка кворума и управление им

>Область применения: Windows Server 2019 г., Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе представлены фона и шаги по настройке и управлении кворумом в отказоустойчивом кластере Windows Server.

## Общие сведения о кворума

Кворума кластера определяется по количеству голосование элементы, которые должен быть частью членства active кластера для этого кластера корректно запускаться или продолжить работу. Более подробные пояснения см. в разделе [Общие сведения о документа кворума кластера и пул](../storage/storage-spaces/understand-quorum.md).

## Параметры конфигурации кворума

Модель кворума в Windows Server является гибкой. Если вам нужно изменить конфигурацию кворума кластера, можно использовать мастер настройки кворума кластера или командлетов отказоустойчивых кластеров Windows PowerShell. Инструкции и рекомендации по настройке кворума см. в разделе [Настройка кворума кластера](#configure-the-cluster-quorum) далее в этом разделе.

В следующей таблице перечислены параметры конфигурации три кворума, которые доступны в мастере настройки кворума кластера.

<table>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Использовать стандартные параметры</td>
<td>Кластера автоматически назначает голос для каждого узла и динамически управляет голосов узла. Если он подходит для кластера, а не доступна общего кластера хранилища, кластера выбирает диск-свидетель. В большинстве случаев рекомендуется использовать этот вариант, поскольку программное обеспечение кластера автоматически выбирает конфигурацию кворума и ресурс-свидетель, обеспечивает максимальную доступность для кластера.</td>
</tr>
<tr class="even">
<td>Добавление или изменение свидетеля кворума</td>
<td>Можно добавлять, изменять и удалять ресурс-свидетель. Вы можете настроить следящего файл общей папке или диска. Кластера автоматически назначает голос для каждого узла и динамически управляет голосов узла.</td>
</tr>
<tr class="odd">
<td>Конфигурация расширенных кворума и выбора ресурс-свидетель</td>
<td>Этот параметр необходимо выбрать только в том случае, если у вас есть требования к конкретному приложению или предоставит для настройки кворума. Можно изменить свидетеля кворума, добавить или удалить голосов узел и выбрать, управляет ли кластера динамически узел голосов. По умолчанию голосов назначаются на всех узлах и динамически управляются голосов узла.</td>
</tr>
</tbody>
</table>

В зависимости от выбранного вами параметр конфигурации кворума и определенные параметры будут настроены в одном из следующих режимов кворума кластера:

<table>
<thead>
<tr class="header">
<th>Режим</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Большинство узлов (нет следящего сервера)</td>
<td>Только узлы имеют голосов. Не свидетеля кворума настроен. Кворума кластера — это большая часть голосование узлов в членства в кластере active.</td>
</tr>
<tr class="even">
<td>Большинство узлов с ресурс-свидетель (диск или в общей папке)</td>
<td>Узлы имеют голосов. Кроме того свидетеля кворума имеет право голоса. Кворума кластера — это большая часть голосование узлов в членства active кластера, а также голос ресурс-свидетель.<br />
<br />
Свидетеля кворума может быть назначенное диск-свидетель или назначенное файловый ресурс-свидетель.</td>
</tr>
<tr class="odd">
<td>Нет большинства (диск-свидетель только)</td>
<td>Узлы имеют голосов. Только следящего диск имеет право голоса. Состояние диска-свидетеля определяется кворума кластера.<br />
<br />
Кластера имеет кворума, если на одном узле, доступных и взаимодействии с определенный диск в хранилище кластера. Как правило не рекомендуется использовать этот режим, и он не должен быть установлен, так как он создает одну точки сбоя для кластера.</td>
</tr>
</tbody>
</table>

Следующие подразделы предоставит дополнительные сведения о параметрах конфигурации расширенных кворума.

### Настройка свидетеля

Как правило при настройке кворума голосование элементы кластера должен быть нечетным. Таким образом Если кластера содержит четным числом голосование узлов, необходимо настроить диск-свидетель или файловый ресурс-свидетель. Кластеру не смогут поддерживать один дополнительный узел вниз. Кроме того Добавление голос ресурс-свидетель позволяет кластер продолжает работать, если половина узлов кластера одновременно неработоспособным или отключены.

Диск-свидетель обычно рекомендуется использовать при всех узлов можно получить доступ к диску. Файловый ресурс-свидетель рекомендуется, если необходимо учитывать многосайтового аварийного восстановления с реплицированного хранилища. Настройка следящего диска с помощью реплицированного хранилища возможно только в том случае, если поставщик хранилища поддерживает доступ для чтения и записи со всех сайтов для реплицированного хранилища. <strong>*Диск-свидетель не поддерживается в локальных дисковых пространств*</strong>.

В следующей таблице приведены дополнительные сведения и рекомендации о типах свидетеля кворума.

<table>
<thead>
<tr class="header">
<th>Тип свидетеля</th>
<th>Описание</th>
<th>Требования и рекомендации</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Диск-свидетель</td>
<td>- Выделенные LUN, который хранит копию базы данных кластера<br />
- Особенно полезно для кластеров с общим хранилищем (не репликации)</td>
<td>- Размер LUN должен быть менее 512 МБ<br />
- Необходимо для использования кластера и не назначен кластерные роли<br />
- Должны быть включены в кластеризованных хранилища и передайте хранилища проверочные тесты<br />
- Не может быть диск, общего тома кластера (CSV)<br />
- Базового диска с одного тома<br />
- Не обязательно должно быть букву диска<br />
- Может быть отформатирован с файловой системой NTFS или ReFS<br />
- Можно дополнительно настроить контроллеры RAID для обеспечения отказоустойчивости<br />
- Должны быть исключены из резервных копий и антивирусного сканирования<br />
- Диск-свидетель не поддерживается в локальных дисковых пространств</td>
</tr>
<tr class="even">
<td>Файловый ресурс-свидетель</td>
<td>- SMB файлового ресурса, который настроен на файловом сервере под управлением Windows Server<br />
- Не храните копии базу данных кластера<br />
- Хранит сведения о кластера только в файл witness.log<br />
- Оптимальных многосайтового кластеров с реплицированного хранилища</td>
<td>- Должен иметь не менее 5 МБ свободного дискового пространства<br />
- Должен быть выделенный в один кластер и не используется для хранения данных пользователя или приложения<br />
- Должен заполнять включить для объект компьютера для имени кластера<br />
<br />
Ниже приведены дополнительные рекомендации для файлового сервера, на котором размещается файлового ресурса-свидетеля.<br />
<br />
- Один файловый сервер можно настроить с помощью файла следящих серверов общего ресурса для нескольких кластеров.<br />
- Файловый сервер должен быть на сайте, отделенной от рабочей нагрузки кластера. Это позволяет равных возможностях для любого узла кластера для пережившие при потере узла для сетевого взаимодействия. Если файловый сервер находится на том же сайте, этот сайт становится первичного сайта, и это единственный узел, который может связаться с общей.<br />
- Файлового сервера можно запустить на виртуальной машине, если виртуальная машина не размещается на том же кластере, который использует файлового ресурса-свидетеля.<br />
- Для обеспечения высокой доступности файлового сервера можно настроить на отдельном отказоустойчивого кластера.</td>
</tr>

<tr class-"odd">
<td>Облако-свидетель</td>
<td>- Файл ресурс-свидетель, хранящиеся в хранилище BLOB-объектов Azure<br>
-Если рекомендуется использовать все серверы в кластере имеют надежное подключение к Интернету.</td>
<td>См. в разделе <a href="https://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness">развертывание облака-свидетеля</a>.</td>
<td>
</td>
</tr>

</tbody>
</table>

### Назначение проголосовать узла

Как параметр конфигурации расширенных кворума вы можете назначение и удаление голосов кворума на каждом узле. По умолчанию все узлы назначаются голосов. Независимо от назначения проголосовать все узлы продолжать работать в кластере, получать обновления базу данных кластера и могут размещаться приложения.

Может потребоваться удалить голосов из узлов в определенных конфигурациях аварийного восстановления. Например в кластере многосайтового можно удалить, голосов из узлов в узле резервного копирования, чтобы эти узлы не влияют на подсчете кворума. Такая конфигурация рекомендуется только ресурс вручную на узлах. Дополнительные сведения см. в разделе [кворума рекомендации для аварийного восстановления конфигурации](#quorum-considerations-for-disaster-recovery-configurations) далее в этом разделе.

Просматривая **NodeWeight** общих свойств узла кластера с помощью командлета [Get-ClusterNode](http://technet.microsoft.com/library/hh847268.aspx)Windows PowerShell можно проверить настроенных голоса узла. Значение 0 указывает, что узел не имеет право голоса кворума настроен. Значение 1 означает, что назначается голоса кворума узла, и оно управляется в кластере. Дополнительные сведения об управлении голоса узла см. в разделе [Управление динамической кворума](#dynamic-quorum-management) далее в этом разделе.

Проголосовать назначения для всех узлов кластера можно проверить с помощью проверку **Проверка кворума кластера** .

#### Дополнительные рекомендации для назначения проголосовать узла

  - Назначение проголосовать узел не рекомендуется применять нечетным числом голосование узлов. Вместо этого необходимо настроить диск-свидетель или файлового ресурса-свидетеля. Дополнительные сведения см. в разделе [свидетеля](#witness-configuration) далее в этом разделе.
  - Если включено управление динамической кворума, только тех узлах, которые настроены на узел голосов назначены может иметь их голосов назначенных или она была удалена динамически. Дополнительные сведения см. в разделе [Управление динамической кворума](#dynamic-quorum-management) далее в этом разделе.

### Управление динамической кворума

В Windows Server 2012 как параметр конфигурации расширенных кворума, вы можете включить управление динамической кворума кластера. [Дополнительные сведения о динамических работы кворума пояснений.](../storage/storage-spaces/understand-quorum.md#dynamic-quorum-behavior)

С помощью управление динамической кворума можно также для кластера для запуска на последней оставшихся узла кластера. Настраивая динамически требование большинство кворума, кластера может выдерживать завершений последовательные узел на один узел.

Назначенные кластера динамических голоса узла можно проверить с помощью общего свойства **DynamicWeight** узла кластера с помощью командлета [Get-ClusterNode](https://docs.microsoft.com/powershell/module/failoverclusters/get-clusternode?view=win10-ps) Windows PowerShell. Значение 0 указывает, что узел не имеет право голоса кворума. Значение 1 означает, что узел имеет право голоса кворума.

Проголосовать назначения для всех узлов кластера можно проверить с помощью проверку **Проверка кворума кластера** .

#### Дополнительные рекомендации для управления динамических кворума

- Управление динамической кворума не позволяет поддерживать одновременных сбоя большей части голосование членов кластера. Чтобы продолжить работу, кластера всегда должен иметь большинство кворума во время сбоев или завершение работы узла.

- Если явно были удалены голоса узла, кластера динамически невозможно добавить или удалить этот голоса.
- При включении локальных дисковых пространств, кластера поддерживает только два сбоев узлов. Это более описано в [разделе кворума пул](../storage/storage-spaces/understand-quorum.md#poolQuorum)

## Общие рекомендации по настройке кворума

Программное обеспечение кластера автоматически настраивает кворума в новый кластер, на основе количество узлов и доступность общего хранилища. Обычно это наиболее подходящего конфигурацию кворума кластера. Тем не менее это хороший способ проверить конфигурацию кворума, после создания кластера перед помещением кластера в рабочую среду. Для просмотра конфигурации кворума кластера подробные, вы можете использовать проверки мастер настройки или командлета [Test-Cluster](https://docs.microsoft.com/powershell/module/failoverclusters/test-cluster?view=win10-ps) Windows PowerShell для выполнения теста **Проверка конфигурации кворума** . В диспетчере отказоустойчивости кластеров, конфигурации кворума базовые отображается в сводных данных для выбранного кластера, или вы можете просмотреть сведения о ресурсах кворума, возвращающий при запуске Windows PowerShell [Get-ClusterQuorum](https://docs.microsoft.com/powershell/module/failoverclusters/get-clusterquorum?view=win10-ps) командлет.

В любое время можно выполнить тест **Проверка конфигурации кворума** для проверки правильности конфигурации кворума оптимально подходит для кластера. Тест видно, если рекомендуется изменения конфигурации кворума и параметры, которые оптимальной. Если изменение рекомендуется, чтобы применить рекомендуемые параметры можно использовать мастера настройки кворума кластера.

После кластера в рабочей среде, не изменяйте конфигурации кворума, если вы определили, что изменение подходит для кластера. Следует подумать о конфигурации кворума в следующих случаях:

- Добавление или исключения узлов
- Добавление или удаление хранилища
- Долгосрочные сбой узла или ресурс-свидетель
- Восстановление кластера в сценарии многосайтового аварийного восстановления

Дополнительные сведения о проверке отказоустойчивого кластера см. в разделе [Проверка оборудования для отказоустойчивого кластера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134244(v%3dws.11)>).

## Настройка кворума кластера

Можно настроить параметры кворума кластера с помощью диспетчера отказоустойчивости кластеров или командлетов отказоустойчивых кластеров Windows PowerShell.

>[!IMPORTANT]
>Обычно лучше всего использовать эту конфигурацию кворума, рекомендуется с помощью мастера настройки кворума кластера. Рекомендуется настраивать конфигурации кворума только в том случае, если вы определили, что изменение подходит для кластера. Дополнительные сведения см. в разделе [Общие рекомендации по настройке кворума](#general-recommendations-for-quorum-configuration) в этом разделе.

### Настройте параметры кворума кластера

Членство в группу локальных **администраторов** на каждом кластерного сервера или аналогичной является минимальные разрешения, необходимые для выполнения этой процедуры. Кроме того учетную запись, которую вы используете должен быть учетную запись пользователя домена.

>[!NOTE]
>Можно изменить конфигурацию кворума кластера без остановки в кластер или прохождение тестов ресурсы автономный режим.

### Изменение конфигурации кворума в отказоустойчивом кластере с помощью диспетчера отказоустойчивости кластеров

1. В диспетчере отказоустойчивости кластеров выберите или укажите кластере, который вы хотите изменить.
2. Выбрав кластер, в области **действий**выберите **Дополнительные действия**, а затем выберите **Настройте параметры кворума кластера**. Откроется мастер настройки кворума кластера. Выберите **Далее**.
3. На странице " **Выбор параметра конфигурации кворума** " выберите один из трех вариантов конфигурации и выполните шаги для этого варианта. Прежде чем настраивать параметры кворума, вы можете просмотреть выбранные вами параметры. Дополнительные сведения о параметрах см. в разделе [Обзор кворумом в отказоустойчивом кластере](#overview-of-the-quorum-in-a-failover-cluster), ранее в этом разделе.

    - Чтобы разрешить кластера автоматически сбросить параметры кворума, которые являются оптимальными для текущей конфигурации кластера, установите **Обычные параметры использования** и затем завершите работу мастера.
    - Чтобы добавить или изменить свидетеля кворума, выберите **Добавление или изменение свидетеля кворума**и затем выполните следующие действия. Сведения и рекомендации о настройке свидетеля кворума см. в разделе [свидетеля](#witness-configuration) ранее в этом разделе.

      1. На странице **Выберите свидетеля кворума** выберите параметр, чтобы настроить диск-свидетель или файловый ресурс-свидетель. Мастер указывает вариантов ресурс-свидетель, рекомендуемые для кластера.

          >[!NOTE]
          >Можно также выбрать **не настраивать свидетеля кворума** и затем завершите работу мастера. Если у вас есть четным числом голосование узлы в кластер, это может быть Рекомендуемая конфигурация.

      2. При выборе этого курса, чтобы настроить свидетель диска, на странице " **Настройка следящего хранилища** ", выберите том хранилища, которое вы хотите назначить в качестве диска-свидетеля и затем завершите работу мастера.
      3. При выборе этого курса, чтобы настроить файловый ресурс-свидетель, на странице " **Настройка файлового ресурса-свидетеля** " введите или перейдите к файлового ресурса, который будет использоваться как ресурс-свидетель, а затем завершите работу мастера.

    - Для настройки параметров управления кворума, а также добавить или изменить свидетеля кворума, **Расширенные кворума конфигурации**и выбор ресурс-свидетель и затем выполните следующие действия. Сведения и рекомендации о параметрах конфигурации расширенных кворума см. в разделе [узел проголосовать назначения](#node-vote-assignment) и [Управление динамической кворума](#dynamic-quorum-management) ранее в этом разделе.

      1. На странице " **Выбор голосование конфигурации** " выберите параметр, чтобы назначить голосов. По умолчанию все узлы назначаются право голоса. Тем не менее для определенных сценариев, вы можете назначать голосов подмножеству узлов.

          >[!NOTE]
          >Также можно выбрать **Нет узлов**. Это обычно не рекомендуется, поскольку это средство не разрешает узлов на участие в голосование кворума, и он требует Настройка следящего диска. Этот диск-свидетель становится одной точки сбоя для кластера.

      2. На странице **Настройка кворума управления** вы включите или отключите параметр " **Разрешить кластеру динамически назначения узла санкционируется** ". При выборе этого параметра обычно повышает доступность кластера. По умолчанию параметр включен, и настоятельно рекомендуется не отключить этот параметр. Этот параметр позволяет кластеру работать в сценариев сбоев, которые невозможно если этот параметр отключен.
      3. На странице **Выберите свидетеля кворума** выберите параметр, чтобы настроить диск-свидетель или файловый ресурс-свидетель. Мастер указывает вариантов ресурс-свидетель, рекомендуемые для кластера.

          >[!NOTE]
          >Можно также выбрать **не настраивать свидетеля кворума**и затем завершите работу мастера. Если у вас есть четным числом голосование узлы в кластер, это может быть Рекомендуемая конфигурация.

      4. При выборе этого курса, чтобы настроить свидетель диска, на странице " **Настройка следящего хранилища** ", выберите том хранилища, которое вы хотите назначить в качестве диска-свидетеля и затем завершите работу мастера.
      5. При выборе этого курса, чтобы настроить файловый ресурс-свидетель, на странице " **Настройка файлового ресурса-свидетеля** " введите или перейдите к файлового ресурса, который будет использоваться как ресурс-свидетель, а затем завершите работу мастера.

4. Выберите **Далее**. Проверьте выбранные параметры на странице подтверждения, которое отображается, а затем выберите **Далее**.

После запуска мастера и **Сводка** страница отображается, если вы хотите просмотреть отчет о задачах выполненных мастером, выберите **Просмотр отчета**. Последний отчет будет оставаться в *systemroot *** \\Cluster\\Reports** папка с именем **QuorumConfiguration.mht**.

>[!NOTE]
>После настройки кворума кластера, рекомендуем запускать тест **Проверка конфигурации кворума** проверка параметров обновленные кворума.

### Эквивалент команды Windows PowerShell

В следующих примерах использование командлета [Set-ClusterQuorum](https://docs.microsoft.com/powershell/module/failoverclusters/set-clusterquorum?view=win10-ps) и других командлетов Windows PowerShell для настройки кворума кластера.

В следующем примере изменяется конфигурации кворума кластера *CONTOSO FC1* конфигурации большинство простого узла с не свидетеля кворума.

```PowerShell
Set-ClusterQuorum –Cluster CONTOSO-FC1 -NodeMajority
```

В следующем примере изменяется конфигурации кворума в кластере локальных для большинства узлов с конфигурацией ресурс-свидетель. Диск ресурса с именем *2 диска кластера* настроен как диск-свидетель.

```PowerShell
Set-ClusterQuorum -NodeAndDiskMajority "Cluster Disk 2"
```

В следующем примере изменяется конфигурации кворума в кластере локальных для большинства узлов с конфигурацией ресурс-свидетель. Файловый ресурс общего доступа, с именем *\\\CONTOSO-FS\\fsw* настроен как файловый ресурс-свидетель.

```PowerShell
Set-ClusterQuorum -NodeAndFileShareMajority "\\fileserver\fsw"
```

Следующий пример удаляет голоса кворума на узле *ContosoFCNode1* в локальном кластере.

```PowerShell
(Get-ClusterNode ContosoFCNode1).NodeWeight=0
```

В следующем примере добавляется голоса кворума узел *ContosoFCNode1* на локальном кластере.

```PowerShell
(Get-ClusterNode ContosoFCNode1).NodeWeight=1
```

В следующем примере включается свойство **DynamicQuorum** кластера *CONTOSO FC1* (если он ранее был отключен):

```PowerShell
(Get-Cluster CONTOSO-FC1).DynamicQuorum=1
```

## Восстановление, запустив без кворума кластера

Кластера, не имеет достаточное количество голосов кворума не запустится. В качестве первого шага следует всегда подтверждение конфигурации кворума кластера и изучить, почему кластера больше не имеет кворум. Это может произойти, если у вас есть узлами, которые не отвечает или первичного сайта недоступен в кластере многосайтового. После выявления причины сбоя кластера, можно использовать восстановления действия, описанные в этом разделе.

>[!NOTE]
> * Если службы кластеров останавливается, так как теряются кворума, 1177 идентификатор события отображается в системный журнал.
> * Это всегда необходимо изучить, почему кворума кластера потеряно.
> * Всегда рекомендуется перевести следящего узла или кворума в работоспособное состояние (присоединение к кластеру) вместо запуска без кворума кластера.

### Узлы кластера меню "Пуск" по усилию

После определения, что вы не можете взыскать кластер включила узлов или свидетеля кворума в работоспособное состояние, потребность принудительное кластер для запуска. Принудительно запустить кластер переопределяет параметры конфигурации кворума кластера и начинает кластера в режиме **ForceQuorum** .

Принудительное для запуска, когда они не содержат кворума кластера может быть особенно полезно в кластере многосайтового. Рассмотрим сценарий аварийного восстановления с кластера, содержащего отдельно расположенному основной и резервный сайты, *SiteA* и *SiteB*. Если *SiteA*является подлинной сбоя, это может занять значительное время для узла в оперативный. Скорее всего нужно принудительно *SiteB* в оперативный, несмотря на то, что они не содержат кворума.

При запуске кластера в режиме **ForceQuorum** , а после его вновь санкционируется достаточно кворума кластера автоматически оставляет принудительную состояние и оно соответствует тому, как правило. Следовательно нет необходимости повторно нормального запуска кластера. Если он теряет кворума кластера теряет узла, он переходит в автономный режим снова так как он больше не находится в состоянии принудительную. Чтобы снова в оперативный когда они не содержат кворума требует принудительного запуска запуск без кворума кластера.

>[!IMPORTANT]
>* После того как кластер работы по усилию, администратор находится в полный контроль над кластера.
>* Кластера используется конфигурации кластера на узле, где кластера является принудительное работы и реплицируются на все остальные узлы, которые доступны.
>* Если вы принудительно Запуск без кворума кластера, все параметры конфигурации кворума игнорируются во время кластер продолжает в режиме **ForceQuorum** . Сюда входят назначения проголосовать конкретного узла и параметры управления динамических кворума.

### Запретить кворума на остальные узлы кластера

После получения принудительно работы кластера на узле, а она необходима начать все остальные узлы в кластер с параметром для предотвращения кворума. Узел работы с параметром, не позволяющий кворума указывает службе кластера для присоединения к существующий кластер под управлением вместо формирующих новый экземпляр кластера. Это предотвращает формирующих кластером комбинированный режим, который содержит два экземпляра конкурирующие остальные узлы.

Это становится необходимые при необходимости восстановить кластер в некоторых многосайтового аварийного восстановления после получения принудительно работы кластера на сайте резервного копирования, *SiteB*. Для присоединения к force работы кластера в *SiteB*, узлах первичного сайта, *SiteA*, необходимые для работы с им запрещено.

>[!IMPORTANT]
>После принудительное работы на узле кластера, рекомендуется начать остальные узлы с им запрещено.

Ниже показано, как восстановить кластера с помощью диспетчера отказоустойчивости кластеров:

1. В диспетчере отказоустойчивости кластеров выберите или укажите кластер, который вы хотите восстановить.
2. Выбрав кластер, в области **действий**выберите **Принудительно запустить кластер**.

    Диспетчер отказоустойчивости кластеров принудительно запускает кластера на всех узлах, которые доступны. Кластер использует текущую конфигурацию кластера при запуске.

>[!NOTE]
>* Принудительно запустить в определенном узле, содержащий конфигурации кластера, которую вы хотите использовать кластер, необходимо использовать командлеты Windows PowerShell или эквивалентные средства командной строки, представленную после выполнения этой процедуры. 
> * При использовании диспетчера отказоустойчивости кластеров для подключения к кластеру, сила работы — и использовании **Запустить службу кластеров** действие для запуска узла, узел автоматически запускается с параметром, который предотвращает кворума.

#### Эквивалент команды Windows PowerShell (меню "Пуск"-Clusternode)

Приведенный ниже показано, как использовать командлет **ClusterNode меню "Пуск"** , чтобы принудительно меню "Пуск" кластера на узле *ContosoFCNode1*.

```PowerShell
Start-ClusterNode –Node ContosoFCNode1 –FQ
```

Кроме того можно ввести следующую команду локально на узле:

```PowerShell
Net Start ClusSvc /FQ
```

Приведенный ниже показано, как использовать командлет **ClusterNode меню "Пуск"** для запуска службы кластеров с помощью кворума, запрещено на узле *ContosoFCNode1*.

```PowerShell
Start-ClusterNode –Node ContosoFCNode1 –PQ
```

Кроме того можно ввести следующую команду локально на узле:

```PowerShell
Net Start ClusSvc /PQ
```

## Рекомендации по кворума для аварийного восстановления конфигураций

В этом разделе кратко описывает характеристики и конфигурации кворума для двух конфигураций несколькими узлами кластера в развертываниях аварийного восстановления. Рекомендации по конфигурации кворума отличаются в зависимости от того, если вам нужно автоматическую отработку отказа или ресурс вручную для рабочих нагрузок между сайтами. Конфигурация обычно зависит от соглашений об уровне обслуживания (SLA), действующих в вашей организации для предоставления и кластерных рабочих нагрузок в случае сбоя или сбоя в офисе.

### Автоматический переход

В этой конфигурации кластера состоит из двух или нескольких сайтов, которые могут размещаться кластерных ролей. При возникновении сбоя на любом узле, за кластерными ролями должны автоматически переключиться на остальные узлы. Таким образом кворума кластера должен быть настроен таким образом, чтобы любой узел выдерживать сбой полный узла.

В следующей таблице перечислены рекомендации для этой конфигурации.

<table>
<thead>
<tr class="header">
<th>Элемент</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Количество голосов узел каждого узла</td>
<td>Должно быть равно</td>
</tr>
<tr class="even">
<td>Назначение проголосовать узла</td>
<td>Так как все узлы одинаково важны не следует удалять голосов узла</td>
</tr>
<tr class="odd">
<td>Управление динамической кворума</td>
<td>Должна быть включена</td>
</tr>
<tr class="even">
<td>Настройка свидетеля</td>
<td>Рекомендуется файлового ресурса-свидетеля, настроен на узле, отделенной от узлов кластера</td>
</tr>
<tr class="odd">
<td>Рабочие нагрузки</td>
<td>Рабочие нагрузки можно настроить для какого-либо из узлов</td>
</tr>
</tbody>
</table>

#### Дополнительные рекомендации для автоматической отработки отказа

- Настройка файлового ресурса-свидетеля в отдельный узел, чтобы дать возможность равенства пережившие каждого узла. Дополнительные сведения см. в разделе [свидетеля](#witness-configuration) ранее в этом разделе.

### Ресурс вручную

В этой конфигурации кластера состоит из первичного сайта, *SiteA*и сайт резервного копирования (восстановление), *SiteB*. Кластерные роли размещаются в *SiteA*. Из-за конфигурации кворума кластера Если произойдет сбой во всех узлов в *SiteA*, работа кластера останавливается. В этом сценарии администратор должен вручную при сбое службы кластеров для *SiteB* и выполнить дополнительные действия для восстановления кластера.

В следующей таблице перечислены рекомендации для этой конфигурации.

<table>
<thead>
<tr class="header">
<th>Элемент</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Количество голосов узел каждого узла</td>
<td>Может отличаться</td>
</tr>
<tr class="even">
<td>Назначение проголосовать узла</td>
<td>- Узел санкционируется не следует удалять из узлов в первичного сайта, <em>SiteA</em><br />
- Узел санкционируется следует удалить из узлов на сайте резервного копирования, <em>SiteB</em><br />
- Если долгосрочной сбой происходит в <em>SiteA</em>, голосов должно быть назначено узлов на <em>SiteB</em> для включения большинства кворума на этом сайте как часть восстановления</td>
</tr>
<tr class="odd">
<td>Управление динамической кворума</td>
<td>Должна быть включена</td>
</tr>
<tr class="even">
<td>Настройка свидетеля</td>
<td>- Настройка следящего, если есть четным числом узлов в <em>SiteA</em><br />
- Если требуется следящий сервер, настройте файловый ресурс-свидетель или диск-свидетель, доступный только для узлов в <em>SiteA</em> (иногда называемая асимметричного диск-свидетель)</td>
</tr>
<tr class="odd">
<td>Рабочие нагрузки</td>
<td>Использовать предпочитаемых владельцев для обеспечения рабочие нагрузки, работающие на узлах в <em>SiteA</em></td>
</tr>
</tbody>
</table>

#### Дополнительные рекомендации для ресурс вручную

- Только узлов на *SiteA* изначально настраиваются с помощью кворума голосов. Это необходимо, чтобы убедиться, что состояние узлов на *SiteB* не влияет на кворума кластера.
- Восстановления действия могут различаться в зависимости от Если *SiteA* отвлекаясь временный сбой или при сбое долгосрочной.

## Дополнительные сведения

* [Отказоустойчивая кластеризация](failover-clustering.md)
* [Командлеты Windows PowerShell отказоустойчивости кластеров](https://docs.microsoft.com/powershell/module/failoverclusters/?view=win10-ps)
* [Общие сведения о кластера и кворума пул](../storage/storage-spaces/understand-quorum.md)