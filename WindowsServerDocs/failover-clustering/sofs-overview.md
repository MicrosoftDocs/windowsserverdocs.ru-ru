---
title: Масштабируемый файловый сервер для обзора данных приложения
description: Общие сведения о возможности масштабируемого файлового сервера для Windows Server 201 R2 и Windows Server 2012.
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 04/26/2018
ms.localizationpriority: medium
ms.openlocfilehash: 3e6d67eee496d19b216a4366af51ab5736229cf0
ms.sourcegitcommit: ed27ddbe316d543b7865bc10590b238290a2a1ad
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/09/2019
ms.locfileid: "65476144"
---
# <a name="scale-out-file-server-for-application-data-overview"></a>Масштабируемый файловый сервер для обзора данных приложения

>Относится к: Windows Server 2012 R2, Windows Server 2012

Масштабируемый файловый сервер — это компонент, предоставляющий масштабируемые файловые ресурсы, которые постоянно доступны для файлового хранилища серверных приложений. Масштабируемые файловые ресурсы обеспечивают возможность совместного использования папок различными узлами одного кластера. Этот сценарий фокусируется на планировании и развертывании масштабируемого файлового сервера.

Вы можете развернуть и настроить кластерный файловый сервер с помощью любого из следующих методов.

- **Масштабируемого файлового сервера для данных приложений** этот кластерный файловый сервер впервые появился в Windows Server 2012, и он позволяет сохранять данные серверных приложений, такие как файлы виртуальной машины Hyper-V, в файловых ресурсах и получить такой же уровень надежности, доступности, управляемости и высокой производительности, который ожидается от сети хранения данных. Все файловые ресурсы одновременно подключены к сети на всех узлах. Общие файловые ресурсы, связанные с кластерным файловым сервером такого типа, называются масштабируемыми файловыми ресурсами. Такая конфигурация иногда называется "активный-активный". Это рекомендуемый тип файлового сервера при развертывании Hyper-V через Server Message Block (SMB) или Microsoft SQL Server через SMB.
- **Файловый сервер для общего использования** . Это продолжение кластерного файлового сервера, который поддерживался в Windows Server с момента внедрения отказоустойчивой кластеризации. Это разновидность кластерного файлового сервера, поэтому все общие папки, связанные с кластерным файловым сервером, не могут быть подключены к сети на нескольких узлах одновременно. Такая конфигурация иногда называется "активный-пассивный" или "двойной активный". Общие файловые ресурсы, связанные с кластерным файловым сервером такого типа, называются кластерными файловыми ресурсами. Это рекомендуемый тип файлового сервера при развертывании сценариев информационных работников.

## <a name="scenario-description"></a>Описание сценария

Масштабируемые файловые ресурсы обеспечивают возможность совместного использования папок несколькими узлами одного кластера. Например при наличии четырех узлов файлового сервера, использующего горизонтального масштабирования Server Message Block (SMB), компьютер под управлением Windows Server 2012 R2 или Windows Server 2012 можно доступ к общим ресурсам из любого из четырех узлов. Это достигается за счет использования новых компонентов отказоустойчивой кластеризации в Windows Server и возможностей протокола файловых серверов Windows — SMB 3.0. Администраторы файловых серверов могут предоставлять масштабируемые файловые ресурсы и постоянно доступные файловые службы серверным приложениям, а также быстро реагировать на увеличение потребностей путем простого подключения к сети дополнительных серверов. Все это можно осуществлять в рабочей среде абсолютно прозрачно для серверного приложения.

Основные преимущества масштабируемого файлового сервера включают следующее.

- **Файловые ресурсы активных**. Все узлы кластера могут принимать и обслуживать запросы SMB-клиентов. Благодаря одновременной доступности содержимого файловых ресурсов для всех узлов кластера взаимодействие кластеров и клиентов SMB 3.0 обеспечивает прозрачную отработку отказа на альтернативные узлы кластера во время планового обслуживания или внезапных сбоев с нарушением работы служб.
- **Увеличенная пропускная способность**. Пропускная способность максимальное общего ресурса является общей пропускной способности всех узлов кластера файловых серверов. В отличие от предыдущих версий Windows Server, общая пропускная способность более не ограничивается пропускной способностью одного узла кластера, а определяется возможностями резервной системы хранения, которая задает ограничения. Увеличить общую пропускную способность можно путем добавления узлов.
- **CHKDSK с нулевым временем простоя**. Средство CHKDSK в Windows Server 2012 было значительно улучшено: резко сокращено время файловой системы находится в автономном режиме, для восстановления. Общие тома кластера (CSV) позволяют вообще исключить этап отключения от сети. Файловая система CSV (CSVFS) может использовать операцию CHKDSK, не затрагивая приложения с открытыми дескрипторами в файловой системе.
- **Кэш общего тома**. CSV в Windows Server 2012 обеспечивает поддержку кэша чтения, которая может значительно повысить производительность в некоторых сценариях, например в инфраструктуре виртуальных рабочих столов (VDI).
- **Более простое управление**. С помощью масштабируемого файлового сервера создание масштабируемых файловых серверов и добавьте необходимые CSV и файловые ресурсы. Теперь нет необходимости создавать несколько кластерных файловых серверов с отдельными дисками кластера, а затем разрабатывать политики размещения, чтобы обеспечить работу каждого узла кластера.
- **Автоматическая повторная Балансировка клиентов масштабируемого файлового сервера**. В Windows Server 2012 R2 Автоматическая повторная Балансировка улучшает масштабируемость и управляемость масштабируемых файловых серверов. Клиентские подключения SMB отслеживаются для каждого общего файлового ресурса (а не для каждого сервера), после чего клиенты перенаправляются в узел кластера с оптимальным доступом к тому, используемому общим файловым ресурсом. Это повышает производительность, снижая трафик перенаправления между узлами файлового сервера. Клиенты перенаправляются после начального подключения при перенастройке системы хранения данных кластера.

## <a name="in-this-scenario"></a>Содержание сценария

Следующие разделы помогут вам развернуть масштабируемый файловый сервер.

- [План для масштабируемого файлового сервера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134258(v%3dws.11)>)

  - [Шаг 1. Планирование хранилища на масштабируемом файловом сервере](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134181%28v%3dws.11%29>)
  - [Шаг 2. Планирование сети на масштабируемом файловом сервере](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134253%28v%3dws.11%29>)

- [Развертывание масштабируемого файлового сервера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831359%28v%3dws.11%29>)

  - [Шаг 1. Установка необходимых компонентов для масштабируемого файлового сервера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831478%28v%3dws.11%29>)
  - [Шаг 2. Настройка масштабируемого файлового сервера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831718%28v%3dws.11%29>)
  - [Шаг 3. Настройка Hyper-V для использования масштабируемого файлового сервера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831463%28v%3dws.11%29>)
  - [Шаг 4. Настройка Microsoft SQL Server для использования масштабируемого файлового сервера](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831815%28v%3dws.11%29>)

## <a name="when-to-use-scale-out-file-server"></a>Когда использовать масштабируемый файловый сервер

Масштабируемый файловый сервер не следует использовать, если рабочая нагрузка создает большое количество операций с метаданными, например открытие и закрытие файлов, создание новых файлов или переименование существующих. Типичный пользователь, работающий с информацией, создает множество операций с метаданными. Масштабируемый файловый сервер рекомендуется использовать, если важны масштабируемость и простота и требуются только те технологии, которые поддерживает масштабируемый файловый сервер.

В следующей таблице перечислены возможности SMB 3.0, общие файловые системы Windows, технологии управления данными файловых серверов и общие рабочие нагрузки. Вы можете увидеть, поддерживается ли технология масштабируемым файловым сервером, или требуется традиционный кластерный файловый сервер (также известный как файловый сервер общего назначения).

<table>
<thead>
<tr class="header">
<th>Технологическая область</th>
<th>Компонент</th>
<th>Кластер файлового сервера общего назначения</th>
<th>Масштабируемый файловый сервер</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SMB</td>
<td>Постоянная доступность SMB</td>
<td>Да</td>
<td>Да</td>
</tr>
<tr class="even">
<td>SMB</td>
<td>Технология SMB Multichannel</td>
<td>Да</td>
<td>Да</td>
</tr>
<tr class="odd">
<td>SMB</td>
<td>SMB Direct</td>
<td>Да</td>
<td>Да</td>
</tr>
<tr class="even">
<td>SMB</td>
<td>Шифрование SMB</td>
<td>Да</td>
<td>Да</td>
</tr>
<tr class="odd">
<td>SMB</td>
<td>Прозрачная отработка отказа SMB</td>
<td>Да (если включена постоянная доступность)</td>
<td>Да</td>
</tr>
<tr class="even">
<td>Файловая система</td>
<td>NTFS</td>
<td>Да</td>
<td>Н/Д</td>
</tr>
<tr class="odd">
<td>Файловая система</td>
<td>Восстанавливаемая файловая система (<a href="https://docs.microsoft.com/windows-server/storage/refs/refs-overview">ReFS</a>)</td>
<td>Рекомендуется использовать с хранилищем пространствами</td>
<td>Рекомендуется использовать с хранилищем пространствами</td>
</tr>
<tr class="even">
<td>Файловая система</td>
<td>Файловая система общего тома кластера (CSV)</td>
<td>Н/Д</td>
<td>Да</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>BranchCache</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>Дедупликация данных (Windows Server 2012)</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>Дедупликация данных (Windows Server 2012 R2)</td>
<td>Да</td>
<td>Да (только VDI)</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>Корень корневого сервера пространства имен DFS (DFSN)</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>Целевой сервер папки пространства имен DFS (DFSN)</td>
<td>Да</td>
<td>Да</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>Репликация DFS (DFSR)</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>Диспетчер ресурсов файлового сервера (экраны и квоты)</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>Инфраструктура классификации файлов</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>Динамический контроль доступа (доступ на основе утверждений, CAP)</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>Перенаправление папок</td>
<td>Да</td>
<td>Не рекомендуется*</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>Автономные файлы (кэширование на стороне клиента)</td>
<td>Да</td>
<td>Не рекомендуется*</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>Проверка перемещаемых профилей пользователей</td>
<td>Да</td>
<td>Не рекомендуется*</td>
</tr>
<tr class="odd">
<td>Управление файлами</td>
<td>Домашние каталоги</td>
<td>Да</td>
<td>Не рекомендуется*</td>
</tr>
<tr class="even">
<td>Управление файлами</td>
<td>рабочие папки</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="odd">
<td>NFS</td>
<td>NFS-сервер</td>
<td>Да</td>
<td>Нет</td>
</tr>
<tr class="even">
<td>Приложения</td>
<td>Hyper-V</td>
<td>Не рекомендуется</td>
<td>Да</td>
</tr>
<tr class="odd">
<td>Приложения</td>
<td>Microsoft SQL Server</td>
<td>Не рекомендуется</td>
<td>Да</td>
</tr>
</tbody>
</table>

\* Перенаправление папок, автономных файлов, перемещаемых профилей пользователей и домашние каталоги создать большое количество операций записи, которые должны немедленно записываться на диск (без буферизации) при использовании постоянно доступные файловые ресурсы, снижает быстродействие по сравнению с файловые ресурсы общего назначения. Постоянно доступные файловые ресурсы также несовместимы с диспетчером ресурсов файлового сервера и ПК под управлением Windows XP. Кроме того, автономные файлы могут не переходить в автономный режим за 3–6 минут после того, как пользователь теряет доступ к общей папке, что может расстраивать планы пользователей, еще не использующих постоянный автономный режим для автономных файлов.

## <a name="practical-applications"></a>Практическое применение

Масштабируемые файловые серверы идеально подходят для хранилища серверных приложений. Ниже перечислены некоторые примеры серверных приложений, которые могут хранить свои данные в масштабируемом файловом ресурсе.

- Веб-сервер IIS может хранить конфигурацию и данные для веб-сайтов в масштабируемом файловом ресурсе. Дополнительные сведения см. в разделе [Общая конфигурация](http://www.iis.net/learn/manage/managing-your-configuration-settings/shared-configuration_264).
- Hyper-V может хранить конфигурацию и динамические виртуальные диски в масштабируемом файловом ресурсе. Дополнительные сведения см. в разделе [Развертывание Hyper-V через SMB](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134187(v%3dws.11)>).
- SQL Server может хранить динамические файлы базы данных в масштабируемом файловом ресурсе. Дополнительные сведения см. в разделе [Установка SQL Server с файловым ресурсом SMB в качестве хранилища](https://docs.microsoft.com/sql/database-engine/install-windows/install-sql-server-with-smb-fileshare-as-a-storage-option).
- Диспетчер виртуальных машин (VMM) может хранить общую папку библиотеки (содержащую шаблоны виртуальных машин и связанные файлы) в масштабируемом файловом ресурсе. Тем не менее сам сервер библиотеки не может быть масштабируемого файлового сервера — он должен быть на изолированном сервере или в отказоустойчивом кластере, который не использует кластерную роль масштабируемого файлового сервера.

При использовании масштабируемого файлового ресурса в качестве общей папки библиотеки можно применять только те технологии, которые совместимы с масштабируемым файловым сервером. Например, нельзя использовать репликацию DFS для репликации общей папки библиотеки, размещенной в масштабируемом файловом ресурсе. Также важно наличие на масштабируемом файловом сервере установленных последних обновлений программного обеспечения.

Чтобы использовать масштабируемый файловый ресурс в качестве общей папки библиотеки, сначала добавьте сервер библиотеки (скорее всего, это виртуальная машина) с локальной общей папкой или вообще без общих папок. Затем при добавлении общей папки библиотеки выберите файловый ресурс, размещенный на масштабируемом файловом сервере. Этот ресурс должен быть управляемым VMM и созданным исключительно для использования сервером библиотеки. Также не забудьте установить последние обновления на масштабируемом файловом сервере. Дополнительные сведения о добавлении серверов библиотеки VMM и общих папок библиотеки, см. в разделе [Добавление профилей в библиотеку VMM](https://docs.microsoft.com/system-center/vmm/library-profiles?view=sc-vmm-1801). Список доступных в настоящее время исправлений для файловых служб и служб хранилища см. в [статье базы знаний Майкрософт 2899011](https://support.microsoft.com/help/2899011/list-of-currently-available-hotfixes-for-the-file-services-technologie).

>[!NOTE]
>Некоторые пользователи, например информационные работники, имеют рабочие нагрузки, которые значительно влияют на производительность. Например, если такие операции, как открытие и закрытие файлов, создание новых файлов и переименование существующих файлов, выполняются несколькими пользователями, они оказывают влияние на производительность. Если файловый ресурс включен с непрерывной доступностью, он обеспечивает целостность данных, но также влияет на общую производительность. Для постоянной доступности требуется сквозная запись данных на диск, чтобы обеспечить целостность в случае сбоя узла кластера на масштабируемом файловом сервере. Таким образом, пользователь, который копирует несколько больших файлов на файловый сервер, может ожидать значительно более низкую производительность на постоянно доступном файловом ресурсе.

## <a name="features-included-in-this-scenario"></a>Компоненты, используемые в данном сценарии

В следующей таблице перечислены компоненты, являющиеся частью данного сценария, и описано, как они поддерживают его.

<table>
<thead>
<tr class="header">
<th>Компонент</th>
<th>Способ поддержки сценария</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="failover-clustering.md">Отказоустойчивая кластеризация</a></td>
<td>Отказоустойчивые кластеры в добавлены следующие возможности в Windows Server 2012 для поддержки масштабируемого файлового сервера: Имя распределенной сети, тип ресурса масштабируемого файлового сервера, кластера Общие тома (CSV) 2 и роль высокой доступности масштабируемого файлового сервера. Дополнительные сведения об этих функциях см. в разделе <a href="https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn265972(v%3dws.11)">новые возможности отказоустойчивой кластеризации в Windows Server 2012 [перенаправление]</a>.</td>
</tr>
<tr class="even">
<td><a href="https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831795(v%3dws.11)">Протокол SMB</a></td>
<td>В Windows Server 2012 для поддержки масштабируемого файлового сервера SMB 3.0 добавлены следующие возможности: прозрачную отработку отказа SMB, SMB Multichannel и SMB Direct.<br />
<br />
Дополнительные сведения о новых и измененных возможностях для SMB в Windows Server 2012 R2, см. в разделе <a href="https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831474(v%3dws.11)">новые возможности SMB в Windows Server</a>.</td>
</tr>
</tbody>
</table>

## <a name="more-information"></a>Дополнительные сведения

- [Руководство по вопросам проектирования программно определяемого хранилища](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/mt243829(v%3dws.11)>)
- [Повышение доступности сети, серверов и хранилища](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831437(v%3dws.11)>)
- [Развертывание Hyper-V через SMB](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134187(v%3dws.11)>)
- [Развертывание быстрых и производительных файловых серверов для серверных приложений](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831723(v%3dws.11)>)
- [Масштабировать или нет, вот в чем вопрос](https://blogs.technet.com/b/filecab/archive/2013/12/05/to-scale-out-or-not-to-scale-out-that-is-the-question.aspx) (запись блога)
- [Перенаправление папок, автономными файлами и перемещаемыми профилями пользователей](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh848267(v%3dws.11)>)