---
title: "Последовательное обновление ОС кластера"
ms.prod: windows-server-threshold
ms.technology: storage-failover-clustering
ms.topic: get-started-article
ms.assetid: 6e102c1f-df26-4eaa-bc7a-d0d55d3b82d5
author: jasongerend
ms.author: jgerend
ms.date: 10/17/2017
ms.openlocfilehash: 8463c163294a4d2223a74b7cfeaea6ac5ae4fcfe
ms.sourcegitcommit: 583355400f6b0d880dc0ac6bc06f0efb50d674f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2017
---
# <a name="cluster-operating-system-rolling-upgrade"></a>Последовательное обновление ОС кластера

> Применяется к: Windows Server (канал точками годовой), Windows Server 2016

Последовательного обновления кластерной ОС позволяет администратору обновлять ОС узлов кластера, не останавливая рабочие нагрузки Scale-Out File Server или Hyper-V. С помощью этой функции, можно избежать простоя потерь от службы соглашений об УРОВНЕ обслуживания.

Последовательного обновления кластерной ОС предоставляет следующие преимущества:

- В отказоустойчивых кластерах виртуальной машины Hyper-V и масштабируемого файлового сервера (SOFS) рабочих нагрузок можно обновить из Windows Server 2012 R2 (выполняющееся на всех узлах в кластере) на Windows Server 2016 (выполняющееся на всех узлах кластера кластера) без простоев. Другие рабочими нагрузками кластера, например SQL Server, будет недоступен во время (как правило меньше, чем на пять минут), необходимое для переключения при сбое на Windows Server 2016.  
- Он не требуется дополнительное оборудование. Хотя можно добавить дополнительные узлы кластера временно в небольших кластеры, чтобы повысить доступность кластера во время последовательного обновления кластерной ОС обработать.  
- Кластер не нужно остановить или перезапустить.  
- Новый кластер не является обязательным. Выполняется обновление существующего кластера. Кроме того используются существующие объекты кластера, хранящегося в Active Directory.  
- Процесс обновления не обратимого шифрования, пока пользователь выбирает «точка из нет возврат», если все узлы кластера под управлением Windows Server 2016, и при запуске командлета PowerShell Update-ClusterFunctionalLevel.  
- Кластер может поддерживать исправлений и обслуживание во время работы в режиме смешанных ОС.  
- Он поддерживает автоматизации через PowerShell и WMI.  
- Открытое свойство кластера **ClusterFunctionalLevel** свойство указывает состояние кластера на узлах кластера Windows Server 2016. Это свойство можно запросить с помощью командлета PowerShell с узла кластера Windows Server 2016, который входит в отказоустойчивый кластер:  
    ```PowerShell
    Get-Cluster | Select ClusterFunctionalLevel  
    ```  

    Значение **8** означает, что кластер работает в Windows Server 2012 R2 режим работы. Значение **9** означает, что кластер выполняется в режим работы Windows Server 2016.  

В этом руководстве описаны различные этапы процесса последовательного обновления кластерной ОС, действия по установке, ограничения и часто задаваемые вопросы и предназначена для следующих сценариев последовательного обновления кластерной ОС в Windows Server 2016:  
- Кластеры Hyper-V  
- Кластерах масштабируемых файловых серверов  

Следующие сценарии не поддерживаются в Windows Server 2016:  
-  Последовательного обновления кластерной ОС из гостевых кластеров с помощью виртуального жесткого диска (.vhdx file) как общее хранилище  

Последовательного обновления кластерной ОС с System Center Virtual Machine Manager (SCVMM) 2016 полностью поддерживается. Если вы используете SCVMM 2016, см. раздел [кластеров обновления Windows Server 2012 R2 для Windows Server 2016 в VMM](https://technet.microsoft.com/library/mt445417.aspx) руководство по обновлению кластеров и автоматизации шагов, описанных в этом документе.  

## <a name="requirements"></a>Требования к  
Прежде чем начать процесс последовательного обновления кластерной ОС, выполните следующие требования.

- Начните с отказоустойчивого кластера под управлением Windows Server (канал точками годовой), Windows Server 2016 или Windows Server 2012 R2.
- Обновление кластера локальных дисковых пространств в Windows Server, 1709 версия не поддерживается.
- Если рабочая нагрузка кластера виртуальных машин Hyper-V или масштабируемого файлового сервера, вы можете ожидать простоя ноль обновления.
- Убедитесь, что узлы Hyper-V процессоров, которые поддерживают второго уровня адресации таблицы (SLAT) с помощью одного из следующих методов;  
        -Просмотрите [совместимы вы SLAT? WP8 SDK совет 01](http://blogs.msdn.com/b/devfish/archive/2012/11/06/are-you-slat-compatible-wp8-sdk-tip-01.aspx) статью с описанием два метода, чтобы проверить, поддерживает ли Процессор SLATs  
        -Загрузите [Coreinfo v3.31](https://technet.microsoft.com/sysinternals/cc835722) средство, чтобы определить, поддерживает ли Процессор SLAT.

## <a name="cluster-transition-states-during-cluster-os-rolling-upgrade"></a>Состояния кластера во время последовательного обновления кластерной ОС

В этом разделе описываются различные состояния перехода кластера Windows Server 2012 R2, которая обновляется с помощью последовательного обновления кластерной ОС Windows Server 2016.  

Для выполнения рабочих нагрузок кластера во время последовательного обновления кластерной ОС, перемещении рабочей нагрузки кластера на узле Windows Server 2012 R2 на Windows Server 2016 узел работает, как если бы обоих узлов работает операционная система Windows Server 2012 R2. При добавлении узлов Windows Server 2016 в кластер, они работают в режиме совместимости с Windows Server 2012 R2. Новый режим концептуальное кластера, называется «Режим смешанный ОС», позволяет узлам различных версий существует в том же кластере (см. рис. 1).  

![Иллюстрация, показывающая три этапа последовательного обновления кластера ОС: все узлы Windows Server 2012 R2, режим смешанный операционной системы и все узлы Windows Server 2016](media/Cluster-Operating-System-Rolling-Upgrade/Clustering_RollingUpgrade_Overview.png)  
**Рисунок 1: Кластер переходы состояния операционной системы**  

Кластер Windows Server 2012 R2 переходит в режим смешанный ОС при добавлении узла Windows Server 2016 в кластер. Процесс полностью обратить - узлы Windows Server 2016 можно удалить из кластера, и Windows Server 2012 R2 узлы можно добавить в кластер, в этом режиме. «Точки of нет возврат» происходит при запуске командлета PowerShell Update-ClusterFunctionalLevel в кластере. Для успешного выполнения этого командлета, все узлы должны быть Windows Server 2016, и все узлы должны находиться в оперативном режиме.  

## <a name="transition-states-of-a-four-node-cluster-while-performing-rolling-os-upgrade"></a>Состояния четырех узлов кластера во время последовательного обновления ОС

В этом разделе показано и описание четырех различных этапах кластер с общим хранилищем, узлы будут обновлены с Windows Server 2012 R2 до Windows Server 2016.  

«Этап 1» — это начальное состояние - начнем с кластером Windows Server 2012 R2.  

![Иллюстрация, показывающая начальное состояние: все узлы Windows Server 2012 R2](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_Stage1.png)  
**Рисунок 2: Начальное состояние: отказоустойчивом кластере Windows Server 2012 R2 (этап 1)**  

В «этап 2», два узла были приостановлены, разрядилась, вытеснен, отформатирован и устанавливаются вместе с Windows Server 2016.  

![Иллюстрация, показывающая кластера в режиме смешанных ОС: из 4 узлов кластера пример, двумя узлами под управлением Windows Server 2016 и двумя узлами под управлением Windows Server 2012 R2](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_Stage2.png)  
**Рисунок 3: Промежуточное состояние: режим смешанный ОС: Windows Server 2012 R2 и Windows Server 2016 отказоустойчивого кластера (этап 2)**  

В «этап 3.», все узлы кластера будут обновлены до Windows Server 2016 и кластер готов к обновлению с помощью командлета PowerShell Update-ClusterFunctionalLevel.  

> [!NOTE]  
> На этом этапе процесс полностью может быть изменено, и в этот кластер можно добавить узлы Windows Server 2012 R2.  

![Рисунок, показывающий, что кластера полностью обновлен до Windows Server 2016 и готов к Update-ClusterFunctionalLevel командлет, чтобы перевести в режим работы кластера до Windows Server 2016](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_Stage3.png)  
**Рисунок 4: Промежуточное состояние: все узлы, которые выполнили обновление до Windows Server 2016, готов к Update-ClusterFunctionalLevel (этап 3)**  

После запуска Update-ClusterFunctionalLevelcmdlet кластера вводит «Этап 4», где можно использовать новые компоненты кластера Windows Server 2016.  

![Рисунок, показывающий, что последовательного обновления операционной системы успешно завершена; все узлы будут обновлены до Windows Server 2016, и кластер работает на функциональном уровне кластера Windows Server 2016](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_Stage4.png)  
**Рисунок 5: Конечное состояние: отказоустойчивого кластера Windows Server 2016 (этап 4)**  

## <a name="cluster-os-rolling-upgrade-process"></a>Последовательное обновление кластерной ОС

В этом разделе описывается рабочий процесс для выполнения последовательного обновления кластерной ОС.  

![Иллюстрация, показывающая рабочий процесс для обновления кластера](media/Cluster-Operating-System-Rolling-Upgrade/Clustering_RollingUpgrade_Workflow.png)  
**Рисунок 6: Последовательное рабочий процесс процесс обновления операционной системы кластера**  

ОС последовательного обновления кластера включает следующие этапы:  

1. Подготовка кластера обновления операционной системы следующим образом:  
    1. Последовательного обновления кластерной ОС требует удаление одного узла одновременно с кластера. Проверьте, если у вас есть достаточными возможностями в кластере для обеспечения высокой ДОСТУПНОСТИ соглашений об уровне обслуживания, когда один из узлов кластера удаляется из кластера для обновления операционной системы. Другими словами требуется возможность перехода на другой ресурс рабочих нагрузок на другой узел при удалении один узел из кластера во время последовательного обновления кластерной ОС? Есть ли кластер мощности для запуска выполнение рабочих нагрузок, когда один узел удаляется из кластера для последовательного обновления кластерной ОС?  
    2. Для рабочих нагрузок Hyper-V убедитесь, что все узлы Windows Server 2016 Hyper-V предоставлены ЦП поддержки таблицы адресов второго уровня (SLAT). Только поддержкой SLAT машины могут использовать роль Hyper-V в Windows Server 2016.  
    3. Убедитесь, что резервные копии рабочей нагрузки завершена и рассмотрим резервное копирование кластера. При добавлении узлов в кластер Stop операций резервного копирования.  
    4. Проверьте, что все узлы кластера подключены к сети/работает и вверх с помощью [ `Get-ClusterNode` ](https://technet.microsoft.com/library/ee460990.aspx) командлета (см. рис. 7).  

        ![Показывает результаты выполнения командлета Get-ClusterNode ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_GetClusterNode.png)  
        **Рисунок 7: Определение состояния узла с помощью командлета Get-ClusterNode**  

    5. Если вы используете кластерного обновления (CAU), убедитесь, если кластерное обновление выполняется с помощью **обновление кластера Aware** пользовательского интерфейса, или [ `Get-CauRun` ](https://technet.microsoft.com/library/hh847230.aspx) командлета (см. рис. 8). Прекратить использование CAU [ `Disable-CauClusterRole` ](https://technet.microsoft.com/library/hh847219.aspx) командлета (см. рис. 9) во избежание узлы приостановки и разрядилась, кластерное обновление во время последовательного обновления кластерной ОС.  

        ![Отображение выходных данных командлета Get-CauRun ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_GetCAU.png)  
        **Рисунок 8: С помощью [ `Get-CauRun` ](https://technet.microsoft.com/library/hh847230.aspx) командлет, чтобы определить, работает ли учитывать обновления для кластера на кластер**  

        ![Отображение выходных данных командлета Disable-CauClusterRole ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_DisableCAU.png)  
        **Рисунок 9: Отключение роли учитывать обновления для кластера с помощью [ `Disable-CauClusterRole` ](https://technet.microsoft.com/library/hh847219.aspx) командлета**  

2. Для каждого узла в кластере выполните следующее.  
    1. С помощью пользовательского интерфейса диспетчера кластеров, выберите узел и использовать **приостановить | Постепенное прекращение** меню параметр, чтобы выполнить сток узла (см. рис. 10) или использовать [ `Suspend-ClusterNode` ](https://technet.microsoft.com/library/ee461051.aspx) командлета (см. рис. 11).  

        ![ScreenCap, показывающий, как выполнить сток ролей с помощью пользовательского интерфейса диспетчера кластеров](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_FCM_DrainRoles.png)  
        **Рисунок 10: Сток роли с узла с помощью диспетчера отказоустойчивости кластеров**  

        ![Отображение выходных данных командлета Suspend-ClusterNode ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_SuspendNode.png)  
        **Рисунок 11: Сток роли с узла с помощью [ `Suspend-ClusterNode` ](https://technet.microsoft.com/library/ee461051.aspx) командлета**  

    2.  С помощью пользовательского интерфейса диспетчера кластеров, **исключение** приостановленного узла из кластера или используйте [ `Remove-ClusterNode` ](https://technet.microsoft.com/library/ee461001.aspx) командлета.  

        ![Отображение выходных данных командлета Remove-ClusterNode ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_RemoveNode.png)  
        **Рис. 12: Удаление узла из кластера с помощью [ `Remove-ClusterNode` ](https://technet.microsoft.com/library/ee461001.aspx) командлета**  

    3.  Переформатировать на системном диске и выполнение «чистой установки операционной системы» Windows Server 2016 на узел с помощью **Выборочная: установить только Windows (Дополнительно)** вариант установки (см. рис. 13) в setup.exe. Не выбирайте **обновление: Установка Windows и храните файлы, параметры и приложения** вариант, поскольку последовательного обновления кластерной ОС не рекомендуется обновление на месте.  

        ![ScreenCap мастера установки Windows Server 2016, показывающая выбранным параметром выборочной установки](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_InstallOption.png)  
        **Рис. 13: Доступных параметров установки для Windows Server 2016**  

    4.  Добавление узла к соответствующему домену Active Directory.  
    5.  Добавьте соответствующих пользователей в группу администраторов.  
    6.  С помощью пользовательского интерфейса диспетчера сервера или PowerShell Install-WindowsFeature командлета установки любой роли сервера, которые вам нужны, таких как Hyper-V.  

        ```PowerShell
        Install-WindowsFeature -Name Hyper-V  
        ```  

    7.  С помощью командлета пользовательского интерфейса диспетчера серверов или Install-WindowsFeature PowerShell, установите компонент отказоустойчивой кластеризации.  

        ```PowerShell
        Install-WindowsFeature -Name Failover-Clustering  
        ```  

    8.  Установите дополнительные компоненты, необходимые для рабочих нагрузок кластера.  
    9. Проверьте параметры подключения к сети и хранилища с помощью пользовательского интерфейса диспетчера отказоустойчивости кластеров.  
    10. Если используется брандмауэр Windows, проверьте правильность настройки брандмауэра для кластера. Например кластеры кластерного обновления (CAU) включена может потребовать настройки брандмауэра.  
    11. Для рабочих нагрузок Hyper-V, используйте пользовательский Интерфейс диспетчера Hyper-V, чтобы открыть диалоговое окно Диспетчер виртуальных коммутаторов (см. рис. 14).  

        Убедитесь, что имя виртуального Switch(s) используется одинаков для всех узлов Hyper-V в кластере.  

        ![ScreenCap показанным расположением диалогового окна Диспетчер виртуальных коммутаторов Hyper-V](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_VMSwitch.png)  
        **На рис. 14: Диспетчер виртуальных коммутаторов**  

    12. На узле Windows Server 2016 (не используйте узел Windows Server 2012 R2), используйте диспетчер отказоустойчивого кластера (см. рис. 15) для подключения к кластеру.  

        ![ScreenCap отображением диалогового окна выберите кластера](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_AddNode.png)  
        **Рис. 15: Добавление узла к кластеру с помощью диспетчера отказоустойчивости кластеров**  

    13. Используйте Интерфейс диспетчера отказоустойчивости кластеров или [ `Add-ClusterNode` ](https://technet.microsoft.com/library/ee461047.aspx) командлета (см. рис. 16) Добавление узла в кластер.  

        ![Отображение выходных данных командлета Add-ClusterNode ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_AddNode3.png)  
        **На рисунке 16: Добавление узла кластера с помощью [ `Add-ClusterNode` ](https://technet.microsoft.com/library/ee461047.aspx) командлета**  

        > [!NOTE]  
        > При первом узле Windows Server 2016 присоединяется к кластеру, кластер переходит в режим «Смешанный ОС», и основные ресурсы кластера, перемещаются на узел Windows Server 2016. Кластера режима «Смешанный ОС» — это полностью работоспособным кластер, где новые узлы работают в режиме совместимости с старый узлами. Режим «Смешанный ОС» — это временной режим для кластера. Не должен быть постоянным и клиенты должны обновить все узлы кластера их в течение четырех недель.  

    14. После выпуска Windows Server 2016 узел успешно добавляется в кластер, можно (при необходимости) переместить некоторые из рабочей нагрузки кластера вновь добавленный узел для балансировки нагрузки в кластере следующим образом:

        ![Отображение выходных данных командлета Move-ClusterVirtualMachineRole ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_MoveVMRole.png)  
        **Рисунок 17: Перемещение рабочей нагрузки (кластерной роли виртуальной Машины) кластера с помощью [ `Move-ClusterVirtualMachineRole` ](https://technet.microsoft.com/library/ee461041.aspx) командлета**  

        1. Используйте **динамической миграции** из диспетчера отказоустойчивости кластеров для виртуальных машин или [ `Move-ClusterVirtualMachineRole` ](https://technet.microsoft.com/library/ee461041.aspx) командлета (см. Рисунок 17) для выполнения динамической миграции виртуальных машин.  

            ```PowerShell
            Move-ClusterVirtualMachineRole -Name VM1 -Node robhind-host3  
            ```  

        2. Используйте **переместить** из диспетчера отказоустойчивости кластеров или [ `Move-ClusterGroup` ](https://technet.microsoft.com/library/ee461002.aspx) командлет для других рабочих нагрузок кластера.  

3. При каждом узле выполнили обновление до Windows Server 2016 и добавлены в кластер или удалялись оставшиеся узлы Windows Server 2012 R2, выполните следующие действия.  

    > [!IMPORTANT]  
    > -   После обновления режим работы кластера, вы не сможете перейти на режим работы Windows Server 2012 R2 и Windows Server 2012 R2 узлы нельзя добавить в кластер.
    > -   Пока [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) выполняется командлет, процесс полностью обратимое и узлы Windows Server 2012 R2 можно добавить в этот кластер и узлы Windows Server 2016, можно удалить.  
    > -   После [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) выполняется командлет, будут доступны новые функции.  

    1.  С помощью пользовательского интерфейса диспетчера отказоустойчивости кластеров или [ `Get-ClusterGroup` ](https://technet.microsoft.com/library/ee461017.aspx) командлета, убедитесь, что все роли кластера под управлением в кластере, как ожидалось. В следующем примере не используется доступное хранилище, вместо этого используется CSV, поэтому отображается доступное хранилище **автономные** состояние (см. Рисунок 18).  

        ![Отображение выходных данных командлета Get-ClusterGroup ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_GetClusterGroup.png)  
        **Рисунок 18: Проверка того, что все кластера групп (кластерных ролей) выполняются с помощью [ `Get-ClusterGroup` ](https://technet.microsoft.com/library/ee461017.aspx) командлета**  

    2.  Проверьте, что все узлы кластера находятся в сети и выполнения с помощью [ `Get-ClusterNode` ](https://technet.microsoft.com/library/ee460990.aspx) командлета.  
    3.  Запустите [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) командлет - ошибки не должны быть возвращены (см. Рисунок 19).  

        ![Отображение выходных данных командлета Update-ClusterFunctionalLevel ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_SelectFunctionalLevel.png)  
        **На рисунке 19: Обновление режим работы кластера с помощью PowerShell**  

    4.  После [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) выполняется командлет, доступны новые функции.  

4. Windows Server 2016 — возобновить работу обновления для обычных кластера и резервные копии.  

    1. Если вы ранее использовали кластерное обновление, перезагрузите его с помощью пользовательского интерфейса CAU или использовать [ `Enable-CauClusterRole` ](https://technet.microsoft.com/library/hh847229.aspx) командлета (см. рисунок 20).  

        ![Отображение выходных данных Enable-CauClusterRole ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_EnableCAUClusterRole.png)  
        **Рисунок 20: Учитывать обновления для кластера Enable роли с помощью [ `Enable-CauClusterRole` ](https://technet.microsoft.com/library/hh847229.aspx) командлета**  

    2. Возобновить операции резервного копирования.  

5. Включение и использование функции Windows Server 2016 на виртуальных машинах Hyper-V.  

    1. После обновления кластера режим работы Windows Server 2016 многих рабочих нагрузок, таких как виртуальные машины Hyper-V будут установлены новые возможности. Список новых возможностей Hyper-V. в разделе [перенос и обновление виртуальных машин](https://msdn.microsoft.com/virtualization/hyperv_on_windows/user_guide/migrating_vms)  

    2. На каждом узле узла Hyper-V в кластере, с помощью [ `Get-VMHostSupportedVersion` ](https://technet.microsoft.com/library/mt653838.aspx) командлет, чтобы просмотреть версии конфигурации виртуальной Машины Hyper-V, поддерживаемые приложением.  

        ![Отображение выходных данных командлета Get-VMHostSupportedVersion ScreenCap](media/Cluster-Operating-System-Rolling-Upgrade/Clustering_GetVMHostSupportVersion.png)  
        **Рисунок 21: Просмотр версии конфигурации виртуальной Машины Hyper-V, поддерживаемые приложением**  

   3.  На каждом узле узла Hyper-V в кластере, версии конфигурации виртуальной Машины Hyper-V можно обновить планирования краткое период обслуживания с пользователями, резервное копирование, отключите виртуальных машин и под управлением [ `Update-VMVersion` ](https://technet.microsoft.com/library/mt484146.aspx) командлета (см. Рисунок 22). Это обновление версии виртуальной машины и реализации новых функций Hyper-V, исключая необходимость будущие обновления компонентов интеграции Hyper-V (IC). Этот командлет можно запустить из узла Hyper-V, на котором размещается виртуальная машина, или `-ComputerName` параметр можно использовать для удаленного обновление версии виртуальной Машины. В этом примере здесь мы обновление версии конфигурации VM1 с 5.0 до версии 7.0 воспользоваться преимуществами несколько новых функций Hyper-V, связанные с этой версии конфигурации виртуальной Машины, например рабочие контрольные точки (согласованное приложений резервного копирования) и двоичный файл конфигурации виртуальной Машины.  

        ![ScreenCap, показывая Update-VMVersion командлет в действии](media/Cluster-Operating-System-Rolling-Upgrade/Cluster_RollingUpgrade_StopVM.png)  
        **На рисунке 22: Обновление версии виртуальной Машины с помощью командлета PowerShell Update-VMVersion**  

4.  Пулы носителей можно обновить с помощью [Update-StoragePool](https://technet.microsoft.com/itpro/powershell/windows/storage/update-storagepool) командлета PowerShell — это является интерактивной операцией.  

Несмотря на то, что мы ожидаем сценариев частного облака, в частности Hyper-V и кластеров масштабируемого файлового сервера, которые можно обновить без простоев, процесс последовательного обновления кластерной ОС можно использовать для любой роли кластера.  

## <a name="restrictions--limitations"></a>Ограничения и ограничения  
- Эта функция работает только для Windows Server 2012 R2, и только в версии Windows Server 2016. Эта функция не может обновить более ранних версий Windows Server, например, Windows Server 2008, Windows Server 2008 R2 или Windows Server 2012 на Windows Server 2016.  
- Каждый узел Windows Server 2016 следует только переформатированы или новой установки. «На месте» или «обновить» типа установки не рекомендуется.  
- Узел Windows Server 2016 должны использоваться для добавления узлов Windows Server 2016 в кластер.  
- Если управление кластером режим смешанный операционной системы, всегда выполняйте задачи управления из узла верхнего уровня, на котором работает Windows Server 2016. Узлы нижнего уровня Windows Server 2012 R2 нельзя использовать средства пользовательского интерфейса или управления от Windows Server 2016.  
- Рекомендуется, так как некоторые компоненты кластера не оптимизированы для режима смешанного ОС быстрое перемещение через процесс обновления кластера.  
- Избежать создания или изменения размера хранилища для узлов Windows Server 2016, пока кластер работает в режиме смешанных ОС из-за несовместимости возможно при отработке отказа с узла Windows Server 2016 в узлы нижнего уровня Windows Server 2012 R2.  

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы  
**Длительность отказоустойчивого кластера работы в режиме смешанных ОС?**  
    Рекомендуется для завершения обновления в течение четырех недель. Существует множество оптимизации в Windows Server 2016. Успешно обновили Hyper-V и кластеров масштабируемого файлового сервера с нулевым временем простоя в общее меньше четырех часов.  

**Будет перенесена этой функции Windows Server 2012, Windows Server 2008 R2 или Windows Server 2008?**  
    Мы не получим все планы переносить эта функция предыдущих версий. Последовательного обновления кластерной ОС является наше видение для обновления кластеров Windows Server 2012 R2, Windows Server 2016, а также других платформ.  

**Необходимо установлены все обновления программного обеспечения перед запуском процесса последовательного обновления кластерной ОС кластера Windows Server 2012 R2?**  
    Да, прежде чем приступать к последовательного обновления кластерной ОС, убедитесь, что все узлы кластера будут обновляться с последними обновлениями программного обеспечения.  

**Можно запустить [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) командлета во время узлы будут выключены или приостановлена?**  
    Нет. Все узлы кластера должны быть и в активной членства для [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) командлет работал.  

**Последовательного обновления кластерной ОС работает для любой рабочей нагрузкой кластера? Это работает для SQL Server?**  
    Да, последовательного обновления кластерной ОС работает для любой рабочей нагрузки кластера. Однако это только ноль простоев для Hyper-V и кластеров масштабируемого файлового сервера. Большинство других рабочих нагрузок взимается некоторое время простоя (обычно несколько минут), когда они и отработка отказа не требуется по крайней мере один раз во время последовательного обновления кластерной ОС.  

**Можно автоматизировать этот процесс, с помощью PowerShell**  
    Да, мы предусмотрели последовательного обновления кластерной ОС для можно автоматизировать с помощью PowerShell.  

**Для больших кластера, который имеет дополнительные рабочей нагрузки и отказоустойчивость можно ли обновить нескольким узлам одновременно?**  
    Да. При удалении один узел из кластера для обновления операционной системы кластера будут иметь один меньше узел для отработки отказа, поэтому будет емкости ограниченной отработки отказа. Для больших кластеров с достаточно рабочей нагрузки и отказоустойчивость на нескольких узлах, можно обновить одновременно. Можно временно добавьте узлы кластера в кластеры, чтобы обеспечить улучшенные рабочей нагрузки и отказоустойчивость во время последовательного обновления кластерной ОС.  

**Что делать, если я обнаружить ошибку в моем кластер после [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx) была успешно выполнена?**  
    Если вы архивированной базы данных кластера с помощью резервной копии состояния системы перед запуском [ `Update-ClusterFunctionalLevel` ](https://technet.microsoft.com/library/mt589702.aspx), можно выполнить Authoritative восстанавливать на узле кластера Windows Server 2012 R2 и восстановить исходную базу данных кластера и конфигурации.  

**Можно использовать обновление на месте для каждого узла, вместо того чтобы использовать Установка чистой операционной системы, переформатировав диск системы?**  
    Мы не рекомендуем использование обновление на месте Windows Server, но нам известно, что он работает в некоторых случаях, где используются стандартные драйверы. Внимательно прочитайте все предупреждающие сообщения отображаются во время обновления на месте в узле кластера.  

**Если я использую репликации Hyper-V для виртуальной Машины Hyper-V на моем кластера Hyper-V, репликация остается неизменным во время и после завершения процесса последовательного обновления кластерной ОС?**  
    Да, реплика Hyper-V не изменяется во время и после завершения процесса последовательного обновления кластерной ОС.  

**Можно использовать System Center 2016 виртуальной машины Manager (SCVMM) для автоматизации процесса последовательного обновления кластерной ОС?**  
    Да, можно автоматизировать процесс последовательного обновления кластерной ОС, с помощью VMM в System Center 2016.  

## <a name="see-also"></a>См. также:  
-   [Заметки о выпуске: Важные проблемы в Windows Server 2016](../get-started/Release-Notes--Important-Issues-in-Windows-Server-2016-Technical-Preview.md)  
-   [Новые возможности Windows Server 2016](../get-started/What-s-New-in-windows-server-2016.md)  
-   [Новые возможности отказоустойчивой кластеризации в Windows Server](whats-new-in-failover-clustering.md)  