---
ms.assetid: 6416d125-bcaf-433d-971a-2f0283bca2c2
title: Часто задаваемые вопросы об обновлении с поддержкой кластера
ms.topic: article
ms.prod: windows-server
manager: dongill
ms.author: jgerend
author: JasonGerend
ms.date: 04/28/2017
description: Ответы на часто задаваемые вопросы об обновлении с поддержкой кластеров в Windows Server.
ms.openlocfilehash: a08366c7e64d9612d63e348d4cecdb4b2389737a
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71361347"
---
# <a name="cluster-aware-updating-frequently-asked-questions"></a>Обновление с поддержкой кластера: Вопросы и ответы

> Относится к: Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

[Обновление с поддержкой кластера](cluster-aware-updating.md) \(CAU @ no__t-2 — это функция, которая координирует обновления программного обеспечения на всех серверах в отказоустойчивом кластере таким образом, что не влияет на доступность службы больше, чем плановая отработка отказа узла кластера. Для некоторых приложений с функциями непрерывной доступности \(such как Hyper @ no__t-1V с динамической миграцией или с помощью файлового сервера SMB 3. x с прозрачной отработкой отказа SMB no__t-2, CAU может координировать автоматическое обновление кластера без влияния на службу. ресурс.

## <a name="does-cau-support-updating-storage-spaces-direct-clusters"></a>Поддерживает ли CAU обновление кластеров Локальные дисковые пространства?  
Да. CAU поддерживает обновление [Локальные дисковые пространстваных](../storage/storage-spaces/storage-spaces-direct-overview.md) кластеров независимо от типа развертывания: с помощью технологии согласования или согласования. В частности, согласование CAU гарантирует, что приостановка каждого узла кластера ожидает работоспособности базового кластерного пространства хранения.

## <a name="does-cau-work-with-windowsserver-2008r2-or-windows7"></a>Работает ли кластерное обновление с Windows Server 2008 R2 или Windows 7?  
Нет. CAU координирует операцию обновления кластера только с компьютеров под управлением Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 10, Windows 8.1 или Windows 8. Обновляемый отказоустойчивый кластер должен работать под управлением Windows Server 2016, Windows Server 2012 R2 или Windows Server 2012.
  
## <a name="is-cau-limited-to-specific-clustered-applications"></a>Ограничена ли CAU конкретными кластеризованными приложениями?  
Нет. Для кластерного обновления не важен тип кластерного приложения. CAU — это внешнее кластерное решение @ no__t-0updating, которое размещается на основе API кластеризации и командлетов PowerShell. Таким образом, CAU может координировать обновление любого кластеризованного приложения, настроенного в отказоустойчивом кластере Windows Server.  
  
> [!NOTE]  
> В настоящее время для CAU протестированы и сертифицированы следующие кластеризованные рабочие нагрузки: SMB, Hyper @ no__t-0V, репликация DFS, пространства имен DFS, iSCSI и NFS.  
  
## <a name="does-cau-support-updates-from-microsoft-update-and-windows-update"></a>Поддерживает ли кластерное обновление обновление из Центра обновления Майкрософт и Центра обновления Windows?  
Да. По умолчанию CAU настраивается с помощью подключаемого модуля @ no__t-0in, который использует служебные API-интерфейсы агента Центр обновления Windows @no__t — 1WUA @ no__t-2 на узлах кластера. Инфраструктуру WUA можно настроить так, чтобы она указывала на Центр обновления Майкрософт и Центр обновления Windows или на Windows Server Update Services \(WSUS @ no__t-1 в качестве источника обновлений.  
  
## <a name="does-cau-support-wsus-updates"></a>Поддерживает ли кластерное обновление обновления WSUS?  
Да. По умолчанию CAU настраивается с помощью подключаемого модуля @ no__t-0in, который использует служебные API-интерфейсы агента Центр обновления Windows @no__t — 1WUA @ no__t-2 на узлах кластера. Инфраструктуру WUA можно настроить так, чтобы она указывала на Центр обновления Майкрософт и Центр обновления Windows или на локальный сервер Windows Server Update Services \(WSUS @ no__t-1 в качестве источника обновлений.  
  
## <a name="can-cau-apply-limited-distribution-release-updates"></a>Способно ли кластерное обновление применять выпуски обновлений для ограниченного распространения?  
Да. Ограниченный выпуск \(LDR @ no__t-1 обновления, которые также называются исправлениями, не публикуются с помощью Центр обновления Майкрософт или Центр обновления Windows, поэтому они не могут быть скачаны агентом Центр обновления Windows \(WUA @ no__t-3 Plug @ no__t-4in, который CAU использует по умолчанию. .  
  
Тем не менее, CAU включает второй подключаемый модуль @ no__t-0in, который можно выбрать для применения обновлений исправлений. Это исправление Plug @ no__t-0in также может быть настроено для применения драйверов, отличных от @ no__t-1Microsoft, встроенного по и обновлений BIOS.  
  
## <a name="can-i-use-cau-to-apply-cumulative-updates"></a>Можно ли использовать CAU для применения накопительных пакетов обновлений?  
Да. Если накопительные пакеты обновлений представляют собой обновления выпуска для общего распространения или обновления LDR, CAU может применить их.  
  
## <a name="can-i-schedule-updates"></a>Можно ли запланировать обновления?  
Да. Кластерное обновление поддерживает следующие режимы обновления, оба из которых позволяют назначать расписание для установки обновлений:  
  
**Self @ no__t-1updating** Позволяет кластеру обновлять себя в соответствии с определенным профилем и обычным расписанием, например в течение ежемесячного периода обслуживания. Можно также запустить Self @ no__t-0Updating по запросу в любое время. Чтобы включить режим Self @ no__t-0updating, необходимо добавить кластерную роль CAU в кластер. Функция CAU Self @ no__t-0updating работает как любая другая кластеризованная Рабочая нагрузка и может беспрепятственно работать с запланированными и незапланированными отработкой отказа компьютера координатора обновлений.  
  
**Remote @ no__t-1updating** Позволяет запускать обновление в любое время с компьютера, работающего под управлением Windows или Windows Server. Вы можете запустить обновление с помощью окна "кластерное обновление" или с помощью командлета PowerShell **Invoke @ no__t-1CauRun** . Remote @ no__t-0updating — это режим обновления по умолчанию для CAU. Можно запускать командлет [Invoke-CauRun](https://technet.microsoft.com/itpro/powershell/windows/cluster-aware-updating/invoke-caurun) по расписанию с удаленного компьютера, который не является одним из узлов кластера, с помощью планировщика заданий.  
  
## <a name="can-i-schedule-updates-to-apply-during-a-backup"></a>Можно ли запланировать обновление для применения во время резервного копирования?  
Да. CAU не накладывает никаких ограничений в этом отношении. Однако выполнение обновлений программного обеспечения на сервере \(with связанным возможным перезапуском @ no__t-1, пока выполняется резервное копирование сервера, не рекомендуется. Помните, что при определении отработки отказа и восстановления размещения ресурса кластерное обновление применяет только API кластеризации, поэтому кластерному обновлению неизвестно, что выполняется архивация сервера.  
  
## <a name="can-cau-work-with-system-center-configuration-manager"></a>Может ли CAU работать с System Center Configuration Manager?  
CAU — это средство, которое координирует обновления программного обеспечения на узле кластера, а Configuration Manager также выполняет обновления серверного программного обеспечения. Важно настроить эти средства таким образом, чтобы они не перекрывали покрытие тех же серверов в любом развертывании центра обработки данных, включая использование разных серверов Windows Server Update Services. Это гарантирует, что цель использования CAU не будет случайно непреднамеренно заблокирована, так как Configuration Manager @ no__t-0driven не поддерживает сведения о кластере.  
  
## <a name="do-i-need-administrative-credentials-to-run-cau"></a>Нужны ли мне учетные записи администратора, чтобы запустить кластерное обновление?  
Да. Для запуска средств CAU кластерному обновлению требуются учетные данные администратора на локальном сервере либо право пользователя **Олицетворение клиента после проверки подлинности** на локальном сервере или на клиентском компьютере, на котором работает кластерное обновление. Однако для координации обновлений программного обеспечения в узлах кластера кластерному обновлению требуются учетные данные администратора кластера на каждом узле. Хотя пользовательский интерфейс CAU может запускаться без учетных данных, он запрашивает учетные данные администратора кластера при подключении к экземпляру кластера для предварительного просмотра или применения обновлений.  
  
## <a name="can-i-script-cau"></a>Можно ли создать сценарий для CAU?  
Да. CAU поставляется с командлетами PowerShell, предлагающими широкий набор вариантов создания сценариев. Это те же командлеты, которые пользовательский интерфейс кластерного обновления вызывает, чтобы выполнять действия кластерного обновления.  

## <a name="what-happens-to-active-clustered-roles"></a>Что происходит с активными кластерными ролями?

Кластерные роли \(formerly под названием приложения и службы @ no__t-1, активные на узле, отправляют отказ на другие узлы перед началом обновления программного обеспечения. CAU управляет такой отработкой отказа, используя режим обслуживания, который приостанавливает и очищает узел от всех активных кластерных ролей. После завершения обновления программного обеспечения кластерное обновление возобновляет работу узла, и кластерные роли восстанавливаются после сбоя в обновленном узле. Благодаря этому распределение кластерных ролей между узлами кластера после выполнения кластерного обновления сохраняется.  
  
## <a name="how-does-cau-select-target-nodes-for-clustered-roles"></a>Как CAU выбирает целевые узлы для кластерных ролей?

Для координации отработки отказа CAU использует API кластеризации. Реализация API кластеризации выбирает целевые узлы, полагается на внутренние метрики и интеллектуальный эвристический механизм размещения \(such в качестве уровней рабочей нагрузки @ no__t-1 между целевыми узлами.  
  
## <a name="does-cau-load-balance-the-clustered-roles"></a>Распределяет ли CAU кластерные роли в балансировке нагрузки?

CAU не распределяет нагрузку на кластерные узлы, но пытается сохранить распределение кластерных ролей. Завершив обновление узла кластера, CAU пытается восстановить ранее размещенные кластерные роли после сбоя. Чтобы восстановить ресурсы после сбоя до состояния на момент приостановки, кластерное обновление использует API кластеризации. Таким образом, при отсутствии незапланированных отработок отказа и настроек предпочтительного владельца распределение кластерных ролей должно оставаться без изменений.  
  
## <a name="how-does-cau-select-the-order-of-nodes-to-update"></a>Каким образом кластерное обновление выбирает порядок обновления узлов?  
По умолчанию кластерное обновление выбирает порядок обновления узлов на основании их уровня активности. В первую очередь обновляются узлы, на которых размещено наименьшее число кластерных ролей. Однако администратор может указать конкретный порядок обновления узлов, указав параметр для прогона обновления в пользовательском интерфейсе CAU или с помощью командлетов PowerShell.  
  
## <a name="what-happens-if-a-cluster-node-is-offline"></a>Что произойдет, если узел кластера находится в автономном режиме?

Администратор, запускающий выполнение обновления, может задать порог количества узлов, которые могут быть не в сети. Поэтому выполнение обновления может продолжать обновление кластера, даже если все узлы кластера отключены от сети.  
  
## <a name="can-i-use-cau-to-update-only-a-single-node"></a>Можно ли использовать CAU для обновления только одного узла?  
Нет. CAU — это средство обновления кластера @ no__t-0scoped, которое позволяет выбирать только кластеры для обновления. Чтобы обновить отдельный узел, можно использовать существующие средства обновления сервера независимо от кластерного обновления.  
  
## <a name="can-cau-report-updates-that-are-initiated-from-outside-cau"></a>Можно ли выполнять обновления отчетов CAU, инициированные извне CAU?  
Нет. Кластерное обновление может сообщать только о выполнении обновления, запущенном из кластерного обновления. Однако при запуске последующего прогона обновления CAU для определения дополнительных обновлений, которые могут быть применимы к каждому узлу кластера, следует учитывать обновления, которые были установлены с помощью методов, отличных от @ no__t-0CAU.  
  
## <a name="can-cau-support-my-unique-it-process-needs"></a>Может ли CAU поддерживать свои уникальные потребности в ИТ – процессах?  
Да. Кластерное обновление предлагает следующие возможности адаптации к индивидуальным потребностям клиента в ИТ-обеспечении:  
  
**Сценарии** В прогоне обновления можно указать скрипт PowerShell @ no__t-1update и сценарий PowerShell POST @ no__t-2update. Сценарий pre @ no__t-0update выполняется на каждом узле кластера перед приостановкой узла. После установки обновлений узла сценарий post @ no__t-0update выполняется на каждом узле кластера.  
  
> [!NOTE]  
> .NET Framework 4,6 или 4,5 и PowerShell должны быть установлены на каждом узле кластера, на котором необходимо выполнять скрипты pre @ no__t-0update и POST @ no__t-1update. Также необходимо включить удаленное взаимодействие PowerShell на узлах кластера. Дополнительные сведения о требованиях к системе см. в разделе [требования и рекомендации по обновлению с поддержкой кластера](cluster-aware-updating-requirements.md).  
  
**Дополнительные параметры** прогона обновления Администратор может дополнительно указать из большого набора дополнительных параметров прогона обновления, таких как максимальное число повторных попыток обновления на каждом узле. Эти параметры можно указать с помощью пользовательского интерфейса CAU или командлетов CAU PowerShell. Эти настраиваемые параметры можно сохранить в профиле запуска обновления и использовать для последующих запусков обновления.  
  
**Открытая архитектура Plug @ no__t-1in** CAU включает функции для регистрации, отмены регистрации и выбора командлета Plug @ no__t-2ins. В состав CAU входит два подключения по умолчанию: @ no__t-0ins. один из них координирует Центр обновления Windows Агент \(WUA @ no__t-2 на каждом узле кластера. Вторая возможность применяет исправления, которые вручную копируются в общую папку, доступную для узлов кластера. Если предприятие имеет уникальные требования, которые не могут быть выполнены с этими двумя подключаемыми модулями @ no__t-0ins, предприятие может создать новый подключаемый модуль CAU @ no__t-1in в соответствии со спецификацией общедоступного API. Дополнительные сведения см. в разделе [cluster @ no__t-1Aware обновить ссылку @ no__t-2in](https://msdn.microsoft.com/library/hh418084(VS.85).aspx).  
  
Сведения о настройке и настройке CAU Plug @ no__t-0ins для поддержки различных сценариев обновления см. в статье [как подключить @ no__t-2ins](assetId:///847b571b-12b3-473c-953f-75a5a1f51333).  
  
## <a name="how-can-i-export-the-cau-preview-and-update-results"></a>Как можно экспортировать из кластерного обновления результаты просмотра и обновления?  
CAU предлагает варианты экспорта через интерфейс Command @ no__t-0line и через пользовательский интерфейс.  
  
**Параметры интерфейса command @ no__t-1line:**  
  
-   Предварительный просмотр результатов с помощью командлета PowerShell **Invoke @ no__t-1CauScan | ConvertTo @ no__t-2Xml**. Вывод: XML  
  
-   Отчет о результатах с помощью командлета PowerShell **Invoke @ no__t-1CauRun | ConvertTo @ no__t-2Xml**. Вывод: XML  
  
-   Отчет о результатах с помощью командлета PowerShell **Get @ no__t-1CauReport | Экспорт @ no__t-2CauReport**. Вывод: HTML, CSV  
  
**Параметры пользовательского интерфейса:**  
  
-   Копирование результатов отчета из экрана **Просмотр обновлений**. Вывод: CSV  
  
-   Копирование результатов отчета из экрана **Создать отчет**. Вывод: CSV  
  
-   Экспорт результатов отчета из экрана **Создать отчет** . Вывод: HTML  
  
## <a name="how-do-i-install-cau"></a>Как установить кластерное обновление?  
Установка CAU легко интегрируется в компонент отказоустойчивой кластеризации. Установка кластерного обновления выполняется следующим образом:  
  
-   При установке отказоустойчивой кластеризации на узле кластера автоматически устанавливается поставщик CAU инструментарий управления Windows (WMI) \(WMI @ no__t-1.  
  
-   Если компонент средств отказоустойчивой кластеризации установлен на сервере или клиентском компьютере, автоматически устанавливаются интерфейс обновления с поддержкой кластера и командлеты PowerShell.
  
## <a name="does-cau-need-components-running-on-the-cluster-nodes-that-are-being-updated"></a>Требуется ли для CAU компоненты, выполняющиеся на обновляемых узлах кластера?  
CAU не требуется служба, работающая на узлах кластера. Однако для CAU требуется программный компонент \(the WMI Provider @ no__t-1, установленный на узлах кластера. Этот компонент устанавливается вместе с компонентом отказоустойчивой кластеризации.  
  
Чтобы включить режим Self @ no__t-0updating, в кластер необходимо также добавить кластерную роль CAU.  
  
## <a name="what-is-the-difference-between-using-cau-and-vmm"></a>В чем разница между использованием CAU и VMM?  
  
-   System Center Virtual Machine Manager \(VMM @ no__t-1 посвящена обновлению только кластеров Hyper @ no__t-2V, тогда как CAU может обновить любой тип поддерживаемого отказоустойчивого кластера, включая кластеры Hyper @ no__t-3V.  
  
-   VMM требует дополнительного лицензирования, тогда как CAU лицензируется для всех Windows Server. Возможности, средства и пользовательский интерфейс кластерного обновления устанавливаются вместе с компонентами отказоустойчивой кластеризации.  
  
-   Если вы уже владеете лицензией System Center, можно продолжать использовать VMM для обновления кластеров Hyper @ no__t-0V, так как он обеспечивает интегрированное управление и обновление программного обеспечения.  
  
-   CAU поддерживается только в кластерах под Windows Server 2016, Windows Server 2012 R2 и Windows Server 2012. VMM также поддерживает кластеры Hyper @ no__t-0V на компьютерах под управлением Windows Server 2008 R2 и Windows Server 2008.  
  
## <a name="can-i-use-remote-updating-on-a-cluster-that-is-configured-for-self-updating"></a>Можно ли использовать удаленный @ no__t-0updating в кластере, настроенном для Self @ no__t-1updating?  
Да. Отказоустойчивый кластер в конфигурации Self @ no__t-0updating можно обновить с помощью удаленного @ no__t-1updating в @ no__t-2demand, точно так же, как можно принудительно выполнить проверку Центр обновления Windows в любое время на компьютере, даже если Центр обновления Windows настроен для установки обновлений. автоматической. Однако следует убедиться, что выполнение обновления не происходит в данный момент.  
  
## <a name="can-i-reuse-my-cluster-update-settings-across-clusters"></a>Могу ли я применить свои параметры обновления кластера ко всем кластерам?  
Да. Кластерное обновление поддерживает разные параметры выполнения обновления, определяющие, как ведет себя выполнение обновления, обновляя кластер. Эти параметры можно сохранить в качестве профиля выполнения обновления, и тогда их можно применять к любому кластеру. Рекомендуется сохранять и повторно использовать настройки для отказоустойчивых кластеров со сходными потребностями обновления. Например, можно создать профиль выполнения "Business @ no__t-0Critical SQL Server с обновлением кластера" для всех кластеров Microsoft SQL Server, которые поддерживают службы Business @ no__t-1critical.  
  
## <a name="where-is-the-cau-plug-in-specification"></a>Где находится спецификация CAU Plug @ no__t-0in?  
  
-   [Cluster @ no__t-1Aware. обновление справочника по вилке @ no__t-2in](https://msdn.microsoft.com/library/hh418084(VS.85).aspx)  
  
-   [Пример обновления модуля Plug @ no__t-1in с поддержкой кластера](https://code.msdn.microsoft.com/windowsdesktop/Cluster-Aware-Updating-6a8854c9)  
  
## <a name="see-also"></a>См. также  
  
-   [Обзор обновления кластера @ no__t-1Aware](cluster-aware-updating.md)  
  
