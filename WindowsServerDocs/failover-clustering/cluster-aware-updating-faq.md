---
ms.assetid: 6416d125-bcaf-433d-971a-2f0283bca2c2
title: Часто задаваемые вопросы об обновлении с поддержкой кластера
ms.topic: article
ms.prod: windows-server
manager: lizross
ms.author: jgerend
author: JasonGerend
ms.date: 04/28/2017
description: Ответы на часто задаваемые вопросы об обновлении с поддержкой кластеров в Windows Server.
ms.openlocfilehash: ca81e952c0524af36ab6d241a205bd1cc971c74a
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80828107"
---
# <a name="cluster-aware-updating-frequently-asked-questions"></a>Кластерное обновление: вопросы и ответы

> Область применения: Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

[Обновление с поддержкой кластера](cluster-aware-updating.md) \(Cau\) — это функция, которая координирует обновления программного обеспечения на всех серверах в отказоустойчивом кластере таким образом, что не влияет на доступность службы больше, чем плановая отработка отказа узла кластера. Для некоторых приложений с функциями непрерывной доступности \(таких как Hyper\-V с динамической миграцией или файлового сервера SMB 3. x с прозрачной отработкой отказа SMB\), CAU может координировать автоматическое обновление кластера без влияния на доступность службы.

## <a name="does-cau-support-updating-storage-spaces-direct-clusters"></a>Поддерживает ли CAU обновление кластеров Локальные дисковые пространства?  
Да. CAU поддерживает обновление [Локальные дисковые пространстваных](../storage/storage-spaces/storage-spaces-direct-overview.md) кластеров независимо от типа развертывания: с помощью технологии согласования или согласования. В частности, согласование CAU гарантирует, что приостановка каждого узла кластера ожидает работоспособности базового кластерного пространства хранения.

## <a name="does-cau-work-with-windowsserver-2008r2-or-windows7"></a>Работает ли кластерное обновление с Windows Server 2008 R2 или Windows 7?  
Нет. CAU координирует операцию обновления кластера только с компьютеров под управлением Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 10, Windows 8.1 или Windows 8. Обновляемый отказоустойчивый кластер должен работать под управлением Windows Server 2016, Windows Server 2012 R2 или Windows Server 2012.
  
## <a name="is-cau-limited-to-specific-clustered-applications"></a>Ограничена ли CAU конкретными кластеризованными приложениями?  
Нет. Для кластерного обновления не важен тип кластерного приложения. CAU — это внешний кластер,\-обновить решение, разслойно на основе API кластеризации и командлетов PowerShell. Таким образом, CAU может координировать обновление любого кластеризованного приложения, настроенного в отказоустойчивом кластере Windows Server.  
  
> [!NOTE]  
> В настоящее время проверяются и начисляются следующие кластеризованные рабочие нагрузки для CAU: SMB, Hyper\-V, репликация DFS, пространств имен DFS, iSCSI и NFS.  
  
## <a name="does-cau-support-updates-from-microsoft-update-and-windows-update"></a>Поддерживает ли кластерное обновление обновление из Центра обновления Майкрософт и Центра обновления Windows?  
Да. По умолчанию CAU настраивается с помощью подключаемого\-в, который использует агент Центр обновления Windows \(агента WUA\) служебные API на узлах кластера. Инфраструктуру WUA можно настроить так, чтобы она указывала на Центр обновления Майкрософт и Центр обновления Windows или Windows Server Update Services \(WSUS\) в качестве источника обновлений.  
  
## <a name="does-cau-support-wsus-updates"></a>Поддерживает ли кластерное обновление обновления WSUS?  
Да. По умолчанию CAU настраивается с помощью подключаемого\-в, который использует агент Центр обновления Windows \(агента WUA\) служебные API на узлах кластера. Инфраструктуру WUA можно настроить так, чтобы она указывала на Центр обновления Майкрософт и Центр обновления Windows или на локальный Windows Server Update Services \(WSUS\) Server в качестве источника обновлений.  
  
## <a name="can-cau-apply-limited-distribution-release-updates"></a>Способно ли кластерное обновление применять выпуски обновлений для ограниченного распространения?  
Да. Ограниченная версия дистрибутива \(LDR\) обновления, также называемые исправлениями, не публикуются с помощью Центр обновления Майкрософт или Центр обновления Windows, поэтому они не могут быть скачаны агентом Центр обновления Windows \(Plug\) Agent, который используется по умолчанию в CAU.\-  
  
Однако в CAU есть вторая подключаемая\-, которую можно выбрать для применения обновлений исправлений. Кроме того,\-эту возможность можно настроить для установки не\-драйвера Майкрософт, встроенного по и обновлений BIOS.  
  
## <a name="can-i-use-cau-to-apply-cumulative-updates"></a>Можно ли использовать CAU для применения накопительных пакетов обновлений?  
Да. Если накопительные пакеты обновлений представляют собой обновления выпуска для общего распространения или обновления LDR, CAU может применить их.  
  
## <a name="can-i-schedule-updates"></a>Можно ли запланировать обновления?  
Да. Кластерное обновление поддерживает следующие режимы обновления, оба из которых позволяют назначать расписание для установки обновлений:  
  
**Обновление самостоятельного\-** Позволяет кластеру обновлять себя в соответствии с определенным профилем и обычным расписанием, например в течение ежемесячного периода обслуживания. Можно также запустить само\-ное обновление по запросу в любое время. Чтобы включить режим обновления Self\-, необходимо добавить кластерную роль CAU в кластер. Функция само\-обновления CAU работает как любая другая кластеризованная Рабочая нагрузка и может беспрепятственно работать с запланированными и незапланированными отработкой отказа компьютера с координатором обновлений.  
  
**Обновление удаленного\-** Позволяет запускать обновление в любое время с компьютера, работающего под управлением Windows или Windows Server. Запустить обновление можно с помощью окна Обновление с поддержкой кластера или с помощью командлета **Invoke\-каурун** PowerShell. Удаленное\-ное обновление является режимом обновления по умолчанию для CAU. Можно запускать командлет [Invoke-CauRun](https://technet.microsoft.com/itpro/powershell/windows/cluster-aware-updating/invoke-caurun) по расписанию с удаленного компьютера, который не является одним из узлов кластера, с помощью планировщика заданий.  
  
## <a name="can-i-schedule-updates-to-apply-during-a-backup"></a>Можно ли запланировать обновление для применения во время резервного копирования?  
Да. CAU не накладывает никаких ограничений в этом отношении. Однако выполнение обновлений программного обеспечения на сервере \(с связанными возможными перезапусками\) во время резервного копирования сервера, не рекомендуется. Помните, что при определении отработки отказа и восстановления размещения ресурса кластерное обновление применяет только API кластеризации, поэтому кластерному обновлению неизвестно, что выполняется архивация сервера.  
  
## <a name="can-cau-work-with-configuration-manager"></a>Может ли CAU работать с Configuration Manager?  
CAU — это средство, которое координирует обновления программного обеспечения на узле кластера, а Configuration Manager также выполняет обновления серверного программного обеспечения. Важно настроить эти средства таким образом, чтобы они не перекрывали покрытие тех же серверов в любом развертывании центра обработки данных, включая использование разных серверов Windows Server Update Services. Это гарантирует, что цель использования CAU не будет случайно непреднамеренно отразиться, поскольку Configuration Manager\-управляемого обновления не включает в себя сведения о кластере.  
  
## <a name="do-i-need-administrative-credentials-to-run-cau"></a>Нужны ли мне учетные записи администратора, чтобы запустить кластерное обновление?  
Да. Для запуска средств CAU кластерному обновлению требуются учетные данные администратора на локальном сервере либо право пользователя **Олицетворение клиента после проверки подлинности** на локальном сервере или на клиентском компьютере, на котором работает кластерное обновление. Однако для координации обновлений программного обеспечения в узлах кластера кластерному обновлению требуются учетные данные администратора кластера на каждом узле. Хотя пользовательский интерфейс CAU может запускаться без учетных данных, он запрашивает учетные данные администратора кластера при подключении к экземпляру кластера для предварительного просмотра или применения обновлений.  
  
## <a name="can-i-script-cau"></a>Можно ли создать сценарий для CAU?  
Да. CAU поставляется с командлетами PowerShell, предлагающими широкий набор вариантов создания сценариев. Это те же командлеты, которые пользовательский интерфейс кластерного обновления вызывает, чтобы выполнять действия кластерного обновления.  

## <a name="what-happens-to-active-clustered-roles"></a>Что происходит с активными кластерными ролями?

Кластерные роли \(ранее именуемые приложениями и службами\), которые активны на узле, отправляют отказ на другие узлы перед началом обновления программного обеспечения. CAU управляет такой отработкой отказа, используя режим обслуживания, который приостанавливает и очищает узел от всех активных кластерных ролей. После завершения обновления программного обеспечения кластерное обновление возобновляет работу узла, и кластерные роли восстанавливаются после сбоя в обновленном узле. Благодаря этому распределение кластерных ролей между узлами кластера после выполнения кластерного обновления сохраняется.  
  
## <a name="how-does-cau-select-target-nodes-for-clustered-roles"></a>Как CAU выбирает целевые узлы для кластерных ролей?

Для координации отработки отказа CAU использует API кластеризации. Реализация API кластеризации выбирает целевые узлы, полагается на внутренние метрики и разумные эвристические алгоритмы размещения \(например уровни рабочей нагрузки\) на целевых узлах.  
  
## <a name="does-cau-load-balance-the-clustered-roles"></a>Распределяет ли CAU кластерные роли в балансировке нагрузки?

CAU не распределяет нагрузку на кластерные узлы, но пытается сохранить распределение кластерных ролей. Завершив обновление узла кластера, CAU пытается восстановить ранее размещенные кластерные роли после сбоя. Чтобы восстановить ресурсы после сбоя до состояния на момент приостановки, кластерное обновление использует API кластеризации. Таким образом, при отсутствии незапланированных отработок отказа и настроек предпочтительного владельца распределение кластерных ролей должно оставаться без изменений.  
  
## <a name="how-does-cau-select-the-order-of-nodes-to-update"></a>Каким образом кластерное обновление выбирает порядок обновления узлов?  
По умолчанию кластерное обновление выбирает порядок обновления узлов на основании их уровня активности. В первую очередь обновляются узлы, на которых размещено наименьшее число кластерных ролей. Однако администратор может указать конкретный порядок обновления узлов, указав параметр для прогона обновления в пользовательском интерфейсе CAU или с помощью командлетов PowerShell.  
  
## <a name="what-happens-if-a-cluster-node-is-offline"></a>Что произойдет, если узел кластера находится в автономном режиме?

Администратор, запускающий выполнение обновления, может задать порог количества узлов, которые могут быть не в сети. Поэтому выполнение обновления может продолжать обновление кластера, даже если все узлы кластера отключены от сети.  
  
## <a name="can-i-use-cau-to-update-only-a-single-node"></a>Можно ли использовать CAU для обновления только одного узла?  
Нет. CAU — это средство обновления с заданной областью\-кластера, которое позволяет выбирать только кластеры для обновления. Чтобы обновить отдельный узел, можно использовать существующие средства обновления сервера независимо от кластерного обновления.  
  
## <a name="can-cau-report-updates-that-are-initiated-from-outside-cau"></a>Можно ли выполнять обновления отчетов CAU, инициированные извне CAU?  
Нет. Кластерное обновление может сообщать только о выполнении обновления, запущенном из кластерного обновления. Однако при запуске последующего прогона обновления CAU следует учитывать обновления, которые были установлены с помощью не\-методов CAU, чтобы определить дополнительные обновления, которые могут быть применимы к каждому узлу кластера.  
  
## <a name="can-cau-support-my-unique-it-process-needs"></a>Может ли CAU поддерживать свои уникальные потребности в ИТ – процессах?  
Да. Кластерное обновление предлагает следующие возможности адаптации к индивидуальным потребностям клиента в ИТ-обеспечении:  
  
**Сценарии** Прогон обновления может указать скрипт PowerShell, выполняемый до\-обновления, и сценарий PowerShell после\-обновления. Сценарий обновления\-выполняется на каждом узле кластера перед приостановкой узла. После установки обновлений узла сценарий обновления после\-выполняется на каждом узле кластера.  
  
> [!NOTE]  
> .NET Framework 4,6 или 4,5 и PowerShell должны быть установлены на каждом узле кластера, на котором требуется выполнить предварительное\-обновление и после\-скриптов обновления. Также необходимо включить удаленное взаимодействие PowerShell на узлах кластера. Дополнительные сведения о требованиях к системе см. в разделе [требования и рекомендации по обновлению с поддержкой кластера](cluster-aware-updating-requirements.md).  
  
**Дополнительные параметры** прогона обновления Администратор может дополнительно указать из большого набора дополнительных параметров прогона обновления, таких как максимальное число повторных попыток обновления на каждом узле. Эти параметры можно указать с помощью пользовательского интерфейса CAU или командлетов CAU PowerShell. Эти настраиваемые параметры можно сохранить в профиле запуска обновления и использовать для последующих запусков обновления.  
  
**Общедоступный подключаемый модуль\-в архитектуре** В CAU есть функции для регистрации, отмены регистрации и выбора модуля Plug\-s. CAU поставляется с двумя модулями\-по умолчанию: один координирует Центр обновления Windows Агент \(агента WUA\) API на каждом узле кластера. Вторая возможность применяет исправления, которые вручную копируются в общую папку, доступную для узлов кластера. Если предприятие имеет уникальные требования, которые не могут быть выполнены с этими двумя подключаемыми модулями\-, предприятие может создать новый подключаемый модуль CAU\-в соответствии со спецификацией общедоступного API. Дополнительные сведения см. [в разделе cluster\-с поддержкой обновления подключаемых\-в справочнике](https://msdn.microsoft.com/library/hh418084(VS.85).aspx).  
  
Сведения о настройке и настройке подключаемых модулей CAU\-для поддержки различных сценариев обновления см. в разделе [работа\-модулей](assetId:///847b571b-12b3-473c-953f-75a5a1f51333).  
  
## <a name="how-can-i-export-the-cau-preview-and-update-results"></a>Как можно экспортировать из кластерного обновления результаты просмотра и обновления?  
CAU предлагает варианты экспорта через интерфейс командной\-Line и через пользовательский интерфейс.  
  
**Параметры интерфейса командной\-строки:**  
  
-   Предварительный просмотр результатов с помощью вызова командлета PowerShell **\-каускан | ConvertTo\-XML**. Вывод: XML-файл  
  
-   Вызывайте результаты отчета с помощью командлета PowerShell **\-каурун | ConvertTo\-XML**. Вывод: XML-файл  
  
-   Отчет о результатах с помощью командлета PowerShell **Get\-каурепорт | Экспорт\-Каурепорт**. Вывод: HTML-файл, CSV-файл  
  
**Параметры пользовательского интерфейса:**  
  
-   Копирование результатов отчета из экрана **Просмотр обновлений**. Вывод: CSV-файл  
  
-   Копирование результатов отчета из экрана **Создать отчет**. Вывод: CSV-файл  
  
-   Экспорт результатов отчета из экрана **Создать отчет**. Вывод: HTML-файл  
  
## <a name="how-do-i-install-cau"></a>Как установить кластерное обновление?  
Установка CAU легко интегрируется в компонент отказоустойчивой кластеризации. Установка кластерного обновления выполняется следующим образом:  
  
-   При установке отказоустойчивой кластеризации на узле кластера автоматически устанавливается поставщик\) инструментарий управления Windows (WMI) CAU \(WMI.  
  
-   Если компонент средств отказоустойчивой кластеризации установлен на сервере или клиентском компьютере, автоматически устанавливаются интерфейс обновления с поддержкой кластера и командлеты PowerShell.
  
## <a name="does-cau-need-components-running-on-the-cluster-nodes-that-are-being-updated"></a>Требуется ли для CAU компоненты, выполняющиеся на обновляемых узлах кластера?  
CAU не требуется служба, работающая на узлах кластера. Однако для CAU требуется программный компонент \(поставщика WMI\) установлен на узлах кластера. Этот компонент устанавливается вместе с компонентом отказоустойчивой кластеризации.  
  
Чтобы включить режим обновления Self\-, кластерная роль CAU также должна быть добавлена в кластер.  
  
## <a name="what-is-the-difference-between-using-cau-and-vmm"></a>В чем разница между использованием CAU и VMM?  
  
-   System Center Virtual Machine Manager \(VMM\) посвящена обновлению только кластеров Hyper-V\-, тогда как CAU может обновить любой тип поддерживаемого отказоустойчивого кластера, включая кластеры Hyper\-V.  
  
-   VMM требует дополнительного лицензирования, тогда как CAU лицензируется для всех Windows Server. Возможности, средства и пользовательский интерфейс кластерного обновления устанавливаются вместе с компонентами отказоустойчивой кластеризации.  
  
-   Если вы уже владеете лицензией System Center, вы можете продолжать использовать VMM для обновления кластеров Hyper\-V, так как он обеспечивает интегрированное управление и обновление программного обеспечения.  
  
-   CAU поддерживается только в кластерах под Windows Server 2016, Windows Server 2012 R2 и Windows Server 2012. VMM также поддерживает кластеры Hyper\-V на компьютерах под управлением Windows Server 2008 R2 и Windows Server 2008.  
  
## <a name="can-i-use-remote-updating-on-a-cluster-that-is-configured-for-self-updating"></a>Можно ли использовать удаленное обновление\-в кластере, настроенном для самостоятельного обновления\-?  
Да. Отказоустойчивый кластер в конфигурации с само\-ным обновлением можно обновить с помощью удаленного\-обновления по запросу на\-, точно так же, как можно принудительно выполнять проверку Центр обновления Windows в любое время на компьютере, даже если Центр обновления Windows настроен на автоматическую установку обновлений. Однако следует убедиться, что выполнение обновления не происходит в данный момент.  
  
## <a name="can-i-reuse-my-cluster-update-settings-across-clusters"></a>Могу ли я применить свои параметры обновления кластера ко всем кластерам?  
Да. Кластерное обновление поддерживает разные параметры выполнения обновления, определяющие, как ведет себя выполнение обновления, обновляя кластер. Эти параметры можно сохранить в качестве профиля выполнения обновления, и тогда их можно применять к любому кластеру. Рекомендуется сохранять и повторно использовать настройки для отказоустойчивых кластеров со сходными потребностями обновления. Например, можно создать "бизнес\-критический SQL Serverный профиль выполнения обновления кластера" для всех кластеров Microsoft SQL Server, которые поддерживают критически важные службы бизнес-\-.  
  
## <a name="where-is-the-cau-plug-in-specification"></a>Где находится подключаемый модуль CAU\-спецификации?  
  
-   [Обновление подключаемых\-с поддержкой\-кластера в справочнике](https://msdn.microsoft.com/library/hh418084(VS.85).aspx)  
  
-   [Обновление подключаемых\-с поддержкой кластера в образце](https://code.msdn.microsoft.com/windowsdesktop/Cluster-Aware-Updating-6a8854c9)  
  
## <a name="see-also"></a>См. также:  
  
-   [Обзор кластерного обновления\-  
  
