---
title: Обновление отказоустойчивых кластеров с помощью существующее оборудование
ms.prod: windows-server-threshold
ms.manager: eldenc
ms.technology: failover-clustering
ms.topic: article
author: johnmarlin-msft
ms.date: 02/28/2019
description: В этой статье описан процесс обновления двух узлов отказоустойчивого кластера с помощью существующее оборудование
ms.localizationpriority: medium
ms.openlocfilehash: 0bfeb05c8cbc205745dc16bc7ef04052481668ea
ms.sourcegitcommit: 2c2027b597e2483eea8967d0710d65c2247b6751
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "9121323"
---
# Обновление отказоустойчивых кластеров на том же оборудовании

> Область применения: Windows Server 2019, Windows Server 2016

Отказоустойчивый кластер — это группа независимых компьютеров, которые работают совместно для повышения доступности приложений и служб. Кластерные серверы (называемые "узлы") соединены физическими кабелями и программным обеспечением. В случае сбоя одного из узлов кластера другой узел начинает для предоставления службы (процесс называется отработки отказа). Пользователи сталкиваются с минимальным количеством проблем в работе службы.

В этом руководстве описаны действия для обновления узлов кластера Windows Server 2019 или Windows Server 2016 с более ранней версии, используя существующее оборудование.

## Обзор

Обновление операционной системы на существующие отказоустойчивого кластера поддерживается только при переходе на Windows 2019 устройство с Windows Server 2016.  Если отказоустойчивого кластера работает под управлением более ранней версии, например, такие как Windows Server 2012 R2 и более ранних версий, обновление во время работы службы кластеров не позволит присоединении узлов друг с другом.  Если существующее оборудование, можно принять меры для получения до новой версии.  

Прежде чем любое обновление в отказоустойчивом кластере обратитесь к [Центра обновления Windows](https://www.microsoft.com/upgradecenter).  При обновлении Windows Server на месте, перемещается из существующей версии операционной системы до более новой версии сохранением на том же оборудовании. Windows Server можно обновления на месте по крайней мере один, а иногда две версии вперед. Например, Windows Server 2012 R2 и Windows Server 2016 можно обновить на месте до Windows Server 2019.  Имейте в виду, что [Мастер миграции кластера](https://blogs.msdn.microsoft.com/clustering/2012/06/25/how-to-move-highly-available-clustered-vms-to-windows-server-2012-with-the-cluster-migration-wizard/) можно использовать, но поддерживается только до двух версиях обратно. На следующем рисунке показан пути обновления для Windows Server. Стрелки вниз указывающих представляют поддерживаемые пути обновления переход с предыдущих версий до Windows Server 2019.

![Схема обновления на месте](media\In-Place-Upgrade\In-Place-Upgrade-1.png)

Следующие действия служат примером переход от сервера Windows Server 2012 отказоустойчивого кластера в Windows Server 2019 с помощью существующее оборудование.  

Перед началом любое обновление, убедитесь, что произошло резервной текущего состояния системы, в том числе.  Обеспечьте все драйверы и встроенное по были обновлены для сертифицированных уровни для операционной системы, вы будете использовать.  Эти два заметки здесь не рассматриваются.

В приведенном ниже примере называется отказоустойчивого КЛАСТЕРА и имена узлов NODE1 и узла 2.

## Шаг 1: Исключения первого узла и выполнить обновление до Windows Server 2016

1. В диспетчере отказоустойчивости кластеров, очищайте все ресурсы из NODE1 для узла 2, правой кнопкой мыши узел и **Пауза** "и" **Очистить роли**.  Кроме того можно использовать команду PowerShell [SUSPEND-CLUSTERNODE](https://docs.microsoft.com/powershell/module/failoverclusters/suspend-clusternode).

    ![Очистке узла](media\In-Place-Upgrade\In-Place-Upgrade-2.png)

2. Исключите NODE1 из кластера, правой кнопкой мыши узел и **Другие действия** и **прекращение**.  Кроме того можно использовать команду PowerShell [REMOVE-CLUSTERNODE](https://docs.microsoft.com/powershell/module/failoverclusters/remove-clusternode).

    ![Очистке узла](media\In-Place-Upgrade\In-Place-Upgrade-3.png)

3. В качестве меры предосторожности отсоедините NODE1 из хранилища, которую вы используете.  В некоторых случаях подойдет отключение кабели хранилища с компьютера.  Обратитесь к поставщику хранилища для правильной удобное действия при необходимости.  В зависимости от хранилища это может не потребоваться.

4. Перестройте NODE1 с помощью Windows Server 2016.  Убедитесь, что вы добавили все необходимые роли, компоненты, драйверы и обновления системы безопасности.

5. Создайте новый кластер с именем CLUSTER1 с NODE1.  Откройте Диспетчер отказоустойчивости кластеров, на панели **управления** , выберите **Создать кластер** и следуйте инструкциям в мастере.

    ![Очистке узла](media\In-Place-Upgrade\In-Place-Upgrade-4.png)

6. После создания кластера роли необходимо перенести из к исходному кластеру этот новый кластер.  На новый кластер правой кнопкой мыши щелкните имя кластера (CLUSTER1) и нажав **Дополнительные действия** и **Копировать кластерных ролей**.  Выполните мастера, чтобы перенести роли.

    ![Очистке узла](media\In-Place-Upgrade\In-Place-Upgrade-5.png)

7.  После были перенесены все ресурсы, питание узла 2 (исходному кластеру) и отключения устройства, чтобы не создавать помех.  Подключения хранилища NODE1.  После подключения все перевести все ресурсы в Интернете и убедитесь, что они работают как следует.

## Шаг 2: Перестроение второго узла в Windows Server 2019

После проверки того, что все работает должным образом, узла 2 можно перестроить для Windows Server 2019 и присоединяется к кластеру.

1. Выполните чистую установку Windows Server 2019 на узла 2. Убедитесь, что вы добавили все необходимые роли, компоненты, драйверы и обновления системы безопасности.

2. Теперь исчезнет, исходного кластера (КЛАСТЕРА), можно оставить новое имя кластера как CLUSTER1 или вернуться в исходное имя.  Если вы хотите вернуться к исходное имя, выполните следующие действия:
   
   А. На NODE1 в диспетчере отказоустойчивости кластеров правой кнопкой мыши щелкните имя кластера (CLUSTER1) и выберите « **Свойства**».
   
   Б. На вкладке " **Общие** " переименуйте кластера в кластере.

   в. При выборе ОК или применить, вы увидите ниже всплывающее диалоговое окно.

    ![Очистке узла](media\In-Place-Upgrade\In-Place-Upgrade-6.png)

    г. Служба кластеров будет остановлен и необходимо снова запустить для переименования для завершения.

3. На NODE1 откройте диспетчер отказоустойчивости кластеров.  Правой кнопкой мыши щелкните **узлов** и **Добавить**узел.  Перейдите по шагам мастера добавления узла 2 в кластере.

4. Присоедините хранилищем узла 2. Сюда могут входить подключение кабели хранилища. 

5. Очистите все ресурсы из NODE1 для узла 2, правой кнопкой мыши узел и **Пауза** "и" **Очистить роли**.  Кроме того можно использовать команду PowerShell [SUSPEND-CLUSTERNODE](https://docs.microsoft.com/powershell/module/failoverclusters/suspend-clusternode).  Убедитесь, что все ресурсы Интернет- а они работают, как должно быть.

## Шаг 3: Выполните сборку первый узел, Windows Server 2019

1. Исключить NODE1 из кластера, отключите хранилища на узле образом через какое вы ранее.

2. Перестройте или обновление NODE1 до Windows Server 2019.  Убедитесь, что вы добавили все необходимые роли, компоненты, драйверы и обновления системы безопасности.

3. Повторно подключите хранилище и добавьте NODE1 кластера.

4. Переместить все ресурсы NODE1 и убедитесь, он перейдет в оперативный режим и работать при необходимости.

5. Текущий функциональный уровень кластера остается в Windows 2016.  Обновите функциональный уровень Windows 2019 с помощью команды PowerShell [UPDATE-CLUSTERFUNCTIONALLEVEL](https://docs.microsoft.com/powershell/module/failoverclusters/update-clusterfunctionallevel).

Теперь вы используете в полностью работоспособными Windows Server 2019 отказоустойчивом кластере.

## Дополнительные примечания

- Как упоминалось ранее, отключение хранилища может содержать или не может потребоваться.  В нашей документации мы хотим об ошибке на стороне предупреждения.  Обратитесь к поставщику хранилища.
- Если вашей отправной точкой Windows Server 2008 или 2008 R2 кластеры, могут потребоваться дополнительные выполнения через действий.
- Если кластера запущен виртуальных машин, убедитесь, что обновление на уровне виртуальной машины после завершения функциональный уровень кластера с помощью команды PowerShell [VMVERSION обновления](https://docs.microsoft.com/powershell/module/hyper-v/update-vmversion).
- Обратите внимание, что при запуске приложения, например SQL Server, Exchange Server и т. д, приложения не будут перенесены с помощью мастера копирования кластерных ролей.  Указания правильной переноса приложения следует ознакомиться с поставщиком приложения.