---
title: Развертывание двух узлов кластеризованного файлового сервера
ms.prod: windows-server-threshold
ms.manager: eldenc
ms.technology: failover-clustering
ms.topic: article
author: johnmarlin-msft
ms.date: 02/01/2019
description: В этой статье описывается создание кластера двухузлового файлового сервера
ms.openlocfilehash: fbfde60f60df64514a6a0f514cbabd005544af84
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59846415"
---
# <a name="deploying-a-two-node-clustered-file-server"></a>Развертывание двух узлов кластеризованного файлового сервера

> Область применения. Windows Server 2019, Windows Server 2016

Отказоустойчивый кластер — это группа независимых компьютеров, которые совместно работают для повышения доступности приложений и служб. Кластерные серверы (называемые "узлы") соединены физическими кабелями и программным обеспечением. При сбое на одном из узлов кластера его функции немедленно передаются другому узлу (этот процесс называется отработкой отказа). Пользователи сталкиваются с минимальным количеством проблем в работе службы.

В этом руководстве описаны шаги по установке и настройке общего назначения отказоустойчивого кластера файловых серверов с двумя узлами. Создайте конфигурацию в данном руководстве, можно Дополнительные сведения об отказоустойчивых кластерах и ознакомиться с интерфейсом оснастка управления отказоустойчивыми кластерами в Windows Server 2019 или Windows Server 2016.

## <a name="overview-for-a-two-node-file-server-cluster"></a>Обзор для кластера двухузлового файлового сервера

Серверы в отказоустойчивом кластере может работать в различных ролей, включая роли файлового сервера, сервера Hyper-V или сервера базы данных и обеспечения высокой доступности по ряду других служб и приложений. В этом руководстве описывается настройка кластера двухузлового файлового сервера.

Отказоустойчивый кластер обычно включает в себя единое хранилище, физически подключен ко всем серверам в кластере, несмотря на то, что любой конкретного тома в хранилище пользуется только один сервер за раз. В примере ниже показан двух узлов отказоустойчивого кластера подключены к единице хранилища.

![Два узла кластера](media\Cluster-File-Server\Cluster-FS-Overview.png)

Тома хранилища или логические номера устройств (LUN) для узлов в кластере может быть предоставлен к другим серверам, включая серверы в другом кластере. На следующей схеме показано это.

![LUN в хранилище](media\Cluster-File-Server\Cluster-FS-LUNs.png)

Обратите внимание, что для максимальной доступности любого сервера, очень важно следовать рекомендациям для управления сервером — к примеру, тщательного управления физической среды серверов, тестирование изменений программного обеспечения перед их, полностью реализацией, а также внимательно с обновлениями программного обеспечения и изменения конфигурации на всех кластерных серверах.

В следующем сценарии показано, как настроить отказоустойчивый кластер файловых серверов. Файлы общего доступа, находятся в хранилище кластера, и либо кластерного сервера может действовать как файловый сервер, который использует их.

## <a name="shared-folders-in-a-failover-cluster"></a>Общие папки в отказоустойчивом кластере

Ниже перечислены функции настройки общей папки, которая интегрирована в отказоустойчивой кластеризации.

- Отображение, ограничиваются кластеризованных общих папок только (без смешивания с общими папками, некластеризованный): При пользователь представления общих папок, указав путь к кластерным файловым сервером, отображение будет включать только общие папки, которые являются частью роли сервера определенного файла. Исключает некластеризованных общих папок и общих папок частью роли сервера отдельные файлы, которые происходят на узле кластера.

- Перечисление на основе доступа: Чтобы скрыть в указанную папку из представления пользователей можно использовать перечисление на основе доступа. Не позволяйте пользователям см. в разделе папке, но не обращаться к данным на нем, вы можете заблокировать их просмотр в папку вообще. Перечисление на основе доступа для кластеризованного общей папки можно настроить так же как и для некластеризованных общую папку.

- Автономный доступ: Вы можете настроить (кэширование) для кластеризованных общей папки так же как и для некластеризованных общей папки автономный доступ.

- Кластерные диски всегда распознаются как часть кластера: Независимо от используемого интерфейса кластера отработки отказа, Windows Explorer или оснастки Share and Storage Management Windows распознает ли диск, обозначенный как находящиеся в хранилище кластера. Если такого диска уже был настроен в управления отказоустойчивыми кластерами как часть кластерного файлового сервера, затем можно использовать любой из упомянутых ранее интерфейсов для создания общей папки на диске. Если такого диска не был настроен как часть кластерного файлового сервера, вы по ошибке общую папку для него нельзя создать. Вместо этого ошибка указывает, что диск необходимо сначала настроить как часть кластерного файлового сервера, прежде чем его можно использовать совместно.

- Интеграция служб для сетевой файловой системы: Роль файлового сервера в Windows Server включает в себя дополнительная служба роли под названием службы для сетевой файловой системы (NFS). Установка службы роли и настройка общих папок с помощью служб для NFS, можно создать кластерный файловый сервер, который поддерживает клиенты под управлением UNIX.

## <a name="requirements-for-a-two-node-failover-cluster"></a>Требования для двух узлов отказоустойчивого кластера

Для отказоустойчивого кластера в Windows Server 2016 или Windows Server 2019 считается решение официально поддерживаемых корпорацией Майкрософт решение должно отвечать следующим критериям.

- Все компоненты оборудования и программного обеспечения должны отвечать требованиям сертификации для логотипа соответствующей ОС. Для Windows Server 2016 это логотип «Сертифицировано для Windows Server 2016». Для Windows Server 2019 это логотип «Сертифицировано для Windows Server 2019 г.». Дополнительные сведения о какие системы, оборудования и программного обеспечения, прошли сертификацию, посетите Microsoft [каталоге Windows Server](https://www.windowsservercatalog.com/default.aspx) сайта.

- Полностью настроенное решение (серверы, сеть и хранилище) должна пройти все тесты в мастере проверки, который входит в оснастке отказоустойчивого кластера.

Ниже необходимы для двух узлов отказоустойчивого кластера.

- **серверы:** Мы рекомендуем использовать соответствующие компьютеры с одинаковые или похожие компоненты.  Серверы для двух узлов отказоустойчивого кластера необходимо запустить одну и ту же версию Windows Server. Кроме того, они должны иметь те же обновления программного обеспечения (исправления).

- **Сетевые адаптеры и кабели:** Сетевое оборудование, как и другие компоненты в отказоустойчивом кластерном решении, должны быть совместимы с Windows Server 2016 или Windows Server 2019. Если используется iSCSI, сетевые адаптеры должна быть выделенной для сетевого взаимодействия или iSCSI, но не оба. Избегайте единственных точек отказа в сетевой инфраструктуре, соединяющей узлы кластера. Существует несколько способов решения этой проблемы. Можно соединить узлы кластера несколькими независимыми сетями. Можно также соединить узлы кластера в одну сеть, основанную на сгруппированных сетевых адаптерах, дублированных коммутаторах и маршрутизаторах и аналогичном оборудовании, исключающем появление единственных точек отказа.

   > [!NOTE]
   > Если узлы кластера соединены одной сетью, сеть пройдет тест избыточности в мастере проверки конфигурации.  Тем не менее отчет будет включать предупреждение, что у сети не должна быть единственной точкой отказа.

- **Контроллеры устройств или соответствующие адаптеры для хранилища:**
    - **Serial Attached SCSI или Fibre Channel:** Если используется Serial Attached SCSI или Fibre Channel во всех кластерных серверах, все компоненты стека хранилища должны быть идентичными. Это необходимо, программное обеспечение multipath I/O (MPIO) и программные компоненты для конкретного модуля устройства (DSM) должно совпадать.  Рекомендуется, чтобы контроллеры запоминающих устройств, то есть адаптер шины (HBA), драйверы HBA и встроенное ПО HBA, присоединенные к хранилищу кластера, были идентичными. При использовании различных HBA следует уточнить у поставщика хранилища, обеспечиваются ли при этом поддерживаемые или рекомендуемые конфигурации.
    - **iSCSI:** При использовании iSCSI каждого кластерного сервера должен быть один или несколько сетевых адаптеров или адаптеров шины, которые выделены для хранения данных ISCSI. Сеть, используемая для iSCSI, не может использоваться для взаимодействия по сети. На всех кластеризованных серверах сетевые адаптеры для подключения к целевому хранилищу iSCSI должны быть одинаковыми. Рекомендуется использовать адаптеры Gigabit Ethernet или с более высокой пропускной способностью.  

- **Хранилище:** Необходимо использовать хранилище общего доступа, сертифицированные для Windows Server 2016 или Windows Server 2019.
  
    Для двух узлов отказоустойчивого кластера хранилище должно включать по крайней мере два отдельных томов (LUN), при использовании диска-свидетеля для кворума. Диск-свидетель — это диск в хранилище кластера, предназначенный для хранения копии базы данных конфигурации кластера. В этом примере двухузлового кластера будет использоваться конфигурация кворума Большинство узлов и дисков. Большинство узлов и дисков означает, что узлов и диска-свидетеля содержать копии конфигурации кластера, и в кластере есть кворум, до тех пор, пока доступны большинство (2 из 3) из этих копий. Другой том (устройства LUN) будет содержать файлы, которые используются совместно для пользователей.

    К хранилищу предъявляются следующие требования.

    - Для использования собственной поддержки дисков, включенной в компонент отказоустойчивого кластера, применяйте базовые, а не динамические диски.
    - Мы рекомендуем форматировать разделы с файловой системой NTFS (для диска-свидетеля, секции должны иметь формат NTFS).
    - Для разделения диска на разделы можно использовать основную загрузочную запись (MBR) или таблицу разделов GPT.
    - Хранилище должно реагировать на правильно определенные команды SCSI, хранилище должно соответствовать стандарту, вызывается SCSI Primary Commands-3 (SPC-3). В частности то хранилище должно поддерживать постоянное резервирование, как указано в стандарте SPC-3. 
    -  Драйвер минипорта, используемое для хранилища необходимо работать с Microsoft Storport драйвер запоминающего устройства.

## <a name="deploying-storage-area-networks-with-failover-clusters"></a>Развертывание сетей хранения данных с отказоустойчивыми кластерами

При развертывании сети хранения (данных SAN) с отказоустойчивым кластером, необходимо соблюдать следующие рекомендации.

- **Подтверждение сертификации хранилища:** С помощью [каталоге Windows Server](https://www.windowsservercatalog.com/default.aspx) сайта, подтвердите поставщика хранилища, включая драйверы, встроенное по и программного обеспечения, сертифицирован для Windows Server 2016 или Windows Server 2019.

- **Изолируйте запоминающие устройства по одному кластеру на устройство:** Серверы из различных кластеров не должны иметь доступа к одним и тем же запоминающим устройствам. В большинстве случаев LUN, используемый для одного набора серверов кластера должен быть изолирован от всех остальных серверов с помощью маски или зонирования LUN.

- **Рассмотрите возможность использования многоканального ввода-вывода:** В структуре хранения данных высокой надежности можно развернуть отказоустойчивые кластеры с несколькими адаптерами шины, используя по многоканального ввода-вывода. Это обеспечивает максимальный уровень резервирования и доступности. Многоканальное решение должно основываться на Microsoft Multipath I/O (MPIO). Поставщики оборудования хранилища может предоставляют модуль конкретного устройства MPIO (DSM) для вашего оборудования, несмотря на то, что Windows Server 2016 и Windows Server 2019 включают один или несколько модулей DSM как часть операционной системы.

## <a name="network-infrastructure-and-domain-account-requirements"></a>Требования к сетевой инфраструктуре и учетным записям домена

Вам потребуется указанная ниже сетевая инфраструктура для двух узлов отказоустойчивого кластера и учетной записи администратора домена следующие разрешения:

- **Параметры сети и IP-адреса:** Если для сети используются одинаковые сетевые адаптеры, также можно используйте одинаковые параметры обмена данными для этих адаптеров (например, скорость, дуплексный режим, управление потоком и тип носителя). Кроме того, сравните параметры на сетевом адаптере и коммутаторе, к которому он подключается, и убедитесь в том, что они не конфликтуют.

    Если есть частные сети, которые не маршрутизируются в остальную часть сетевой инфраструктуры, убедитесь, что для каждой из этих частных сетей используется уникальная подсеть. Это необходимо даже в том случае, если каждому сетевому адаптеру присвоен уникальный IP-адрес. Например, если в центральном офисе есть узел кластера, использующий одну физическую сеть, а в филиале есть другой узел, использующий отдельную физическую сеть, не указывайте адрес 10.0.0.0/24 для обеих сетей, даже если каждому адаптеру присвоен уникальный IP-адрес.

    Дополнительные сведения о сетевых адаптерах см. в разделе Требования к оборудованию для двух узлов отказоустойчивого кластера, ранее в этом руководстве.

- **DNS-СЕРВЕР:** Серверы в кластере должны использовать доменных имен (DNS) для разрешения имен. Можно использовать протокол динамического обновления DNS.

- **Роль домена:** Все серверы кластера находились в одном домене Active Directory. Мы рекомендуем, чтобы все кластерные серверы имели одинаковую роль домена (рядовой сервер или контроллер домена). Рекомендованная роль — рядовой сервер.

- **Контроллер домена:** Мы рекомендуем использовать серверы кластера рядовые серверы. В таком случае требуется дополнительный сервер, который выступает в качестве контроллера домена в домене, который содержит в отказоустойчивом кластере.

- **Клиенты:** При необходимости для тестирования подключения одного или нескольких сетевых клиентов в отказоустойчивый кластер, созданный и наблюдать воздействие на клиентском компьютере, при перемещении или отработки отказа кластерного файлового сервера с одного узла кластера на другой.

- **Учетная запись для администрирования кластера:** При создании кластера или добавить серверы к нему, вы должны войти в систему в домен с учетной записью, имеющей права и разрешения администратора на всех серверах в кластере. Она не обязательно должна входить в группу "Администраторы домена". Например, это может быть учетная запись пользователя домена, входящая в группу "Администраторы" на каждом кластерном сервере. Кроме того, если учетная запись не является учетной записью "Администраторы домена", учетная запись (или группу, в которой находится учетная запись) необходимо предоставить **создание объектов-компьютеров** и **чтение всех свойств** разрешения в домен организационное подразделение (OU), будет находиться в.

## <a name="steps-for-installing-a-two-node-file-server-cluster"></a>Действия по установке кластера двухузлового файлового сервера

Необходимо выполнить следующие действия для установки отказоустойчивого кластера двухузлового файлового сервера.

Шаг 1. Подключение кластера серверов к сетям и хранилищу

Шаг 2. Установка компонента отказоустойчивого кластера

Шаг 3. Проверка конфигурации кластера

Шаг 4. Создание кластера

Если вы уже установили узлов кластера и хотите настроить отказоустойчивый кластер файловых серверов, см. в разделе действия по настройке двухузлового файлового сервера, далее в этом руководстве.

### <a name="step-1-connect-the-cluster-servers-to-the-networks-and-storage"></a>Шаг 1. Подключение кластера серверов к сетям и хранилищу

Сеть кластера отработки отказа можно Избегайте единых точек отказа. Существует несколько способов решения этой проблемы. Можно соединить узлы кластера несколькими независимыми сетями. Кроме того, можно соединить узлы кластера с одной сетью, который создается с объединенные сетевые адаптеры, дублированных коммутаторах, маршрутизаторах и аналогичном оборудовании, единых точек отказа (если использовать сеть для iSCSI, необходимо создать этой сети в дополнение к другим сетям).

Для кластера двухузлового файлового сервера при подключении серверов в хранилище кластера, должен предоставлять по крайней мере два тома (LUN). Вы можете предоставлять дополнительные тома, при необходимости для всестороннего тестирования конфигурации. Не предоставляйте томах кластера, на серверы, не входящие в кластер.

#### <a name="to-connect-the-cluster-servers-to-the-networks-and-storage"></a>Для подключения к сетям и хранилищу кластера серверов

1. Просмотрите сведения о сетях в требования к оборудованию для двух узлов отказоустойчивого кластера и сетевой инфраструктуры и домена требования к учетной записи для двух узлов отказоустойчивого кластера, ранее в этом руководстве.

2. Подключите и настройте сети, которые будут использовать серверы в кластере.

3. Если в тестовую конфигурацию включает клиенты или являться контроллером домена, некластеризованный, убедитесь, что эти компьютеры могут подключаться на кластеризованных серверах через сеть по крайней мере один.

4. Чтобы физически подключить серверы к хранилищу, следуйте инструкциям изготовителя.

5. Убедитесь в том, что диски (LUN), которые вы хотите использовать в кластере, доступны кластерным серверам (и только им). Для предоставления дискам или LUN можно использовать любой из следующих интерфейсов:

    - интерфейс, предоставленный изготовителем хранилища;

    - Если используется iSCSI, соответствующий интерфейс iSCSI.

6. Если вы приобрели программное обеспечение, управляющее форматом или функционированием диска, следуйте инструкциям поставщика по использованию этого по с Windows Server.

7. На одном из серверов, которые вы хотите кластера, нажмите кнопку Пуск Администрирование, управление компьютером и нажмите кнопку «Управление дисками». (Если появится диалоговое окно контроля учетных записей, убедитесь, что действие, которое он отображает то, что нужно, и нажмите кнопку Продолжить.) В оснастке управления дисками убедитесь, что диски кластера видны.

8. Если требуется объем хранилища более 2 терабайт, а для управления форматом диска используется интерфейс Windows, преобразуйте тип разделов диска в таблицу разделов GPT. Чтобы сделать это, архивировать все данные на диске, удалите все тома на диске и затем в оснастке управления дисками, щелкните правой кнопкой мыши диск (не раздел) и пункт Преобразовать в GPT-диск.  Если объем меньше 2 терабайт, то вместо таблицы разделов GPT можно использовать тип разделов, называемый основной загрузочной записью (MBR).

9. Проверьте форматы всех предоставленных томов или LUN. Мы рекомендуем NTFS для формата (для диска-свидетеля, необходимо использовать NTFS).

### <a name="step-2-install-the-file-server-role-and-failover-cluster-feature"></a>Шаг 2. Установка компонента кластера роли и отработки отказа сервера файл

На этом шаге устанавливается файл роль и отказоустойчивого кластера компонент сервера. Оба сервера должна быть запущена Windows Server 2016 или Windows Server 2019.

#### <a name="using-server-manager"></a>С помощью диспетчера сервера

1. Откройте **диспетчера серверов** и в разделе **управление** раскрывающийся список, выберите **Добавить роли и компоненты**.

   ![Добавить функцию](media\Cluster-File-Server\Cluster-FS-Add-Feature.png)

2. Если **перед началом** откроется окно, выберите **Далее**.

3. Для **тип установки**выберите **Установка ролей или компонентов** и **Далее**.

4. Убедитесь, **выберите сервер из пула серверов** — флажок установлен, имя компьютера, будет выделен, и **Далее**.

5. Для роли сервера, в списке ролей, откройте **файловых служб**выберите **файлового сервера**, и **Далее**.

   ![Добавление роли](media\Cluster-File-Server\Cluster-FS-Add-FS-Role-1.png)

6. Компоненты, список функций, выберите **отказоустойчивой кластеризации**.  Где указаны средства администрирования также установлены, отобразится всплывающее диалоговое окно.  Сохранять все выбранные, выберите **добавить компоненты** и **Далее**.

   ![Добавить функцию](media\Cluster-File-Server\Cluster-FS-Add-WSFC-1.png)

7. На странице подтверждения выберите команду "установить".

8. После завершения установки перезагрузите компьютер.

9. Повторите эти действия на другом компьютере.

#### <a name="using-powershell"></a>Использование PowerShell

1. Откройте сеанс PowerShell с правами администратора, щелкнув правой кнопкой мыши кнопку «Пуск», а затем выбрав **Windows PowerShell (Admin)**.
2. Чтобы установить роль файлового сервера, выполните команду:

    ```PowerShell
    Install-WindowsFeature -Name FS-FileServer
    ```

3. Чтобы установить средство отказоустойчивости кластеров и средствами управления, выполните команду:

    ```PowerShell
    Install-WindowsFeature -Name Failover-Clustering -IncludeManagementTools
    ```

4. После завершения, убедитесь, что они установлены с помощью команд:

    ```PowerShell
    Get-WindowsFeature -Name FS-FileServer
    Get-WindowsFeature -Name Failover-Clustering
    ```

5. После проверки, что они установлены, перезагрузите компьютер с помощью команды:

    ```PowerShell
    Restart-Computer
    ```

6. Повторите шаги на втором сервере.

### <a name="step-3-validate-the-cluster-configuration"></a>Шаг 3. Проверка конфигурации кластера

Перед созданием кластера настоятельно рекомендуется проверить конфигурацию. Проверка помогает убедиться, что конфигурации серверов, сети и хранилища соответствует набору определенных требованиях для отказоустойчивых кластеров.

#### <a name="using-failover-cluster-manager"></a>С помощью диспетчера отказоустойчивости кластеров

1. Из **диспетчера серверов**, выберите **средства** раскрывающийся список и выберите **Диспетчер отказоустойчивости кластеров**.

2. В **Диспетчер отказоустойчивости кластеров**, перейдите в средний столбец, в разделе **управления** и выберите **проверить конфигурацию**.

3. Если **перед началом** откроется окно, выберите **Далее**.

4. В **Выбор серверов или кластера** окна, добавление в именах двух машин, которые будут узлами кластера.  Например, если имена не узел1 и узел2, введите имя и выберите **добавить**.  Вы также можете **Обзор** кнопку для поиска Active Directory для имен.  Когда оба отображаются в категории **выбранные серверы**, выберите **Далее**.

5. В **параметры тестирования** выберите **выполнить все тесты (рекомендуется)**, и **Далее**.

6. На **Подтверждение** страницы, она даст вам список всех тестов, он будет проверять.  Выберите **Далее** и начнется тесты.

7. После завершения **Сводка** появится после выполнения тестов. Чтобы просмотреть разделы справки, которые помогут интерпретировать результаты, щелкните **Дополнительные сведения о тестах для проверки кластеров**.

8. Хотя по-прежнему на странице "Сводка" нажмите кнопку Просмотреть отчет, чтобы просмотреть результаты теста. Внесите необходимые изменения в конфигурации и повторно запустите тесты. <br>Чтобы просмотреть результаты тестов после закрытия мастера, см. в разделе *SystemRoot\Cluster\Reports\Validation Report date and time.html*.

9. Чтобы просмотреть разделы справки о проверке кластера после закрытия мастера, в Управление отказоустойчивым кластером, в справке, нажмите кнопку справки, перейдите на вкладку содержимое, разверните содержимое справки отказоустойчивого кластера и щелкните Проверка конфигурации отказоустойчивого кластера .

#### <a name="using-powershell"></a>Использование PowerShell

1. Откройте сеанс PowerShell с правами администратора, щелкнув правой кнопкой мыши кнопку «Пуск», а затем выбрав **Windows PowerShell (Admin)**.

2. Для проверки компьютеров (например, имена компьютеров, узел1 и узел2) для отказоустойчивой кластеризации, выполните команду:

    ```PowerShell
    Test-Cluster -Node "NODE1","NODE2"
    ```
4. Чтобы просмотреть результаты тестов после закрытия мастера, см. в разделе указанный файл (в SystemRoot\Cluster\Reports\), а затем внесите необходимые изменения в конфигурации и выполните тесты повторно.

Дополнительные сведения см. в разделе [Проверка конфигурации отказоустойчивого кластера](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134244(v=ws.11)).

### <a name="step-4-create-the-cluster"></a>Шаг 4. Создание кластера

Следующие операции создадут кластер из машин и конфигурацией.

#### <a name="using-failover-cluster-manager"></a>С помощью диспетчера отказоустойчивости кластеров

1. Из **диспетчера серверов**, выберите **средства** раскрывающийся список и выберите **Диспетчер отказоустойчивости кластеров**.

2. В **Диспетчер отказоустойчивости кластеров**, перейдите в средний столбец, в разделе **управления** и выберите **создания кластеров**.

3. Если **перед началом** откроется окно, выберите **Далее**.

4. В **Выбор серверов** окна, добавление в именах двух машин, которые будут узлами кластера.  Например, если имена не узел1 и узел2, введите имя и выберите **добавить**.  Вы также можете **Обзор** кнопку для поиска Active Directory для имен.  Когда оба отображаются в категории **выбранные серверы**, выберите **Далее**.

5. В **точка доступа для администрирования кластера** окно, введите имя кластера, вы будете использовать.  Обратите внимание на то, что это не имя, которое будет использоваться для подключения к вашей службой файлов.  Это просто администрирование кластера.

   > [!NOTE]
   > При использовании статических IP-адресов, необходимо будет выбрать сеть, и введите IP-адрес будет использоваться для имени кластера.  Если при использовании DHCP для IP-адреса, IP-адрес будет настроен автоматически для вас.

6. Выберите **Далее**.

7. На **Подтверждение** странице, убедитесь, что вы настроили и выберите **Далее** для создания кластера.

8. На **Сводка** страницы, она даст вам конфигурации, он создан.  Вы можете выбрать отчет для просмотра отчета о создании.

#### <a name="using-powershell"></a>Использование PowerShell

1. Откройте сеанс PowerShell с правами администратора, щелкнув правой кнопкой мыши кнопку «Пуск», а затем выбрав **Windows PowerShell (Admin)**.

2. Выполните следующую команду для создания кластера, если вы используете статические IP-адреса.  Например имена компьютеров, узел1 и узел2 кластера будет называться КЛАСТЕРА и IP-адрес будет 1.1.1.1.

   ```PowerShell
    New-Cluster -Name CLUSTER -Node "NODE1","NODE2" -StaticAddress 1.1.1.1
   ```

3. Выполните следующую команду для создания кластера, если вы используете DHCP для IP-адресов.  Например имена компьютеров, узел1 и узел2 и имя кластера будет КЛАСТЕРА.

   ```PowerShell    
   New-Cluster -Name CLUSTER -Node "NODE1","NODE2"
   ```

### <a name="steps-for-configuring-a-file-server-failover-cluster"></a>Действия по настройке отказоустойчивого кластера файловых серверов

Чтобы настроить отказоустойчивый кластер файловых серверов, выполните следующие действия.

1. Из **диспетчера серверов**, выберите **средства** раскрывающийся список и выберите **Диспетчер отказоустойчивости кластеров**.

2. Когда откроется Диспетчер отказоустойчивости кластеров, он автоматически должны быть имя созданного кластера.  Если этого не произошло, перейдите в средний столбец, в разделе **управления** и выберите **подключиться к кластеру**.  Введите имя кластера, вы создали и **ОК**.

3. В дереве консоли щелкните «>» рядом с кластера, который вы создали разверните элементы под ним.

4. Щелкните правой кнопкой мыши **ролей** и выберите **настроить роль**.

5. Если **перед началом** откроется окно, выберите **Далее**.

6. В списке ролей выберите **файлового сервера** и **Далее**.

7. Тип файлового сервера, выберите **файловый сервер для общего использования** и **Далее**.<br>Сведения о масштабируемого файлового сервера, см. в разделе [Обзор масштабируемого файлового сервера](sofs-overview.md).

   ![Тип файлового сервера](media\Cluster-File-Server\Cluster-FS-File-Server-Type.png)

8. В **точки доступа клиента** окно, введите имя файлового сервера, вы будете использовать.  Обратите внимание на то, что это не имя кластера.  Это необходимо для подключения общей папки файла.  Например, если я хочу подключиться к \\сервера, поле введено значение будет сервера.

   > [!NOTE]
   > При использовании статических IP-адресов, необходимо будет выбрать сеть, и введите IP-адрес будет использоваться для имени кластера.  Если при использовании DHCP для IP-адреса, IP-адрес будет настроен автоматически для вас.

6. Выберите **Далее**.

7. В **Выбор хранилища** окно, выберите дополнительный диск (не следящего сервера), который будет содержать к ним и **Далее**.

8. На **Подтверждение** , проверьте конфигурацию и укажите **Далее**.

9. На **Сводка** страницы, она даст вам конфигурации, он создан.  Вы можете выбрать отчет для просмотра отчета создания роли сервера файла.

10. В разделе **роли** в дереве консоли, вы увидите новую роль, вы создали перечисляются в виде имя, вы создали.  С помощью он выделен, в разделе **действия** панели справа выберите **добавить общую папку**.

11. Выполните в мастере общий ресурс, введя следующее:

    - Тип общего ресурса, будет работать
    - Путь к расположению будет общей папкой
    - Имя общего ресурса пользователи будут подключаться к
    - Дополнительными параметрами, например перечисление на основе доступа, кэширование, шифрования и т. д
    - Файл, уровень разрешений, если они будут отличного от значения по умолчанию

12. На **Подтверждение** странице, убедитесь, что вы настроили и выберите **создать** для создания файлового сервера.

13. На **результаты** выберите Close, если он создан общий ресурс.  Если не удалось создать общую папку, она даст вам связанные ошибки.

14. Выберите **закрыть**.

15. Повторите эту процедуру для любых дополнительных общих ресурсов.