---
title: Развертывание файлового ресурса-свидетеля в Windows Server 2019 г.
ms.prod: windows-server-threshold
ms.manager: eldenc
ms.technology: failover-clustering
ms.topic: article
author: johnmarlin-msft
ms.date: 01/24/2019
description: Ресурсы-свидетели файл можно будет использовать общую папку для голосования в кворуме кластера. В этом разделе описывает файл ресурсы-свидетели и новые функциональные возможности, в том числе с помощью USB-накопитель, подключенные к маршрутизатору как файловый ресурс-свидетель.
ms.localizationpriority: medium
ms.openlocfilehash: 1888142f96208800a0417c9caeea89e8a0472e88
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59831755"
---
# <a name="deploy-a-file-share-witness"></a>Развертывание файлового ресурса-свидетеля

> Область применения. Windows Server 2019 г., Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Файловый ресурс-свидетель представляет собой общую папку SMB, который использует отказоустойчивый кластер в качестве голос в кворуме кластера. Здесь представлен обзор технологии и новые функциональные возможности Windows Server 2019, в том числе с помощью USB-накопитель, подключенные к маршрутизатору как файловый ресурс-свидетель.

Ресурсы-свидетели файл удобны в следующих случаях:  

- Облако-свидетель не может использоваться, так как не все серверы в кластере имеют надежным подключением к Интернету
- Нельзя использовать диск-свидетель, так как не все общие диски для диска-свидетеля. Это может быть дисковых кластера, всегда на доступности группы (групп Доступности SQL Server), Exchange базы данных группы доступности (DAG), и т.д.  Ни один из этих типов кластеров использовать общие диски.

## <a name="file-share-witness-requirements"></a>Файл требования следящий сервер общий ресурс

Вы можете разместить следящая общая папка на сервере Windows, присоединенных к домену, или если кластер работает под управлением Windows Server 2019, любое устройство, можно узла SMB 2 или более поздней версии файла общую папку.

|Тип файлового сервера                 | Поддерживаемые кластеры |
|---------------------------------|--------------------|
|Любое устройство w/an SMB 2 файлового ресурса | Windows Server 2019|
|Присоединенные к домену Windows Server     | Windows Server 2008 и более поздних версий|

Если кластер работает под управлением Windows Server 2019, ниже приведены требования:

- Файловый ресурс SMB *на любое устройство, использующее SMB 2 или более поздней версии протокол*, в том числе:
    - Устройства к сети (NAS)
    - Компьютеры Windows, входящем в рабочую группу
    - Маршрутизаторы с локально подключенных USB-накопителя
- Локальной учетной записи на устройстве для аутентификации кластера
- Если вместо этого вы используете Active Directory для проверки подлинности кластера с общей папкой, объект имени кластера (CNO) должна иметь разрешения на запись в общей папке, а сервер должен находиться в одном лесу Active Directory, что и кластер
- Общий файловый ресурс содержит как минимум 5 МБ свободного места

Если кластер работает в Windows Server 2016 или более ранней версии, ниже приведены требования:

- Файловые ресурсы SMB *на сервере Windows, присоединенных к одному лесу Active Directory, что и кластер*
- Объект имени кластера (CNO) должна иметь разрешения на запись в общей папке
- Общий файловый ресурс содержит как минимум 5 МБ свободного места

Другие примечания:
- Чтобы использовать файловый ресурс-свидетель, поддерживаемого устройства, кроме присоединенных к домену Windows server, в настоящее время необходимо использовать **Set-ClusterQuorum-Credential** командлет PowerShell, чтобы задать следящего сервера, как описано далее в этом разделе.
- Для обеспечения высокой доступности можно использовать файловый ресурс-свидетель в отдельном отказоустойчивом кластере
- Файловый ресурс может использоваться несколькими кластерами
- Использование общей папки с распределенной файловой системы (DFS) или реплицируемых хранилищ не поддерживается с любой версией отказоустойчивой кластеризации.  Это может привести к ситуации разделения вычислительных мощностей где кластерные серверы работают независимо друг от друга и может привести к потере данных.

## <a name="creating-a-file-share-witness-on-a-router-with-a-usb-device"></a>Создание файлового ресурса-свидетеля на маршрутизаторе с USB-устройством

В [Microsoft Ignite 2018](https://azure.microsoft.com/ignite/), [DataOn хранения](http://www.dataonstorage.com/) имели прямой кластер хранилища пробелы на своей территории киоска.  Этот кластер был подключен к [NetGear](https://www.netgear.com) маршрутизатору Wi-Fi X4S Nighthawk, используя USB-порта в формате ресурса-свидетеля, аналогичную следующей.

![NetGear следящего сервера](media\File-Share-Witness\FSW1.png)

Ниже перечислены шаги по созданию файлового ресурса-свидетеля, с помощью USB-устройства для этого конкретного маршрутизатора.  Учтите, что зависит от действия на других маршрутизаторах и NAS-устройства и должно быть выполнено с помощью поставщика указано направлениях.


1. Войдите на маршрутизатор с подключенным устройством USB.

   ![Интерфейс NetGear](media\File-Share-Witness\FSW2.png)

2. В списке вариантов выберите ReadySHARE, который является, где можно создать общие папки.

   ![NetGear ReadySHARE](media\File-Share-Witness\FSW3.png)

3. Для файлового ресурса-свидетеля общую папку основные — все, что требуется.  Выбрав "Изменить" будет отображаться всплывающее диалоговое окно на USB-устройство, в котором можно создать общую папку.

   ![Интерфейс NetGear общей папки](media\File-Share-Witness\FSW4.png)

4. После выбора кнопки "Применить", создается общему ресурсу и можно увидеть в списке.

   ![Общие папки NetGear](media\File-Share-Witness\FSW5.png)

5. После создания общей папки файлового ресурса-свидетеля для кластера создается с помощью PowerShell.

   ```PowerShell
   Set-ClusterQuorum -FileShareWitness \\readyshare\Witness -Credential (Get-Credential)
   ```

   Откроется диалоговое окно, введите локальную учетную запись на устройстве.

Эти же аналогичные действия можно сделать на маршрутизаторах, другие возможности USB, NAS-устройства или других устройств Windows.
