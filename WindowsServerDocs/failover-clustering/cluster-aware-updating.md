---
title: Общие сведения о кластерном обновлении
description: Обновление с поддержкой кластера (CAU) автоматизирует установку обновлений программного обеспечения в кластерах под управлением Windows Server.
ms.topic: article
ms.prod: windows-server
manager: lizross
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 08/06/2018
ms.assetid: 3c2993b4-aa81-452b-a5c3-3724ad95d892
ms.openlocfilehash: bd3c15d08b0d4b6f174fd9c790f0dacb2457472e
ms.sourcegitcommit: 771db070a3a924c8265944e21bf9bd85350dd93c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2020
ms.locfileid: "85473291"
---
# <a name="cluster-aware-updating-overview"></a>Общие сведения о кластерном обновлении

> Применяется к: Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе приводятся общие сведения об \- обновлении Cau с учетом кластеров \( \) , который автоматизирует процесс обновления программного обеспечения на кластеризованных серверах, сохраняя доступность.

> [!NOTE]
> При обновлении кластеров [Локальные дисковые пространства](../storage/storage-spaces/storage-spaces-direct-overview.md) рекомендуется использовать обновление с поддержкой кластера.

## <a name="feature-description"></a><a name="BKMK_OVER"></a>Описание функции
Кластерное обновление — это автоматизированная функция, которая позволяет обновлять серверы в [отказоустойчивом кластере](failover-clustering-overview.md) с незначительной потерей доступности в процессе обновления. Во время прогона обновления кластерное обновление прозрачно выполняет следующие задачи:

1. Помещает каждый узел кластера в режим обслуживания узла.
2. Перемещает кластерные роли за пределы узла.
3. Устанавливает обновления и все зависимые обновления.
4. При необходимости выполняет перезагрузку.
5. Переводит узел в режим обслуживания.
6. Восстанавливает кластерные роли на узле.
7. Переходит к обновлению следующего узла.

Для многих кластерных ролей в кластере процесс автоматического обновления вызывает плановую отработку отказа. Это может привести к временному прерыванию обслуживания подключенных клиентов. Однако в случае непрерывных доступных рабочих нагрузок, таких как Hyper \- V с динамической миграцией или файлового сервера с прозрачной отработкой отказа SMB, обновление с поддержкой кластера может координировать обновления кластера без влияния на доступность службы.

## <a name="practical-applications"></a>Практическое применение

-   CAU сокращает время простоя служб в кластеризованных службах, снижает потребность в способах обновления вручную и делает \- \- процесс обновления кластера более надежным для администратора. Если функция CAU используется в сочетании с постоянно доступными рабочими нагрузками кластера, например в постоянно доступных файловых серверах \( Рабочая нагрузка файлового сервера с прозрачной отработкой отказа SMB \) или Hyper \- V, обновления кластера могут быть выполнены с нулевым влиянием на доступность служб для клиентов.

-   Кластерное обновление упрощает адаптацию ИТ-процессов на предприятии. Обновление профилей выполнения может быть создано для различных классов отказоустойчивых кластеров, а затем управляется централизованно на файловом ресурсе, чтобы обеспечить согласованное применение обновлений в рамках ИТ-организации, даже если кластеры управляются разными \- частями \- бизнеса или администраторами.

-   Кластерное обновление позволяет запланировать запуск обновления ежедневно, раз в неделю или раз в месяц. Это позволяет согласовать обновление кластера с другими процессами управления.

-   CAU предоставляет расширяемую архитектуру для обновления инвентаризации программного обеспечения кластера в кластере \- . Они могут использоваться издателями для координации установки обновлений программного обеспечения, не опубликованных в Центр обновления Windows или Центр обновления Майкрософт или недоступных в корпорации Майкрософт, например обновлений для драйверов устройств, отличных от \- Майкрософт.

-   \-Режим самообновления Cau позволяет устройству "кластер в виде Box" \( набор кластеризованных физических компьютеров, обычно упакованных в один корпус \) для обновления самого себя. Как правило, такие решения развертываются в филиалах с минимальной локальной поддержкой. \-Режим самообновления обеспечивает высокую ценность в этих сценариях развертывания.

## <a name="important-functionality"></a>Важные функции
Ниже приведено описание важных функций обновления, поддерживающих кластер.

-   Пользовательский интерфейс пользовательского \( интерфейса \) — Обновление окна с поддержкой кластера, а также набор командлетов, которые можно использовать для предварительного просмотра, применения, мониторинга и отчетов по обновлениям.

-   Комплексная \- \- Автоматизация операции обновления кластера \- \( \) , которая управляется одним или несколькими компьютерами координатора обновлений

-   Подключаемый модуль по умолчанию \- , который интегрируется с существующим агентом центр обновления Windows агента \( WUA \) и Windows Server Update Services \( \) инфраструктурой WSUS в Windows Server для применения важных обновлений Майкрософт

-   Второй подключаемый модуль \- , который может использоваться для применения исправлений Майкрософт и может быть настроен для применения обновлений, не выпущенных \- корпорацией Майкрософт

-   Профили выполнения обновления, в которых можно указывать параметры запуска обновления, например максимальное число повторных попыток запуска процесса обновления на каждом узле Профили выполнения обновления позволяют повторно использовать одинаковые параметры для разных экземпляров обновления и использовать параметры обновления совместно с другими отказоустойчивыми кластерами.

-   Расширяемая архитектура, которая поддерживает новую разработку подключаемых модулей \- для координации других \- средств обновления узлов в кластере, таких как пользовательские установщики программного обеспечения, средства обновления BIOS, сетевые адаптеры и \( средства обновления адаптера шины узла HBA \) .

Обновление с поддержкой кластера может координировать полную операцию обновления кластера в двух режимах:

-   ** \- Режим самообновления** для этого режима. КЛАСТЕРная роль Cau настраивается в качестве рабочей нагрузки в обновляемом отказоустойчивом кластере и определяется связанное расписание обновления. Затем кластер самостоятельно обновляется в запланированное время с использованием профиля по умолчанию или пользовательского профиля прогона обновления. В ходе прогона обновления на узле, который в этот момент является владельцем кластерной роли CAU, запускается процесс координатора обновлений, последовательно обновляющий каждый узел кластера. Чтобы обновить текущий узел кластера, кластерная роль CAU переводится на другой узел кластера, а новый процесс координатора обновлений на этом узле берет на себя управление прогоном обновления. В \- режиме автоматического обновления Cau может обновить отказоустойчивый кластер, используя полностью автоматизированный, сквозной \- \- процесс обновления. Администратор может также активировать обновления по \- запросу в этом режиме или просто использовать метод удаленного обновления, \- если это необходимо. В \- режиме автоматического обновления администратор может получить сводные сведения о выполняемом прогоне обновления, подключившись к кластеру и выполнив командлет **Get \- каурун** Windows PowerShell.

-   ** \- Режим удаленного обновления** для этого режима — удаленный компьютер, который называется координатором обновлений, настраивается с помощью средств Cau. Координатор обновлений не является членом кластера, обновление которого проводится во время прогона обновления. С удаленного компьютера администратор активирует \- Запуск обновления по запросу с помощью стандартного или пользовательского профиля прогона обновления. \-Режим удаленного обновления полезен для мониторинга хода выполнения процесса обновления в реальном \- времени и для кластеров, работающих в установках Server Core.

## <a name="hardware-and-software-requirements"></a>Требования к аппаратному и программному обеспечению

CAU можно использовать во всех выпусках Windows Server, включая установки Server Core. Подробные сведения о требованиях см. в статье [требования к кластерному обновлению и](cluster-aware-updating-requirements.md)рекомендации.

### <a name="installing-cluster-aware-updating"></a>Установка обновления с поддержкой кластера
Чтобы использовать CAU, установите компонент отказоустойчивой кластеризации в Windows Server и Создайте отказоустойчивый кластер. Компоненты, поддерживающие кластерное обновление, автоматически устанавливаются на каждом узле кластера.

Для установки компонента "Средство отказоустойчивости кластеров" можно использовать следующие средства:
- Мастер добавления ролей и компонентов в диспетчере сервера
- [Install-WindowsFeature](https://docs.microsoft.com/powershell/module/servermanager/Install-WindowsFeature?view=winserver2012r2-ps&viewFallbackFrom=win10-ps)   Командлет Windows PowerShell
- Программа командной строки "Система обслуживания образов развертывания и управления ими" (DISM)

Дополнительные сведения см. [в разделе Установка компонента отказоустойчивой кластеризации](create-failover-cluster.md#install-the-failover-clustering-feature).

Также необходимо установить средства отказоустойчивой кластеризации, которые являются частью средства удаленного администрирования сервера и устанавливаются по умолчанию при установке компонента отказоустойчивой кластеризации в диспетчер сервера. Средства отказоустойчивой кластеризации включают в себя пользовательский интерфейс обновления с поддержкой кластера и командлеты PowerShell.

Для поддержки различных режимов обновления CAU необходимо установить средства отказоустойчивости кластеров, как указано ниже.

- Чтобы использовать CAU в \- режиме автоматического обновления, установите средства отказоустойчивой кластеризации на каждом узле кластера.

- Чтобы включить \- режим удаленного обновления, установите средства отказоустойчивой кластеризации на компьютере с сетевым подключением к отказоустойчивому кластеру.

> [!NOTE]
> -   Средства отказоустойчивой кластеризации в Windows Server 2012 нельзя использовать для управления кластерным обновлением в более новой версии Windows Server.
> -   Для использования CAU только в \- режиме удаленного обновления установка средств отказоустойчивой кластеризации на узлах кластера не требуется. Однако определенные функции CAU будут недоступны. Дополнительные сведения см. в разделе [требования и рекомендации по \- обновлению с учетом кластеров](cluster-aware-updating-requirements.md).
> -   Если только вы не используете CAU только в \- режиме самообновления, компьютер, на котором установлены средства Cau и который координирует обновления, не может быть членом отказоустойчивого кластера.

### <a name="enabling-self-updating-mode"></a>Включение режима самообновления
Чтобы включить режим самообновления, необходимо добавить кластерную роль обновления с поддержкой кластера в отказоустойчивый кластер. Для этого используйте один из следующих методов.
- В Диспетчер сервера выберите **инструменты**  >  **обновление с поддержкой кластера**, а затем в окне кластерное обновление выберите **настроить параметры самостоятельного обновления кластера**.
- В сеансе PowerShell выполните командлет [Add-кауклустерроле](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole?view=win10-ps) .

Чтобы удалить CAU, удалите компонент отказоустойчивой кластеризации или средства отказоустойчивой кластеризации с помощью диспетчер сервера, командлета [uninstall-WindowsFeature](https://docs.microsoft.com/powershell/module/servermanager/Uninstall-WindowsFeature?view=win10-ps) или \- средств командной строки DISM.

### <a name="additional-requirements-and-best-practices"></a>Дополнительные требования и рекомендации

Для успешного обновления узлов кластера через CAU и для получения дополнительных рекомендаций по настройке среды отказоустойчивой кластеризации для использования CAU можно запустить анализатор соответствия рекомендациям CAU.

Подробные требования и рекомендации по использованию CAU, а также сведения о выполнении анализатор соответствия рекомендациям CAU см. в разделе [требования и рекомендации по \- обновлению с поддержкой кластера](cluster-aware-updating-requirements.md).

### <a name="starting-cluster-aware-updating"></a>Запуск обновления с поддержкой кластера

##### <a name="to-start-cluster-aware-updating-from-server-manager"></a>Запуск обновления с поддержкой кластера с диспетчер сервера

1.  Запустите диспетчер серверов.

2.  Выполните одно из следующих действий.

    -   В меню **Сервис** выберите пункт **обновление с \- поддержкой кластера**.

    -   Если один или несколько узлов кластера или кластер добавляются в диспетчер сервера, на странице **все серверы** щелкните правой кнопкой мыши \- имя узла \( или имя кластера \) , а затем выберите команду **обновить кластер**.

## <a name="additional-references"></a>Дополнительные ссылки
Дополнительные сведения об использовании кластерного обновления см. по следующим ссылкам.

-   [Требования и рекомендации по \- обновлению с учетом кластеров](cluster-aware-updating.md)

-   [\-Обновление с поддержкой кластера: часто задаваемые вопросы](cluster-aware-updating-faq.md)

-   [Дополнительные параметры и профили прогона обновления для CAU](cluster-aware-updating-options.md)

-   [Как работают подключаемые модули CAU \-](cluster-aware-updating-plug-ins.md)

-   [\-Командлеты обновления с поддержкой кластера в Windows PowerShell](https://docs.microsoft.com/powershell/module/clusterawareupdating/?view=win10-ps&viewFallbackFrom=winserverr2-ps)

-   [\-Справочник по подключаемому модулю обновления с поддержкой кластера \-](https://docs.microsoft.com/previous-versions/windows/desktop/mscs/cluster-aware-update-plug-in-interfaces-and-classes)


