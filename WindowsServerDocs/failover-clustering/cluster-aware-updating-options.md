---
ms.assetid: 2f4b6641-0ec2-4b1c-85fb-a1f1d16685c8
title: "поддержкой глянца обновления Дополнительные параметры и профили прогона обновления"
ms.topic: article
ms.prod: storage-failover-clustering
manager: dongill
ms.author: jgerend
author: JasonGerend
ms.date: 6/7/2017
description: "Как настроить дополнительные параметры и профили прогона обновления для кластерного обновления (CAU)"
ms.openlocfilehash: 5b6f035791a946ff96ff6a95a1f753ef505d54b4
ms.sourcegitcommit: 583355400f6b0d880dc0ac6bc06f0efb50d674f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2017
---
# <a name="cluster-aware-updating-advanced-options-and-updating-run-profiles"></a>Дополнительные параметры и профили прогона обновления кластерное обновление

>Применяется к: Windows Server (канал точками годовой), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе описываются параметры прогона обновления, которые могут быть настроены для [кластерное обновление](cluster-aware-updating.md) прогона обновления (CAU). Эти дополнительные параметры можно настроить при использовании пользовательского интерфейса CAU или командлетов CAU Windows PowerShell для применения обновлений или настройки параметров самообновления.

Большинство параметров конфигурации можно сохранить в XML-файл, который называется профиля прогона обновления и использовать для последующих запусков обновления. Значения по умолчанию для параметров прогона обновления, предоставляемые службой кластерное обновление может также использоваться во множестве кластерных сред.

Сведения о дополнительных параметрах, которые можно задавать для каждого выполнения обновления и о профилях прогона обновления см. в следующих разделах, далее в этом разделе:

Параметры, указываемые при запросе обновления запуска используйте параметры выполнения обновления профилей, задаваемых в профиле прогона обновления

В следующей таблице перечислены параметры, которые можно настроить в профиле прогона обновления CAU. 

> [!NOTE] 
> Чтобы задать параметр PreUpdateScript или PostUpdateScript, убедитесь, установить Windows PowerShell и платформу .NET Framework 4.6 или 4.5 и что удаленное взаимодействие PowerShell включено на каждом узле кластера. Дополнительные сведения см. в разделе Настройка узлов для удаленного управления в [требования и рекомендации для кластерного обновления ](cluster-aware-updating-requirements.md).


|Параметр|Значение по умолчанию|Сведения о|  
|------------|-------------------|-------------|  
|**StopAfter**|Неограниченное время|Время в минутах, после чего выполнение обновления будет остановлен не завершена. **Примечание:** при указании перед обновлением или после обновления сценария PowerShell весь процесс запуска сценариев и выполнения обновлений должен быть завершен в течение **StopAfter** ограничение по времени.|  
|**WarnAfter**|По умолчанию предупреждение не выводится|Время в минутах, после чего будет выведено предупреждение, если выполнение обновления (включая скрипт перед обновлением и скрипт после обновления, если они настроены) не была завершена.|  
|**MaxRetriesPerNode**|3|Максимальное число попыток процесс обновления (включая скрипт перед обновлением и скрипт после обновления, если они настроены) на каждом узле. Максимальное — 64.|  
|**MaxFailedNodes**|Для большинства кластеров — целое число, примерно равное трети от количества узлов кластера|Максимальное число узлов, на которых обновление может завершиться ошибкой из-за отказа узла или остановки службы кластеров. Если данное число превышено, прогон обновления останавливается.<br /><br /> Допустимый диапазон значений — 0 до 1 меньше количества узлов кластера.|  
|**RequireAllNodesOnline**|Нет|Указывает, что все узлы должны находиться в оперативном режиме и достижимыми перед началом обновления.|  
|**RebootTimeoutMinutes**|15|Время в минутах, отводимое CAU на перезагрузку узла (если такая перезагрузка необходима) и запуск всех служб автоматического запуска. Если процесс перезагрузки не завершается в течение этого времени, выполнение обновления на этом узле помечается как завершившийся ошибкой.|  
|**PreUpdateScript**|Нет|Путь и имя файла для сценария PowerShell, выполняемого на каждом узле перед началом обновления и перед как узел переводится в режим обслуживания. Расширение имени файла должно быть **.ps1**, общая длина пути и имени файла не должна превышать 260 символов. Рекомендуется сценарий должен находиться на диске в системе хранения данных кластера или в папке высокой доступности сети, чтобы убедиться, что он был всегда доступен для всех узлов кластера. Если сценарий находится на общем сетевом ресурсе, убедитесь, что все группы, и запретите доступ на запись для предотвращения несанкционированного изменения файлов несанкционированного настраиваемое общей папке для разрешение на чтение.<br /><br /> Если указать скрипт перед обновлением убедитесь, что параметры, такие как время ограничивает (например, **StopAfter**), настроены на разрешение успешное выполнение сценария. Эти ограничения задают временной интервал весь процесс запуска сценариев и установки обновлений, не только в процессе установки обновлений.|  
|**PostUpdateScript**|Нет|Путь и имя файла для сценария PowerShell, выполняемого после завершения обновления (после выхода узла из режима обслуживания). Расширение имени файла должно быть **.ps1** общая длина пути и имени файла не должна превышать 260 символов. Рекомендуется сценарий должен находиться на диске в системе хранения данных кластера или в папке высокой доступности сети, чтобы убедиться, что он был всегда доступен для всех узлов кластера. Если сценарий находится на общем сетевом ресурсе, убедитесь, что все группы, и запретите доступ на запись для предотвращения несанкционированного изменения файлов несанкционированного настраиваемое общей папке для разрешение на чтение.<br /><br /> Если указать скрипт после обновления, убедитесь, что параметры, такие как время ограничивает (например, **StopAfter**), настроены на разрешение успешное выполнение сценария. Эти ограничения задают временной интервал весь процесс запуска сценариев и установки обновлений, не только в процессе установки обновлений.|  
|**ConfigurationName**|Этот параметр действует только при выполнении сценариев.<br /><br /> Если указать сценарий Pre-Update или сценарий POST-Update, но не указывайте **ConfigurationName**, сеанс по умолчанию используется конфигурация для PowerShell (Microsoft.PowerShell).|Задает конфигурацию сеанса PowerShell, которая определяет сессию, выполняющую сценарии (заданные параметрами **PreUpdateScript** и **PostUpdateScript**), а также может ограничить команды, которые могут выполняться.|  
|**CauPluginName**|**Microsoft.WindowsUpdatePlugin**|Подключаемый модуль, который вы кластерного обновления можно использовать для просмотра обновлений или выполнения прогона обновления. Дополнительные сведения см. в разделе [как кластерное обновление подключаемых модулях](cluster-aware-updating-plug-ins.md).|  
|**CauPluginArguments**|Нет|Набор *имя = значение* пар (аргументов) для обновления, подключаемый модуль для использования, например:<br /><br /> **Domain=domain.Local**<br /><br /> Эти *имя = значение* пары должны быть понятны подключаемый модуль, указанный в **CauPluginName**.<br /><br /> Чтобы задать аргумент в пользовательском Интерфейсе CAU, введите *имя*, нажимайте клавишу Tab, а затем введите соответствующее *значение*. Чтобы задать следующий аргумент, снова нажмите клавишу Tab. Каждый *имя* и *значение* автоматически отделяются друг от друга знаком равенства (=). Пары автоматически отделяются друг друга точкой с запятой.<br /><br /> По умолчанию **Microsoft.WindowsUpdatePlugin** подключаемый модуль, не требуются аргументы. Тем не менее можно задать необязательный аргумент, например указать стандартную строку запроса агента обновления Windows для фильтрации набор обновлений, которые применяются подключаемым модулем. Для *имя*, используйте **QueryString**, а также для *значение*, заключите весь запрос в кавычки.<br /><br /> Дополнительные сведения см. в разделе [как кластерное обновление подключаемых модулях](cluster-aware-updating-plug-ins.md).|  
  
##  <a name="BKMK_runtime"></a>Параметры, указываемые при запросе прогона обновления  
 В следующей таблице перечислены параметры (отличные в профиле прогона обновления), указываемые при запросе прогона обновления. Сведения о параметрах, задаваемых в профиле прогона обновления см. в предыдущей таблице.  
  
|Параметр|Значение по умолчанию|Сведения о|  
|------------|-------------------|-------------|  
|**Имя кластера**|Нет <br>**Примечание:** этот параметр необходимо задавать только в том случае, если пользовательский Интерфейс CAU не запущен на узле отказоустойчивого кластера или если нужно сослаться на отказоустойчивый кластер, отличный от того, где запущен пользовательский Интерфейс CAU.|NetBIOS-имя кластера, на котором следует выполнить обновление.|  
|**Учетные данные**|Учетные данные текущей учетной записи|Учетные данные администратора для целевого кластера, на которого приложение Updating Run будет выполнен. Вы уже могут быть необходимые учетные данные, если запущен пользовательский Интерфейс CAU (или открыт сеанс PowerShell, если вы используете командлеты CAU PowerShell) из учетной записи с правами и разрешениями администратора в кластере.|  
|**NodeOrder**|По умолчанию CAU начинает работу с узла с наименьшим количеством кластерных ролей, затем переходит на узел, второй наименьшее число и т. д.|Имена узлов кластера, в том порядке, в котором они должны быть обновлены (если возможно).|  
  
##  <a name="BKMK_profile"></a>Использование профилей прогона обновления  
 Каждый прогон обновления можно связать с особым профилем прогона обновления. По умолчанию профиль прогона обновления хранятся в *%windir%\cluster* папки. Если вы используете пользовательский Интерфейс CAU удаленного обновления режиме, вы можете указать профиль прогона обновления во время установки обновлений или использовать профиль прогона обновления по умолчанию. Если вы используете CAU в режиме самообновления, можно импортировать параметры из указанного профиля прогона обновления при настройке параметров самообновления. В обоих случаях можно переопределить значения, отображаемые для параметров прогона обновления в соответствии с потребностями. Если требуется, можно сохранить параметры прогона обновления в виде профиля прогона обновления с тем же именем или с другим именем файла. В следующий раз при применении обновлений или настройке параметров самообновления CAU автоматически выберет профиль прогона обновления, ранее была выбрана.  
  
 Можно изменить существующий профиль прогона обновления или создать новую, выбрав **создать или изменить профиль прогона обновления** в пользовательском Интерфейсе CAU.

Ниже приведены некоторые важные сведения об использовании профили прогона обновления.

* Профиль прогона обновления не сохраняются данные кластера такие как административные учетные данные. Если вы используете CAU в режиме самообновления, профиль прогона обновления также не сохраняются данные о расписании самообновления. Это позволяет совместно использовать профиль прогона обновления во всех отказоустойчивых кластерах определенного класса.
* Если настроить параметры самообновления с помощью профиля прогона обновления, а затем изменить профиль, задав другие значения для параметров прогона обновления, то конфигурация самообновления не изменится автоматически. Чтобы применить новые параметры прогона обновления, необходимо снова настроить параметры самообновления.
* Редактор профиль выполнения к сожалению не поддерживает пути к файлам, которые включают пробелы, такие как *C:\Program Files*. В качестве решения хранения вашей операционных систем и учет сценарии обновления в пути, который не содержать пробелы или использовать PowerShell исключительно для управления профилями запустите, помещая в кавычки путь при выполнении **Invoke-CauRun**.

### <a name="windows-powershell-equivalent-commands"></a>Эквивалентные команды Windows PowerShell
  
 Параметры можно импортировать из профиля прогона обновления, при запуске **Invoke-CauRun**, **Add-CauClusterRole**, или **Set-CauClusterRole** командлета.  
  
 В следующем примере выполняется проверка и полный прогон обновления в кластере с именем *CONTOSO-FC1*, с использованием параметров прогона обновления, которые указаны в *C:\Windows\Cluster\DefaultParameters.xml*. Для остальных параметров командлета используются значения по умолчанию.  
  
```powershell  
$MyRunProfile = Import-Clixml C:\Windows\Cluster\DefaultParameters.xml  
Invoke-CauRun –ClusterName CONTOSO-FC1 @MyRunProfile   
```  
  
 С помощью профиля прогона обновления, можно обновить отказоустойчивый кластер повторять операции с одинаковыми параметрами для обработки исключений, ограничений по времени и других рабочих показателей. Так как эти параметры обычно связаны с некоторым классом отказоустойчивых кластеров, например «Все кластеры Microsoft SQL Server» или «Важнейшие кластеры организации», может потребоваться каждого профиля прогона обновления имя соответствующее классу отказоустойчивых кластеров, которые будут использоваться вместе с. Кроме того можно управлять профиль прогона обновления в общей папке, которая доступна всем отказоустойчивым кластерам определенного класса в ИТ-организации.  
  
  
  
## <a name="see-also"></a>См. также:

-   [Кластерное обновление](cluster-aware-updating.md)
  
-   [Командлеты кластерного обновления в Windows PowerShell](https://technet.microsoft.com/itpro/powershell/windows/cluster-aware-updating)