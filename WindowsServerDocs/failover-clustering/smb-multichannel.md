---
ms.assetid: a6343f1c-e9dd-4a02-91ad-39bd519d66cd
title: Упрощенные кластерные сети SMB Multichannel и Multi-NIC
ms.topic: article
author: RobHindman
ms.author: robhind
ms.date: 09/15/2016
ms.openlocfilehash: 7fad43cb5f3de5c10ed815fa802b6168c15850d1
ms.sourcegitcommit: 68444968565667f86ee0586ed4c43da4ab24aaed
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2020
ms.locfileid: "87990750"
---
# <a name="simplified-smb-multichannel-and-multi-nic-cluster-networks"></a>Упрощенные кластерные сети SMB Multichannel и Multi-NIC

> Применяется к: Windows Server 2019, Windows Server 2016

Упрощенный многоканальный и многоуровневый протокол SMB<abbr title="Сетевой адаптер">Сетевая карта</abbr> Кластерные сети — это функция, которая позволяет использовать несколько сетевых карт в одной подсети кластера и автоматически включает многоканальный протокол SMB.

Упрощенные сети с многоканальными и многосетевыми кластерами SMB обеспечивают следующие преимущества:
- Отказоустойчивая кластеризация автоматически распознает все сетевые карты на узлах, использующих один коммутатор или ту же подсеть. Дополнительная настройка не требуется.
- Многоканальный SMB включен автоматически.
- Сети, которые имеют только ресурсы IP-адресов локальной связи IPv6 (FE80), распознаются только в частных сетях.
- По умолчанию каждый ресурс IP-адреса настраивается в каждом сетевом имени точки доступа к кластеру (NN).
- При обнаружении нескольких сетевых карт в одной подсети Проверка кластера больше не выдает предупреждающих сообщений.

## <a name="requirements"></a>Требования
-   Несколько сетевых адаптеров на один сервер, используя один коммутатор или подсеть.

## <a name="how-to-take-advantage-of-multi-nic-clusters-networks-and-simplified-smb-multichannel"></a>Использование сетей кластеров с несколькими сетевыми адаптерами и упрощенного многоканального протокола SMB
В этом разделе описывается использование преимуществ новых сетей кластеров с несколькими сетевыми адаптерами и упрощенных функций многоканального протокола SMB.

### <a name="use-at-least-two-networks-for-failover-clustering"></a>Использовать по меньшей мере две сети для отказоустойчивой кластеризации
Хотя в редких случаях сетевые коммутаторы могут завершаться сбоем, по-прежнему рекомендуется использовать по крайней мере две сети для отказоустойчивой кластеризации. Все найденные сети используются для пульса кластера. Избегайте использования одной сети для отказоустойчивого кластера, чтобы избежать единой точки отказа. В идеале между узлами в кластере должно быть несколько физических путей обмена данными, не имеющих единой точки отказа.

![Иллюстрация двух сетей для отказоустойчивой кластеризации ](media/Simplified-SMB-Multichannel-and-Multi-NIC-Cluster-Networks/Clustering_MulitNIC_Fig1.png)
 **рис. 1. Использование по крайней мере двух сетей для отказоустойчивой кластеризации**

### <a name="use-multiple-nics-across-clusters"></a>Использование нескольких сетевых карт в кластерах

Максимальное преимущество упрощенного многоканального протокола SMB достигается, когда несколько сетевых карт используются в кластерах как в хранилище, так и в кластерах рабочей нагрузки хранилища. Это позволяет кластерам рабочей нагрузки (Hyper-V, SQL Server экземпляру отказоустойчивого кластера, реплике хранилища и т. д.) использовать многоканальный протокол SMB и приводить к более эффективному использованию сети. В конфигурации кластера с согласованной (также известной как расагрегированная), в которой для хранения данных рабочей нагрузки используется кластер масштабируемых файловых серверов в кластере экземпляров отказоустойчивого кластера Hyper-V или SQL Server, эта сеть часто называется «Север-Южная подсеть» или «сеть». Многие клиенты максимально максимизируют пропускную способность этой сети за счет вложения сетевых карт и коммутаторов RDMA.

![Иллюстрация подсети SMB ](media/Simplified-SMB-Multichannel-and-Multi-NIC-Cluster-Networks/Clustering_MulitNIC_Fig2.png)
 **, расположенной в южной части. 2. для достижения максимальной пропускной способности сети используйте несколько сетевых интерфейсов как в кластере масштабируемых файловых серверов, так и в кластере экземпляров отказоустойчивого кластера Hyper-V или SQL Server кластера, который совместно используют подсеть северо-Юг** .

![Снимке экрана из двух кластеров, использующих несколько сетевых карт в одной подсети для использования многоканального SMB на ](media/Simplified-SMB-Multichannel-and-Multi-NIC-Cluster-Networks/Clustering_MulitNIC_Fig3.png)
 **рис. 3: два кластера (масштабируемый файловый сервер для хранения, SQL Server <abbr title=" экземпляр отказоустойчивого кластера "> FCI </abbr> для рабочей нагрузки) оба используют несколько сетевых интерфейсов в одной подсети для использования многоканального протокола SMB и обеспечивают лучшую пропускную способность сети.**

## <a name="automatic-recognition-of-ipv6-link-local-private-networks"></a>Автоматическое распознавание локальных частных сетей связи IPv6
При обнаружении частных сетей (только кластеров) с несколькими сетевыми картами кластер автоматически распознает IP-адреса локальной сети (FE80) IPv6 Link для каждой сетевой карты. Это экономит время администраторов, так как им больше не нужно вручную настраивать ресурсы IP-адресов локальной связи IPv6 (FE80).

При использовании нескольких частных сетей (только кластеров) Проверьте конфигурацию маршрутизации IPv6, чтобы убедиться, что маршрутизация не настроена на использование перекрестных подсетей, так как это снизит производительность сети.

![Снимке экрана для автоматической настройки сети в пользовательском интерфейсе диспетчер отказоустойчивости кластеров ](media/Simplified-SMB-Multichannel-and-Multi-NIC-Cluster-Networks/Clustering_MulitNIC_Fig4.png)
 **рис. 4. конфигурация ресурса автоматической настройки адреса локальной связи IPv6 (FE80)**

## <a name="throughput-and-fault-tolerance"></a>Пропускная способность и отказоустойчивость
Windows Server 2019 и Windows Server 2016 автоматически определяют возможности сетевого интерфейса и попытаются использовать каждый сетевой адаптер в самой быстрой конфигурации. Все сетевые карты, Объединенные в группу, сетевые карты с поддержкой RSS и сетевые карты с возможностью RDMA, можно использовать. В таблице ниже обобщены компромиссы при использовании этих технологий. Максимальная пропускная способность достигается при использовании нескольких сетевых интерфейсов с поддержкой RDMA. Дополнительные сведения см. [в разделе основы SMB мутличаннел](/archive/blogs/josebda/the-basics-of-smb-multichannel-a-feature-of-windows-server-2012-and-smb-3-0).

![Иллюстрация пропускной способности и отказоустойчивости для различных конфигураций сетевых адаптеров ](media/Simplified-SMB-Multichannel-and-Multi-NIC-Cluster-Networks/Clustering_MulitNIC_Fig5.png)
 **рис. 5. пропускная способность и отказоустойчивость для различных сетевых адаптеров конифигуратионс**

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы
**Используются ли все сетевые карты в сети с несколькими сетевыми адаптерами, используемой для сердца-бьющееся в кластере?**
Да.

**Можно ли использовать сеть с несколькими сетевыми картами только для обмена данными в кластере? Можно ли использовать его только для обмена данными между клиентом и кластером?**
Любая из этих конфигураций будет работать. все роли сети кластера будут работать в сети с несколькими сетевыми КАРТАми.

**Также используется ли многоканальный SMB для трафика CSV и кластера?**
Да, по умолчанию все кластеры и трафик CSV будут использовать доступные многосетевые сети. Для изменения роли сети администраторы могут использовать командлеты PowerShell для отказоустойчивой кластеризации или пользовательский интерфейс диспетчер отказоустойчивости кластеров.

**Как можно увидеть параметры многоканального SMB?**
Используйте командлет **Get-смбсерверконфигуратион** , найдите значение свойства енаблемултичаннел.

**Учитывается ли общее свойство кластера Плумбаллкросссубнетраутес в сети с несколькими сетевыми картами?**
Да.

## <a name="additional-references"></a>Дополнительные ссылки
- [Новые возможности отказоустойчивой кластеризации в Windows Server 2016](whats-new-in-failover-clustering.md)