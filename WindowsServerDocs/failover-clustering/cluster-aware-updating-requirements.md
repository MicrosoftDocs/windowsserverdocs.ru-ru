---
ms.assetid: 75cc1d24-fa2f-45bd-8f3b-1bbd4a1aead0
title: Требования кластерного обновления и рекомендации
ms.prod: windows-server-threshold
ms.topic: article
ms.manager: dongill
author: JasonGerend
ms.author: jgerend
ms.technology: storage-failover-clustering
ms.date: 08/06/2018
description: Требования для использования кластерного обновления для установки обновлений на кластерах под управлением Windows Server.
ms.openlocfilehash: 379c3caa39b09e8a912150f2423190e143991c05
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59819735"
---
# <a name="cluster-aware-updating-requirements-and-best-practices"></a>Требования кластерного обновления и рекомендации

>Относится к: Windows Server (полугодовой канал), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе описываются требования и зависимости, которые необходимы для использования [кластерное обновление](cluster-aware-updating.md) (CAU), чтобы применить обновления к отказоустойчивый кластер под управлением Windows Server.
  
> [!NOTE]  
> Может потребоваться самостоятельно проверить готовность к применению обновлений, если вы используете разъем кластерной среды\-в отличные от **Microsoft.WindowsUpdatePlugin**. Если вы используете не\-Microsoft plug\-, обратитесь к издателю, Дополнительные сведения. Дополнительные сведения о подключаемых\-модули, см. в разделе [как подключить\-ins работать](cluster-aware-updating-plug-ins.md).   
  
## <a name="BKMK_REQ_CLUS"></a>Установите средство отказоустойчивости кластеров и средств отказоустойчивости кластеров  
Для использования CAU необходимо установить компонент отказоустойчивости кластеров и средства отказоустойчивости кластеров. Средства отказоустойчивости кластеров включают в себя средства CAU \(clusterawareupdating.dll\), командлеты отказоустойчивой кластеризации и другие компоненты, необходимые для операций CAU. Инструкции по установке компонента отказоустойчивости кластеров см. в записи блога [Установка компонента отказоустойчивости кластеров и средств отказоустойчивости кластеров](create-failover-cluster.md#install-the-failover-clustering-feature).  
  
Требования установки для средства отказоустойчивости кластеров зависят от того, координирует ли компонент CAU обновления как кластерная роль в отказоустойчивом кластере \(с помощью self\-режима обновления\) или с удаленного компьютера. Self\-Кроме того обновления режима кластерного обновления требуется установить кластерная роль CAU в отказоустойчивом кластере с помощью средств CAU.    
  
В таблице ниже кратко описываются требования для установки компонента CAU в двух режимах обновления CAU.  
  
|Установленный компонент|SELF\-режима обновления|Удаленный\-режима обновления|  
|-----------------------|-----------------------|-------------------------|  
|Средство отказоустойчивости кластеров|Требуется во всех узлах кластера|Требуется во всех узлах кластера|  
|Средства отказоустойчивости кластеров|Требуется во всех узлах кластера|-Required на удаленном сервере\-обновления компьютера<br />-Требуются на всех узлах кластера для запуска [Save-CauDebugTrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps) командлета|  
|Кластерная роль CAU|Обязательно|Не требуется|  
  
## <a name="obtain-an-administrator-account"></a>Получение учетной записи администратора  
Для использования компонентов CAU требуются указанные ниже разрешения администратора.  
  
-   Для предварительного просмотра и применения обновлений с помощью пользовательского интерфейса CAU \(пользовательского интерфейса\) или командлетов кластерного обновления, необходимо использовать учетную запись домена с правами и разрешениями локального администратора на всех узлах кластера. Если учетная запись не имеет достаточных прав на каждом узле, предлагается в окне кластерного обновления для предоставления необходимых учетных данных при выполнении этих действий. Чтобы использовать [кластерное обновление](https://docs.microsoft.com/powershell/module/clusterawareupdating/?view=win10-ps) командлетов, можно указать необходимые учетные данные в качестве параметра командлета.  
  
-   Если вы используете CAU в удаленных\-режима обновления в том случае, когда вы выполняете вход с использованием учетной записи, которая не имеет права и разрешения локального администратора на узлах кластера, необходимо запустить средства CAU от имени администратора с помощью учетной записи локального администратора на Обновите компьютер координатора, или с помощью учетной записи с **олицетворение клиента после проверки подлинности** право пользователя. 
  
-   Чтобы запустить анализатор соответствия рекомендациям для кластерного обновления, необходимо использовать учетную запись с правами администратора в узлах кластера и правами локального администратора на компьютере, который используется для запуска [Test-CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) командлета или для анализа с помощью кластерного обновления окна готовности к обновлению кластера. Подробнее см. в подразделе [Проверка готовности к обновлению кластера](#BKMK_BPA).  
  
## <a name="verify-the-cluster-configuration"></a>Проверка конфигурации кластера  
Ниже приведены общие требования, которые должны выполняться, чтобы отказоустойчивый кластер поддерживал обновление с помощью CAU. Дополнительные требования к конфигурации для удаленного управления на узлах приведены в подразделе [Настройка узлов для удаленного управления](#BKMK_NODE_CONFIG) далее в этом разделе.  
  
-   Должно быть доступно достаточное число узлов кластера, чтобы в кластере был кворум.  
  
-   Все узлы кластера должны быть в одном домене Active Directory.  
  
-   Имя кластера должно разрешаться в сети с помощью DNS.  
  
-   Если кластерное обновление используется в удаленных\-режима обновления, компьютер координатора обновлений должен иметь сетевое подключение к узлам кластера отработки отказа, и он должен быть в том же домене Active Directory, что и отказоустойчивый кластер.  
  
-   Служба кластеров должна быть запущена во всех узлах кластера. По умолчанию эта служба устанавливается во всех узлах кластера, и для нее настраивается автоматический запуск.  
  
-   Для использования PowerShell pre\-обновить или опубликовать\-обновления, во время прогона обновления CAU, убедитесь, что они установлены на всех узлах кластера, или что они доступны для всех узлов, например, в общей папке высокой доступности сети. Если сценарии сохранены в сетевой папке, настройте для нее разрешение на чтение для группы "Все".  
  
## <a name="BKMK_NODE_CONFIG"></a>Настройка узлов для удаленного управления  
Чтобы использовать кластерное обновление, все узлы кластера должны быть настроены для удаленного управления. По умолчанию, единственной задачей необходимо выполнить для настройки узлов для удаленного управления, — [Включение правила брандмауэра для обеспечения автоматического перезапуска](#BKMK_FW). 

Ниже перечислены требования завершения удаленного управления, в случае, если среде отличается от значения по умолчанию.

Эти требования дополняют требования для [установки компонента отказоустойчивости кластеров и средств отказоустойчивости кластеров](#BKMK_REQ_CLUS), а также общие требования для использования кластеризации, которые описаны в предыдущих подразделах этого раздела.  
  
|Требование|Состояние по умолчанию|SELF\-режима обновления|Удаленный\-режима обновления|  
|---------------|---|-----------------------|-------------------------|  
|[Включение правила брандмауэра для обеспечения автоматического перезапуска](#BKMK_FW)|Отключено|Требуется во всех узлах кластера, если используется брандмауэр|Требуется во всех узлах кластера, если используется брандмауэр|  
|[Включение инструментария управления Windows](#BKMK_WMI)|Enabled|Требуется во всех узлах кластера|Требуется во всех узлах кластера|  
|[Включить Windows PowerShell 3.0 или 4.0 и удаленного взаимодействия Windows PowerShell](#BKMK_PS)|Enabled|Требуется во всех узлах кластера|Требуется во всех узлах кластера для выполнения следующих компонентов:<br /><br />- [Save-CauDebugTrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps) командлета<br />-PowerShell pre\-обновить и провести\-обновления, во время выполнения обновления<br />-Тесты с помощью кластерного обновления окна готовности к обновлению кластера или [теста\-CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) командлета Windows PowerShell|  
|[Установите .NET Framework 4.6 и 4.5](#BKMK_NET)|Enabled|Требуется во всех узлах кластера|Требуется во всех узлах кластера для выполнения следующих компонентов:<br /><br />- [Save-CauDebugTrace](https://docs.microsoft.com/powershell/module/clusterawareupdating/Save-CauDebugTrace?view=win10-ps) командлета<br />-PowerShell pre\-обновить и провести\-обновления, во время выполнения обновления<br />-Тесты с помощью кластерного обновления окна готовности к обновлению кластера или [теста\-CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup?view=win10-ps) командлета Windows PowerShell|  

### <a name="BKMK_FW"></a>Включение правила брандмауэра для обеспечения автоматического перезапуска  
Для обеспечения автоматического перезапуска после применения обновлений \(Если требуется для установки обновления\), если брандмауэр Windows или не\-брандмауэра Майкрософт уже используется на узлах кластера, должно быть включено правило брандмауэра Каждый узел, разрешающее следующий трафик:  
  
-   Protocol: TCP  
  
-   Направление: входящий  
  
-   Программа: wininit.exe  
  
-   Порты: динамические порты RPC  
  
-   Профиль: Домен  
  
Если в узлах кластера используется брандмауэр Windows, сделать это можно путем включения группы правил брандмауэра Windows **Удаленное завершение работы** в каждом узле кластера. При использовании окна кластерного обновления для применения обновлений и настроить self\-обновление параметров, **удаленное завершение работы** группу правил брандмауэра Windows включается автоматически на каждом узле кластера.  
  
> [!NOTE]  
> Группу правил брандмауэра Windows **Remote Shutdown** нельзя включить, если она вступит в конфликт с параметрами групповой политики, настроенными для брандмауэра Windows.    
  
**Удаленное завершение работы** группу правил брандмауэра также можно включить путем указания **– EnableFirewallRules** при выполнении следующих командлетов CAU: [-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole?view=win10-ps), [Invoke-CauRun](https://docs.microsoft.com/powershell/module/clusterawareupdating/Invoke-CauRun?view=win10-ps), и [SetCauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Set-CauClusterRole?view=win10-ps).  
  
В следующем примере PowerShell показано дополнительный метод для обеспечения автоматического перезапуска в узле кластера.  
  
```PowerShell  
Set-NetFirewallRule -Group "@firewallapi.dll,-36751" -Profile Domain -Enabled true  
```  

### <a name="BKMK_WMI"></a>Включение инструментария управления Windows (WMI) 
Все узлы кластера должны быть настроены таким образом, удаленное управление с помощью инструментария управления Windows \(WMI\). Она включена по умолчанию.  
  
Чтобы включить удаленное управление вручную, выполните указанные ниже действия.  
  
1.  В консоли "Службы" запустите службу **Удаленное управление Windows** и задайте для нее тип запуска **Автоматически**.  
  
2.  Запустите [Set-WSManQuickConfig](https://docs.microsoft.com/powershell/module/Microsoft.WsMan.Management/Set-WSManQuickConfig?view=powershell-6) командлета или выполните следующую команду из командной строки с повышенными строки:  
  
    ```PowerShell  
    winrm quickconfig -q  
    ```  
  
Для поддержки удаленного взаимодействия WMI, если в узлах кластера используется брандмауэр Windows, правило брандмауэра **удаленное управление Windows \(HTTP\-в\)**  должна быть включена на каждом узле.  По умолчанию это правило включено.  
  
### <a name="BKMK_PS"></a>Включить Windows PowerShell и удаленное взаимодействие Windows PowerShell  
Чтобы включить self\-обновление режима и некоторых функций CAU в удаленных\-режима обновления, PowerShell необходимо установить и включить выполнение удаленных команд на всех узлах кластера. По умолчанию установлен и включен для удаленного взаимодействия PowerShell.  
  
Чтобы включить удаленное взаимодействие PowerShell, используйте один из следующих методов:  
  
-   Запустите [Enable-PSRemoting](https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Core/Enable-PSRemoting) командлета.  
  
-   Настройка домена\-параметр групповой политики для удаленного управления Windows на уровне \(WinRM\).  
  
Дополнительные сведения о включении удаленного взаимодействия PowerShell см. в разделе [об удаленном требования](https://docs.microsoft.com/powershell/module/microsoft.powershell.core/about/about_remote_requirements?view=powershell-6).  
  
### <a name="BKMK_NET"></a>Установите .NET Framework 4.6 и 4.5  
Чтобы включить self\-обновление режима и некоторых функций CAU в удаленных\-обновления режима, .NET Framework 4.6 или .NET Framework 4.5 (на Windows Server 2012 R2) должен быть установлен на всех узлах кластера. По умолчанию устанавливается .NET Framework.  

Чтобы установить .NET Framework 4.6 (или 4.5), с помощью PowerShell, если он еще не установлен, используйте следующую команду:

```PowerShell
Install-WindowsFeature -Name NET-Framework-45-Core
```

## <a name="BKMK_BEST_PRAC"></a>Практические рекомендации по использованию кластерного обновления 
  
### <a name="BKMK_BP_WUA"></a>Рекомендации по применению обновлений Майкрософт

Рекомендуется, чтобы при запуске для использования CAU для применения обновлений со значением по умолчанию **Microsoft.WindowsUpdatePlugin** подключите\-в кластере, прекращения использования других методов установки обновлений программного обеспечения от корпорации Майкрософт в кластере узлы.  
  
> [!CAUTION]  
> Использование CAU в сочетании с методами, автоматическое обновление отдельных узлов \(по расписанию в заданное время\) может привести к непредсказуемым результатам, вплоть до прерывания обслуживания и незапланированных простоев.  
  
Рекомендуется придерживаться следующего плана действий.  
  
-   Для получения оптимальных результатов рекомендуется отключить параметры автоматического обновления в узлах кластера, например параметры автоматического обновления на панели управления или параметры, настроенные с помощью групповой политики.  
  
    > [!CAUTION]  
    > Автоматическая установка обновлений в узлах кластера может помешать установке обновлений с помощью CAU и привести к сбоям CAU.  
  
    При необходимости можно использовать следующие параметры автоматического обновления, которые совместимы с CAU, так как администратор может управлять временем установки обновлений:  
  
    -   параметры, в соответствии с которыми перед загрузкой и установкой обновлений выводятся уведомления;  
  
    -   параметры, в соответствии с которыми обновления загружаются автоматически, но перед их установкой выводятся уведомления.  
  
    Однако, если служба автоматического обновления загружает обновления одновременно с прогоном обновления CAU, на выполнение прогона может потребоваться больше времени.  
  
-   Не настраивайте систему обновления, такие как Windows Server Update Services \(WSUS\) для автоматического применения обновлений \(по расписанию в заданное время\) для узлов кластера.  
  
-   Во всех узлах кластера должно быть настроено использование одного и того же источника обновлений, например сервера служб WSUS, Центра обновления Windows или Центра обновления Майкрософт.  
  
-   При использовании системы управления конфигурацией для обновления программного обеспечения на компьютерах в сети отмените все обязательные и автоматические обновления для узлов кластера. Примеры систем управления конфигурацией включают Microsoft System Center Configuration Manager 2007 и Microsoft System Center Virtual Machine Manager 2008.  
  
-   Если серверы распространения программного обеспечения для внутреннего \(например, серверы WSUS\) используются для содержат и развертывать обновления, убедитесь, что эти серверы правильно определяют утвержденные обновления для узлов кластера.  
  
#### <a name="BKMK_PROXY"></a>Применение обновлений Майкрософт в филиалах основного офиса  
Для загрузки обновлений Майкрософт из Центра обновления Майкрософт или Центра обновления Windows на узлы кластера в филиале в некоторых случаях может потребоваться настроить параметры прокси-сервера для учетной записи Local System в каждом узле. Например, это может быть необходимо сделать в случае, если кластеры в филиалах получают доступ к Центру обновления Майкрософт или Центру обновления Windows для загрузки обновлений через локальный прокси-сервер.  
  
При необходимости настройте параметры прокси-сервера WinHTTP на каждом узле, чтобы указать локальный прокси-сервер и исключения локальных адресов \(то есть список исключений для локальных адресов\). Для этого можно выполнить следующую команду в каждом узле кластера из командной строки с повышенными привилегиями.  
  
```  
netsh winhttp set proxy <ProxyServerFQDN >:<port> "<local>"  
```  
  
где <*ProxyServerFQDN*> — полное доменное имя прокси-сервера и <*порт*> — порт, для которого требуется обмениваться данными (обычно это порт 443).  
  
Например, чтобы настроить параметры прокси-сервера WinHTTP для учетной записи Local System, указав прокси-сервера *MyProxy.CONTOSO.com*с порта 443 и исключения локальных адресов, введите следующую команду:  
  
```  
netsh winhttp set proxy MyProxy.CONTOSO.com:443 "<local>"  
```  
  
### <a name="BKMK_BP_HF"></a>Рекомендации по использованию подключаемого модуля Microsoft.HotfixPlugin  
  
-   Мы рекомендуем настроить разрешения для корневой папки исправлений и файла конфигурации исправлений, предоставив доступ для записи только локальным администраторам компьютеров, на которых хранятся эти файлы. Это поможет предотвратить несанкционированный доступ к этим файлам, который может нарушить функционирование отказоустойчивого кластера при применении исправлений.  
  
-   Чтобы обеспечить целостность данных в блоке сообщений сервера \(SMB\) подключения, используемые для доступа к корневой папке исправлений, необходимо настроить шифрование SMB в общей папке SMB, если это возможно, для ее настройки. Подключаемый модуль **Microsoft.HotfixPlugin** требует настройки подписания SMB или шифрования SMB для обеспечения целостности данных, передаваемых через подключения SMB. 
  
    Дополнительные сведения см. в разделе [ограничение доступа к корневой папке исправлений и файлу конфигурации исправлений](cluster-aware-updating-plug-ins.md#BKMK_ACL).
  
### <a name="additional-recommendations"></a>Дополнительные рекомендации  
  
-   Чтобы не помешать выполнению пробега обновления CAU, который может быть запланирован на то же время, не планируйте изменение паролей для объектов имен кластеров и виртуальных объектов-компьютеров на периоды запланированного обслуживания.  
  
-   Следует задать соответствующие разрешения для pre\-обновить и провести\-сценарии обновления, сохраняются в сети общих папок, чтобы предотвратить возможный с этими файлами, неавторизованные пользователи.  
  
-   Чтобы настроить CAU в самостоятельно\-режима виртуальный объект-компьютер обновления \(VCO\) для CAU кластерной роли должны быть созданы в Active Directory. Компонент CAU может создать этот объект автоматически при добавлении кластерной роли CAU, если у отказоустойчивого кластера достаточно разрешений. Однако из-за политик безопасности в некоторых организациях может быть необходимо предварительно подготовить этот объект в Active Directory. Описание этой процедуры см. в разделе [Действия по предварительной настройке учетной записи для кластерной роли](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731002\(v=ws.10\)#steps-for-prestaging-the-cluster-name-account).  
  
-   Чтобы сохранить параметры прогона обновления, а затем использовать их повторно применительно к отказоустойчивым кластерам с аналогичными потребностями в обновлении, можно создать профили прогона обновления. Кроме того, в зависимости от режима обновления можно сохранить профили прогона обновления и управлять ими в общей папке, доступной всем удаленным компьютерам координатора обновлений или отказоустойчивым кластерам. Дополнительные сведения см. в разделе [Дополнительные параметры и профили прогона обновления для CAU](cluster-aware-updating-options.md).  
  
## <a name="BKMK_BPA"></a>Проверка готовности к обновлению кластера  
Можно запустить анализатор соответствия рекомендациям для CAU \(BPA\) модели для проверки отказоустойчивого кластера и сетевое окружение выполнить многие из требований для применения обновлений по CAU. Многие из тестов проверяют среду на готовность к применению обновлений Майкрософт с помощью подключаемого модуля по умолчанию\-в **Microsoft.WindowsUpdatePlugin**.  
  
> [!NOTE]  
> Может потребоваться самостоятельно проверить готовность к применению обновлений программного обеспечения с помощью подключаемого модуля кластерной среды\-в отличные от **Microsoft.WindowsUpdatePlugin**. Если вы используете не\-Microsoft plug\-, такую как изготовителя оборудования, обратитесь к издателю Дополнительные сведения.  
  
Анализатор соответствия рекомендациям можно запустить двумя способами.  
  
1.  В консоли CAU выберите **Проанализировать готовность кластера к обновлению** . После анализатора соответствия Рекомендациям выполнит тесты готовности, отображается отчет о тестировании. В нем можно просмотреть информацию о выявленных неполадках и соответствующих узлах, чтобы принять меры по устранению этих неполадок. Выполнение тестов может занять несколько минут.  
  
2.  Запустите [Test-CauSetup](https://docs.microsoft.com/powershell/module/clusterawareupdating/Test-CauSetup) командлета. Командлет можно запустить на локальном или удаленном компьютере, на котором установлен отработки отказа кластеризации модуля для Windows PowerShell (часть средств отказоустойчивой кластеризации). Его также можно выполнить в узле отказоустойчивого кластера.  
  
> [!NOTE]  
> -   Необходимо использовать учетную запись с правами администратора в узлах кластера и правами локального администратора на компьютере, который используется для запуска **теста\-CauSetup** командлета или анализа готовности к обновлению кластера в окне кластерного обновления. Для выполнения тестов с помощью окна кластерного обновления, необходимо войти в компьютер с необходимыми учетными данными.  
> -   При проведении тестов предполагается, что средства CAU, используемые для просмотра и применения обновлений ПО, запускаются с того же компьютера и с теми же учетными данными, которые используются для проверки готовности к обновлению кластера.  
  
> [!IMPORTANT]  
> Настоятельно рекомендуем проверить кластер на готовность к обновлению в следующих ситуациях:  
>   
> -   перед первым использованием кластерного обновления для применения обновлений ПО;  
> -   после добавления узла в кластер или внесения других изменений в оборудование кластера, требующих запуска мастера проверки кластера;  
> -   После изменения источника обновлений, или изменения параметров или конфигураций обновления \(Кроме CAU\) , которые могут повлиять на применение обновлений на узлах.  
  
### <a name="tests-for-cluster-updating-readiness"></a>Тесты готовности к обновлению кластера  
В таблице ниже перечислены тесты готовности к обновлению кластера, некоторые распространенные проблемы и действия по их устранению.  
  
|Тестирование|Возможные проблемы и их последствия|Действия по разрешению|  
|--------|-------------------------------|--------------------|  
|Должен быть доступен отказоустойчивый кластер|Не удается разрешить имя отказоустойчивого кластера, либо невозможно получить доступ к одному или нескольким узлам кластера. Анализатор соответствия рекомендациям не может выполнить тесты готовности кластера.|— Проверьте правильность написания имени кластера, указанное во время запуска анализатора соответствия Рекомендациям.<br />— Убедитесь, что все узлы кластера подключены к сети и выполнения.<br />— Проверьте, что проверки мастера настройки можно успешно запустить в отказоустойчивом кластере.|  
|На узлах отказоустойчивого кластера должно быть включено удаленное управление через WMI|Один или несколько узлов отказоустойчивого кластера не включены для удаленного управления с помощью инструментария управления Windows \(WMI\). Компонент CAU не может обновить узлы кластера, если для них не настроено удаленное управление.|Убедитесь в том, что для узлов отказоустойчивого кластера включено удаленное управление через WMI. Подробнее см. в подразделе [Настройка узлов для удаленного управления](#BKMK_NODE_CONFIG) этого раздела.|  
|Удаленное взаимодействие PowerShell должен быть включен на каждом узле отказоустойчивого кластера|PowerShell не установлена или не включена для удаленного взаимодействия на один или несколько узлов отказоустойчивого кластера. CAU нельзя настроить для самообслуживания\-режима обновления или использования определенных функций в удаленных\-режима обновления.|Убедитесь, что PowerShell установлена на всех узлах кластера и настроена для удаленного взаимодействия.<br /><br />Подробнее см. в подразделе [Настройка узлов для удаленного управления](#BKMK_NODE_CONFIG) этого раздела.|  
|Версия отказоустойчивого кластера|Один или несколько узлов в отказоустойчивом кластере не выполняются, Windows Server 2016, Windows Server 2012 R2 или Windows Server 2012. Компонент CAU не может обновить отказоустойчивый кластер.|Убедитесь в работоспособности отказоустойчивого кластера, указанный при запуске анализатора соответствия Рекомендациям Windows Server 2016, Windows Server 2012 R2 или Windows Server 2012.<br /><br />Дополнительные сведения см. в разделе [Проверка конфигурации кластера](#BKMK_REQ_CLUS) этой статьи.|  
|На всех узлах отказоустойчивого кластера должны быть установлены требуемые версии .NET Framework и Windows PowerShell|.NET framework 4.6, 4.5 или Windows PowerShell не установлена на одном или нескольких узлах кластера. Некоторые функции CAU могут не работать.|Убедитесь, что .NET Framework 4.6 и 4.5 и Windows PowerShell установлены на всех узлах кластера, если они требуются.<br /><br />Подробнее см. в подразделе [Настройка узлов для удаленного управления](#BKMK_NODE_CONFIG) этого раздела.|  
|Служба кластеров должна работать на всех узлах кластера|Служба кластеров не работает на одном или нескольких узлах. Компонент CAU не может обновить отказоустойчивый кластер.|— Убедитесь, что служба кластеров \(clussvc\) запускается на всех узлах в кластере, и она настроена на автоматический запуск.<br />— Проверьте, что проверки мастера настройки можно успешно запустить в отказоустойчивом кластере.<br /><br />Дополнительные сведения см. в разделе [Проверка конфигурации кластера](#BKMK_REQ_CLUS) этой статьи.|  
|Службу автоматического обновления не следует настраивать для автоматической установки обновлений на узлы отказоустойчивого кластера|По крайней мере на одном узле отказоустойчивого кластера служба автоматического обновления настроена на автоматическую установку обновлений Майкрософт. Использование CAU в сочетании с другими способами обновления может привести к незапланированным простоям или непредвиденным результатам.|Если на одном или нескольких кластерах настроено автоматическое обновление с помощью Центра обновления Windows, убедитесь в том, что служба автоматического обновления не настроена на автоматическую установку обновлений.<br /><br />Дополнительные сведения см. в разделе [Рекомендации по применению обновлений Майкрософт](#BKMK_BP_WUA).|  
|Узлы отказоустойчивого кластера должны использовать один и тот же источник обновления|Для одного или нескольких узлов отказоустойчивого кластера настроено использование источника обновлений Майкрософт, отличного то указанного для остальных узлов. Компонент CAU не может обеспечить единообразное применение обновлений к узлам кластера.|Убедитесь в том, что для всех узлов кластера настроено использование одного и того же источника обновлений, например сервера служб WSUS, Центра обновления Windows или Центра обновления Майкрософт.<br /><br />Дополнительные сведения см. в разделе [Рекомендации по применению обновлений Майкрософт](#BKMK_BP_WUA).|  
|На каждом узле отказоустойчивого кластера должно быть включено правило брандмауэра, разрешающее удаленное выключение|На одном или нескольких узлах отказоустойчивого кластера не включено правило брандмауэра, разрешающее удаленное выключение, либо включение этого правила запрещено параметром групповой политики. Прогоны обновления, требующие автоматической перезагрузки узлов, могут быть применены неверно.|Если брандмауэр Windows или не\-брандмауэра Майкрософт уже используется на узлах кластера, настройте правило брандмауэра, разрешающее удаленное выключение.<br /><br />Подробнее см. в подразделе [Включение правила брандмауэра для обеспечения автоматического перезапуска](#BKMK_FW) этого раздела.|  
|В качестве прокси-сервера на каждом узле отказоустойчивого кластера должен быть задан локальный прокси-сервер|На одном или нескольких узлах отказоустойчивого кластера неправильно настроен прокси-сервер.<br /><br />Если используется локальный прокси-сервер, параметр прокси-сервера на каждом узле должен быть настроен правильно, чтобы кластер мог получать доступ к Центру обновления Майкрософт или Центру обновления Windows.|Убедитесь в том, что в качестве прокси-сервера WinHTTP на каждом узле кластера задан локальный прокси-сервер, если он необходим. Если в вашей среде прокси-сервер не используется, это предупреждение можно игнорировать.<br /><br />Подробнее см. в подразделе [Применение обновлений Майкрософт в филиалах](#BKMK_PROXY) этого раздела.|  
|Кластерная роль CAU должен устанавливаться на отказоустойчивом кластере, чтобы включить self\-режима обновления|Кластерная роль CAU не установлена на этом отказоустойчивом кластере. Эта роль необходима для кластера self\-обновление.|Чтобы использовать CAU в self\-режима обновления добавьте кластерную роль CAU в отказоустойчивом кластере одним из следующих способов:<br /><br />— Запустите [Add-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Add-CauClusterRole) командлета PowerShell.<br />-Выберите **настройка кластера self\-обновление параметров** действия в окне кластерного обновления.|  
|Кластерная роль CAU должна быть включена в отказоустойчивом кластере, чтобы включить self\-режима обновления|Кластерная роль CAU отключена. Например, кластерная роль CAU не установлена или отключена с помощью [отключить\-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Disable-CauClusterRole) командлета PowerShell. Эта роль необходима для кластера self\-обновление.|Чтобы использовать CAU в self\-режима обновления включить кластерную роль CAU в отказоустойчивом кластере одним из следующих способов:<br /><br />— Запустите [Enable-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Enable-CauClusterRole) командлета PowerShell.<br />-Выберите **настройка кластера self\-обновление параметров** действия в окне кластерного обновления.|  
|Настроенные подключаемые кластерное обновление\-в для самообслуживания\-режима обновления должен быть зарегистрирован на всех узлах отказоустойчивого кластера|Кластерная роль CAU на одном или нескольких узлах этого отказоустойчивого кластера не может получить доступ к вилка CAU\-в модуле, который настроен в self\-параметров обновления. Самостоятельный\-обновление запуска может завершиться ошибкой.|— Убедитесь, что настроенный вилка CAU\-в устанавливается на всех узлах кластера, выполнив процедуру установки для продукта, который содержит вилка CAU\-в.<br />— Запустите [зарегистрировать\-CauPlugin](https://docs.microsoft.com/powershell/module/clusterawareupdating/Register-CauPlugin) командлет PowerShell, чтобы зарегистрировать вилка\-в на требуемых узлах кластера.|  
|Все узлы отказоустойчивого кластера должны иметь тот же набор зарегистрированных подключаемых CAU\-модулей|Самостоятельный\-обновление запуска может завершиться ошибкой, если вилка\-тем, что настроен для использования в процессе прогона, изменяется на такой, который не поддерживается на всех узлах кластера.|— Убедитесь, что настроенный вилка CAU\-в устанавливается на всех узлах кластера, выполнив процедуру установки для продукта, который содержит вилка CAU\-в.<br />— Запустите [зарегистрировать\-CauPlugin](https://docs.microsoft.com/powershell/module/clusterawareupdating/Register-CauPlugin) командлет PowerShell, чтобы зарегистрировать вилка\-в на требуемых узлах кластера.|  
|Должны быть настроены допустимые параметры прогона обновления|Self\-обновление расписания и прогона параметры, настроенные для этого отказоустойчивого кластера, являются неполными или являются недопустимыми. Самостоятельный\-обновление запуска может завершиться ошибкой.|Настройка самозаверяющего допустимым\-обновление расписания и набор параметров прогона обновления. Например, можно использовать [задать\-CauClusterRole](https://docs.microsoft.com/powershell/module/clusterawareupdating/Set-CauClusterRole) командлет PowerShell, чтобы настроить CAU кластерной роли.|  
|По крайней мере два узла отказоустойчивого кластера должны быть владельцами кластерной роли CAU|Выполнение обновления запускается в самостоятельно\-режима обновления завершится ошибкой, поскольку кластерная роль CAU не имеет узел возможного владельца для перемещения.|С помощью средств отказоустойчивости кластеров настройте все узлы кластера в качестве потенциальных владельцев кластерной роли CAU. Это конфигурация по умолчанию.||  
|Все узлы отказоустойчивого кластера должны иметь доступ к сценариям Windows PowerShell|Не все возможные узлы-владельцы кластерной роли CAU можно получить доступ к настроенной подготовительной версии Windows PowerShell\-обновить и провести\-обновления сценариев. Самостоятельный\-обновление выполнить не удастся.|Убедитесь, что все возможные узлы-владельцы кластерной роли CAU имеют разрешения на доступ к настроенной pre PowerShell\-обновить и провести\-обновления сценариев.|  
|На всех узлах отказоустойчивого кластера должны использоваться идентичные сценарии Windows PowerShell|Не все возможные узлы-владельцы кластерной роли CAU использовать ту же копию указанного подготовительной версии Windows PowerShell\-обновить и провести\-обновления сценариев. Самостоятельный\-обновление запуска может завершиться ошибкой или непредвиденное поведение.|Убедитесь, что все возможные узлы-владельцы кластерной роли CAU используют же pre PowerShell\-обновить и провести\-обновления сценариев.|  
|Значение параметра WarnAfter, заданное для прогона обновления, должно быть меньше значения параметра StopAfter|Указанные значения времени ожидания прогона обновления CAU делают время ожидания предупреждения недействительным. Прогон обновления может быть отменен до регистрации предупреждения в журнале событий.|В параметрах прогона обновления задайте значение параметра **WarnAfter** так, чтобы оно было меньше значения параметра **StopAfter** .|  
  
## <a name="see-also"></a>См. также  
  
-   [Общие сведения о кластерном обновлении](cluster-aware-updating.md)