---
title: Следует ли создавать виртуальные машины поколения 1 или 2 в Hyper-V?
description: Предоставляет рекомендации, в частности поддерживаемые методы загрузки и другие отличия, которые помогут вам выбрать поколение соответствует вашим потребностям.
ms.prod: windows-server-threshold
ms.service: na
manager: dongill
ms.technology: compute-hyper-v
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 02e31413-6140-4723-a8d6-46c7f667792d
author: KBDAzure
ms.author: kathydav
ms.date: 12/05/2016
ms.openlocfilehash: e3c88ef5ee700bb3906746402bf6cc8916976800
ms.sourcegitcommit: 0b5fd4dc4148b92480db04e4dc22e139dcff8582
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/24/2019
ms.locfileid: "66192766"
---
# <a name="should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v"></a>Следует ли создавать виртуальные машины поколения 1 или 2 в Hyper-V?

>Область применения. Windows 10, Windows Server 2016, Microsoft Hyper-V Server 2016, Windows Server 2019 г., Microsoft Hyper-V Server 2019 г.

> [!NOTE]
> Если планируется когда-либо отправить Windows виртуальные машины (VM) на платформу Microsoft Azure, поколение 1 и виртуальные машины поколения 2 в формате виртуального жесткого диска и имеют фиксированный размер диска, поддерживаются. См. в разделе [виртуальных машин поколения 2 в Azure](https://docs.microsoft.com/azure/virtual-machines/windows/generation-2) Дополнительные сведения о возможностях поколения 2, поддерживаемых в Azure. Дополнительные сведения о загрузке Windows VHD или VHDX, см. в разделе [Подготовка к отправке в Azure виртуального жесткого диска Windows или VHDX](https://docs.microsoft.com/azure/virtual-machines/windows/prepare-for-upload-vhd-image).

Выбор для создания версии 1 или поколения 2 виртуальной машины зависит от гостевой операционной системы требуется установка и метод загрузки, которые вы хотите использовать для развертывания виртуальной машины. Мы рекомендуем создать виртуальной машины поколения 2, чтобы воспользоваться преимуществами функции, такие как безопасная загрузка, если одно из следующих утверждений верно:  

- Для загрузки с виртуального жесткого диска не [совместимые с UEFI](https://technet.microsoft.com/library/hh824898.aspx).  
- Поколение 2 не поддерживает операционную систему, которую вы хотите запустить на виртуальной машине.  
- Поколение 2 не поддерживает метод загрузки, которую вы хотите использовать.  

Дополнительные сведения о функциях, доступных с виртуальными машинами поколения 2, см. в разделе [совместимость возможностей Hyper-V в зависимости от поколения и гостя](../Hyper-V-feature-compatibility-by-generation-and-guest.md).

Создание виртуальной машины после ее создания изменить нельзя. Таким образом мы рекомендуем, что вы изучите вопросы здесь, а также выбрать операционную систему, метод загрузки и функции, которые вы хотите использовать, прежде чем выбрать поколение.  

## <a name="BKMK_OS"></a>Какие гостевые операционные системы поддерживаются?

Виртуальные машины поколения 1 поддерживают большинство гостевых операционных систем. Виртуальные машины поколения 2 поддерживают наиболее 64-разрядных версиях Windows, а также более текущие версии операционных систем Linux и FreeBSD. Поколение виртуальной машины, поддерживает гостевой операционной системы, который вы хотите установить, следуйте приведенным ниже.  

- [Поддержка гостевых операционных систем Windows](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_Windows)  

- [CentOS и Red Hat Enterprise Linux поддержка гостевых операционных систем](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_CentOS)  

- [Поддержка Debian гостевых операционных систем](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_Debian)  

- [Поддержка гостевых операционных систем FreeBSD](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_FreeBSD)  

- [Поддержка гостевых операционных систем Oracle Linux](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_Oracle)  

- [Поддержка гостевых операционных систем SUSE](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_SUSE)  

- [Поддержка гостевых операционных систем Ubuntu](Should-I-create-a-generation-1-or-2-virtual-machine-in-Hyper-V.md#BKMK_Ubuntu)  

### <a name="BKMK_Windows"></a>Поддержка гостевых операционных систем Windows

В следующей таблице показаны 64-разрядных версиях Windows можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.  

|64-разрядных версиях Windows|Поколение 1|Поколение 2|  
|-------------------------------|----------------|----------------|  
| Windows Server 2019 |&#10004;|&#10004;|  
| Windows Server 2016 |&#10004;|&#10004;|  
| Windows Server 2012 R2 |&#10004;|&#10004;|  
| Windows Server 2012 |&#10004;|&#10004;|  
|Windows Server 2008 R2|&#10004;| &#10006;|  
|Windows Server 2008|&#10004;| &#10006;|  
|Windows 10|&#10004;|&#10004;|  
|Windows 8.1|&#10004;|&#10004;|  
|Windows 8|&#10004;|&#10004;|  
|Windows 7|&#10004;| &#10006;|

В следующей таблице показаны 32-разрядных версиях Windows можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.

|32-разрядных версиях Windows|Поколение 1|Поколение 2|  
|-------------------------------|----------------|----------------|  
|Windows 10|&#10004;| &#10006;|  
|Windows 8.1|&#10004;| &#10006;|  
|Windows 8|&#10004;| &#10006;|  
|Windows 7|&#10004;| &#10006;|  

### <a name="BKMK_CentOS"></a>CentOS и Red Hat Enterprise Linux поддержка гостевых операционных систем

В следующей таблице показано, какие версии Red Hat Enterprise Linux \(RHEL\) и CentOS можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.

|Версии операционной системы|Поколение 1|Поколение 2|  
|-----------------------------|----------------|----------------|  
|RHEL или CentOS 7.x рядов|&#10004;|&#10004;|  
|RHEL или CentOS 6.x рядов|&#10004;|&#10004;<br />**Примечание.** Поддерживается только в Windows Server 2016 и более поздних версий.|  
|Серии 5.x RHEL и CentOS|&#10004;| &#10006;|  

Дополнительные сведения см. в разделе [CentOS и Red Hat Enterprise Linux виртуальных машин в Hyper-V](../Supported-CentOS-and-Red-Hat-Enterprise-Linux-virtual-machines-on-Hyper-V.md).  

### <a name="BKMK_Debian"></a>Поддержка Debian гостевых операционных систем  

В следующей таблице показаны, какие версии Debian можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.

|Версии операционной системы|Поколение 1|Поколение 2|  
|-----------------------------|----------------|----------------|  
|Debian 7.x рядов|&#10004;| &#10006;|  
|Debian 8.x рядов|&#10004;|&#10004;|  

Дополнительные сведения см. в разделе [виртуальные машины Debian на узле Hyper-V](../Supported-Debian-virtual-machines-on-Hyper-V.md).  

### <a name="BKMK_FreeBSD"></a>Поддержка гостевых операционных систем FreeBSD

В следующей таблице показаны, какие версии FreeBSD можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.  

|Версии операционной системы|Поколение 1|Поколение 2|  
|-----------------------------|----------------|----------------|  
|FreeBSD 10 и 10.1|&#10004;| &#10006;|  
|FreeBSD 9.1 и 9.3|&#10004;| &#10006;|  
|FreeBSD 8.4|&#10004;| &#10006;|  

Дополнительные сведения см. в разделе [виртуальные машины FreeBSD в Hyper-V](../Supported-FreeBSD-virtual-machines-on-Hyper-V.md).  

### <a name="BKMK_Oracle"></a>Поддержка гостевых операционных систем Oracle Linux  

В следующей таблице показаны, какие версии серии совместимый ядро Red Hat может служить гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.  

|Серии ядер совместимый Red Hat версий|Поколение 1|Поколение 2|  
|---------------------------------------------|----------------|----------------|  
|Oracle Linux 7.x рядов|&#10004;|&#10004;|
|Oracle Linux 6.x рядов|&#10004;| &#10006;|  

В следующей таблице показаны, какие версии с ядром Unbreakable Enterprise Kernel можно использовать как гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.

|Версии с ядром unbreakable Enterprise Kernel (UEK)|Поколение 1|Поколение 2|  
|--------------------------------------------------|----------------|----------------|  
|Oracle Linux UEK R3 QU3|&#10004;| &#10006;|  
|Oracle Linux UEK R3 QU2|&#10004;| &#10006;|  
|Oracle Linux UEK R3 QU1|&#10004;| &#10006;|  

Дополнительные сведения см. в разделе [виртуальные машины Oracle Linux в Hyper-V](../Supported-Oracle-Linux-virtual-machines-on-Hyper-V.md).  

### <a name="BKMK_SUSE"></a>Поддержка гостевых операционных систем SUSE

В следующей таблице показаны, какие версии SUSE можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.

|Версии операционной системы|Поколение 1|Поколение 2|  
|-----------------------------|----------------|----------------|  
|SUSE Linux Enterprise Server 12 рядов|&#10004;|&#10004;|  
|Серия SUSE Linux Enterprise Server 11|&#10004;| &#10006;|  
|Откройте SUSE 12.3|&#10004;| &#10006;|  

Дополнительные сведения см. в разделе [виртуальные машины SUSE в Hyper-V](../Supported-SUSE-virtual-machines-on-Hyper-V.md).  

### <a name="BKMK_Ubuntu"></a>Поддержка гостевых операционных систем Ubuntu

В следующей таблице показаны, какие версии Ubuntu можно использовать в качестве гостевой операционной системы для поколения 1 и поколения 2 виртуальных машин.

|Версии операционной системы|Поколение 1|Поколение 2|  
|-----------------------------|----------------|----------------|  
|Ubuntu 14.04 и более поздних версий|&#10004;|&#10004;|  
|Ubuntu 12.04|&#10004;| &#10006;|  

Дополнительные сведения см. в разделе [Ubuntu виртуальных машин в Hyper-V](../Supported-Ubuntu-virtual-machines-on-Hyper-V.md).  

## <a name="BKMK_Boot"></a>Как загрузку виртуальной машины?

В следующей таблице показаны методы поддерживаются поколения 2 виртуальных машинах поколения 1 и загрузки.  

|Метод загрузки|Поколение 1|Поколение 2|  
|---------------|----------------|----------------|  
|PXE-загрузка с помощью стандартного сетевого адаптера;| &#10006;|&#10004;|  
|PXE-загрузки с помощью устаревший сетевой адаптер|&#10004;| &#10006;|  
|Загрузка с виртуального жесткого диска SCSI (. VHDX) или виртуальный DVD-диска (. ISO)| &#10006;|&#10004;|  
|Загрузка с виртуального жесткого диска контроллера IDE с номером (. Виртуальный жесткий ДИСК) или виртуальный DVD-диска (. ISO)|&#10004;| &#10006;|  
|Загрузки с дискеты (. VFD)|&#10004;| &#10006;|  

## <a name="BKMK_Advantages"></a>Каковы преимущества использования виртуальных машин поколения 2?

Ниже приведены некоторые из преимуществ, получаемых при использовании виртуальной машины поколения 2.  
- **Безопасная загрузка** это функция, который проверяет, загрузчик подписан доверенным центром сертификации на базе UEFI избежание несанкционированного встроенного по, операционных систем или драйверов UEFI во время запуска системы. В виртуальных машинах поколения 2 безопасная загрузка включена по умолчанию. Если необходимо запустить гостевой операционной системе, которая не поддерживается в безопасной загрузки, можно отключить его после создания виртуальной машины.  Дополнительные сведения см. в статье [Безопасная загрузка](https://technet.microsoft.com/library/dn486875.aspx).  

    Для виртуальных машин Linux поколения 2 безопасную загрузку необходимо выбрать шаблон безопасная загрузка UEFI ЦС при создании виртуальной машины.  

- **Большего размера загрузочного тома** максимальное загрузочный том для виртуальных машин поколения 2 — 64 ТБ. Это максимальный размер, поддерживаемый. VHDX. Для виртуальных машин поколения 1, максимальное загрузочного тома составляет 2 ТБ для. Vhdx-файлы и 2 040 ГБ для. ВИРТУАЛЬНЫЙ ЖЕСТКИЙ ДИСК. Дополнительные сведения см. в разделе [Hyper-V Virtual Hard Disk Format Overview](https://technet.microsoft.com/library/hh831446.aspx).  

 Также можно заметить небольшое увеличение времени загрузки и установки виртуальной машины с виртуальными машинами поколения 2.

## <a name="BKMK_DeviceCompare"></a> В чем разница в поддержке устройств?

В следующей таблице сравниваются устройств, доступных между поколения 1 и виртуальные машины поколения 2.  

|Устройство поколения 1|Замена в поколении 2|Усовершенствования в поколении 2|  
|-----------------------|----------------------------|-----------------------------|  
|Контроллер интерфейса IDE|Виртуальный SCSI-контроллер|Загрузка из файла .VHDX (максимальный размер 64 ТБ, возможность оперативного изменения размера)|  
|Дисковод IDE|Виртуальный дисковод SCSI|Поддержка до 64 DVD-устройств SCSI на SCSI-контроллер.|  
|Традиционная BIOS|Встроенное ПО UEFI|Безопасная загрузка|  
|Традиционный сетевой адаптер|Синтетический сетевой адаптер|Сетевая загрузка по протоколам IPv4 и IPv6|  
|Контроллер гибких дисков и DMA|Контроллер гибких дисков не поддерживается|Н/Д|  
|Универсальный асинхронный приемопередатчик (UART) для COM-портов|Дополнительный UART для отладки|Более быстрый и надежный|  
|Контроллер клавиатуры i8042|Программный ввод|Использует меньше ресурсов, так как нет эмуляции. Также уменьшает уязвимость гостевой операционной системы|  
|Клавиатура PS/2|Программная клавиатура|Использует меньше ресурсов, так как нет эмуляции. Также уменьшает уязвимость гостевой операционной системы|  
|Мышь PS/2|Программная мышь|Использует меньше ресурсов, так как нет эмуляции. Также уменьшает уязвимость гостевой операционной системы|  
|S3-видео|Программное видео|Использует меньше ресурсов, так как нет эмуляции. Также уменьшает уязвимость гостевой операционной системы|  
|Шина PCI|Больше не требуется|Н/Д|  
|Программируемый контроллер прерываний (PIC)|Больше не требуется|Н/Д|  
|Программируемый интервальный таймер (PIT)|Больше не требуется|Н/Д|  
|Устройство Super I/O|Больше не требуется|Н/Д|  

## <a name="BKMK_More"></a> Сведения о виртуальных машинах поколения 2

Ниже приведены некоторые дополнительные советы по использованию виртуальных машин поколения 2.

### <a name="attach-or-add-a-dvd-drive"></a>Присоединить или добавить DVD-дисковод

- Не удается подключить физический диск CD или DVD-диска к виртуальной машине поколения 2. Виртуальный DVD-дисковод в виртуальных машинах поколения 2 поддерживает только файлы ISO-образов. Для создания ISO-файла образа среды Windows можно использовать средство командной строки Oscdimg. Дополнительные сведения см. в разделе [Параметры командной строки Oscdimg](https://msdn.microsoft.com/library/hh824847.aspx).
- При создании новой виртуальной машины с помощью командлета New-VM в Windows PowerShell, виртуальная машина поколения 2 нет DVD-дисковод. Во время работы виртуальной машины можно добавить DVD-дисковод.

### <a name="use-uefi-firmware"></a>Использовать встроенное по UEFI

- Безопасная загрузка или встроенное по UEFI не требуется на физическом узле Hyper-V. Hyper-V предоставляет виртуальное встроенное по виртуальным машинам, который не зависит от того, что на узле Hyper-V.
- Встроенное по UEFI в виртуальной машине поколения 2 не поддерживает режим установки для безопасной загрузки.
- Мы не поддерживаем под управлением оболочку UEFI или другие приложения UEFI в виртуальной машине поколения 2. Использование оболочки UEFI или приложений UEFI других разработчиков технически возможно, если они компилируются непосредственно в источниках. Если эти приложения не имеют соответствующим образом цифровой подписи, необходимо отключить безопасную загрузку для виртуальной машины.

### <a name="work-with-vhdx-files"></a>Работа с файлами VHDX

- Можно изменить размер vhdx-файла, содержащего загрузочный том для виртуальной машины поколения 2 во время работы виртуальной машины.
- Мы не поддерживает или рекомендуем создать VHDX-файл поколения 1 и виртуальные машины поколения 2.  
- Поколение виртуальной машины — это свойство виртуальной машины, а не виртуального жесткого диска. Поэтому невозможно определить, был ли vhdx-файл создан с первого или второго поколения виртуальной машины.  
- Vhdx-файл, созданные с помощью поколения 2 виртуальной машины можно подключить к контроллеру интерфейса IDE или SCSI-контроллеру виртуальной машины поколения 1. Тем не менее если это загрузочный vhdx-файл, не загружается виртуальная машина поколения 1.

### <a name="use-ipv6-instead-of-ipv4"></a>Использование протокола IPv6 вместо IPv4

По умолчанию виртуальные машины поколения 2 используют протокол IPv4. Чтобы использовать IPv6, запустите [Set-VMFirmware](https://technet.microsoft.com/library/dn464287.aspx) командлета Windows PowerShell. Например следующая команда задает предпочтительного протокола IPv6 для виртуальной машины testvm:  

```powershell
Set-VMFirmware -VMName TestVM -IPProtocolPreference IPv6  
```  

## <a name="BKMK_Debug"></a>Добавить Последовательный порт для отладки на уровне ядра

COM-порты не доступны в виртуальных машинах поколения 2, пока не будут добавлены. Это можно сделать с помощью Windows PowerShell или инструментария управления Windows (WMI). Ниже показано, как это сделать с помощью Windows PowerShell.

Чтобы добавить COM-порт:  

1. Отключите безопасную загрузку. Отладка ядра несовместима с безопасной загрузкой. Убедитесь, что виртуальная машина находится в состоянии Off, а затем использовать [Set-VMFirmware](https://technet.microsoft.com/library/dn464287.aspx) командлета. Например следующая команда отключает безопасной загрузки на виртуальной машине TestVM:  

    ```powershell  
    Set-VMFirmware -Vmname TestVM -EnableSecureBoot Off  
    ```  

2. Добавьте COM-порта. Используйте [Set-VMComPort](https://technet.microsoft.com/library/hh848616.aspx) командлет, чтобы сделать это. Например следующая команда настраивает первый COM-порт на виртуальной машине TestVM на подключение к именованному каналу TestPipe на локальном компьютере:  

    ```powershell
    Set-VMComPort -VMName TestVM 1 \\.\pipe\TestPipe  
    ```  

> [!NOTE]  
> Настроенные COM-порты не указаны в параметрах виртуальной машины в диспетчере Hyper-V.

## <a name="see-also"></a>См. также  

- [Linux и виртуальные машины FreeBSD в Hyper-V](../Supported-Linux-and-FreeBSD-virtual-machines-for-Hyper-V-on-Windows.md)
- [Использовать локальные ресурсы на виртуальной машине Hyper-V с вложенной виртуализацией](../learn-more/Use-local-resources-on-Hyper-V-virtual-machine-with-VMConnect.md)
- [Планирование масштабируемость Hyper-V в Windows Server 2016](Plan-for-Hyper-V-scalability-in-Windows-Server-2016.md)
