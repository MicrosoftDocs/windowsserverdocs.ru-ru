---
title: Поддерживаемые виртуальные машины Ubuntu в Hyper-V
description: Список служб и компонентов интеграции Linux, входящих в каждую версию
ms.prod: windows-server
manager: dongill
ms.technology: compute-hyper-v
ms.topic: article
ms.assetid: 95ea5f7c-25c6-494b-8ffd-2a77f631ee94
author: shirgall
ms.author: shirgall
ms.date: 06/13/2019
ms.openlocfilehash: 06c836d9671547ea3d40e5582c2ed7b330777ac9
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80857997"
---
# <a name="supported-ubuntu-virtual-machines-on-hyper-v"></a>Поддерживаемые виртуальные машины Ubuntu в Hyper-V

>Область применения: Windows Server 2019, 2016, Hyper-V Server 2019, 2016, Windows Server 2012 R2, Hyper-V Server 2012 R2, Windows Server 2012, Hyper-V Server 2012, Windows Server 2008 R2, Windows 10, Windows 8.1, Windows 8, Windows 7,1, Windows 7

Начиная с Ubuntu 12,04, при загрузке пакета "Linux-Virtual" устанавливается ядро, подходящее для использования в качестве гостевой виртуальной машины. Этот пакет всегда зависит от последнего минимально общего образа ядра и заголовков, используемых для виртуальных машин. Хотя его использование является необязательным, виртуальный ядро Linux загружает меньшее число драйверов и может ускорить загрузку и снизить нагрузку на память, чем универсальный образ.

Чтобы получить полное использование Hyper-V, установите соответствующие пакеты Linux-Tools и Linux-Cloud-Tools, чтобы установить средства и управляющие программы для использования с виртуальными машинами. При использовании ядра Linux для виртуальных систем Загрузите Linux-Tools-Virtual и Linux-Cloud-Tools-Virtual.

Следующая схема распределения признаков показывает функции в каждой версии. Известные проблемы и способы их решения для каждого распространения перечислены после таблицы.

## <a name="table-legend"></a>Условные обозначения таблицы

* **Встроенные в** систему LIS включены в состав этого дистрибутива Linux. Пакет скачивания LIS, предоставленный корпорацией Майкрософт, не подходит для этого распространения, поэтому не устанавливайте его. Номера версий модулей ядра для встроенных LIS (например, как показано в **лсмод**) отличаются от номера версии в пакете скачанных пакетов LIS, предоставленных корпорацией Майкрософт. Несоответствие не означает, что встроенное в LIS Обновление устарело.

* &#10004;-Доступно компонентов

* (*пусто*) — функция недоступна

|**Функциями**|**Версия операционной системы Windows Server**|**18,10/19,04**|**18,04 LTS**|**16,04 LTS**|**14,04 LTS**|**12,04 LTS**|
|-|-|-|-|-|-|-|
|**Доступность**||Встроенные методы|Встроенные методы|Встроенные методы|Встроенные методы|Встроенные методы|
|**[Центральный](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#core)**|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Точное время Windows Server 2016|2019, 2016|&#10004;|&#10004;|&#10004;|||
|**[Сети](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#networking)**|||||||
|Jumbo-кадры|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Добавление тегов и магистрали виртуальной ЛС|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Динамическая миграция|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Статическая Вставка IP-адресов|2019, 2016, 2012 R2, 2012|&#10004;Примечание 1|&#10004;Примечание 1|&#10004;Примечание 1|&#10004;Примечание 1|&#10004;Примечание 1|
|vRSS|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|Сегментация TCP и разгрузка контрольной суммы|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|SR-IOV;|2019, 2016|&#10004;|&#10004;|&#10004;|||
|**[Объема](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#storage)**||||||
|Изменение размера VHDX|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|виртуальный адаптер Fibre Channel;|2019, 2016, 2012 R2|&#10004;Примечание 2|&#10004;Примечание 2|&#10004;Примечание 2|&#10004;Примечание 2||
|Динамическая Архивация виртуальных машин|2019, 2016, 2012 R2|&#10004;Примечание 3, 4, 6|&#10004;Примечание 3, 4, 5|&#10004;Примечание 3, 4, 5|&#10004;Примечание 3, 4, 5||
|Поддержка TRIM|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|WWN ДЛЯ SCSI|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|**[Свободной](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#memory)**||||||
|Поддержка ядра PAE|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Настройка зазора MMIO|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Динамическая память — "горячее" Добавление|2019, 2016, 2012 R2, 2012|&#10004;Примечание 7, 8, 9|&#10004;Примечание 7, 8, 9|&#10004;Примечание 7, 8, 9|&#10004;Примечание 7, 8, 9||
|Всплывающие подсказки динамическая память|2019, 2016, 2012 R2, 2012|&#10004;Примечание 7, 8, 9|&#10004;Примечание 7, 8, 9|&#10004;Примечание 7, 8, 9|&#10004;Примечание 7, 8, 9||
|Изменение размера памяти среды выполнения|2019, 2016|&#10004;|&#10004;|&#10004;|&#10004;||
|**[Роли](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#video)**|||||||
|Устройство, относящееся к Hyper-V|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|**[Включаем](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#miscellaneous)**||||||
|Пара "ключ-значение"|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;Примечание 6, 10|&#10004;Примечание 5, 10|&#10004;Примечание 5, 10|&#10004;Примечание 5, 10|&#10004;Примечание 5, 10|
|Немаскируемое прерывание|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;|&#10004;|
|Копирование файлов с узла на гость|2019, 2016, 2012 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|Команда лсвмбус|2019, 2016, 2012 R2, 2012, 2008 R2|&#10004;|&#10004;|&#10004;|&#10004;||
|Сокеты Hyper-V|2019, 2016||||||
|Транзитный/ДДА PCI|2019, 2016|&#10004;|&#10004;|&#10004;|&#10004;||
|**[Виртуальные машины поколения 2](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md#generation-2-virtual-machines)**||||||
|Загрузка с помощью UEFI|2019, 2016, 2012 R2|&#10004;Примечание 11, 12|&#10004;Примечание 11, 12|&#10004;Примечание 11, 12|&#10004;Примечание 11, 12||
|Безопасная загрузка|2019, 2016|&#10004;|&#10004;|&#10004;|&#10004;||

## <a name="notes"></a>Примечания

1. Статическая Вставка IP-адресов может не работать, если **Диспетчер сети** настроен для конкретного сетевого адаптера Hyper-V на виртуальной машине. Чтобы обеспечить гладкую работу статического внедрения IP-адресов, убедитесь, что диспетчер сети полностью отключен или отключен для определенного сетевого адаптера через его файл **ifcfg-ЕСКС** .

2. При использовании виртуальных устройств оптоволоконного канала убедитесь, что логический номер устройства 0 (LUN 0) заполнен. Если LUN 0 не заполнен, виртуальная машина Linux может не иметь возможности подключать устройства оптоволоконного канала в собственном режиме.

3. Если во время динамической операции резервного копирования виртуальных машин имеются открытые дескрипторы файлов, то в некоторых уголках резервных виртуальных жестких дисков может потребоваться проверка согласованности файловой системы (`fsck`) при восстановлении.

4. Операции динамической архивации могут автоматически завершаться сбоем, если виртуальная машина имеет подключенное устройство iSCSI или прямое подключенное хранилище (также называемое транзитным диском).

5. В выпусках долгосрочной поддержки (LTS) используйте последнюю версию ядра для обновления виртуальных аппаратных средств (HWE) для Integration Services Linux.

   Чтобы установить ядро, настроенное для Azure, на 14,04, 16,04 и 18,04, выполните следующие команды в качестве корневого (или sudo):

   ```bash
   # apt-get update
   # apt-get install linux-azure
   ```

   12,04 не имеет отдельного виртуального ядра. Чтобы установить универсальный ядро HWE на 12,04, выполните следующие команды в качестве корневого (или sudo):

   ```bash
   # apt-get update
   # apt-get install linux-generic-lts-trusty
   ```

   В Ubuntu 12,04 следующие управляющие программы Hyper-V находятся в отдельном установленном пакете:

   * **Управляющая программа моментальных снимков VSS** . Эта управляющая программа необходима для создания динамических резервных копий виртуальных машин Linux.
   * **Управляющая программа KVP** . Эта управляющая программа позволяет задавать и запрашивать внутренние и внешние пары значений ключа.
   * **управляющая программа фкопи** . Эта управляющая программа реализует службу копирования файлов между узлом и гостем.

   Чтобы установить управляющую программу KVP на 12,04, выполните следующие команды в качестве корневого (или sudo).

   ```bash
   # apt-get install hv-kvp-daemon-init linux-tools-lts-trusty linux-cloud-tools-generic-lts-trusty
   ```

   При каждом обновлении ядра необходимо перезагрузить виртуальную машину, чтобы использовать ее.

6. В Ubuntu 18,10 или 19,04 используйте последнюю версию виртуального ядра для получения актуальных возможностей Hyper-V.

   Чтобы установить виртуальный ядро на 18,10 или 19,04, выполните следующие команды в качестве корневого (или sudo):

   ```bash
   # apt-get update
   # apt-get install linux-azure
   ```

   При каждом обновлении ядра необходимо перезагрузить виртуальную машину, чтобы использовать ее.

7. Поддержка динамической памяти доступна только на 64-разрядных виртуальных машинах.

8. Динамическая память операции могут завершиться ошибкой, если в операционной системе на виртуальной машине слишком мало памяти. Ниже приведены некоторые рекомендации.

   * Объем памяти при запуске и минимальный объем памяти должны быть больше или равны объему памяти, рекомендуемому для поставщика распространения.

   * Приложения, которые обычно потребляют всю доступную память в системе, могут потреблять до 80 процентов доступной памяти.

9. При использовании динамическая память в операционных системах Windows Server 2019, Windows Server 2016 или Windows Server 2012/2012 R2 укажите **объем памяти при запуске**, **Минимальный объем памяти**и параметры **максимального объема памяти** , кратные 128 мегабайтам (МБ). Несоблюдение этого действия может привести к сбоям "горячего" добавления, и в гостевой операционной системе может не появиться никакого увеличения объема памяти.

10. В Windows Server 2019, Windows Server 2016 или Windows Server 2012 R2 инфраструктура пар "ключ — значение" может работать неправильно без обновления программного обеспечения Linux. Обратитесь к поставщику распространения, чтобы получить обновление программного обеспечения на случай возникновения проблем с этой функцией.

11. На виртуальных машинах Windows Server 2012 R2 с версии 2 по умолчанию включена безопасная загрузка, и некоторые виртуальные машины Linux не будут загружаться, если только не будет отключен параметр безопасной загрузки. Вы можете отключить безопасную загрузку в разделе **встроенное по** в параметрах виртуальной машины в **диспетчере Hyper-V** или отключить ее с помощью PowerShell:

    ```Powershell
    Set-VMFirmware -VMName "VMname" -EnableSecureBoot Off
    ```

12. Прежде чем пытаться скопировать виртуальный жесткий диск существующей виртуальной машины виртуального жесткого диска поколения 2 для создания новых виртуальных машин поколения 2, выполните следующие действия.

    1. Войдите в существующую виртуальную машину версии 2.

    2. Перейдите в каталог boot EFI.

       ```bash
       # cd /boot/efi/EFI
       ```

    3. Скопируйте каталог Ubuntu в новый каталог с именем Boot:

       ```bash
       # sudo cp -r ubuntu/ boot
       ```

    4. Перейдите в каталог только что созданный каталог загрузки:

       ```bash
       # cd boot
       ```

    5. Переименуйте файл shimx64. EFI:

       ```bash
       # sudo mv shimx64.efi bootx64.efi
       ```

## <a name="see-also"></a>См. также

* [Поддерживаемые CentOS и Red Hat Enterprise Linux виртуальные машины в Hyper-V](Supported-CentOS-and-Red-Hat-Enterprise-Linux-virtual-machines-on-Hyper-V.md)

* [Поддерживаемые виртуальные машины Debian в Hyper-V](Supported-Debian-virtual-machines-on-Hyper-V.md)

* [Поддерживаемые виртуальные машины Oracle Linux в Hyper-V](Supported-Oracle-Linux-virtual-machines-on-Hyper-V.md)

* [Поддерживаемые виртуальные машины SUSE в Hyper-V](Supported-SUSE-virtual-machines-on-Hyper-V.md)

* [Описания функций для виртуальных машин Linux и FreeBSD в Hyper-V](Feature-Descriptions-for-Linux-and-FreeBSD-virtual-machines-on-Hyper-V.md)

* [Рекомендации по запуску Linux в Hyper-V](Best-Practices-for-running-Linux-on-Hyper-V.md)

* [Set-Вмфирмваре](https://technet.microsoft.com/library/dn464287.aspx)

* [Ubuntu 14,04 в блоге поколения 2 VM-Бен Армстронга](https://blogs.msdn.com/b/virtual_pc_guy/archive/2014/06/09/ubuntu-14-04-in-a-generation-2-vm.aspx)
