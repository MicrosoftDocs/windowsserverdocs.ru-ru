---
title: Использование динамической миграции без отказоустойчивой кластеризации для перемещения виртуальной машины
description: Предоставляет необходимые компоненты и инструкции для выполнения динамической миграции в автономной среде.
ms.prod: windows-server
manager: dongill
ms.technology: compute-hyper-v
ms.topic: article
ms.assetid: 75c32e42-97f7-48df-aac9-1d82d34825e1
author: kbdazure
ms.author: kathydav
ms.date: 01/17/2017
ms.openlocfilehash: 41d5edb02d4384955e711024d4e4d68cee5d3937
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80858927"
---
# <a name="use-live-migration-without-failover-clustering-to-move-a-virtual-machine"></a>Использование динамической миграции без отказоустойчивой кластеризации для перемещения виртуальной машины

>Область применения: Windows Server 2016

В этой статье показано, как переместить виртуальную машину, выполнив динамическую миграцию без использования отказоустойчивой кластеризации. Динамическая миграция перемещает запущенные виртуальные машины между узлами Hyper-V без заметного простоя.   
  
Для этого потребуются следующие возможности:   

- Учетная запись пользователя, которая является членом локальной группы администраторов Hyper-V или группы администраторов на исходном и конечном компьютерах. 
  
- Роль Hyper-V в Windows Server 2016 или Windows Server 2012 R2, установленная на исходном и целевом серверах и настроенная для динамической миграции. Вы можете выполнить динамическую миграцию между узлами под управлением Windows Server 2016 и Windows Server 2012 R2, если виртуальная машина имеет версию не ниже 5.

    Инструкции по обновлению версий см. [в статье обновление версии виртуальной машины в Hyper-V в Windows 10 или Windows Server 2016](../deploy/Upgrade-virtual-machine-version-in-Hyper-V-on-Windows-or-Windows-Server.md). Инструкции по установке см. в разделе [Настройка узлов для динамической миграции](../deploy/Set-up-hosts-for-live-migration-without-Failover-Clustering.md).

- Средства управления Hyper-V, установленные на компьютере под управлением Windows Server 2016 или Windows 10, если эти средства не установлены на исходном или целевом сервере, и вы запустите их отсюда.  
   
## <a name="use-hyper-v-manager-to-move-a-running-virtual-machine"></a>Перемещение работающей виртуальной машины с помощью диспетчера Hyper-V  
  
1.  Откройте диспетчер Hyper-V. (В диспетчер сервера щелкните **инструменты** >>**Диспетчер Hyper-V**.)  
  
2.  В области навигации выберите один из серверов. (Если он отсутствует в списке, щелкните правой кнопкой мыши **Диспетчер Hyper-V**, выберите пункт **Подключение к серверу**, введите имя сервера и нажмите кнопку **ОК**. Повторите, чтобы добавить другие серверы.)  
  
3.  В области **виртуальные машины** щелкните правой кнопкой мыши виртуальную машину и выберите пункт **переместить**. Откроется мастер перемещения. 
  
4.  Используйте страницы мастера для выбора типа перемещения, целевого сервера и параметров.
  
5.  На странице **сводных данных** просмотрите выбранные вами параметры и нажмите кнопку **Готово**.  

## <a name="use-windows-powershell-to-move-a-running-virtual-machine"></a>Перемещение работающей виртуальной машины с помощью Windows PowerShell
  
В следующем примере командлет Move-VM используется для перемещения виртуальной машины с именем *лмтест* на целевой сервер с именем *TestServer02* и перемещения виртуальных жестких дисков и другого файла, таких как контрольные точки и файлы Smart paging, в каталог *д:\лмтест* на целевом сервере.  
  
```  
PS C:\> Move-VM LMTest TestServer02 -IncludeStorage -DestinationStoragePath D:\LMTest  
```  
  
## <a name="troubleshooting"></a>Диагностика

### <a name="failed-to-establish-a-connection"></a>Не удалось установить соединение 

Если вы еще не настроили ограниченное делегирование, перед перемещением виртуальной машины необходимо войти на исходный сервер. Если этого не сделать, попытка проверки подлинности завершится ошибкой, и отобразится следующее сообщение:  
  
"Сбой операции миграции виртуальной машины в источнике миграции.  
Не удалось установить соединение с именем главного *компьютера*: нет доступных учетных данных в пакете безопасности 0x8009030E.
  
 Чтобы устранить эту проблему, войдите на исходный сервер и повторите попытку перемещения. Чтобы избежать входа на исходный сервер перед выполнением динамической миграции, Настройте ограниченное делегирование. Для настройки ограниченного делегирования необходимы учетные данные администратора домена. Инструкции см. в разделе [Настройка узлов для динамической миграции](../deploy/Set-up-hosts-for-live-migration-without-Failover-Clustering.md). 
 
 ### <a name="failed-because-the-host-hardware-isnt-compatible"></a>Не удалось выполнить, так как оборудование узла несовместимо
 
 Если на виртуальной машине не включена совместимость процессора и имеется один или несколько моментальных снимков, перемещение завершается ошибкой, если у узлов разные версии процессора. Возникла ошибка, и отобразится следующее сообщение:
 
**Виртуальную машину невозможно переместить на конечный компьютер. Оборудование конечного компьютера несовместимо с требованиями к оборудованию этой виртуальной машины.**
 
 Чтобы устранить эту проблему, завершите работу виртуальной машины и включите параметр совместимости процессора.
 
1. В диспетчере Hyper-V в области **виртуальные машины** щелкните правой кнопкой мыши виртуальную машину и выберите пункт Параметры.
2. В области навигации разверните узел **процессоры** и выберите пункт **Совместимость**.
3. Установите флажок **выполнить миграцию на компьютер с другой версией процессора**.
4. Нажмите кнопку **ОК**.
 
   Чтобы использовать Windows PowerShell, используйте командлет [Set-вмпроцессор](https://technet.microsoft.com/library/hh848533.aspx) :
 
   ```
   PS C:\> Set-VMProcessor TestVM -CompatibilityForMigrationEnabled $true
   ```