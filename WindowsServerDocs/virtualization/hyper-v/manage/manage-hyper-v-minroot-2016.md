---
title: Minroot
description: Настройка элементов управления ведущего приложения ресурсов ЦП
keywords: windows 10, hyper-v
author: allenma
ms.date: 12/15/2017
ms.topic: article
ms.prod: windows-10-hyperv
ms.service: windows-10-hyperv
ms.assetid: ''
ms.openlocfilehash: e1269c11df32c8ce95cc7455d47d7170e9d0b1c8
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59844335"
---
# <a name="hyper-v-host-cpu-resource-management"></a>Управление ресурсами ЦП узла Hyper-V

Элементы управления ресурсами ЦП на узле Hyper-V в Windows Server 2016 или более поздней версии позволяют администраторам лучше управлять и распределения ресурсов ЦП между «root», или управляющего раздела и гостевых виртуальных машин сервера узла Hyper-V. С помощью этих элементов управления, администраторы могут быть выделены подмножеству процессоров узла для корневого раздела. Это можно разделить работу в узле Hyper-V из рабочих нагрузок, работающих в гостевых виртуальных машин работать на отдельном подмножества процессоры системы.

Дополнительные сведения об оборудовании для узлов Hyper-V см. в разделе [требования к системе Windows 10 Hyper-V](https://docs.microsoft.com/virtualization/hyper-v-on-windows/reference/hyper-v-requirements).

## <a name="background"></a>Фон

Прежде, чем настройка контролирует, для Hyper-V разместить ресурсы ЦП, советуем ознакомиться с основами архитектуры Hyper-V.  
Можно найти в Общая Сводка [архитектура Hyper-V](https://docs.microsoft.com/windows-server/administration/performance-tuning/role/hyper-v-server/architecture) раздел.
Ниже перечислены важные понятия в этой статье.

* Hyper-V создает и управляет секциями виртуальной машины, на какие вычислительные ресурсы выделенных и совместно, в системе управления гипервизора.  Разделы обеспечивают четких границ между всех гостевых виртуальных машин, а также между гостевых виртуальных машин и корневой раздел.

* Корневой раздел является секции виртуальную машину, несмотря на то, что она имеет уникальные свойства и гораздо больше полномочий, чем гостевых виртуальных машин.  Корневой раздел предоставляет услуги по управлению, которые управляют все гостевые виртуальные машины, поддерживает виртуальное устройство для гостевых систем и управляет всем устройством ввода-вывода для гостевых виртуальных машин.  Корпорация Майкрософт настоятельно рекомендует не выполняется любой рабочей нагрузки приложения в раздел узлов.

* Каждый виртуальный процессор (VP) корневой раздел является сопоставленные 1:1 для базовой логический процессор (LP).  Вице-Президент ведущее приложение будет всегда выполняться на том же базового LP: в нем нет миграции вице-президенты корневой раздел.  

* По умолчанию LPs, на которых запущены вице-президенты узла можно также запустить вице-президенты гостя.

* Вице-Президентом гостевой может быть запланирован низкоуровневой оболочкой для запуска на любой доступных логический процессор.  Хотя необходимо учитывать расположение временного кэша, топология NUMA и множество других факторов при планировании вице-Президентом гостевой берет на себя планировщик низкоуровневой оболочки, в конечном счете вице-Президент могут планироваться на любом узле LP.

## <a name="the-minimum-root-or-minroot-configuration"></a>Минимальное корневой или конфигурации «Minroot»

Ранние версии Hyper-V было архитектуры максимум 64 вице-президенты каждой секции.  Это применяется к секциям корневой и гостевой.  Как системы с более чем 64 логических процессоров появлялись на мощных серверов, Hyper-V также разработан предел масштабирования узла для поддержки этих более крупные системы, в одной точке, поддерживающих узел с до 320 LPs.  Тем не менее критические 64 вице-Президент предел секционирования в этот момент представлены некоторые сложности и появился сложностей, которые сделаны поддержки более 64 вице-президенты на секцию чрезмерно высокой.  Для решения этой проблемы Hyper-V из ограниченного числа вице-президенты, присвоенный корневому разделу 64, даже если базовая машина у многих более логических процессоров, доступных.  Низкоуровневая оболочка будет продолжать использовать все доступные LPs для выполнения гостевой вице-президенты, но искусственно покрываются корневой раздел, в 64.  Эта конфигурация стал известен как «минимальное root» или «minroot» конфигурации.  Тестирование производительности подтверждает, что, даже в крупномасштабных системах с более чем 64 LP, корневой не требовалась более чем 64 вице-президенты корневой для обеспечения достаточно большое число гостевых виртуальных машин и гостевых вице-президенты — на самом деле, намного меньше, чем 64 корневой вице-президенты часто было достаточно , само собой в зависимости от числа и размера из гостевых виртуальных машин, для конкретных рабочих нагрузок выполняются и т. д.

Эта концепция «minroot» продолжает использоваться уже сегодня.  На самом деле даже в Windows Server 2016 Hyper-V, увеличено его максимальная поддержка по вопросам архитектуры для 512 LPs узла LPs, по-прежнему будет ограничен более 320 LPs корневой раздел.

## <a name="using-minroot-to-constrain-and-isolate-host-compute-resources"></a>С помощью Minroot ограничить и изолировать вычислительных ресурсов узла
С высокого уровня по умолчанию пороговое значение 320 LPs в Windows Server 2016 Hyper-V minroot конфигурации будет использоваться только в очень большого серверных системах.  Тем не менее эту возможность можно настроить для много нижний порог администратором узла Hyper-V и таким образом использовать, чтобы значительно ограничить объем ресурсов ЦП узла, доступных на корневом разделе.  Само собой следует тщательно определенное количество LPs корневой использовать поддерживающая максимальное требования виртуальных машин и рабочих нагрузок, выделенный для узла.  Тем не менее приемлемые значения для числа LPs узла может быть определяются посредством важно провести тщательный анализ и проверенные в нерабочей среде до широкого развертывания и мониторинга производственных рабочих нагрузок.

## <a name="enabling-and-configuring-minroot"></a>Включение и настройка Minroot

Конфигурация minroot, контролируется с помощью записи в BCD низкоуровневой оболочки. Чтобы включить minroot из командной строки с правами администратора:

```
    bcdedit /set hypervisorrootproc n
```
Где n — количество корневой вице-президенты. 

Необходимо выполнить перезагрузку системы, и новое количество процессоров корневой сохраняются в течение времени существования загрузки ОС.  Невозможно изменить конфигурацию minroot динамически во время выполнения.

При наличии нескольких узлов NUMA, каждый узел получит `n/NumaNodeCount` процессоров.

Обратите внимание, что с несколькими узлами NUMA, необходимо убедиться, что топология виртуальной Машины — таким образом, что имеется достаточно свободного LPs (т. е. LPs без параметра root VPs) на каждом узле NUMA, для запуска узла NUMA соответствующей виртуальной Машины вице-президенты.

## <a name="verifying-the-minroot-configuration"></a>Проверка конфигурации Minroot

Можно проверить настройки minroot узла, с помощью диспетчера задач, как показано ниже.

![](./media/minroot-taskman.png)

При активном Minroot диспетчер задач будет отображаться количество логических процессоров, которые в настоящее время, выделенное для узла, а также общее число логических процессоров в системе.
 
