---
title: Обзор общего доступа к файлам по протоколу SMB 3 в Windows Server
description: Обзор по протоколу SMB 3 для файловых ресурсов и файлами с помощью Windows Server.
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage
ms.date: 07/09/2018
ms.localizationpriority: medium
ms.openlocfilehash: fc4c8b341ee78db80f862ee412400f0a930fe810
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59845055"
---
# <a name="overview-of-file-sharing-using-the-smb-3-protocol-in-windows-server"></a>Обзор общего доступа к файлам по протоколу SMB 3 в Windows Server

>Относится к: Windows Server 2012 R2, Windows Server 2012, Windows Server 2016

В этом разделе описывается компонент SMB 3.0 в Windows Server® 2012, Windows Server 2012 R2 и Windows Server 2016 — Практическое применение функции, наиболее существенные новые и измененные функции в этой версии по сравнению с предыдущими версиями, а также оборудование требования.

## <a name="feature-description"></a>Описание компонента

Протокол SMB — это сетевой протокол для общего доступа к файлам, который позволяет приложениям компьютера читать и записывать файлы, а также запрашивать службы серверных программ в компьютерной сети. Протокол SMB может использоваться поверх протокола TCP/IP или других сетевых протоколов. С помощью протокола SMB приложение (или использующий его пользователь) может получать доступ к файлам и другим ресурсам удаленного сервера. Это позволяет приложениям читать, создавать и обновлять файлы на удаленном сервере. Этот протокол может также обмениваться данными с любой серверной программой, которая настроена на получение клиентских запросов SMB. Windows Server 2012 появился новая версия протокола SMB 3.0.

## <a name="practical-applications"></a>Практическое применение

В этом подразделе описан ряд способов использования нового протокола SMB 3.0.

* **Хранилище файлов для виртуализации (Hyper-V™ через SMB)**. С помощью протокола SMB 3.0 Hyper-V может хранить в файловых ресурсах общего доступа файлы виртуального компьютера, например файлы конфигурации, файлы виртуального жесткого диска (VHD) и снимки. Этот способ может использоваться как для изолированных файловых серверов, так и для кластерных файловых серверов, которые используют Hyper-V вместе с общедоступным хранилищем файлов для кластера.
* **Microsoft SQL Server через SMB**. SQL Server может хранить файлы базы данных пользователей в файловых ресурсах SMB. Сейчас эта возможность поддерживается SQL Server 2008 R2 для изолированных серверов SQL. В будущих версиях SQL Server будет добавлена поддержка кластерных серверов SQL и системных баз данных.
* **Традиционное хранение данных пользователя**. Протокол SMB 3.0 предоставляет дополнительные возможности для рабочих нагрузок клиентов или сотрудников, работающих с информацией. Эти возможности включают сокращение задержек приложений при получении пользователями филиала доступа к данным через глобальную сеть и защиту данных от перехвата злоумышленниками.

## <a name="new-and-changed-functionality"></a>Новые и измененные функции

Сведения о новых и измененных функциях в Windows Server 2012 R2, см. в разделе [новые возможности SMB в Windows Server](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831474(v%3dws.11)>).

SMB в Windows Server 2012 и Windows Server 2016 включает в себя новый протокол SMB 3.0 и много улучшений описанных в следующей таблице.

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Компонент или функция</p></th>
<th><p>Новинка или обновление</p></th>
<th><p>Сводка</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Прозрачная отказоустойчивость SMB</p></td>
<td><p>Оператор new</p></td>
<td><p>Позволяет администраторам обслуживать аппаратное и программное обеспечение узлов кластерного файлового сервера, не прерывая работу приложений сервера, хранящих данные в этих файловых ресурсах. Кроме того, при сбое оборудования или программного обеспечения в узле кластера клиенты SMB подключатся к другому узлу кластера, не прерывая работу приложений сервера, хранящих данные в этих файловых ресурсах.</p></td>
</tr>
<tr class="even">
<td><p>Масштабирование SMB</p></td>
<td><p>Оператор new</p></td>
<td><p>С помощью версии 2 общих томов кластера (CSV) администраторы могут создавать файловые ресурсы, предоставляющие одновременный доступ к файлам данных с прямыми операциями ввода-вывода через все узлы кластера файлового сервера. Это улучшает использование пропускной способности сети и балансировку нагрузки клиентов файлового сервера, а также оптимизирует производительность серверных приложений.</p></td>
</tr>
<tr class="odd">
<td><p>Технология SMB Multichannel</p></td>
<td><p>Оператор new</p></td>
<td><p>Обеспечивает агрегирование пропускной способности и отказоустойчивости сети, если доступно несколько путей между клиентом SMB 3.0 и сервером SMB 3.0. Это позволяет приложениям сервера использовать всю доступную пропускную способность сети и быть устойчивыми к сетевым сбоям.</p></td>
</tr>
<tr class="even">
<td><p>SMB Direct</p></td>
<td><p>Оператор new</p></td>
<td><p>Поддерживает использование сетевых адаптеров, которые поддерживают RDMA и могут работать на полной скорости с очень низкой задержкой, используя очень малую часть ЦП. При использовании этой функции для таких рабочих нагрузок, как Hyper-V и Microsoft SQL Server, работа с удаленным файловым сервером будет похожа на работу с локальным хранилищем.</p></td>
</tr>
<tr class="odd">
<td><p>Счетчики производительности для серверных приложений</p></td>
<td><p>Оператор new</p></td>
<td><p>Новые счетчики производительности SMB предоставляют подробную информацию о пропускной способности, задержке и числе операций ввода-вывода в секунду каждого ресурса, что позволяет администраторам анализировать производительность файловых ресурсов SMB 3.0, в которых они хранят данные. Эти счетчики разработаны специально для серверных приложений, таких как Hyper-V и SQL Server, которые хранят файлы в удаленных файловых ресурсах.</p></td>
</tr>
<tr class="even">
<td><p>Оптимизация производительности</p></td>
<td><p>Обновлено</p></td>
<td><p>Клиент SMB 3.0 и сервер SMB 3.0 были оптимизированы с целью уменьшения числа случайных операций ввода-вывода для чтения-записи, которые часто встречаются в таких серверных приложениях, как SQL Server OLTP (оперативная обработка транзакций). Помимо этого, большое значение для наибольшего размера передаваемых данных (MTU) теперь включено по умолчанию, что значительно повышает производительность больших последовательных передач, таких как работа с хранилищем данных SQL Server, архивация и восстановление базы данных, развертывание и копирование виртуальных жестких дисков.</p></td>
</tr>
<tr class="odd">
<td><p>Командлеты Windows PowerShell для SMB</p></td>
<td><p>Оператор new</p></td>
<td><p>С помощью командлетов Windows PowerShell для SMB администраторы могут полностью управлять файловыми ресурсами файлового сервера из командной строки.</p></td>
</tr>
<tr class="even">
<td><p>Шифрование SMB</p></td>
<td><p>Оператор new</p></td>
<td><p>Обеспечивает непрерывное шифрование данных SMB и защищает их от перехвата в недоверенных сетях. Не нуждается в новых затратах на развертывание, протоколе IPsec, специализированном оборудовании и ускорителях WAN. Шифрование SMB может быть настроено для отдельных ресурсов или всего файлового сервера и может быть включено для ряда сценариев, при которых данные проходят через недоверенные сети.</p></td>
</tr>
<tr class="odd">
<td><p>Аренда каталогов SMB</p></td>
<td><p>Оператор new</p></td>
<td><p>Сокращает время ответа приложений в филиалах При использовании аренды каталогов число передач пакетов от клиента к серверу и обратно сокращается, так как метаданные извлекаются из кэша каталога с большим временем хранения. Обеспечивается согласованность кэша, так как клиенты извещаются об изменениях информации о каталоге на сервере. Данная возможность работает со сценариями <em>Домашняя папка</em> (чтение-запись без общего доступа) и <em>Публикация</em> (только чтение без общего доступа).</p></td>
</tr>
</tbody>
</table>

## <a name="hardware-requirements"></a>Требования к оборудованию

Для обеспечения прозрачной отказоустойчивости SMB необходимо соблюдать следующие требования.

* Отказоустойчивый кластер под управлением Windows Server 2012 или Windows Server 2016 с минимум двумя узлами. Кластер должен пройти проверочный тест для кластеров, входящий в состав мастера проверки.
* Файловые ресурсы должны быть созданы со свойством "Постоянная доступность" (CA), что является настройкой по умолчанию.
* Файловые ресурсы нужно создавать на путях к тому CSV, чтобы обеспечить масштабирование SMB.
* Клиентские компьютеры должны работать под управлением Windows® 8 или Windows Server 2012, которые содержат обновленный клиент SMB, поддерживающий постоянную доступность.

>[!NOTE]
>Клиенты низкого уровня могут подключаться к файловые ресурсы, имеющие свойство ЦС, но не будут поддерживаться прозрачную отработку отказа для этих клиентов.

Для поддержки многоканальности SMB необходимо соблюдать следующие требования.

* По крайней мере два компьютера с Windows Server 2012 являются обязательными. Установки дополнительных компонентов не требуется — эта технология включена по умолчанию.
* Сведения о рекомендуемых сетевых настройках см. в подразделе "Дополнительные сведения" в конце этого раздела.

Для поддержки прямой технологии SMB необходимо соблюдать следующие требования.

* По крайней мере два компьютера с Windows Server 2012 являются обязательными. Установки дополнительных компонентов не требуется — эта технология включена по умолчанию.
* Сетевые адаптеры с поддержкой RDMA. На данный момент существует три типа таких адаптеров: iWARP, Infiniband и RoCE (RDMA over Converged Ethernet).

## <a name="more-information"></a>Дополнительные сведения

Ниже приведены дополнительные ресурсы Интернета с информацией о SMB и связанных технологиях в Windows Server 2012 R2, Windows Server 2012 и Windows Server 2016.

* [Хранилища в Windows Server](../storage.md)
* [Масштабируемый файловый сервер для данных приложений](../../failover-clustering/sofs-overview.md)
* [Повысить производительность файлового сервера с SMB Direct](smb-direct.md)
* [Развертывание Hyper-V через SMB](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj134187(v%3dws.11)>)
* [Развертывание SMB Multichannel](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn610980(v%3dws.11)>)
* [Развертывание быстрых и производительных файловых серверов для серверных приложений](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh831723(v%3dws.11)>)
* [SMB: Руководство по устранению неполадок](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn659439(v%3dws.11)>)