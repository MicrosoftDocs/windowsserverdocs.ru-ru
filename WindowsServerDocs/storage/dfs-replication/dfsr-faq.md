---
Title: Репликация DFS. Вопросы и ответы
ms.date: 06/18/2014
ms.prod: windows-server-threshold
ms.technology: storage
author: JasonGerend
manager: elizapo
ms.author: jgerend
ms.openlocfilehash: 00bb3dfd79096e28f9752053152571ea9919edcf
ms.sourcegitcommit: afb0602767de64a76aaf9ce6a60d2f0e78efb78b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2019
ms.locfileid: "67284267"
---
# <a name="dfs-replication-frequently-asked-questions-faq"></a>Репликация DFS. Вопросы и ответы


Обновлено: 30 апреля 2019 г.

Область применения. Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2, Windows Server 2008

Ответы на вопросы о репликации распределенной файловой системы (DFS) (также называется DFS-R или DFSR) для Windows Server.

Сведения о пространствах имен DFS см. в разделе [пространств имен DFS: Ответы на вопросы о](https://technet.microsoft.com/library/ee404780).

Сведения о том, что новые возможности репликации DFS см. в разделах:

  - [Пространства имен DFS и DFS Replication Overview](https://technet.microsoft.com/library/jj127250) (в Windows Server 2012)  
      
  - [Новые возможности распределенной файловой системы](https://technet.microsoft.com/library/ee307957) подразделы [изменение функциональности от Windows Server 2008 на Windows Server 2008 R2](https://technet.microsoft.com/library/dd391932)  
      
  - [Распределенная файловая система](https://technet.microsoft.com/library/cc753479) подразделы [изменение функциональности от Windows Server 2003 с пакетом обновления 1 для Windows Server 2008](https://technet.microsoft.com/library/cc753208)  
      

Список последних изменений раздела см. в подразделе [Журнал изменений](#change-history) этого раздела.

      

## <a name="interoperability"></a>Взаимодействие

### <a name="can-dfs-replication-communicate-with-frs"></a>Репликация DFS взаимодействуют FRS?

Нет. Репликация DFS не взаимодействуют с помощью службы репликации файлов (FRS). Служба репликации DFS и FRS можно запустить на одном сервере в то же время, но они никогда не должны быть настроены для репликации одной и той же папки или вложенные папки, так как это может привести к потере данных.

### <a name="can-dfs-replication-replace-frs-for-sysvol-replication"></a>Репликация DFS замените FRS для репликации SYSVOL

Да, репликация DFS может заменять FRS для репликации SYSVOL на серверах под управлением Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2 или Windows Server 2008. Серверы под управлением Windows Server 2003 R2 не поддерживают использование репликации DFS для репликации папки SYSVOL.

Дополнительные сведения о репликации SYSVOL с помощью репликации DFS см. в разделе [руководство по миграции репликации SYSVOL: FRS на DFS](https://technet.microsoft.com/library/dd640019).

### <a name="can-i-upgrade-from-frs-to-dfs-replication-without-losing-configuration-settings"></a>Можно ли обновить с FRS на DFS без потери параметры конфигурации?

Да. Чтобы перенести репликации с FRS на DFS, ознакомьтесь со следующими документами:

  - Чтобы перенести репликации папок кроме папки SYSVOL, см. в разделе [руководство по операциям DFS: Миграция с FRS на DFS](http://go.microsoft.com/fwlink/?linkid=192776) и [FRS2DFSR – Миграция с FRS на служебная программа переноса DFSR](http://go.microsoft.com/fwlink/?linkid=195437) (http://go.microsoft.com/fwlink/?LinkID=195437).  
      
  - Чтобы перенести репликации папки SYSVOL с репликацией DFS, см. в разделе [руководство по миграции репликации SYSVOL: FRS на DFS](https://technet.microsoft.com/library/dd640019).  
      

### <a name="can-i-use-dfs-replication-in-a-mixed-windowsunix-environment"></a>Можно использовать репликацию DFS в смешанной среде Windows и UNIX?

Да. Несмотря на то, что служба репликации DFS поддерживает только репликацию содержимого между серверами под управлением Windows Server, клиенты UNIX можно получить доступ к общим файловым ресурсам на серверах Windows. Для этого нужно установите службы для сетевой файловой системы (NFS) на сервере репликации DFS.

Можно также использовать функции клиента SMB/CIFS, включенные в многие клиенты UNIX прямой доступ к Windows общие файловые ресурсы, несмотря на то, что эта функциональность часто, а также требует внесения изменений в среде Windows (например, отключение с помощью подписывания SMB Групповая политика).

Репликация DFS взаимодействует с NFS на сервере под управлением ОС Windows Server, но не может реплицировать точку подключения NFS.

### <a name="can-i-use-the-volume-shadow-copy-service-with-dfs-replication"></a>Можно использовать службы теневого копирования томов с репликацией DFS

Да. Репликация DFS поддерживается на томах службы теневого копирования томов (VSS) и предыдущего моментальные снимки могут быть восстановлены успешно с предыдущая версия клиента.

### <a name="can-i-use-windowsbackup-ntbackupexe-to-remotely-back-up-a-replicated-folder"></a>Можно ли использовать Windows Backup (Ntbackup.exe) удаленно резервной копии реплицируемой папки?

Нет, использование Windows Backup (Ntbackup.exe) на компьютере под управлением Windows Server 2003 или более ранней, чтобы создать резервную копию реплицированной папке на компьютере под управлением Windows Server 2012, Windows Server 2008 R2 или Windows Server 2008 не поддерживается.

Чтобы создать резервную копию файлов, которые хранятся в реплицированной папке, используйте архивации данных Windows Server или Microsoft® System Center Data Protection Manager. Сведения о функции резервного копирования и восстановления в Windows Server 2008 R2 и Windows Server 2008, см. в разделе [резервного копирования и восстановления](https://technet.microsoft.com/library/Cc754097). Дополнительные сведения см. в разделе [System Center Data Protection Manager](http://go.microsoft.com/fwlink/?linkid=182261) (http://go.microsoft.com/fwlink/?LinkId=182261).

### <a name="do-file-system-policies-impact-dfs-replication"></a>Файл системные политики влияют на репликации DFS

Да. Не настраивайте политики файловой системы на реплицируемых папок. Политики файловой системы, чтобы повторно применяет разрешения NTFS на каждый интервал обновления групповой политики. Это может привести нарушения совместного доступа, так как файл не реплицируются, пока файл не будет закрыт.

### <a name="does-dfs-replication-replicate-mailboxes-hosted-on-microsoft-exchange-server"></a>Репликация DFS и реплицировать почтовым ящикам, размещенным на сервере Microsoft Exchange Server?

Нет. Репликация DFS не может использоваться для репликации почтовых ящиков, размещенных на сервере Microsoft Exchange Server.

### <a name="does-dfs-replication-support-file-screens-created-by-file-server-resource-manager"></a>Поддерживает ли служба репликации DFS блокировки файлов, созданные с диспетчера ресурсов файлового сервера?

Да. Однако параметры блокировки файлов диспетчера ресурсов файлового сервера (FSRM) должны совпадать на обоих концах репликации. Кроме того репликация DFS имеет собственный механизм фильтр для файлов и папок, которые можно использовать для исключения из репликации определенных файлов и типов файлов.

Ниже приведены рекомендации по реализации фильтры блокировки файлов или квоты.

  - Не должно быть скрытой папке DfsrPrivate квоты и блокировки файлов.  
      
  - Экранированная файлов не должен существовать в любой реплицированной папки до включения блокировки.  
      
  - Папки не может превышать квоту до включения квоту.  
      
  - Жесткие квоты необходимо использовать с осторожностью. Это возможно для отдельных членов группы репликации, чтобы оставаться в пределах квоты до репликации, но когда файлы реплицируются превышать его. Например если пользователь копирует файл 10 мегабайт (МБ) на сервере A (который будет строгое ограничение), а другой пользователь копирует файл 5 МБ на сервер B, при следующей репликации, оба сервера превысит квоту 5 мегабайт. Это может привести к репликации DFS, повторные попытки выполнить репликации файлов, вызывая отверстия в вектор версии и возможные проблемы с производительностью.  
      

### <a name="is-dfs-replication-cluster-aware"></a>Известно о репликации DFS кластера?

Репликация DFS в Windows Server 2012 R2, Windows Server 2012 и Windows Server 2008 R2 включает в себя возможность добавить отказоустойчивый кластер в качестве члена группы репликации. Дополнительные сведения см. в разделе [добавить отказоустойчивый кластер в группу репликации](http://go.microsoft.com/fwlink/?linkid=155085) (http://go.microsoft.com/fwlink/?LinkId=155085). Служба репликации DFS в версиях Windows до Windows Server 2008 R2 не предназначена для координации с отказоустойчивым кластером, а служба не была перенесена на другой узел.


> [!NOTE]
> Репликация DFS не поддерживает репликацию файлов на общих томах кластера. 
<br>


### <a name="is-dfs-replication-compatible-with-data-deduplication"></a>Репликация DFS совместима с дедупликации данных?

Да, репликация DFS может реплицировать папки на томах с использованием дедупликации данных в Windows Server.

### <a name="is-dfs-replication-compatible-with-ris-and-wds"></a>Репликация DFS совместим со службой RIS и WDS?

Да. Репликация DFS реплицирует томов, на которых включено хранилище единственных копий (SIS). Хранилище единственных копий используется служб удаленной установки (RIS), службы развертывания Windows (WDS) и Windows Storage Server.

### <a name="is-it-possible-to-use-dfs-replication-with-offline-files"></a>Это можно использовать репликацию DFS с автономными файлами?

Можно безопасно использовать репликацию DFS и работы с автономными файлами друг с другом в сценариях при наличии только одного пользователя одновременно пишущий к файлам. Это удобно для пользователей, которые передаются между двумя филиалами и хотите иметь возможность обращаться к файлам в ни одну из ветвей или когда вне сети. Автономные файлы кэширует файлы локально в автономном режиме, и репликация DFS реплицирует данные между в каждом филиале.

Не использовать репликацию DFS с автономными файлами в многопользовательской среде, так как служба репликации DFS не поддерживает любой распределенной механизм блокировки или возможности извлечения файлов. Если два пользователя изменяют тот же файл в то же время на разных серверах, репликация DFS перемещает файл в старые DfsrPrivate\\папка ConflictandDeleted (находится по локальному пути реплицируемой папки) во время следующей репликации.

### <a name="what-antivirus-applications-are-compatible-with-dfs-replication"></a>Какие антивирусные приложения совместимы с репликацией DFS?

Антивирусные приложения может вызвать излишняя репликация, если их сканирования операций alter файлы в реплицированной папке. Дополнительные сведения [тестирование взаимодействия приложений антивирусная программа с репликацией DFS](http://go.microsoft.com/fwlink/?linkid=73990) (http://go.microsoft.com/fwlink/?LinkId=73990).

### <a name="what-are-the-benefits-of-using-dfs-replication-instead-of-windows-sharepoint-services"></a>Каковы преимущества использования репликации DFS вместо служб Windows SharePoint Services?

Windows® SharePoint® Services обеспечивает согласование с тесной в виде функции извлечения файлов, репликация DFS не поддерживает. Если вы беспокоитесь о несколько человек, редактирования и тот же файл, рекомендуется использовать службы Windows SharePoint Services. Windows SharePoint Services 2.0 с пакетом обновления 2 доступна как часть Windows Server 2003 R2. Windows SharePoint Services можно загрузить с веб-узла Майкрософт; оно не указано в более новых версиях Windows Server. Тем не менее если данные реплицируются на нескольких сайтах, пользователи не будет изменять файлы, в то же время репликации DFS предоставляет больше пропускной способности и более простое управление.

## <a name="limitations-and-requirements"></a>Ограничения и требования

### <a name="can-dfs-replication-replicate-between-branch-offices-without-a-vpn-connection"></a>Можно ли реплицировать репликации DFS между филиалами без VPN-подключение?

Да, предполагая, что есть закрытый (Wide Area Network – WAN) ссылка (не через Интернет) подключение филиалов. Тем не менее необходимо открыть соответствующие порты в Внешние брандмауэры. Репликация DFS использует Сопоставитель конечных точек RPC (порт 135) и назначения случайным образом временный порт выше 1024. Можно использовать **Dfsrdiag** средство командной строки для указания статического порта вместо временных портов. Дополнительные сведения об указании конечных точек RPC см. в разделе [статьи 154596](http://go.microsoft.com/fwlink/?linkid=73991) в базе знаний Майкрософт (http://go.microsoft.com/fwlink/?LinkId=73991).

### <a name="can-dfs-replication-replicate-files-encrypted-with-the-encrypting-file-system"></a>Можно ли репликация DFS реплицировать файлы, зашифрованные с помощью шифрованной файловой системы?

Нет. Репликация DFS не будут реплицированы, файлы или папки, которые будут зашифрованы с помощью шифрованной файловой системы (EFS). Если пользователь шифрует файл, который ранее реплицировался, репликация DFS удаляет файл из всех других членов группы репликации. Это гарантирует, что доступно только копию файла является зашифрованной версии на сервере.

### <a name="can-dfs-replication-replicate-outlook-pst-or-microsoft-office-access-database-files"></a>Репликация DFS можно реплицировать .pst в Outlook или файлам баз данных Microsoft Office Access?

Репликация DFS может безопасно реплицировать Microsoft Outlook личных папок (PST) и файлы Microsoft Access только в том случае, если они хранятся в архивных целях и не осуществляется по сети с помощью клиента, например Outlook или доступа (чтобы открыть доступ или PST файлы, сначала скопируйте файлы является устройством локального хранилища). Далее приведены причины этого.

  - Открытия файлов PST с сетевых подключений может привести к повреждению данных в PST-файлах. Дополнительные сведения о почему PST-файлы не может быть организован и безопасно по сети, см. в разделе [статьи 297019](http://go.microsoft.com/fwlink/?linkid=125363) в базе знаний Майкрософт (http://go.microsoft.com/fwlink/?LinkId=125363).  
      
  - PST и доступа к файлам, как правило, остаются открытыми в течение длительного времени во время, к которым обращаются клиента, например Outlook или Office Access. Это предотвращает репликации DFS реплицировать эти файлы, пока они будут закрыты.  
      

### <a name="can-i-use-dfs-replication-in-a-workgroup"></a>Можно использовать репликацию DFS в рабочей группе?

Нет. Репликация DFS зависит от доменных служб Active Directory® для конфигурации. Он будет работать только в домене.

### <a name="can-more-than-one-folder-be-replicated-on-a-single-server"></a>Могут быть реплицированы более чем одной папки на одном сервере?

Да. Репликация DFS может реплицировать содержимого папок между серверами. Убедитесь, что каждой реплицированной папки имеет уникальный корневой путь, и что они не будут перекрываться. Например, D:\\продаж и D:\\учета может быть корневых путей для двух реплицированных папок, но D:\\продаж и D:\\Sales\\отчетов не может быть корневых путей для двух реплицированных папок.

### <a name="does-dfs-replication-require-dfs-namespaces"></a>Требуется ли пространств имен DFS для репликации DFS?

Нет. Служба репликации DFS и пространств имен DFS может использоваться отдельно или совместно. Кроме того можно использовать репликацию DFS для репликации автономного пространства имен DFS, что не было возможно с FRS.

### <a name="does-dfs-replication-require-time-synchronization-between-servers"></a>Репликация DFS требует синхронизации времени между серверами?

Нет. Репликация DFS явным образом не требует синхронизации времени между серверами. Однако репликация DFS требует точного соответствия часов сервера. Сервер необходимо установить в течение пяти минут друг от друга (по умолчанию) для проверки подлинности Kerberos для правильной. Например репликация DFS использует метки времени, чтобы определить, какой файл имеет приоритет в случае конфликта. Точное время также важны для сбора мусора, расписания и другие функции.

### <a name="does-dfs-replication-support-replicating-an-entire-volume"></a>Служба репликации DFS поддерживает репликацию на весь том?

Да. Тем не менее необходимо сначала установить пакет обновления 2 для Windows Server 2003 или исправления. Дополнительные сведения см. в разделе [статьи 920335](http://go.microsoft.com/fwlink/?linkid=76776) в базе знаний Майкрософт (http://go.microsoft.com/fwlink/?LinkId=76776). Кроме того репликация целый том может вызвать следующие проблемы:

  - Если том содержит файл подкачки Windows, репликации и регистрирует событие DFSR 4312 в журнал системных событий.  
      
  - Репликация DFS устанавливает атрибуты системы и Hidden реплицируемую папку на серверы назначения. Это происходит, потому что Windows применяет атрибуты «System» и «Hidden в корневую папку тома по умолчанию. Если локальный путь к реплицируемой папки на серверах назначения также корневой папки тома, никакие изменения вносятся в папку атрибуты.  
      
  - При репликации тома, содержащего папку системы Windows, репликация DFS распознает папку % WINDIR % и не реплицируются. Однако репликация DFS реплицировать папки, используемые приложениями сторонних разработчиков, которые могут вызвать приложения, которые должны завершиться ошибкой на серверах назначения, если приложение имеет проблемы взаимодействия с репликацией DFS.  
      

### <a name="does-dfs-replication-support-rpc-over-http"></a>Поддерживает ли служба репликации DFS RPC через HTTP?

Нет.

### <a name="does-dfs-replication-work-across-wireless-networks"></a>Репликация DFS работает через беспроводные сети?

Да. Репликация DFS не зависит от типа соединения.

### <a name="does-dfs-replication-work-on-refs-or-fat-volumes"></a>Репликация DFS работает на ReFS или FAT?

Нет. Репликация DFS поддерживают тома, отформатированные в файловой системе NTFS. Resilient File System (ReFS) и файловой системой FAT не поддерживаются. Служба репликации DFS требуется NTFS, так как он использует журнал изменений NTFS и другие возможности NTFS файловая система.

### <a name="does-dfs-replication-work-with-sparse-files"></a>Репликация DFS работает с разреженные файлы?

Да. Вы можете реплицировать разреженные файлы. **Sparse** атрибут сохраняется в принимающем члене.

### <a name="do-i-need-to-log-in-as-administrator-to-replicate-files"></a>Требуется выполнить вход от имени администратора для репликации файлов?

Нет. Репликация DFS — это служба, которая выполняется под учетной записью локальной системы, поэтому необходимо войти как администратор для репликации. Тем не менее необходимо быть администратором домена или локального администратора серверов измененного файла для изменения конфигурации репликации DFS.

Дополнительные сведения см. в разделе «Требования к безопасности репликации DFS и делегирования» в [делегировать возможность управления репликацией DFS](http://go.microsoft.com/fwlink/?linkid=182294) (http://go.microsoft.com/fwlink/?LinkId=182294).

### <a name="how-can-i-upgrade-or-replace-a-dfs-replication-member"></a>Как обновить или заменить член репликации DFS

Чтобы обновить или заменить член репликации DFS, прочитайте запись блога на Ask блог команды разработчиков служб каталогов: [Замена элемента оборудования или ОС DFSR](http://blogs.technet.com/b/askds/archive/2010/09/10/series-wrap-up-and-downloads-replacing-dfsr-member-hardware-or-os.aspx).

### <a name="is-dfs-replication-suitable-for-replicating-roaming-profiles"></a>Подходит ли репликация DFS для репликации перемещаемых профилей?

Да. При репликации перемещаемых профилей пользователей, поддерживаются определенные сценарии. Сведения о поддерживаемых сценариях см. в разделе [корпорации Майкрософт поддержки инструкции вокруг реплицированные данные профиля пользователя](http://go.microsoft.com/fwlink/?linkid=201282) (http://go.microsoft.com/fwlink/?LinkId=201282).

### <a name="is-there-a-file-character-limit-or-limit-to-the-folder-depth"></a>Есть ли количество знаков в файл или ограничение на глубину папку?

Windows и репликация DFS поддерживают пути к папкам с до 32 тысячи символов. Репликация DFS не ограничивается пути к папкам 260 символов.

### <a name="must-members-of-a-replication-group-reside-in-the-same-domain"></a>Члены группы репликации находиться в одном домене?

Нет. Групп репликации могут охватывать нескольких доменах в рамках одного леса, но не в разных лесах.

### <a name="what-are-the-supported-limits-of-dfs-replication"></a>Каковы ограничения на поддерживаемые репликации DFS?

Ниже приведены набор рекомендаций по масштабируемости, которые были протестированы корпорацией Майкрософт в Windows Server 2012 R2.

  - Размер всех реплицированных файлов на сервере: 100 ТБ.  
      
  - Число реплицируемых файлов на томе: 70 млн.  
      
  - Максимальный размер файла: 250 ГБ.  
      


> [!IMPORTANT]
> При создании групп репликации с большим числом или размера файлов рекомендуется экспорте клона базы данных и с помощью предварительно заполнения методов, чтобы свести к минимуму продолжительность начальной репликации. Дополнительные сведения см. в разделе <A href="http://blogs.technet.com/b/filecab/archive/2013/08/21/dfs-replication-initial-sync-in-windows-server-2012-r2-attack-of-the-clones.aspx">начальной синхронизации репликация DFS в Windows Server 2012 R2: Атака клонов</A>. 
<br>


Ниже приведены набор рекомендаций по масштабируемости, которые были протестированы корпорацией Майкрософт в Windows Server 2012, Windows Server 2008 R2 и Windows Server 2008.

  - Размер всех реплицированных файлов на сервере: 10 терабайт.  
      
  - Число реплицируемых файлов на томе: 11 миллионов.  
      
  - Максимальный размер файла: 64 ГБ.  
      


> [!NOTE]
> Больше не существует ограничение на количество групп репликации, реплицированных папок, подключений или членов группы репликации. 
<br>


Список рекомендаций по масштабируемости, корпорацией Microsoft для Windows Server 2003 R2, см. в разделе [рекомендации по масштабируемости репликации DFS](http://go.microsoft.com/fwlink/?linkid=75043) (http://go.microsoft.com/fwlink/?LinkId=75043).

### <a name="when-should-i-not-use-dfs-replication"></a>Если не использовать репликацию DFS?

Не используйте репликации DFS в среде, где несколько пользователей, обновить или изменить те же файлы одновременно на разных серверах. Это может привести к репликации DFS для перемещения копий конфликтующих файлов в скрытые DfsrPrivate\\ConflictandDeleted папки.

Когда несколько пользователей, которые нужно изменить те же файлы в то же время на разных серверах, используйте функции извлечения файлов служб Windows SharePoint Services, чтобы убедиться, что только один пользователь работает с файлом. Windows SharePoint Services 2.0 с пакетом обновления 2 доступна как часть Windows Server 2003 R2. Windows SharePoint Services можно загрузить с веб-узла Майкрософт; оно не указано в более новых версиях Windows Server.

### <a name="why-is-a-schema-update-required-for-dfs-replication"></a>Почему такое обновление схемы, необходимой для репликации DFS

Репликация DFS использует новые объекты в контексте именования домена доменных служб Active Directory для хранения сведений о конфигурации. Эти объекты создаются при обновлении схемы доменных служб Active Directory. Дополнительные сведения см. в разделе [Проверка требований для репликации DFS](http://go.microsoft.com/fwlink/?linkid=182264) (http://go.microsoft.com/fwlink/?LinkId=182264).

## <a name="monitoring-and-management-tools"></a>Средства мониторинга и управления

### <a name="can-i-automate-the-health-report-to-receive-warnings"></a>Можно ли автоматизировать отчет о работоспособности для получения предупреждения?

Да. Существует три способа для автоматизации отчеты о работоспособности:

  - Используйте модуль DFSR Windows PowerShell, включенные в Windows Server 2012 R2 или DfsrAdmin.exe в сочетании с помощью планировщика заданий для регулярного создания отчетов о работоспособности. Дополнительные сведения см. в разделе [автоматизация отчеты о работоспособности репликации DFS](http://go.microsoft.com/fwlink/?linkid=74010) (http://go.microsoft.com/fwlink/?LinkId=74010).  
      
  - Используйте пакет управления репликации DFS для System Center Operations Manager для создания оповещений, с учетом заданных условий.  
      
  - Используйте поставщик WMI репликации DFS скриптов предупреждений.  
      

### <a name="can-i-use-microsoft-system-center-operations-manager-to-monitor-dfs-replication"></a>Можно использовать Microsoft System Center Operations Manager для наблюдения за репликацией DFS?

Да. Дополнительные сведения см. в разделе [пакет управления репликации DFS для System Center Operations Manager 2007](http://go.microsoft.com/fwlink/?linkid=182265) в центре загрузки Майкрософт (http://go.microsoft.com/fwlink/?LinkId=182265).

### <a name="does-dfs-replication-support-remote-management"></a>Служба репликации DFS поддерживает удаленное управление?

Да. Служба репликации DFS поддерживает удаленное управление с помощью консоли управления DFS и **Добавление группы репликации** команды. Например на сервере А, сможет подключиться к репликации группы, определенной в лес с серверов A и B в качестве членов.

Управление DFS входит в состав Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2, Windows Server 2008 и Windows Server 2003 R2. Для управления репликацией DFS от других версий Windows, использовать удаленный рабочий стол или [удаленного средства администрирования сервера для Windows 7](https://technet.microsoft.com/library/Ee449475).


> [!IMPORTANT]
> Для просмотра или управления группами репликации, которые содержат реплицированные папки только для чтения или члены, которые являются отказоустойчивых кластеров, необходимо использовать версию управления DFS, которая входит в состав Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2, <a href="http://go.microsoft.com/fwlink/p/?linkid=238560">Средства удаленного администрирования сервера для Windows 8</a>, или <a href="https://technet.microsoft.com/library/ee449475">средства удаленного администрирования сервера для Windows 7</a>. 
<br>


### <a name="do-ultrasound-and-sonar-work-with-dfs-replication"></a>Средство Ultrasound и Sonar работают с репликацией DFS?

Нет. Репликация DFS имеет свой собственный набор средств мониторинга и диагностики. Средство Ultrasound и Sonar доступны только мониторинга FRS.

### <a name="how-can-files-be-recovered-from-the-conflictanddeleted-or-preexisting-folders"></a>Как можно восстановить файлы из папок ConflictAndDeleted и PreExisting?

Для восстановления утраченных файлов, восстановите файлы из папки в файловой системе или общую папку, с помощью файла журнала, **восстановить предыдущие версии** команду в проводнике или путем восстановления файлов из резервной копии. Чтобы восстановить файлы непосредственно из папок ConflictAndDeleted и PreExisting, используйте `Get-DfsrPreservedFiles` и `Restore-DfsrPreservedFiles` (входит в состав модуля DFSR в Windows Server 2012 R2), командлеты Windows PowerShell или [RestoreDFSR](http://code.msdn.microsoft.com/restoredfsr) пример скрипта из коллекции кода MSDN. Этот сценарий предназначен только для аварийного восстановления и предоставляется AS-есть, без гарантии.

### <a name="is-there-a-way-to-know-the-state-of-replication"></a>Есть ли способ узнать состояние репликации?

Да. Существует ряд способов для наблюдения за репликацией.

  - Репликация DFS имеет пакета управления для System Center Operations Manager, который обеспечивает упреждающий мониторинг.  
      
  - Управление DFS имеет диагностический отчет в поле для невыполненной работы по репликации, эффективности репликации и количество файлов и папок в группе данной репликации.  
      
  - Модуль DFSR Windows PowerShell в Windows Server 2012 R2 содержит командлеты для запуска тестов распространения и записи распространения и отчеты о работоспособности. Дополнительные сведения см. в разделе [распределенных файлов системы репликации командлетов в Windows PowerShell](https://technet.microsoft.com/library/dn296601.aspx).  
      
  - Dfsrdiag.exe является средством командной строки, которое может создать счетчик невыполненной работы или триггер проверки распространения. В обоих отчетах отображаются состояние репликации. Распространение рассказывается о том, если файлы реплицируются на все узлы. Невыполненная работа рассказывается о том, сколько файлов по-прежнему требуется реплицировать, прежде чем два компьютера находятся в синхронизированном. Счетчик невыполненной работы — количество обновлений, которые не выполнил обработку члена группы репликации. На компьютерах под управлением Windows Server 2012 R2, Windows Server 2012 или Windows Server 2008 R2 Dfsrdiag.exe можно также отобразить обновления, которые служба репликации DFS сейчас реплицируются.  
      
  - Скрипты можно использовать инструментарий WMI для сбора сведений невыполненной работы — вручную или с помощью MOM.  
      

## <a name="performance"></a>Производительность

### <a name="does-dfs-replication-support-dial-up-connections"></a>Служба репликации DFS поддерживает подключения удаленного доступа?

Несмотря на то, что служба репликации DFS будет работать со скоростью удаленного доступа, его можно получить задержке при наличии большого количества изменений для репликации. Если небольших изменений в существующие файлы, репликации DFS с удаленное разностное сжатие (RDC) обеспечит более высокую производительность, чем копирование файла напрямую.

### <a name="does-dfs-replication-perform-bandwidth-sensing"></a>Репликация DFS выполняет предусмотренная пропускной способности?

Нет. Репликация DFS не выполняет проверки пропускной способности. Вы можете настроить репликацию DFS для использования ограниченный объем пропускной способности на соединению (регулирование полосы пропускания). Тем не менее, репликация DFS не еще больше сократить использование пропускной способности, если сетевой интерфейс переполняется, и репликация DFS могут насытить ссылку для коротких промежутков времени. Полосы пропускания с помощью репликации DFS не вполне точной, так как репликация DFS регулирует пропускную способность по регулирования вызовы RPC. В результате различные буферы на нижних уровнях сетевого стека (включая безопасный RPC) может помешать, вызывая внезапно возникающего сетевого трафика.

### <a name="does-dfs-replication-throttle-bandwidth-per-schedule-per-server-or-per-connection"></a>Репликации DFS регулировать пропускную способность по расписанию, на каждом сервере или на соединение?

Если настроить регулирование полосы пропускания при задании расписания, все подключения для этой группы репликации будет использовать этот параметр для регулирования пропускной способности. Регулирование полосы пропускания можно также задать в качестве параметра уровня соединения с использованием "Управление DFS".

### <a name="does-dfs-replication-use-active-directory-domain-services-to-calculate-site-links-and-connection-costs"></a>Используется ли репликация DFS доменных служб Active Directory для вычисления связей сайтов и затраты на подключение?

Нет. Репликация DFS использует топологию, определенных администратором, который не зависит от оценки затрат сайта доменных служб Active Directory.

### <a name="how-can-i-improve-replication-performance"></a>Как можно повысить производительность репликации?

Дополнительные сведения о различных методов оптимизации производительности репликации, см. в разделе [помощник по настройке производительности репликации в DFSR](http://blogs.technet.com/b/askds/archive/2010/03/31/tuning-replication-performance-in-dfsr-especially-on-win2008-r2.aspx) на [попросите блог команды разработчиков служб каталогов](http://blogs.technet.com/b/askds/).

### <a name="how-does-dfs-replication-avoid-saturating-a-connection"></a>Как репликация DFS избежать перегрузки подключение?

В репликации DFS, можно задать максимальную пропускную способность, которую вы хотите использовать для подключения, а служба поддерживает этот уровень использования сети. Это отличается от фоновой интеллектуальной передачи Service (BITS) и репликации DFS не насытить соединения, если настроить ее соответствующим образом.

Тем не менее регулирование полосы пропускания не является абсолютной, и репликация DFS могут насытить ссылку на короткое время. Это обусловлено репликации DFS регулирует пропускную способность по регулирования вызовы RPC. Так как этот процесс основан на различные буферы на нижних уровнях сетевого стека, в том числе RPC, трафик репликации обычно передаются в пиковые нагрузки, которые в некоторых случаях могут насытить сетевые соединения.

Репликация DFS в Windows Server 2008 включает в себя несколько улучшений производительности, как описано в [распределенной файловой системы](https://technet.microsoft.com/library/Cc753479), раздел в [изменение функциональности от Windows Server 2003 с пакетом обновления 1 для Windows Server 2008](https://technet.microsoft.com/library/cc753208).

### <a name="how-does-dfs-replication-performance-compare-with-frs"></a>Как производительность репликации DFS соотносятся с FRS?

Репликация DFS — намного быстрее, чем FRS, особенно при небольших изменений для больших файлов и включено удаленное разностное СЖАТИЕ. Например, с RDC, небольшое изменение в презентацию MB PowerPoint® 2 может привести только 60 килобайт (КБ, отправляемые по сети) — это экономия до 97 процентов в байтов, переданных.

RDC не используется для файлов размером менее 64 КБ, может оказаться полезным в локальных сетях высокоскоростной где пропускная способность сети не состязаний. RDC можно отключить для каждого подключения с помощью "Управление DFS".

### <a name="how-frequently-does-dfs-replication-replicate-data"></a>Как часто репликации DFS реплицировать данные?

Данные реплицируются согласно заданному расписанию. Например можно присвоить расписание 15-минутных интервалов, семь дней в неделю. Во время этих интервалов включена репликация. Репликация начинается сразу после обнаружено изменение файла (обычно за несколько секунд).

Расписание группы репликации может быть задан по времени координировать (UTC), пока расписание подключения имеет значение местного времени принимающего члена. Учитывать это при репликации группы распространяется на разных часовых поясов. Местное время означает время члена размещение входящее подключение. Отображается расписание входящее подключение и соответствующие исходящее подключение отражают различия между часовыми поясами расписание, настроенное в местное время.

### <a name="how-much-of-my-servers-system-resources-will-dfs-replication-consume"></a>Какой объем системных ресурсов сервера будет потреблять репликации DFS?

Диска, памяти и ресурсов ЦП, используемые репликацией DFS зависит от нескольких факторов, включая число и размер файлов, скорость изменения, число членов группы репликации и число реплицируемых папок. Кроме того некоторые ресурсы, довольно сложно оценить. Например технология расширенного обработчика хранилищ (ESE), используемые в базе данных репликации DFS может использовать большой процент доступной памяти, освободив его по запросу. Приложения, за исключением репликации DFS может размещаться на одном сервере в зависимости от конфигурации сервера. Тем не менее при размещении нескольких приложений или ролей сервера на одном сервере, важно проверить этой конфигурации перед его внедрением в производственной среде.

### <a name="what-happens-if-a-wan-link-fails-during-replication"></a>Что произойдет, если во время репликации происходит сбой канала глобальной сети?

Если соединение выходит из строя, служба репликации DFS будет продолжать попытки репликации при открытом расписания. Также будет ошибки подключения, записанной в журнал событий репликации DFS, можно собирать с помощью MOM (заранее с помощью оповещения) и отчет о работоспособности репликации DFS (по факту, например, когда администратор выполняет его).

## <a name="remote-differential-compression-details"></a>Сведения о удаленного разностного сжатия

### <a name="are-changes-compressed-before-being-replicated"></a>Изменения сжимаются при репликации?

Да. Измененные части файлы сжимаются перед отправкой для всех типов, за исключением, следующий (который уже сжаты) файлов: .wma, .wmv, ZIP-файл, .jpg, .mpg, .mpeg, .m1v, .mp2, .mp3, .mpa, .cab, .wav, .snd, .au, .asf, .wm, .avi, .z, .gz, .tgz и .frx. Параметры сжатия для файлов этих типов не настраиваются через Windows Server 2003 R2.

### <a name="can-an-administrator-turn-off-rdc-or-change-the-threshold"></a>Отключите RDC администратора или изменить пороговое значение?

Да. RDC можно отключить на странице свойств данного соединения. Отключение RDC можно уменьшить ЦП задержки репликации и использования в наличии без ограничений пропускной способности каналов скоростных локальных сетях (LAN) или для групп репликации, которые состоят главным образом из файлов размером менее 64 КБ. Если вы решили отключить RDC на подключение, проверьте эффективность репликации до и после изменения, чтобы убедиться, что имеют улучшенную производительность репликации.

Можно изменить пороговое значение размера RDC с помощью **Dfsradmin соединение установлено** команды, поставщик WMI репликации DFS или путем редактирования XML-ФАЙЛ конфигурации файла.

### <a name="does-rdc-work-on-all-file-types"></a>Работает ли RDC на все типы файлов?

Да. RDC вычисляет различия на уровне блоков, независимо от типа данных файла. Тем не менее RDC работает более эффективно для файлов определенных типов, таких как документы Word, PST-файлов и образов виртуальных жестких ДИСКОВ.

### <a name="how-does-rdc-work-on-a-compressed-file"></a>Как работает RDC на сжатый файл?

Репликация DFS использует RDC, который вычисляет блоки в файле, которые были изменены и передает только блоки по сети. Репликация DFS не нужно знать ничего о содержимом файла — только какие блоки были изменены.

### <a name="is-cross-file-rdc-enabled-when-upgrading-to-windows-server-enterprise-edition-or-datacenter-edition"></a>Является перекрестного удаленного Разностного сжатия включен при обновлении до Windows Server Enterprise Edition или Datacenter Edition?

Стандартный выпусками Windows Server не поддерживают перекрестного удаленного Разностного сжатия. Тем не менее он включается автоматически при обновлении до выпуска, что поддерживает перекрестного удаленного Разностного сжатия, или членом подключения репликации работает под управлением поддерживаемого выпуска. Список выпусков, что поддержка перекрестного удаленного Разностного сжатия см. в разделе выпусках поддержка операционных систем Windows перекрестного удаленного Разностного сжатия?

### <a name="is-rdc-true-block-level-replication"></a>Такое RDC true блочные репликации?

Нет. RDC — это протокол общего назначения для сжатия передачу файлов. Репликация DFS использует RDC на блоки на уровне файлов, а не на уровне блоков диска. RDC файл разбивается на блоки. Для каждого блока в файле он вычисляет подписи, которая является небольшим числом байтов, которые могут представлять большего размера блока. Набор сигнатур передается с сервера клиенту. Клиент сравнивает свой собственный сервер сигнатур. Клиент затем запросы на сервер отправлять данные только для подписи, которые еще не на стороне клиента.

### <a name="what-happens-if-i-rename-a-file"></a>Что произойдет, если я переименую файл?

Репликация DFS переименовывает файл на все остальные члены группы репликации во время следующей репликации. Файлы, отслеживаемые использование уникального идентификатора, так что переименование файла и перемещение файла в реплике не влияет на способность репликации DFS для репликации в файл.

### <a name="what-is-cross-file-rdc"></a>Что является перекрестного удаленного Разностного сжатия?

Перекрестное RDC позволяет репликации DFS использовать RDC, даже в том случае, если файл с таким именем не существует на стороне клиента. Перекрестное RDC использует эвристику для определения файлов, которые похожи на файл, который нужно реплицировать, и использует блоки аналогичные файлы, которые совпадают с файл репликации, чтобы свести к минимуму объем данных, передаваемых по глобальной сети. Перекрестное Разностное можно использовать блоки до пяти аналогичных файлов в этом процессе.

Использование перекрестного удаленного Разностного сжатия, один член подключения репликации должен работать выпуск Windows, поддерживает перекрестного удаленного Разностного сжатия. Список выпусков, что поддержка перекрестного удаленного Разностного сжатия см. в разделе выпусках поддержка операционных систем Windows перекрестного удаленного Разностного сжатия?

### <a name="what-is-rdc"></a>Что такое RDC?

Удаленное разностное сжатие (RDC) — это протокол клиент сервер, который может использоваться эффективно обновлять файлы в сети с ограниченной пропускной способностью. Алгоритм RDC выявляет операций вставки, удаления и перераспределения данных в файлах, позволяя репликации DFS для репликации только изменения, при обновлении файлов. RDC используется только для файлов, которые являются 64 КБ или большего размера по умолчанию. RDC можно использовать более старую версию файла с тем же именем в реплицированной папке или в DfsrPrivate\\папок ConflictandDeleted (расположен по локальному пути реплицируемой папки).

### <a name="when-is-rdc-used-for-replication"></a>Когда RDC используется для репликации?

RDC используется в том случае, если файл превышает пороговое значение минимального размера. Это пороговое значение размера по умолчанию составляет 64 КБ. После превышения этого порога файл будет реплицирована, обновленные версии файла всегда использовать RDC, если большая часть файла изменяется или RDC отключен.

### <a name="which-editions-of-the-windows-operating-system-support-cross-file-rdc"></a>Какие выпуски поддержка операционных систем Windows перекрестного удаленного Разностного сжатия?

Использование перекрестного удаленного Разностного сжатия, один член подключения репликации необходимо использовать выпуск операционной системы Windows, поддерживает перекрестного удаленного Разностного сжатия. В следующей таблице показано, какие выпуски ОС Windows поддерживают перекрестного удаленного Разностного сжатия.

### <a name="cross-file-rdc-availability-in-editions-of-the-windows-operating-system"></a>Перекрестное доступности RDC в выпусках операционной системы Windows

<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Версия операционной системы</th>
<th>Standard Edition</th>
<th>Выпуск Enterprise</th>
<th>Datacenter Edition</th>
</tr>
</thead>
<tbody>
<tr class="even">
<td><p>Windows Server 2012 R2</p></td>
<td><p>Да<em></p></td>
<td><p>Недоступно</p></td>
<td><p>Да</em></p></td>
</tr>
<tr class="odd">
<td><p>Windows Server 2012</p></td>
<td><p>Да</p></td>
<td><p>Недоступно</p></td>
<td><p>Да</p></td>
</tr>
<tr class="even">
<td><p>Windows Server 2008 R2</p></td>
<td><p>Нет</p></td>
<td><p>Да</p></td>
<td><p>Да</p></td>
</tr>
<tr class="odd">
<td><p>Windows Server 2008</p></td>
<td><p>Нет</p></td>
<td><p>Да</p></td>
<td><p>Нет</p></td>
</tr>
<tr class="even">
<td><p>Windows Server 2003 R2</p></td>
<td><p>Нет</p></td>
<td><p>Да</p></td>
<td><p>Нет</p></td>
</tr>
</tbody>
</table>

\* При необходимости можно отключить перекрестное RDC в Windows Server 2012 R2.

## <a name="replication-details"></a>Сведения о репликации

### <a name="can-i-change-the-path-for-a-replicated-folder-after-it-is-created"></a>Можно изменить путь к реплицируемой папки после ее создания?

Нет. Если необходимо изменить путь к реплицируемой папке, необходимо удалить его в "Управление DFS" и добавьте его обратно в качестве новой реплицируемой папки. Затем служба репликации DFS использует удаленное разностное сжатие (RDC) для выполнения синхронизации, которое определяет, являются ли данные одинаковым на отправляющим и принимающим членами. Он не реплицирует все данные в папку еще раз.

### <a name="can-i-configure-which-file-attributes-are-replicated"></a>Можно ли настроить, какие атрибуты файла, реплицируются?

Нет, нельзя настроить, репликация DFS реплицирует атрибуты файла.

Список значений атрибутов и их описания, см. в разделе [атрибуты файла](http://go.microsoft.com/fwlink/?linkid=182268) на сайте MSDN (http://go.microsoft.com/fwlink/?LinkId=182268).

Следующие значения атрибутов задаются с помощью `SetFileAttributes dwFileAttributes` функции и они будут реплицироваться с помощью репликации DFS. Изменения значений этих атрибутов вызывают репликации атрибутов. Содержимое файла не реплицируются, только содержимое, а также изменения. Дополнительные сведения см. в разделе [функция SetFileAttributes](http://go.microsoft.com/fwlink/?linkid=182269) в библиотеке MSDN (http://go.microsoft.com/fwlink/?LinkId=182269).

  - ФАЙЛ\_АТРИБУТ\_HIDDEN  
      
  - ФАЙЛ\_АТРИБУТ\_ТОЛЬКО ДЛЯ ЧТЕНИЯ  
      
  - ФАЙЛ\_АТРИБУТ\_СИСТЕМЫ  
      
  - ФАЙЛ\_АТРИБУТ\_НЕ\_СОДЕРЖИМОГО\_ИНДЕКСОМ  
      
  - ФАЙЛ\_АТРИБУТ\_OFFLINE  
      

Следующие значения атрибутов будут реплицироваться с помощью репликации DFS, но они не запускают репликации.

  - ФАЙЛ\_АТРИБУТ\_АРХИВА  
      
  - ФАЙЛ\_АТРИБУТ\_НОРМ.  
      

Следующие значения атрибутов файла также запустить репликацию, несмотря на то, что не могут быть изменены с помощью `SetFileAttributes` функция (использовать `GetFileAttributes` функцию, чтобы просмотреть значения атрибутов).

  - ФАЙЛ\_АТРИБУТ\_ПОВТОРНОЙ ОБРАБОТКИ\_ТОЧКИ  
      

> [!NOTE]
> Репликация DFS не реплицирует значения атрибутов точки повторного анализа Если тег повторной обработки не IO_REPARSE_TAG_SYMLINK. Файлы с тегами повторного анализа IO_REPARSE_TAG_DEDUP, IO_REPARSE_TAG_SIS или IO_REPARSE_TAG_HSM реплицируются как обычные файлы. Тем не менее тег повторной обработки и буферов данных повторной обработки не реплицируются на другие серверы, так как объект точки повторной обработки работает только в локальной системе. 
<br>

  - ФАЙЛ\_АТРИБУТ\_СЖАТАЯ  
      
  - ФАЙЛ\_АТРИБУТ\_ENCRYPTED  
      

> [!NOTE]
> Репликация DFS не реплицирует файлы, зашифрованные с помощью шифрованной файловой системы (EFS). Репликация DFS реплицировать файлы, зашифрованные с помощью программного обеспечения сторонних разработчиков, но только в том случае, если значение атрибута FILE_ATTRIBUTE_ENCRYPTED в файле не установлен. 
<br>

  - ФАЙЛ\_АТРИБУТ\_SPARSE\_ФАЙЛА  
      
  - ФАЙЛ\_АТРИБУТ\_КАТАЛОГА  
      

Репликация DFS реплицирует ФАЙЛ\_АТРИБУТ\_временное значение.

### <a name="can-i-control-which-member-is-replicated"></a>Могу ли я контролировать, какие члены реплицируется?

Да. При создании группы репликации, можно выбрать топологию. Или можно выбрать **не топологии** и вручную настроить подключения после создания группы репликации.

### <a name="can-i-seed-a-replication-group-member-with-data-prior-to-the-initial-replication"></a>Можно заполнить группу репликации с помощью данных перед начальной репликации?

Да. Служба репликации DFS поддерживает копирование файлов для члена группы репликации перед начальной репликации. «Подготовка» значительно снижают объем данных, реплицируемых во время начальной репликации.

Начальная репликация не требуется репликация содержимого, когда файлы отличаются только реальных атрибуты или метки времени. Настоящий атрибут является атрибутом, который можно задать с помощью функции Win32 `SetFileAttributes`. Дополнительные сведения см. в разделе [функция SetFileAttributes](http://go.microsoft.com/fwlink/?linkid=182269) в библиотеке MSDN (http://go.microsoft.com/fwlink/?LinkId=182269). Если два файла отличаются от других атрибутов, например сжатие, содержимое файла реплицируются.

Предварительная настройка члена группы репликации, скопируйте файлы в соответствующую папку на серверы назначения, создайте группу репликации и затем выбрать основной член. Выберите элемент, который содержит самые последние версии файлов, которые требуется реплицировать, так как содержимое основного члена считается как «достоверное». Это означает, что во время начальной репликации файлы основного члена всегда перезаписывается другим версиям файлов на остальные члены группы репликации.

Сведения о предварительное заполнение и клонирование базы данных DFSR, см. в разделе [начальной синхронизации репликация DFS в Windows Server 2012 R2: Атака клонов](http://blogs.technet.com/b/filecab/archive/2013/08/21/dfs-replication-initial-sync-in-windows-server-2012-r2-attack-of-the-clones.aspx).

Дополнительные сведения о начальной репликации, см. в разделе [создайте группы репликации](https://technet.microsoft.com/library/cc725893).

### <a name="does-dfs-replication-overcome-common-file-replication-service-issues"></a>Репликации DFS преодолеть распространенные проблемы со службой репликации файлов?

Да. Служба репликации DFS, лишенный недостатков три распространенных проблем службы репликации файлов:

  - Усечение журнала: Вывод журнала в режиме реального времени восстановления после репликации DFS. Все существующие файлы и папки будут помечены как journalWrap и проверку в файловой системе, прежде чем снова включить репликацию. Во время восстановления этот том не доступен для репликации в любом направлении.  
      
  - Излишняя репликация: Чтобы предотвратить чрезмерное репликации, репликация DFS использует систему кредитов.  
      
  - Трансформированное папки: Во избежание имена трансформированное папок репликации DFS сохраняет конфликтующие данные в скрытых DfsrPrivate\\папок ConflictandDeleted (расположен по локальному пути реплицируемой папки). Например одновременно создать несколько папок с одинаковыми именами на разных серверах, реплицировать с помощью FRS вызывает FRS для переименования на более старые папки. Вместо этого репликации DFS перемещает на более старые папки в локальную папку конфликтов и удалений.  
      

### <a name="does-dfs-replication-replicate-files-in-chronological-order"></a>Репликация DFS и реплицировать файлы в хронологическом порядке?

Нет. Файлы могут реплицироваться в неправильном порядке.

### <a name="does-dfs-replication-replicate-files-that-are-being-used-by-another-application"></a>Репликации DFS репликации файлов, которые используются другим приложением?

Если приложение открывает файл и создает файл блокировку на нем (так как с ним используется другими приложениями, когда он открыт), репликация DFS не будут реплицированы файле до его закрытия. Если приложение открывает файл с чтения доступ к таким файлам, файл по-прежнему могут реплицироваться.

### <a name="does-dfs-replication-replicate-ntfs-file-permissions-alternate-data-streams-hard-links-and-reparse-points"></a>Репликации DFS реплицировать разрешения файлов NTFS, альтернативные потоки данных, жесткие связи и точки повторной обработки?

  - Репликация DFS реплицирует разрешения файлов NTFS и альтернативные потоки данных.  
      
  - Майкрософт не поддерживает создание NTFS жестких связей в или из файлов в реплицированной папке – это может вызвать проблемы репликации с затронутыми файлами. Файлы жесткой связи игнорируются по репликации DFS и репликация не выполняется. Точки соединения также не реплицируются, и репликация DFS записывает событие 4406 для каждой точки соединения, которыми он сталкивается.  
      
  - Только точки повторного анализа, реплицированный с помощью репликации DFS являются те, которые используют операции ввода-ВЫВОДА\_повторной ОБРАБОТКИ\_ТЕГА\_символьную ссылку на НЕГО тег; тем не менее, репликация DFS не гарантирует, что цель символьную ссылку, также реплицируются. Дополнительные сведения см. в разделе [попросите блог команды разработчиков служб каталогов](http://blogs.technet.com/b/askds/archive/2011/09/30/friday-mail-sack-super-slo-mo-edition.aspx).  
      
  - Файлов с помощью операций ввода-ВЫВОДА\_повторной ОБРАБОТКИ\_ТЕГА\_ДЕДУПЛИКАЦИИ, операции ввода-ВЫВОДА\_повторной ОБРАБОТКИ\_ТЕГА\_SIS или операций ввода-ВЫВОДА\_повторной ОБРАБОТКИ\_ТЕГА\_реплицируются теги HSM повторной обработки как обычные файлы. Тег повторной обработки и буферов данных повторной обработки не реплицируются на другие серверы, так как объект точки повторной обработки работает только в локальной системе. Таким образом репликация DFS может реплицировать папки на томах с использованием дедупликации данных в хранилище единственных копий (SIS) или Windows Server 2012, однако сведения о дедупликации данных, хранятся отдельно, когда каждый сервер, на котором включена служба роли.  
      

### <a name="does-dfs-replication-replicate-timestamp-changes-if-no-other-changes-are-made-to-the-file"></a>Репликации DFS реплицировать изменения отметки времени, если другие изменения не вносятся в файл?

Нет, служба репликации DFS не реплицирует файлы, для которых единственное изменение заключается в изменении метки времени. Кроме того измененные отметки времени не реплицируются с другими членами группы репликации, если другие изменения, внесенные в файл.

### <a name="does-dfs-replication-replicate-updated-permissions-on-a-file-or-folder"></a>Поддерживает ли служба репликации DFS реплицировать обновленные разрешения для файла или папки?

Да. Репликация DFS реплицирует изменения разрешений для файлов и папок. Реплицируются только часть файла, связанного с помощью списка управления доступом (ACL), несмотря на то, что служба репликации DFS по-прежнему необходимо считывать весь файл, в промежуточной области.


> [!NOTE]
> Изменения в списки доступа на большом числе файлов может повлиять на производительность репликации. Тем не менее при использовании RDC, объем переданных данных пропорционально размеру ACL, а не размер всего файла. Объем трафика диска обусловлено тем, по-прежнему пропорционален размеру файлов файлы должны быть считаны в и из промежуточной папки. 
<br>


### <a name="does-dfs-replication-support-merging-text-files-in-the-event-of-a-conflict"></a>Служба репликации DFS поддерживает слияние текстовых файлов в случае конфликта?

Репликация DFS не объединение файлов, когда возникает конфликт. Тем не менее, он пытается сохранить старую версию файла в скрытые DfsrPrivate\\ConflictandDeleted папку на компьютере, где был обнаружен конфликт.

### <a name="does-dfs-replication-use-encryption-when-transmitting-data"></a>Репликация DFS использует шифрование при передаче данных?

Да. Репликация DFS использует подключения удаленного вызова процедур (RPC) с шифрованием.

### <a name="is-it-possible-to-disable-the-use-of-encrypted-rpc"></a>Это можно отключить с помощью зашифрованного RPC?

Нет. Служба репликации DFS использует удаленные вызовы процедур (RPC) по протоколу TCP для репликации данных. Для защиты передачи данных через Интернет, служба репликации DFS позволяет всегда использовать константы уровня проверки подлинности, `RPC_C_AUTHN_LEVEL_PKT_PRIVACY`. Это гарантирует, что шифровать обмен данными RPC через Интернет. Таким образом не можно отключить с помощью зашифрованного RPC, служба репликации DFS.

Дополнительные сведения см. в разделе следующих веб-сайтах Microsoft:

  - [Технический справочник по RPC](http://go.microsoft.com/fwlink/?linkid=182278)  
      
  - [О удаленное разностное сжатие](http://go.microsoft.com/fwlink/?linkid=182279)  
      
  - [Константы уровня проверки подлинности](http://go.microsoft.com/fwlink/?linkid=182280)  
      

### <a name="how-are-simultaneous-replications-handled"></a>Способ обработки одновременных репликации?

Имеется один диспетчер обновлений в реплицированной папке. Обновление работы диспетчеры независимо друг от друга.

По умолчанию максимальное значение — 16 (четыре в Windows Server 2003 R2) одновременных сеансов загрузки для являются общими для всех подключений и группы репликации. Поскольку подключения и обновления группы репликации не сериализуются, нет без определенного порядка, в которой обновления применяются. Если открыты два расписания, обычно получения и установки обновлений из обоих типов подключений в то же время.

### <a name="how-do-i-force-replication-or-polling"></a>Как заставить репликации или опроса?

Вы может запускать принудительную репликацию сразу же с помощью консоли управления DFS, как описано в разделе [изменение расписаний репликации](https://technet.microsoft.com/library/Cc732278). Можно также принудительно репликации с помощью `Sync-DfsReplicationGroup` командлетов, включенных в модуль DFSR PowerShell, представленные в Windows Server 2012 R2 или **Dfsrdiag SyncNow** команды. Можно принудительно опроса, используя `Update-DfsrConfigurationFromAD` командлета, или **Dfsrdiag PollAD** команды.

### <a name="is-it-possible-to-configure-a-quiet-time-between-replications-for-files-that-change-frequently"></a>Это можно настроить автоматический время между репликациями для файлов, которые часто изменяются?

Нет. Если расписание не открыто, репликация DFS реплицирует изменения как заметит, что их. Нет способа для настройки quiet времени для файлов.

### <a name="is-it-possible-to-configure-one-way-replication-with-dfs-replication"></a>Это можно настроить одностороннюю репликацию с репликацией DFS?

Да. Если вы используете Windows Server 2012 или Windows Server 2008 R2, можно создать реплицированной папки только для чтения, который копирует содержимое через соединение одностороннего. Дополнительные сведения см. в разделе [сделать только для чтения папку реплицируются на определенного члена](http://go.microsoft.com/fwlink/?linkid=156740) (http://go.microsoft.com/fwlink/?LinkId=156740).

Мы не поддерживаем Создание одностороннего подключения репликации с помощью репликации DFS в Windows Server 2008 или Windows Server 2003 R2. Это может вызвать множество проблем, включая ошибки проверки работоспособности топологии, промежуточные проблемы и проблемы с базой данных репликации DFS.

Если вы используете Windows Server 2008 или Windows Server 2003 R2, можно имитировать соединение одностороннего, выполнив следующие действия:

  - Обучение администраторов, чтобы внести изменения только на серверах, на который вы хотите назначить в качестве серверов-источников. Затем позвольте изменениям реплицироваться на конечных серверах.  
      
  - Настройте разрешения общей папки на конечных серверах, так что конечные пользователи будут иметь разрешения на запись. Если изменения не разрешены на серверы подразделения, нет ничего для репликации, а затем имитация соединение одностороннего и при низких использование глобальной сети.  
      

### <a name="is-there-a-way-to-force-a-complete-replication-of-all-files-including-unchanged-files"></a>Есть ли способ принудительного завершения репликации всех файлов, включая неизмененные файлы?

Нет. Если служба репликации DFS считает, что файлы идентичны, не может реплицировать их. Если измененные файлы не были реплицированы, служба репликации DFS автоматически реплицирует их, когда настроены соответствующим образом. Чтобы перезаписать настроенному расписанию, используйте метод WMI **ForceReplicate()** . Тем не менее, это только переопределить расписание, и его не репликацию без изменений или идентичные файлы.

### <a name="what-happens-if-the-primary-member-suffers-a-database-loss-during-initial-replication"></a>Что произойдет, если основной член какой-то причине потери базы данных во время начальной репликации?

Во время начальной репликации файлы основного члена будут всегда имеют приоритет разрешения конфликтов, которая возникает, если принимающие члены содержат различные версии файлов в основном члене. Назначение основного члена хранится в доменных службах Active Directory и назначение пространства имен очищается после основного члена готов для репликации, но до все члены репликации группы репликации.

Если происходит сбой начальной репликации или перезапуска службы репликации DFS во время репликации, основного члена увидит назначение основного члена в локальную базу данных репликации DFS и повторяет начальной репликации. Если базы данных репликации DFS основного члена теряется, отмените назначение основного пространства имен в доменных службах Active Directory, но перед всеми членами группы репликации выполнения начальной репликации, не все члены группы репликации репликации папки, так как сервер не используется в качестве основного члена. В этом случае используйте **членства Dfsradmin/set /isprimary:true** команду на сервере основного члена вручную восстановить назначение основного члена.

Дополнительные сведения о начальной репликации, см. в разделе [создайте группы репликации](https://technet.microsoft.com/library/cc725893).


> [!WARNING]
> Назначение основного члена используется только во время начальной репликации. Если вы используете <STRONG>Dfsradmin</STRONG> команду, чтобы указать основной член для реплицированной папки после репликации будет завершена, репликация DFS не назначить сервер в качестве основного члена в доменных службах Active Directory. Тем не менее если базы данных репликации DFS на сервере впоследствии страдает необратимые повреждения или потери данных, сервер пытается выполнить начальную репликацию в основном члене вместо восстановления его данных из другой член репликации Группа. По сути сервер станет незаконных сервер-источник, который может приводить к конфликтам. По этой причине укажите основного члена вручную, только если уверены, что начальная репликация не удалось безвозвратно. 
<br>


### <a name="what-happens-if-the-replication-schedule-closes-while-a-file-is-being-replicated"></a>Что произойдет, если расписание репликации закрывается, а файл проходит репликацию?

Если удаленное разностное сжатие (RDC) включен в соединении, входящего трафика репликации файлов размером более 64 КБ, начинающийся непосредственно перед закрывающим расписание репликации (или ее изменение **не пропускной способности**) по-прежнему при запланировать откроется (или что-то отличное от изменения **не пропускной способности**). Репликация продолжается с состоянию, в котором она находилась на момент репликация остановлена.

Если RDC окажется выключен, репликация DFS полностью перезапускает передачи файла. Это может быть отложено, если файл доступен в принимающем члене.

### <a name="what-happens-when-two-users-simultaneously-update-the-same-file-on-different-servers"></a>Что происходит при одновременном обновлении тот же файл, на разных серверах?

При репликации DFS обнаруживает конфликт, он использует версию файла, который был сохранен последнего. Она перемещает другого файла в DfsrPrivate\\папок ConflictandDeleted (по локальному пути реплицируемой папки на компьютере, который разрешил конфликт). Остается там до конфликтов и удалений очистку папки, которая происходит, когда в папку конфликтов и удалений превышает заданный размер или репликации DFS возникает ошибка дискового пространства. В папку конфликтов и удалений не реплицируются, и этот метод разрешения конфликтов помогает избежать проблемы трансформированное каталогов, который был возможен в службе репликации.

При возникновении конфликта, репликация DFS регистрирует информационное событие в журнал событий репликации DFS. Это событие не требуют вмешательства пользователя по следующим причинам:

  - Он не отображается для пользователей (видны только администраторам сервера).  
      
  - Служба репликации DFS в папку конфликтов и удалений считает кэша. При достижении порогового значения квоты, она удаляет некоторые из этих файлов. Нет никакой гарантии, что конфликтующие файлы будут сохранены.  
      
  - Конфликт может находиться на сервере, отличном от источник конфликта.  
      

## <a name="staging"></a>Поэтапное создание

### <a name="does-dfs-replication-continue-staging-files-when-replication-is-disabled-by-a-schedule-or-bandwidth-throttling-quota-or-when-a-connection-is-manually-disabled"></a>Репликация DFS продолжить промежуточных файлов, при отключении репликации по расписанию или по регулирования Квота пропускной способности или при отключении подключения вручную?

Нет. Репликация DFS не выполняет промежуточные файлы за пределами время запланированной репликации, если была превышена квота регулирования пропускной способности или при отключении подключения.

### <a name="does-dfs-replication-prevent-other-applications-from-accessing-a-file-during-staging"></a>Влияет ли репликация DFS других приложений доступа к файлу во время промежуточного хранения?

Нет. Репликация DFS открывает файлы в виде, не блокирует пользователям или приложениям открывать файлы в папке «репликация». Этот метод называется «нежесткие блокировки применялись.»

### <a name="is-it-possible-to-change-the-location-of-the-staging-folder-with-the-dfs-management-tool"></a>Это можно изменить расположение промежуточной папки с помощью средства управления DFS?

Да. Расположение промежуточной папки настроено на **Дополнительно** вкладке **свойства** диалоговое окно для каждого члена группы репликации.

### <a name="when-are-files-staged"></a>Когда размещены файлы?

Файлы размещены на отправляющего члена, когда принимающего члена запрашивает файл (если только файл составляет 64 КБ или меньше) как показано в следующей таблице. При отключении удаленное разностное сжатие (RDC) для подключения будет выполнено промежуточное сохранение файла применяется в 256 КБ или меньше. Файлы также размещены на принимающего члена, как они будут перенесены при размер, меньше 64 КБ, несмотря на то, что можно настроить этот параметр, от 16 КБ до 1 МБ. Если расписание закрыт, файлы не выполняется промежуточное сохранение.

### <a name="the-minimum-file-sizes-for-staging-files"></a>Минимальные размеры для промежуточных файлов

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>RDC включена</th>
<th>RDC отключена</th>
</tr>
</thead>
<tbody>
<tr class="even">
<td><p>Отправляющего члена</p></td>
<td><p>64 КБ</p></td>
<td><p>256 КБ</p></td>
</tr>
<tr class="odd">
<td><p>Принимающего члена</p></td>
<td><p>64 КБ, по умолчанию</p></td>
<td><p>64 КБ, по умолчанию</p></td>
</tr>
</tbody>
</table>

### <a name="what-happens-if-a-file-is-changed-after-it-is-staged-but-before-it-is-completely-transmitted-to-the-remote-site"></a>Что произойдет, если файл изменяется после его на промежуточное хранение, но до полностью передаются на удаленный сайт?

Если уже передается любую часть файла, репликация DFS продолжает передачу. Если файл изменяется, перед началом репликации DFS передачи файла, будет отправлено новой версии файла.

## <a name="change-history"></a>История изменений


<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th>Date</th>
<th>Описание</th>
<th>`Reason`</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>15 ноября 2018 г.</p></td>
<td><p>Обновление для Windows Server 2019 г.</p></td>
<td><p>Новую операционную систему.</p></td>
</tr>
<tr class="even">
<td><p>9 октября 2013 г.</p></td>
<td><p>Обновить, каковы ограничения на поддерживаемые для репликации DFS? раздел с результаты тестов в Windows Server 2012 R2.</p></td>
<td><p>Обновления для последней версии Windows Server</p></td>
</tr>
<tr class="odd">
<td><p>30 января 2013</p></td>
<td><p>Добавлены репликации DFS Does по-прежнему промежуточных файлов, при отключении репликации по расписанию или по регулирования Квота пропускной способности или при отключении подключения вручную? запись.</p></td>
<td><p>Вопросы клиентов</p></td>
</tr>
<tr class="even">
<td><p>31 октября 2012 г.</p></td>
<td><p>Редактировать, каковы ограничения на поддерживаемые для репликации DFS? запись, чтобы увеличить протестированных число реплицируемых файлов на томе.</p></td>
<td><p>Отзывы пользователей</p></td>
</tr>
<tr class="odd">
<td><p>15 августа 2012 г.</p></td>
<td><p>Измененный файлов разрешения, альтернативные потоки данных, жесткие связи NTFS реплицировать Does репликации DFS и точки повторного анализа? точки входа для дополнительного уточнения, как служба репликации DFS обрабатывает жестких связей и повторной обработки.</p></td>
<td><p>Отзыв от службы поддержки пользователей</p></td>
</tr>
<tr class="even">
<td><p>13 июня 2012 г.</p></td>
<td><p>Изменить работу Does репликации DFS на ReFS или FAT? записи, которую необходимо добавить описание ссылки.</p></td>
<td><p>Отзывы пользователей</p></td>
</tr>
<tr class="odd">
<td><p>25 апреля 2012 г.</p></td>
<td><p>Измененный файлов разрешения, альтернативные потоки данных, жесткие связи NTFS реплицировать Does репликации DFS и точки повторного анализа? запись, чтобы прояснить, как служба репликации DFS обрабатывает жестких связей.</p></td>
<td><p>Избежать потенциальных проблем</p></td>
</tr>
<tr class="even">
<td><p>30 марта 2011 г.</p></td>
<td><p>Редактировать репликацию DFS можно реплицировать .pst Outlook или файлов базы данных Microsoft Office Access? запись, чтобы устранить возможные последствия с помощью репликации DFS с PST и доступа к файлам.</p>
<p>Добавлена как можно повысить производительность репликации?</p></td>
<td><p>Вопросы клиентов о предыдущей записи, который неправильно указано, что репликация или доступа к файлам PST может повредить базу данных репликации DFS.</p></td>
</tr>
<tr class="odd">
<td><p>26 января 2011 г.</p></td>
<td><p>Добавлена как можно восстановить файлы из ConflictAndDeleted или существующий папок?</p></td>
<td><p>Отзывы пользователей</p></td>
</tr>
<tr class="even">
<td><p>20 октября 2010 г.</p></td>
<td><p>Добавить как обновить или заменить член репликации DFS?</p></td>
<td><p>Отзывы пользователей</p></td>
</tr>
</tbody>
</table>

