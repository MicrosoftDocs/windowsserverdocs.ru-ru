---
title: Создание шаблона квоты
description: В этой статье описывается процесс создания шаблона квоты для определения ограничения пространства хранилища
ms.date: 7/7/2017
ms.prod: windows-server-threshold
ms.technology: storage
ms.topic: article
author: JasonGerend
manager: brianlic
ms.author: jgerend
ms.openlocfilehash: f74382c4a5e2c0a8636edbd4f9cfe2227cd6334a
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59875875"
---
# <a name="create-a-quota-template"></a>Создание шаблона квоты

> Относится к: Windows Server (полугодовой канал), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2

*Шаблон квоты* определяет ограничение пространства, тип квоты (жесткая или мягкая) и (необязательно) набор уведомлений, создаваемых автоматически, когда использование квоты достигнет определенных пороговых уровней.

Создавая квоты исключительно на основе шаблонов, можно централизованно управлять квотами путем обновления шаблонов вместо репликации изменений в каждой квоте. Данная возможность упрощает реализацию изменений политики хранения за счет централизованного обновления.

## <a name="to-create-a-quota-template"></a>Чтобы создать шаблон квоты, выполните приведенные ниже действия.

1.  В окне **Управление квотами** щелкните узел **Шаблоны квот**.

2.  Щелкните **Шаблоны квот** правой кнопкой мыши, а затем выберите команду **Создать шаблон квоты** (или выберите **Создать шаблон квоты** на панели **Действия**). Откроется диалоговое окно **Создание шаблона квоты**.

3.  Если требуется скопировать свойства существующего шаблона, чтобы использовать их в качестве основы для нового шаблона, выберите шаблон в раскрывающемся списке **Скопировать свойства из шаблона квоты**. Затем нажмите кнопку **Копировать**.

    Независимо от стоящей задачи — использование свойств существующего шаблона или создание нового шаблона — измените или установите следующие значения на вкладке **Параметры**:

4.  В текстовом поле **Имя шаблона** введите имя нового шаблона.

5.  В текстовом поле **Метка** введите необязательную описательную метку, которая будет отображаться рядом с квотами, созданными на основе данного шаблона.

6.  В разделе **Предел используемого пространства** выполните указанные ниже действия.

    -   В текстовом поле **Предел** введите число и выберите единицу измерения (КБ, МБ, ГБ или ТБ), чтобы задать ограничение пространства для квоты.
    -   Выберите параметр **Жесткая квота** или **Мягкая квота**. (Жесткая квота запрещает сохранение файлов после достижения установленного ограничения пространства и создает уведомления, когда объем данных достигает настроенного порогового значения. Мягкая квота не применяет квоту принудительно, но создает все настроенные уведомления).

7.  Для шаблона квоты можно настроить одно или несколько дополнительных уведомлений о достижении порога, как описано в следующей процедуре. После выбора всех свойств шаблона квоты, которые требуется использовать, нажмите кнопку **ОК**, чтобы сохранить шаблон.

## <a name="setting-optional-notification-thresholds"></a>Настройка необязательных пороговых значений уведомлений

Когда пространство хранилища в томе или папке достигает заданного вами предела, диспетчер ресурсов файлового сервера может отправить сообщение электронной почты администраторам или отдельным пользователям, зарегистрировать событие в журнале, выполнить команду или сценарий, или создать отчет. Можно настроить более одного типа уведомлений для каждого порога. Кроме того, можно задать несколько порогов для любой квоты (или шаблона квоты). По умолчанию уведомления не создаются.

Например, можно настроить пороговые значения, при достижении которых будет осуществляться отправка сообщения электронной почты администратору и пользователям, которым необходимо знать, когда предел квоты папки достигнет 85 процентов, а затем отправить еще одно уведомление по достижении квотой максимального предела. Кроме того, может потребоваться запустить сценарий, который использует команду **dirquota.exe** для автоматического увеличения предела квоты при достижении порогового значения.

> [!Important]
> Для отправки уведомлений по электронной почте и настройки отчетов хранилищ с параметрами, которые подходят для вашей серверной среды, необходимо сначала настроить общие параметры диспетчера ресурсов файлового сервера. Подробную информацию см. в разделе [Настройка параметров диспетчера ресурсов файлового сервера](setting-file-server-resource-manager-options.md).

**Чтобы настроить уведомления, которые создадут диспетчер ресурсов файлового сервера на пороговое значение квоты**

1.  В диалоговом окне **Создание шаблона квоты** в разделе **Пороговые значения для уведомлений** нажмите кнопку **Добавить** . Откроется диалоговое окно **Добавление порогового значения**.

2.  Чтобы задать предел квоты в процентном выражении, по достижении которого будут формироваться уведомления, выполните следующие действия.

    В текстовом поле **Создавать уведомления при достижении уровня (%)** введите предел квоты в процентах в качестве порогового значения для формирования уведомлений. (Первый уведомлений пороговое процентное значение по умолчанию — 85 процентов).

3.  Настройка уведомлений по электронной почте.

    На вкладке **Сообщения электронной почты** задайте следующие параметры:

    -   Чтобы администраторы получали уведомление при достижении порогового значения, установите флажок **Отправить сообщение электронной почты следующим администраторам**, а затем введите имена учетных записей администраторов, которые будут получать уведомления. Используйте формат *account@domain*, а несколько учетных записей разделяйте точкой с запятой.
    -   Для отправки электронного сообщения пользователю, в результате сохранения файла которым был достигнут порог квоты, установите флажок **Отправлять сообщения пользователям, превысившим порог**.
    -   Чтобы настроить сообщение, измените тему по умолчанию и текст сообщения. Текст в квадратных скобках вставляет данные переменных о событии квоты, вызвавшем формирование уведомления. Например **\[владелец источника ввода-вывода\]** переменная вставляет имя пользователя, который сохранен файл, который достиг предела квоты. Чтобы добавить дополнительные переменные в текст, нажмите кнопку **Вставить переменную**.
    -   Чтобы настроить дополнительные заголовки (включая "Копия", "Скрытая копия" и "Ответ на адрес:"), нажмите **Дополнительные заголовки сообщений**.

4.  Чтобы зарегистрировать событие, выполните следующие действия:

    На вкладке **Журнал событий** установите флажок **Записывать предупреждения в журнал** и измените запись журнала по умолчанию.

5.  Запуск команды или сценария.

    На вкладке **Команды** установите флажок **Выполнять эту команду или сценарий**. Затем введите команду или нажмите кнопку **Обзор** для поиска места хранения сценария. Можно также ввести аргументы команды, выбрать рабочий каталог для команды или сценария или изменить параметр безопасности команды.

6.  Создание одного или нескольких отчетов хранилища.

    На вкладке **Отчет** установите флажок **Создавать отчеты**, а затем выберите, какие отчеты необходимо создать. (Можно выбрать один или несколько адресов электронной почты администраторов, которым будет отправлен отчет, или отправить отчет по электронной почте пользователю, действия которого привели к достижению порогового значения.)

    Отчет сохраняется в расположении по умолчанию для отчетов об инцидентах, которое можно изменить в диалоговом окне **Параметры диспетчера ресурсов файлового сервера**.

7.  Нажмите кнопку **ОК**, чтобы сохранить порог уведомлений.

8.  Повторите эти действия, если требуется настроить дополнительные пороги уведомлений для шаблона квоты.

## <a name="see-also"></a>См. также

-   [Управление квотами](quota-management.md)
-    [Параметры диспетчера ресурсов файлового сервера в параметр](setting-file-server-resource-manager-options.md)
-   [Изменение свойств шаблона квоты](edit-quota-template-properties.md)
-   [Программы командной строки](command-line-tools.md)


