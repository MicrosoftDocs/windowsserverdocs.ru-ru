---
title: Обзор службы миграции хранилища
description: Служба миграции хранилища упрощает миграцию хранилища на Windows Server или в Azure. Он предоставляет графическое средство для инвентаризации данных на серверах Windows и Linux, а затем передает данные на новые серверы или на виртуальные машины Azure. Служба миграции хранилища также предоставляет возможность передачи удостоверения сервера на целевой сервер, чтобы приложения и пользователи могли получать доступ к своим данным без изменения ссылок или путей.
author: jasongerend
ms.author: jgerend
manager: elizapo
ms.date: 01/17/2020
ms.topic: article
ms.prod: windows-server
ms.technology: storage
ms.openlocfilehash: 70ce4ebca35e071cf6e27fe429d3c4e6f67d342c
ms.sourcegitcommit: 8b801bd86e2ddf8255899b11f547daa920e5f651
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80110677"
---
# <a name="storage-migration-service-overview"></a>Обзор службы миграции хранилища

>Область применения: Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server (половина ежегодного канала)

Служба миграции хранилища упрощает миграцию хранилища на Windows Server или в Azure. Он предоставляет графическое средство для инвентаризации данных на серверах Windows и Linux, а затем передает данные на новые серверы или на виртуальные машины Azure. Служба миграции хранилища также предоставляет возможность передачи удостоверения сервера на целевой сервер, чтобы приложения и пользователи могли получать доступ к своим данным без изменения ссылок или путей.

В этом разделе обсуждается, зачем использовать службу миграции хранилища, как работает процесс миграции и каковы требования к исходным и целевым серверам.

## <a name="why-use-storage-migration-service"></a>Зачем использовать службу миграции хранилища

Используйте службу миграции хранилища, так как у вас есть сервер (или большое количество серверов), который вы хотите перенести на более новое оборудование или виртуальные машины. Служба миграции хранилища предназначена для помощи в выполнении следующих действий.

- Инвентаризация нескольких серверов и их данных
- Быстро переносите файлы, общие файловые ресурсы и конфигурацию безопасности с исходных серверов
- При необходимости Возьмите идентификаторы исходных серверов (также называемые обрезкой), чтобы пользователям и приложениям не применялось никаких изменений для доступа к существующим данным.
- Управление одной или несколькими процессами миграции из пользовательского интерфейса центра администрирования Windows

![Схема, показывающая, что служба миграции хранилища выполняет миграцию файлов & конфигурацию с исходных серверов на целевые серверы, виртуальные машины Azure или Синхронизация файлов Azure.](media/overview/storage-migration-service-diagram.png)

**Рис. 1. источники и назначения службы миграции хранилища**

## <a name="how-the-migration-process-works"></a>Принцип работы процесса миграции

Процесс миграции состоит из трех этапов:

1. **Инвентаризация серверов** для сбора сведений о файлах и конфигурации (показано на рис. 2).
2. **Перенос (копирование) данных** с исходных серверов на целевые серверы.
3. **Вырежьте на новые серверы** (необязательно).<br>Целевые серверы предполагают наличие бывших удостоверений исходных серверов, чтобы приложениям и пользователям не применялось ничего. <br>Исходные серверы вводят состояние обслуживания, где они по-прежнему содержат те же файлы, которые они всегда имеют (мы никогда не удаляют файлы с исходных серверов), но недоступны пользователям и приложениям. После этого вы сможете списать серверы с вашего удобства.

Снимок экрана ![, показывающий сервер, готовый к сканированию](media/migrate/inventory.png)
**рис. 2. Инвентаризация серверов службы миграции хранилища**

В этом видеоролике показано, как использовать службу миграции хранилища для перевода сервера, например сервера Windows Server 2008 R2, который сейчас не поддерживается, и перемещения хранилища на более новый сервер.

> [!VIDEO https://www.youtube.com/embed/h-Xc9j1w144]

## <a name="requirements"></a>Требования

Для использования службы миграции хранилища необходимо следующее:

- **Исходный сервер** или **отказоустойчивый кластер** для переноса файлов и данных из
- **Целевой сервер** под Windows Server 2019 (кластеризованный или автономный), на который выполняется миграция. Windows Server 2016 и Windows Server 2012 R2 работают так же, как и более чем на 50%
- **Сервер Orchestrator** под управлением Windows Server 2019 для управления миграцией  <br>Если выполняется миграция только нескольких серверов и один из серверов работает под Windows Server 2019, его можно использовать в качестве Orchestrator. При переносе дополнительных серверов рекомендуется использовать отдельный сервер Orchestrator.
- **Компьютер или сервер с запущенным [центром администрирования Windows](../../manage/windows-admin-center/understand/windows-admin-center.md)**  для запуска пользовательского интерфейса службы миграции хранилища, если вы не предпочитаете использовать PowerShell для управления миграцией. Центр администрирования Windows и версия Windows Server 2019 должны иметь версию не ниже 1809.

Настоятельно рекомендуется, чтобы в Orchestrator и на конечных компьютерах имелось по крайней мере два ядра или два виртуальных ЦП и не менее 2 ГБ памяти. Операции инвентаризации и перемещения выполняются значительно быстрее с увеличением количества процессоров и памяти.

### <a name="security-requirements-the-storage-migration-service-proxy-service-and-firewall-ports"></a>Требования безопасности, служба-посредник службы миграции хранилища и порты брандмауэра

- Учетная запись миграции, которая является администратором на исходных компьютерах и на компьютере Orchestrator.
- Учетная запись миграции, которая является администратором на конечных компьютерах и компьютером Orchestrator.
- На компьютере Orchestrator должны быть включены *Входящие*правила брандмауэра для общего доступа к файлам и принтерам (SMB-in).
- На исходном и целевом компьютерах должны быть включены следующие правила брандмауэра *(хотя* они уже могут быть включены):
  - Общий доступ к файлам и принтерам (входящий трафик SMB)
  - Служба Netlogon (NP-in)
  - Инструментарий управления Windows (DCOM-In)
  - Инструментарий управления Windows (WMI-In)
  
  > [!TIP]
  > При установке прокси-сервера службы миграции хранилища на компьютер под Windows Server 2019 автоматически открываются необходимые порты брандмауэра на этом компьютере. Для этого подключитесь к целевому серверу в центре администрирования Windows, а затем перейдите в **Диспетчер сервера** (в центре администрирования windows) > **роли и компоненты**, выберите **прокси-служба миграции хранилища**и нажмите кнопку **установить**.


- Если компьютеры принадлежат к домену домен Active Directory Services, все они должны принадлежать к одному лесу. Целевой сервер также должен находиться в том же домене, что и исходный сервер, если вы хотите переместить имя домена источника в место назначения при вырезание. Прямую миграцию технически работает в разных доменах, но полное доменное имя назначения будет отличаться от исходного...

### <a name="requirements-for-source-servers"></a>Требования к исходным серверам

Исходный сервер должен работать под управлением одной из следующих операционных систем:

- Windows Server, Semi-Annual Channel
- Windows Server 2019
- Windows Server 2016
- Windows Server 2012 R2
- Windows Server 2012
- Windows Server 2008 R2
- Windows Server 2008
- Windows Server 2003 R2
- Windows Server 2003
- Windows Small Business Server 2003 R2
- Windows Small Business Server 2008
- Windows Small Business Server 2011
- Windows Server 2012 Essentials
- Windows Server 2012 R2 Essentials
- Windows Server2016 Essentials
- Windows Server 2019 Essentials
- Windows Storage Server 2008
- Windows Storage Server 2008 R2
- Windows Storage Server 2012
- Windows Storage Server 2012 R2
- Windows Storage Server 2016

Примечание. Windows Small Business Server и Windows Server Essentials являются контроллерами домена. Служба миграции хранилища еще не может быть перенесена с контроллеров домена, но может выполнять инвентаризацию и передачу файлов из них.   

Можно выполнить миграцию следующих дополнительных типов источников, если Orchestrator работает под управлением Windows Server версии 1903 или более поздней или если на сервере Orchestrator запущена более ранняя версия Windows Server с установленным [KB4512534](https://support.microsoft.com/help/4512534/windows-10-update-kb4512534) :

- Отказоустойчивые кластеры под Windows Server 2012, Windows Server 2012 R2, Windows Server 2016, Windows Server 2019
- Серверы Linux, использующие Samba. Мы протестировали следующее:
    - CentOS 7
    - Debian GNU/Linux 8
    - RedHat Enterprise Linux 7,6
    - SUSE Linux Enterprise Server (SLES) 11 SP4
    - Ubuntu 16,04 LTS и 12.04.5 LTS
    - Samba 4,8, 4,7, 4,3, 4,2 и 3,6

### <a name="requirements-for-destination-servers"></a>Требования к целевым серверам

Целевой сервер должен работать под управлением одной из следующих операционных систем:

- Windows Server, Semi-Annual Channel
- Windows Server 2019
- Windows Server 2016
- Windows Server 2012 R2

> [!TIP]
> Целевые серверы под управлением Windows Server 2019 или Windows Server, полугодовой канал или более поздней версии имеют удвоенную производительность передачи более ранних версий Windows Server. Это повышение производительности связано с включением встроенной службы "прокси-служба миграции хранилища", которая также открывает необходимые порты брандмауэра, если они еще не открыты.

## <a name="azure-vm-migration"></a>Миграция виртуальных машин Azure

Центр администрирования Windows версии 1910 позволяет развертывать виртуальные машины Azure. При этом развертывание виртуальной машины интегрируется в службу миграции хранилища. Вместо создания новых серверов и виртуальных машин на портале Azure вручную перед развертыванием рабочей нагрузки и, возможно, отсутствующими необходимыми действиями и настройками, центр администрирования Windows может развернуть виртуальную машину Azure, настроить ее хранилище, присоединить к домену, установить роли и Затем настройте распределенную систему. 

## <a name="whats-new-in-storage-migration-service"></a>Новые возможности службы миграции хранилища

Следующие новые возможности доступны при запуске сервера миграции хранилища Orchestrator на Windows Server, версии 1903 или более поздней или более ранней версии Windows Server с установленным [KB4512534](https://support.microsoft.com/help/4512534/windows-10-update-kb4512534) .

- Перенос локальных пользователей и групп на новый сервер.
- Перенос хранилища из отказоустойчивых кластеров, миграция на отказоустойчивые кластеры и миграция между автономными серверами и отказоустойчивыми кластерами
- Перенос хранилища с сервера Linux, использующего Samba.
- Более простая синхронизация перенесенных общих ресурсов в Azure с помощью компонента "Синхронизация файлов Azure".
- Перенос в новые сети, такие как Azure.

## <a name="see-also"></a>См. также:

- [Перенос файлового сервера с помощью службы миграции хранилища](migrate-data.md)
- [Часто задаваемые вопросы о службах миграции хранилища](faq.md)
- [Известные проблемы со службой миграции хранилища](known-issues.md)
