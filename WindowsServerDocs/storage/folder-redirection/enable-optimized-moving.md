---
title: Включить оптимизированного перемещений перенаправленных папок
description: Сведения о выполнении оптимизированного перемещение перенаправленных папок для нового файлового ресурса.
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage
ms.date: 09/10/2018
ms.localizationpriority: medium
ms.openlocfilehash: 7bdf30a4f721568add4e7902245da2a803b72db1
ms.sourcegitcommit: ed27ddbe316d543b7865bc10590b238290a2a1ad
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/09/2019
ms.locfileid: "65475868"
---
# <a name="enable-optimized-moves-of-redirected-folders"></a>Включить оптимизированного перемещений перенаправленных папок

>Относится к: Windows 10, Windows 8, Windows 8.1, Windows Server 2019 г., Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows Server (Semi-Annual Channel)

В этом разделе описывается выполнение оптимизированного перемещение перенаправленных папок (перенаправление папок), в новый файловый ресурс. Если включить этот параметр политики, когда администратор перемещает файловый ресурс, размещение перенаправленных папок и обновляет целевой путь для перенаправленных папок в групповой политике, кэшированное содержимое просто переименовано в локальном кэше автономных файлов без задержки или потеря данных для пользователя.

Ранее администраторы могут изменить целевой путь для перенаправленных папок в групповой политике и предназначены для клиентских компьютеров скопируйте файлы в затронутого пользователя следующего входа в систему причиной отложенных входа в. Кроме того Администраторы можно переместить общую папку и выполнения обновления целевой путь для перенаправленных папок в групповой политике. Тем не менее любые изменения, внесенные локально на клиентских компьютерах между началом перемещения и первую синхронизацию, после перемещения будут потеряны.

## <a name="prerequisites"></a>Предварительные требования

Оптимизированный перемещения предъявляются следующие требования:

- Перенаправление папок должны быть настроены. Дополнительные сведения см. в разделе [развертывание перенаправления папок с автономными файлами,](deploy-folder-redirection.md).
- Компьютеры клиентов должны управляться Windows 10, Windows 8.1, Windows 8, Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012 или Windows Server (Semi-Annual Channel).

## <a name="step-1-enable-optimized-move-in-group-policy"></a>Шаг 1. Включить оптимизированного перемещения в групповой политике

Чтобы оптимизировать параметры перемещения данных перенаправления папок, использовать групповую политику для включения **Enable оптимизированных для операций перемещения содержимого в кэше автономных файлов при изменении пути перенаправления папок сервера** параметры политики в отношении нужную групповую политику Объект Групповой политики. Настройка параметра **отключено** или **не настроен** заставляет клиента заносить в копирование всего содержимого перенаправления папок в новое расположение и удалите содержимое из старой позиции, если изменения пути сервера.

Вот как можно включить оптимизированного перемещение перенаправленных папок:

1. В управлении групповыми политиками, щелкните правой кнопкой мыши объект групповой Политики, созданной для параметры перенаправления папок (например, **настройки перемещаемых профилей пользователей и перенаправления папок**), а затем выберите **изменить**.
2. В разделе **Конфигурация пользователя**, перейдите к **политики**, затем **административные шаблоны**, затем **системы**, затем  **Перенаправление папок**.
3. Щелкните правой кнопкой мыши **Enable оптимизированных для операций перемещения содержимого в кэше автономных файлов при изменении пути перенаправления папок сервера**, а затем выберите **изменить**.
4. Выберите **включено**, а затем выберите **ОК**.

## <a name="step-2-relocate-the-file-share-for-redirected-folders"></a>Шаг 2. Переместить общую папку для перенаправленных папок

При перемещении общую папку, содержащую пользователей, перенаправление папок, важно принять меры предосторожности, чтобы убедиться, что папки переносятся надлежащим образом.

>[!IMPORTANT]
>Если файлы пользователей находятся в, использовать или если полное состояние не сохраняется при переходе, пользователи могут испытывать к снижению производительности, как файлы копируются по сети, конфликты синхронизации, созданные автономных файлов, или даже потерю данных.

1. Предупредите пользователей заранее о изменит что их перенаправленных папок на сервере и выполнить следующие действия:

      - Синхронизировать содержимое своего кэша автономных файлов и разрешать любые конфликты.
      - Откройте командную строку с повышенными правами, введите **GpUpdate /Target:User/force**и затем выйдите из системы и снова войдите, чтобы убедиться, что последние настройки групповой политики применяются к клиентскому компьютеру

        >[!NOTE]
        >По умолчанию клиентские компьютеры обновить групповую политику каждые 90 минут, поэтому если вы разрешите достаточно времени для клиентских компьютеров могли получать обновленную политику, не нужно попросить пользователей использовать **GpUpdate**.
2. Удаление общей папки с сервера, чтобы убедиться, что нет файлов в файловом ресурсе, используется. Для этого в диспетчере серверов на **общих папок** страницы файловых служб и служб хранилища, щелкните правой кнопкой мыши в соответствующий файловый ресурс, а затем выберите **удалить**.

    Пользователи будут работать в автономном режиме с помощью автономных файлов до завершения перемещения и получают обновленные параметры перенаправления папок из групповой политики.

3. С помощью учетной записи с правами резервного копирования переместить содержимое общей папки в новое расположение, используя метод, который сохраняет метки времени файлов, таких как резервное копирование и восстановление служебной программы. Чтобы использовать **Robocopy** команды, откройте командную строку с повышенными правами и введите следующую команду, где ```<Source>``` используется текущее расположение общей папки, и ```<Destination>``` — новое местоположение:

    ```PowerShell
    Robocopy /B <Source> <Destination> /Copyall /MIR /EFSRAW
    ```

    >[!NOTE]
    >**Xcopy** команды не сохраняет все сведения о состоянии файла.
4. Настройте параметры политики перенаправления папок, обновление расположение папки для каждой перенаправленной папки, которую следует переместить. Дополнительные сведения см. в шаге 4 [развертывание перенаправления папок с автономными файлами,](deploy-folder-redirection.md).
5. Уведомление пользователей был изменен на сервер, содержащий их перенаправленных папок и их следует использовать **GpUpdate /Target:User/force** команды, а затем выйдите из системы и снова войдите на обновление конфигурации и возобновление нужного файла синхронизация.

    Пользователи должны входить в ко всем компьютерам по крайней мере один раз убедитесь, что данные правильно перемещается в каждом кэше автономных файлов.

## <a name="more-information"></a>Дополнительные сведения

* [Развертывание перенаправления папок с автономными файлами](deploy-folder-redirection.md)
* [Развертывание перемещаемых профилей пользователя](deploy-roaming-user-profiles.md)
* [Обзор перенаправления папок, автономных файлов и перемещаемых профилей пользователей](folder-redirection-rup-overview.md)