---
title: Устранение неполадок с профилями пользователя с событиями
description: Способы устранения проблемы при загрузке и выгрузке профилей пользователей с помощью событий и журналы трассировки.
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage
ms.date: 04/05/2018
ms.localizationpriority: medium
ms.openlocfilehash: f30bfcd531731e3a0d14350536ddf418c50f3ea0
ms.sourcegitcommit: ed27ddbe316d543b7865bc10590b238290a2a1ad
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/09/2019
ms.locfileid: "65475951"
---
# <a name="troubleshoot-user-profiles-with-events"></a>Устранение неполадок с профилями пользователя с событиями

>Относится к: Windows 10, Windows 8, Windows 8.1, Windows Server 2019 г., Windows Server 2016, Windows Server 2012 R2, Windows Server 2012 и Windows Server (Semi-Annual Channel).

В этом разделе рассматриваются способы устранения проблемы при загрузке и выгрузке профилей пользователей с помощью событий и журналы трассировки. В следующих разделах как использовать три журнала событий, которые записывают сведения о профиле пользователя.

## <a name="step-1-checking-events-in-the-application-log"></a>Шаг 1. Проверка событий в журнале приложений

Первым шагом при устранении неполадок с загрузкой и выгрузкой профилей (включая перемещаемые профили пользователей) — это использовать средство просмотра событий для просмотра любого события предупреждений и ошибок, записываемых служба профилей пользователей в приложение журнал пользователей.

Вот как можно просмотреть события службы профиля пользователя в журнале приложений:

1. Запустите средство просмотра событий. Чтобы сделать это, откройте **панели управления**выберите **система и безопасность**, а затем в **Администрирование** выберите **просмотреть журналы событий**. Откроется окно просмотра событий.
2. В дереве консоли, сначала перейдите к **журналы Windows**, затем **приложения**.
3. В области действий выберите **фильтровать текущий журнал**. Будет открыто диалоговое окно Фильтровать текущий журнал.
4. В **источники событий** выберите **служба профилей пользователей** флажок, а затем выберите **ОК**.
5. Просмотрите список событий, уделяя особое внимание на события ошибок.
6. Найдя заслуживающие внимания события, щелкните ссылку веб-справка журнала событий, чтобы отобразить дополнительные сведения и процедуры устранения неполадок.
7. Для дальнейшего устранения неисправностей, обратите внимание на дату и время значимых событий и изучите Операционный журнал (как описано на шаге 2) для получения сведений об службы профилей пользователей во время события ошибки или предупреждения.

>[!NOTE]
>Можно игнорировать служба профилей пользователей 1530 событий «Windows обнаружила, что ваш файл реестра все еще используется другими приложениями или службами.»

## <a name="step-2-view-the-operational-log-for-the-user-profile-service"></a>Шаг 2. Просмотр журнала операций для службы профилей пользователей

Если не удается устранить проблему, с помощью только журнал приложений, используйте следующую процедуру, чтобы просмотреть события службы профилей пользователей в Операционный журнал. Этот журнал показаны некоторые из внутренней работы службы и может помочь определить, откуда в профиль нагрузки или выгрузить процесс, возникают определенные проблемы.

В журнале приложений Windows и службы профиля пользователя Операционный журнал включены по умолчанию во всех установках Windows.

Вот как можно просмотреть Операционный журнал для службы профилей пользователей:

1. В дереве консоли просмотра событий перейдите к **журналы приложений и служб**, затем **Microsoft**, затем **Windows**, затем **служба профилей пользователей**, а затем **Operational**.
2. Проверьте события, возникшие во время события ошибки или предупреждения, записанные в журнале приложений.

## <a name="step-3-enable-and-view-analytic-and-debug-logs"></a>Шаг 3. Включение и просмотр аналитический и отладочный журналы

Если требуется, чтобы более подробно, чем предоставляет Операционный журнал, можно включить аналитический и отладочный журналы на соответствующем компьютере. Этот уровень ведения журнала гораздо более подробные и должна быть отключена, за исключением того, при попытке устранения проблемы.

Вот как можно включить, а также просматривать аналитический и отладочный журналы:

1. В **действия** области средства просмотра событий, выберите **представление**, а затем выберите **Отобразить аналитический и отладочный журналы**.
2. Перейдите к **журналы приложений и служб**, затем **Microsoft**, затем **Windows**, затем **служба профилей пользователей**, а затем  **Диагностики**.
3. Выберите **включить журнал** , а затем выберите **Да**. Это позволяет журнала диагностики, который запустит ведения журнала.
4. Если требуется более подробной информации, см. в разделе [Step 4: Создание и декодирования трассировки](#step-4-creating-and-decoding-a-trace) Дополнительные сведения о том, как создать журнал трассировки.
5. Когда вы закончите устранения неполадки, перейдите к **диагностики** журнала, выберите **отключить журнал**выберите **представление** , а затем снимите **Показать Аналитический и отладочный журналы** флажок, чтобы скрыть аналитический и отладочный ведения журнала.

## <a name="step-4-creating-and-decoding-a-trace"></a>Шаг 4. Создание и декодирования трассировки

Если вам не удается решить проблему с помощью событий, можно создать журнал трассировки (ETL-файл) при воспроизведении проблему и затем декодировать ее с использованием открытых символов с сервера символов Майкрософт. Журналы трассировки содержат конкретные сведения о новые службы профилей пользователей делает и может помочь определить, где произошел сбой.

При использовании трассировки ETL, рекомендуется сначала сохраняющий наименьшее журнал невозможно. После декодирования журнала выполните поиск в журнале ошибок.

Вот как создать и декодирование трассировки для службы профилей пользователей:

1. Войдите на компьютер, где пользователь испытывает проблемы, с помощью учетной записи, которая является членом локальной группы администраторов.
2. Из командной строки с повышенными правами введите следующие команды, где *\<путь\>* — это путь к локальной папке, созданный ранее, например C:\\журналы:
        
    ```PowerShell
    logman create trace -n RUP -o <Path>\RUP.etl -ets
    logman update RUP -p {eb7428f5-ab1f-4322-a4cc-1f1a9b2c5e98} 0x7FFFFFFF 0x7 -ets
    ```
3. На начальном экране выберите имя пользователя, а затем выберите **переключить учетную запись**, стараясь не выйти администратор. Если вы используете удаленный рабочий стол, закройте сеанс администратора сеанс пользователя.
4. Воспроизвести проблему. Процедура для воспроизведения проблемы обычно не должны входить в возникает описанная проблема, выхода пользователя из системы, пользователя или в виде.
5. После воспроизведения проблемы, войдите учетную запись локального администратора еще раз.
6. Из командной строки с повышенными привилегиями выполните следующую команду, чтобы сохранить журнал в файл ETL:
  
    ```PowerShell
    logman stop -n RUP -ets
    ```
7. Введите следующую команду, чтобы экспортировать ETL-файла в удобное для восприятия файл в текущем каталоге (скорее всего домашней папке или папке % WINDIR %\\папке System32):
    
    ```PowerShell
    Tracerpt <path>\RUP.etl
    ```
8. Откройте **Summary.txt** файл и **Dumpfile.xml** файл (их можно открыть в Microsoft Excel позволяет более легко просмотреть все сведения о журнале). Найдите события, которые включают **ошибкой** или **сбой**; можно не обращать внимания строк, которые включают **Неизвестный** имя события.

## <a name="more-information"></a>Дополнительные сведения

* [Развертывание перемещаемых профилей пользователя](deploy-roaming-user-profiles.md)