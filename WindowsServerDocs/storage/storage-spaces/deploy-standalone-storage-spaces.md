---
title: Развертывание дисковых пространств на автономном сервере
description: В этой статье описывается развертывание дисковых пространств на отдельном сервере под управлением Windows Server 2012.
ms.prod: windows-server-threshold
ms.topic: article
author: JasonGerend
ms.author: jgerend
ms.technology: storage-spaces
ms.date: 07/09/2018
ms.localizationpriority: medium
ms.openlocfilehash: 40265e767ac9aca05386c0893def259aca3a5633
ms.sourcegitcommit: e73fbe1046a8bd2bf4f24ccffc11465ad8dfab1d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2019
ms.locfileid: "8992537"
---
# Развертывание дисковых пространств на автономном сервере

>Область применения: Windows Server 2019 г., Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе описывается развертывание дисковых пространств на отдельном сервере. Сведения о том, как создать кластерного дискового пространства, см. в разделе [развертывания кластер дисковые пространства в Windows Server 2012 R2](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/mt270997(v%3dws.11)>).

Чтобы создать дисковое пространство, необходимо сначала создать один или несколько пулов. Пул носителей — это набор физические диски. Пул носителей позволяет агрегирования хранилища, увеличение объема эластичное и делегированного администрирования.

Из пула носителей вы можете создать один или несколько виртуальных дисков. Эти виртуальные диски также называются *дисковых пространств*. Дисковое пространство отображается для операционной системы Windows, как обычный диск, из которой вы можете создать отформатирован тома. При создании виртуального диска через пользовательский интерфейс файловые службы и службы хранилища, можно настроить тип устойчивости (проще, зеркала или контроль четности), подготовки тип (тонкого или основных), а также размер. Через Windows PowerShell можно задать дополнительные параметры, такие как число столбцов, значение interleave и какие физических дисков в пуле для использования. Сведения об этих дополнительных параметрах см. в разделе [New-VirtualDisk](https://docs.microsoft.com/powershell/module/storage/new-virtualdisk?view=win10-ps) и [Каковы столбцов и как дисковые определяет, сколько использовать?](https://social.technet.microsoft.com/wiki/contents/articles/11382.storage-spaces-frequently-asked-questions-faq.aspx%23what_are_columns_and_how_does_storage_spaces_decide_how_many_to_use) в локальных дисковых часто вопросы и ответы.

>[!NOTE]
>Нельзя использовать в дисковое пространство для размещения операционной системы Windows.

От виртуального диска вы можете создать один или несколько томов. При создании тома, можно настроить размер, букву диска или папки, файловая система (файловой системы NTFS или Resilient File System (ReFS)), размером и необязательную метку тома.

На следующем рисунке показано дисковые рабочего процесса.

![Рабочего процесса локальных дисковых пространств](media/deploy-standalone-storage-spaces/storage-spaces-workflow.png)

**Рис. 1: Рабочий процесс дисковые**

>[!NOTE]
>Этот раздел содержит пример командлеты Windows PowerShell, который можно использовать для автоматизации часть указаны процедуры, описанные. Дополнительные сведения см. в разделе [PowerShell](https://docs.microsoft.com/powershell/scripting/powershell-scripting?view=powershell-6).

## Необходимые условия

Для использования дисковых пространств на отдельном сервере 2012−based Windows Server, убедитесь, что физические диски, которые вы хотите использовать соответствовать следующим требованиям.

> [!IMPORTANT]
> Если вы хотите узнать, как развертывание дисковых пространств в отказоустойчивом кластере, см. в разделе [развертывания кластер дисковые пространства в Windows Server 2012 R2](<https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/mt270997(v%3dws.11)>). Развертывание отказоустойчивого кластера условий разные, например поддерживаемый диск шины типы, типы поддерживаемых устойчивости и требуется минимальное количество дисков.

|Область|Требование|Примечания|
|---|---|---|
|Шина типов дисков|-Серийный подключенные SCSI (SAS)<br>-Серийный дополнительные технологии вложения (SATA)<br>-iSCSI и Fibre Channel контроллеров. |Можно также использовать USB-накопителей. Тем не менее не оптимальное использование USB-накопителей в среде сервера.<br>Дисковые поддерживается на iSCSI и контроллеров Fibre Channel (FC) до тех пор, пока виртуальные диски, созданные поверх них, неустойчивому (простой с любого количества столбцов).<br>|
|Конфигурация диска|-Физические диски должен быть не менее 4 ГБ<br>-Диски должны быть пустыми и не отформатирован. Не следует создавать тома.||
|Рекомендации по HBA|-Рекомендуется использовать простой адаптеров шины (HBA), не поддерживающих функции RAID<br>-Если RAID поддержкой, HBA должен находиться в режиме без RAID с все функции RAID<br>-Адаптеры не должно выделяют физические диски, кэширование данных, или скрывать все подключенные устройства. Это относится к службам вложение, предоставляемые подключенные устройства только a улучшений — от дисков (JBOD). |Дисковые совместим только с HBA, где вы можете полностью отключить все функции RAID.|
|Дисковых ПОЛОК JBOD|-Дисковых ПОЛОК JBOD являются необязательными<br>-Рекомендуется использовать дисковые сертифицированных вложения, перечисленные в каталоге Windows Server<br>-Если вы используете полок JBOD, с поставщиком хранилища корпусе проверьте, поддерживает ли дисковых пространств для обеспечения полной функциональности<br>— Чтобы определить, поддерживает ли полок JBOD идентификации корпуса и разъем, выполните следующий командлет Windows PowerShell:<br><br>`Get-PhysicalDisk \| ? {$_.BusType –eq "SAS"} \| fc`<br><br>Если поля **EnclosureNumber** и **SlotNumber** содержат значения, корпус поддерживает эти функции.||

Рассчитывать на количество физических дисков и типа устойчивости нужные для развертывания автономного сервера, используйте следующие рекомендации.

|Тип устойчивости|На диске|Варианты использования|
|---|---|---|
|**Простота**<br><br>-Полосы данные по физическим дискам<br>-Обеспечивает максимальную емкость диска и повышает пропускную способность<br>-Не устойчивости (не защищает от сбоев диска)<br><br><br><br><br><br><br>|Требуется по крайней мере один физический диск.|Не используйте уникальные данные узла. Простой пробелов защищает от сбоев дисков.<br><br>Используйте для узла временные или легко повторном данные по сниженной.<br><br>Подходит для высокопроизводительных рабочих нагрузок, где устойчивости не является обязательным или предоставленную приложением.|
|**Отражение (Mirror)**<br><br>-Содержит два или три копии данных распределяя физических дисков<br>-Повышает надежность, но уменьшает емкости. Дублирование происходит при каждой записи. Данные также разделяются пробелом уровне с зеркалированием на несколько физических дисков.<br>-Данные пропускную способность и низкой задержкой доступ с контролем четности<br>-Использует "грязный" область отслеживания (DRT), чтобы отслеживать изменения дисков в пуле. Когда система возобновляет из незапланированного завершения работы и пробелы в оперативный режим, DRT делает дисков в пуле согласованное друг с другом.|Требуется по крайней мере два физических дисков для защиты от сбоев один диск.<br><br>Требуется по крайней мере пять физические диски для защиты от двух сбоев дисков одновременно.|Используйте их для большинства развертываний. Например уровень с зеркалированием дисковых подходят для общего назначения файловый ресурс или библиотеки виртуального жесткого диска (VHD).|
|**Четность**<br><br>-Сведения о данных и четности полос по физическим дискам<br>-Повышает надежность при его сравнивается с пробелом простой, но немного уменьшает емкости<br>-Повышает устойчивость через ведения журнала. Это поможет предотвратить повреждение данных в случае незапланированного завершения работы.|Требуется по крайней мере три физических дисков для защиты от сбоев один диск.|Используйте их для рабочих нагрузок, которые большой последовательной, например архивации или резервного копирования.|

## Шаг 1: Создание пула носителей

Необходимо доступные физические диски по первой группы в один или несколько пулов устройств хранения данных.

1. В области навигации диспетчера серверов выберите **файловые службы и службы хранилища**.

2. В области навигации выберите страницу **Пула носителей** .
    
    По умолчанию доступных дисков, включаются в пул с именем *primordial* пул. Если пул не primordial находится в списке **ПУЛОВ устройств хранения данных**, это означает, что хранилище не соответствует требованиям для дисковых пространств. Убедитесь, что диски требованиям, описанным в разделе "Предварительные условия".
    
    >[!TIP]
    >При выборе **Primordial** пул носителей, доступные физические диски перечислены в разделе **ФИЗИЧЕСКИЕ ДИСКИ**.

3. В разделе **ПУЛА НОСИТЕЛЕЙ**выберите список **задач** , а затем выберите **Новый пул носителей**. Откроется мастер создания пула хранилища.

4. На странице " **перед началом** " выберите **Далее**.

5. На странице " **Укажите имя пула хранилища и подсистемы** " введите имя и необязательное описание пул носителей, выберите группу доступные физические диски, которые вы хотите использовать и выберите **Далее**.

6. На странице " **Выбор дисков для пула носителей** " сделать ниже, а затем выберите **Далее**:
    
    1. Установите флажок рядом с каждого физический диск, который вы хотите включить в пуле носителей.
    
    2. Если вы хотите назначить один или дополнительных дисков как Горячее резервирование, в области **выделения**, выберите стрелку раскрывающегося списка, затем выберите **"Горячие" резервирования**.

7. На странице " **подтвердить выбор** " Убедитесь, что параметры указаны правильно, а затем выберите **Создать**.

8. На странице " **Просмотр результатов** " Убедитесь, что все задачи завершения, а затем выберите **Закрыть**.
    
    >[!NOTE]
    >При необходимости для продолжения, напрямую к следующему шагу, можно выбрать флажок **создать виртуальный диск при закрытии мастера** .

9. В разделе **ПУЛА НОСИТЕЛЕЙ**убедитесь, что новый пул носителей.

### Эквивалент команды Windows PowerShell для создания пулов устройств хранения данных

Следующие командлета Windows PowerShell и командлеты выполняют ту же функцию в предыдущей процедуре. Введите каждый командлет в одной строке, несмотря на то, что они могут отображаться словам по нескольким строкам здесь из-за ограничений форматирования.

В следующем примере показано, какие физические диски доступны в пуле primordial.

```PowerShell
Get-StoragePool -IsPrimordial $true | Get-PhysicalDisk | Where-Object CanPool -eq $True
```

В следующем примере создается новый пул носителей с именем *StoragePool1* , который использует все доступные диски.

```PowerShell
New-StoragePool –FriendlyName StoragePool1 –StorageSubsystemFriendlyName “Storage Spaces*” –PhysicalDisks (Get-PhysicalDisk –CanPool $True)
```

В следующем примере создается новый пул носителей, *StoragePool1*, который использует четыре доступных дисков.

```PowerShell
New-StoragePool –FriendlyName StoragePool1 –StorageSubsystemFriendlyName “Storage Spaces*” –PhysicalDisks (Get-PhysicalDisk PhysicalDisk1, PhysicalDisk2, PhysicalDisk3, PhysicalDisk4)
```

В следующем примере порядке командлеты инструкция по добавлению доступных физический диск *PhysicalDisk5* запасным "горячие" в пул носителей *StoragePool1*.

```PowerShell
$PDToAdd = Get-PhysicalDisk –FriendlyName PhysicalDisk5
Add-PhysicalDisk –StoragePoolFriendlyName StoragePool1 –PhysicalDisks $PDToAdd –Usage HotSpare
```

## Шаг 2: Создание виртуального диска

Затем необходимо создать один или несколько виртуальных дисков из пула носителей. При создании виртуального диска, вы можете выбрать, каким образом данные размещены на разных физических дисков. Это влияет на производительность и надежность. Можно также выбрать, следует ли создать тонкой или фиксированной подготовкой дисков.

1. Если мастера создания виртуального диска еще не открыт, на странице " **Пулов** " в диспетчере сервера в группе **ПУЛА НОСИТЕЛЕЙ**, убедитесь, что выбран нужный пуле.

2. В разделе **ВИРТУАЛЬНЫХ ДИСКОВ**выберите список **задач** , а затем выберите **Новый виртуальный диск**. Откроется мастера создания виртуального диска.

3. На странице " **перед началом** " выберите **Далее**.

4. На странице **Выберите пул носителей** выберите нужный пуле и выберите **Далее**.

5. На странице " **Укажите имя виртуального диска** " введите имя и необязательное описание, а затем выберите **Далее**.

6. На странице " **Выбор раскладки хранилища** " выберите нужного макета, а затем выберите **Далее**.
    
    >[!NOTE]
    >При выборе макета, где у вас достаточно физические диски, вы получите сообщение об ошибке при выборе **Далее**. Сведения о том, какой макет для использования и на диске см. в разделе [необходимых компонентов](#prerequisites)).

7. Если выбран **уровень с зеркалированием** как структуру хранения, и у вас есть пять или более дисков в пуле, будут отображаться на странице **настройки параметров устойчивости** . Выберите один из следующих вариантов:
    
      - **Двухстороннее зеркало**
      - **Трехстороннее зеркало**

8. На странице " **Укажите подготовки тип** " выберите один из следующих параметров, а затем выберите **Далее**.
    
      - **Тонкая**
        
        С помощью тонкая подготовка пространство выделяется по мере необходимости. Это оптимизирует использование доступное хранилище. Тем не менее так как это позволяет избыточного выделения памяти, необходимо тщательно следить за счетчиком объем места на диске.
    
      - **Фиксированные**
        
        С помощью основных подготовки емкость выделяется немедленно, во время создания виртуального диска. Таким образом фиксированной подготовки использует пространство из пула носителей, равен размеру виртуального диска.
    
    >[!TIP]
    >С помощью дисковых пространств вы можете создать оба тонкой и фиксированной подготовкой виртуальные диски в том же пуле носителей. Например можно использовать тонкой виртуального диска для размещения базы данных и подготовкой фиксированной виртуального диска для размещения связанные файлы журнала.

9. На странице " **Укажите размер виртуального диска** " выполните следующие действия.
    
    Если вы выбрали тонкая подготовка на предыдущем шаге, в **виртуальной места на диске** введите размера виртуального диска, выберите единицы измерения (**МБ**, **ГБ**или **ТБ**), а затем выберите **Далее**.
    
    Если вы выбрали фиксированного подготовки на предыдущем шаге, выберите один из следующих:
    
      - **Укажите размер**
        
        Чтобы указать размер, введите значение в поле **виртуальной места на диске** , а затем выберите единицы измерения (**МБ**, **ГБ**или **ТБ**).
        
        Если вы используете макете хранилища, отличных от простого, виртуальный диск, который использует больше свободного места, чем размер, указанный. Чтобы избежать потенциальных ошибок, где размер тома превышает пула свободного места, можно выбрать флажок **Создание большого виртуального диска, возможно, зависит от заданного размера** .
    
      - **Максимальный размер**
        
        Выберите этот вариант, чтобы создать виртуальный диск, использующий максимальную емкость пул носителей.

10. На странице " **подтвердить выбор** " Убедитесь, что параметры указаны правильно, а затем выберите **Создать**.

11. На странице " **Просмотр результатов** " Убедитесь, что все задачи завершения, а затем выберите **Закрыть**.
    
    >[!TIP]
    >По умолчанию установлен флажок **Создать том при закрытии мастера** . Вы перейдете непосредственно к следующему шагу.

### Эквивалент команды Windows PowerShell для создания виртуальных дисков

Следующие командлета Windows PowerShell и командлеты выполняют ту же функцию в предыдущей процедуре. Введите каждый командлет в одной строке, несмотря на то, что они могут отображаться словам по нескольким строкам здесь из-за ограничений форматирования.

В следующем примере создается с именем *VirtualDisk1* на пул носителей с именем *StoragePool1*виртуального диска 50 ГБ.

```PowerShell
New-VirtualDisk –StoragePoolFriendlyName StoragePool1 –FriendlyName VirtualDisk1 –Size (50GB)
```

В следующем примере создается зеркальный виртуального диска с именем *VirtualDisk1* на пул носителей с именем *StoragePool1*. Пул носителей Максимальная емкость хранилища используется на диске.

```PowerShell
New-VirtualDisk –StoragePoolFriendlyName StoragePool1 –FriendlyName VirtualDisk1 –ResiliencySettingName Mirror –UseMaximumSize
```

В следующем примере создается с именем *VirtualDisk1* на пул носителей с именем *StoragePool1*виртуального диска 50 ГБ. Тип тонкая подготовки использует диск.

```PowerShell
New-VirtualDisk –StoragePoolFriendlyName StoragePool1 –FriendlyName VirtualDisk1 –Size (50GB) –ProvisioningType Thin
```

В следующем примере создается виртуального диска с именем *VirtualDisk1* на пул носителей с именем *StoragePool1*. Виртуальный диск, который использует трехстороннее зеркальное отображение и фиксированный размер 20 ГБ.

>[!NOTE]
>Необходимо иметь по крайней мере пять физических дисков в пуле носителей для этого командлета для работы. (Эти сведения не включают все диски, которые назначаются как Горячее резервирование.)

```PowerShell
New-VirtualDisk -StoragePoolFriendlyName StoragePool1 -FriendlyName VirtualDisk1 -ResiliencySettingName Mirror -NumberOfDataCopies 3 -Size 20GB -ProvisioningType Fixed
```

## Шаг 3: Создание тома

Затем необходимо создать тома с виртуального диска. Можно назначить букву диска дополнительных или папки, а затем отформатировать том с файловой системой.

1. Если мастер создания томов еще не открыт, на странице " **Пулов** " в диспетчере сервера, в разделе **ВИРТУАЛЬНЫХ ДИСКОВ**, щелкните правой кнопкой мыши нужный виртуальный диск и выберите **Новый том**.
    
    Откроется мастер создания томов.

2. На странице " **перед началом** " выберите **Далее**.

3. На странице " **Выбор сервера и диска** " сделать ниже, а затем выберите **Далее**.
    
    1. В области **сервера** выберите сервер, на котором вы хотите подготовить тома.
    
    2. В области **диска** выберите виртуальный диск, на котором вы хотите создать тома.

4. На странице " **Укажите размер тома** " введите размер тома, указать единицы измерения (**МБ**, **ГБ**или **ТБ**) и нажмите кнопку **Далее**.

5. На странице " **назначить букву диска или папке** " Настройка нужный параметр и выберите **Далее**.

6. На странице **Выберите параметры файловой системы** сделать ниже, а затем выберите **Далее**.
    
    1. В списке **файловой системы** выберите **файловой системы NTFS** или **ReFS**.
    
    2. В списке **размер кластера** оставьте значение по **умолчанию** или задать размер кластера.
        
        >[!NOTE]
        >Дополнительные сведения о размером см. в разделе [по умолчанию размер кластера NTFS, FAT и exFAT](https://support.microsoft.com/help/140365/default-cluster-size-for-ntfs-fat-and-exfat).

    
    3. При необходимости в поле **меткой тома** , введите имя метки тома, например, **Сотрудник отдела Кадров данных**.

7. На странице " **подтвердить выбор** " Убедитесь, что параметры указаны правильно, а затем выберите **Создать**.

8. На странице " **Просмотр результатов** " Убедитесь, что все задачи завершения, а затем выберите **Закрыть**.

9. Чтобы убедиться, что том был создан, в диспетчере сервера выберите страницу **тома** . Том указан сервер, на котором он был создан. Вы также можете проверить, что том является в проводнике Windows.

### Эквивалент команды Windows PowerShell для создания томов

Следующий командлет Windows PowerShell выполняет те же функции, что и ранее. Введите команду в одной строке.

В следующем примере инициализируется диски для виртуального диска *VirtualDisk1*, создает раздел с буквой диска ограниченного и форматирует том с использованием файловой системы NTFS по умолчанию.

```PowerShell
Get-VirtualDisk –FriendlyName VirtualDisk1 | Get-Disk | Initialize-Disk –Passthru | New-Partition –AssignDriveLetter –UseMaximumSize | Format-Volume
```

## Дополнительные сведения

- [Дисковые пространства](overview.md)
- [Командлеты хранилища в Windows PowerShell](https://docs.microsoft.com/powershell/module/storage/index?view=win10-ps)
- [Развертывание кластерных дисковых пространств](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/jj822937(v%3dws.11))
- [Дисковые часто задаваемые вопросы и ответы](https://social.technet.microsoft.com/wiki/contents/articles/11382.storage-spaces-frequently-asked-questions-faq.aspx)
