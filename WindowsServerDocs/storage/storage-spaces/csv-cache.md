---
title: Кэш чтения хранилища локальными дисковыми пространствами в памяти
ms.prod: windows-server-threshold
ms.author: eldenc
ms.manager: siroy
ms.technology: storage-spaces
ms.topic: article
author: eldenchristensen
ms.date: 02/20/2019
ms.localizationpriority: medium
ms.openlocfilehash: 7ed5894a569d4c42a3a4b0e018de5171f2c84a62
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59850555"
---
# <a name="using-storage-spaces-direct-with-the-csv-in-memory-read-cache"></a>С помощью дисковых пространств с помощью CSV-ФАЙЛ в памяти кэш чтения
> Область применения. Windows Server 2016, Windows Server 2019 г.

В этом разделе описывается использование системной памяти для повышения производительности [Storage Spaces Direct](storage-spaces-direct-overview.md).

Дисковыми пространствами совместим с общего тома кластера (CSV) в памяти кэш чтения. Использование системной памяти для операций чтения кэша может улучшить производительность для приложений, таких как Hyper-V, который использует без буферизации ввода-вывода для доступа к файлам VHD или VHDX. (Без буферизации IOs являются любые операции, которые не кэшируются диспетчером кэша Windows).

Так как кэш в памяти локального сервера, это улучшает локальность данных для гиперконвергентных развертываниях дисковыми пространствами: последних операций чтения, кэшируются в памяти на одном узле, где запущена виртуальная машина, уменьшая частоту операции осуществляются по сети. Это приводит к более низкую задержку и повышает производительность хранилища.

## <a name="planning-considerations"></a>Факторы, которые следует учесть при планировании

В памяти чтения кэша наиболее эффективен для рабочих нагрузок с высокой интенсивностью чтения, например инфраструктуры виртуальных рабочих столов (VDI). И наоборот Если рабочая нагрузка записи очень интенсивно, кэш может вызвать большие затраты, чем значение и должен быть отключен.

Можно использовать до 80% от общего объема физической памяти, кэша см. в CSV-ФАЙЛ в памяти.

  > [!TIP]
  > Для гиперконвергентных развертываниях, где вычисления и хранения, выполните на тех же серверах, будьте внимательны, оставляющее достаточно памяти для виртуальных машин. Для конвергентных развертываниях масштабируемого файлового сервера (SoFS), с помощью конфликты при обращении к памяти это не относится.

  > [!NOTE]
  > Определенные microbenchmarking средства, такие как DISKSPD и [Fleet виртуальной Машины](https://github.com/Microsoft/diskspd/tree/master/Frameworks/VMFleet) может привести к результатам хуже, с помощью CSV-файла в памяти чтения кэш включен, чем без него. По умолчанию Fleet виртуальной Машины создает один общий для 100 виртуальных машин — 10 Гиб VHDX на каждую виртуальную машину — приблизительно 1 Тиб, а затем выполняет *равномерно случайных* считывает и записывает в них. В отличие от реальных рабочих нагрузок операции чтения не выполняйте любым другим шаблоном прогнозируемый или повторяющихся, поэтому кэш в памяти не действует и только что влечет за собой издержки.

## <a name="configuring-the-in-memory-read-cache"></a>Настройка в памяти кэш чтения

CSV-ФАЙЛ в памяти чтения кэш будет доступен в Windows Server 2016 и Windows Server 2019 с одинаковой функциональностью. В Windows Server 2016 оно отключено по умолчанию. В Windows Server 2019 оно включено по умолчанию 1 ГБ выделенной.

| Версия ОС          | По умолчанию размер кэша CSV |
|---------------------|------------------------|
| Windows Server 2016 | 0 (отключено)           |
| Windows Server 2019 | 1 Гиб                   |

Чтобы узнать, сколько памяти выделяется с помощью PowerShell, выполните следующую команду:

```PowerShell
(Get-Cluster).BlockCacheSize
```

Возвращаемое значение в mebibytes (MiB) на каждом сервере. Например `1024` представляет 1 гигабайт (ГБ).

Чтобы изменить объем памяти выделяется, измените это значение с помощью PowerShell. Например чтобы выделить 2 ГБ на один сервер, выполните следующую команду:

```PowerShell
(Get-Cluster).BlockCacheSize = 2048
```

Для изменения вступают в силу немедленно, приостановить и возобновить тома CSV или перемещать их между серверами. Например можно используйте этот фрагмент PowerShell для перемещения каждого CSV-ФАЙЛ на другой узел сервера и обратно:

```PowerShell
Get-ClusterSharedVolume | ForEach {
    $Owner = $_.OwnerNode
    $_ | Move-ClusterSharedVolume
    $_ | Move-ClusterSharedVolume -Node $Owner
}
```

## <a name="see-also"></a>См. также

- [Общие сведения о дисковых хранилища](storage-spaces-direct-overview.md)
