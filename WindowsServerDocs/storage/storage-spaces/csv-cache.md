---
title: Локальные дисковые пространства в кэш чтения памяти
ms.prod: windows-server-threshold
ms.author: eldenc
ms.manager: siroy
ms.technology: storage-spaces
ms.topic: article
author: eldenchristensen
ms.date: 02/20/2019
ms.localizationpriority: medium
ms.openlocfilehash: 7ed5894a569d4c42a3a4b0e018de5171f2c84a62
ms.sourcegitcommit: 5ed023a2ef3a9002daf41c7717feb1df186d2a14
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2019
ms.locfileid: "9122057"
---
# С помощью локальных дисковых пространств с помощью CSV-файла в памяти кэш чтения
> Область применения: Windows Server 2016, Windows Server 2019 г.

В этом разделе описывается, как использовать системную память для повышения производительности [локальных дисковых](storage-spaces-direct-overview.md)пространств.

Локальные дисковые пространства совместим с помощью общего тома кластера (CSV) в памяти кэш чтения. С помощью системной памяти кэширование операций чтения можно повысить производительность приложения, такие как Hyper-V, который использует без буферизации ввода-вывода для доступа к файлам VHD или VHDX. (Без буферизации IOs являются любых операций, которые не кэшируются диспетчером кэша Windows).

Так как кэш в памяти является локальный сервер, он повышает расположения данных для гиперконвергентных развертываний локальных дисковых пространств: кэшируются последних операций чтения в памяти на одном узле, где выполняется на виртуальной машине, как часто уменьшения операции чтения перейти по сети. Это приводит к более низкой задержкой и более высокую производительность хранилища.

## Нужно учитывать при планировании

Кэш является наиболее эффективным для чтения рабочих нагрузок, например виртуального рабочего стола инфраструктуры виртуальных рабочих СТОЛОВ чтения в памяти. И наоборот Если рабочая нагрузка — очень записи интенсивно, кэш может приводить к чем значение и должна быть отключена.

Вы можете использовать до 80% от общего объема физической памяти для CSV-файла в кэш чтения памяти.

  > [!TIP]
  > Для гиперконвергентных развертываний, где вычислений и хранения работать на тех же серверах, будьте внимательны, чтобы оставить достаточный объем памяти для виртуальных машин. Для конвергентных развертываниях масштабируемый файловый сервер (SoFS), с меньшим количеством конфликтов памяти это не применяется.

  > [!NOTE]
  > Некоторые средства microbenchmarking как DISKSPD и [Флота виртуальная машина](https://github.com/Microsoft/diskspd/tree/master/Frameworks/VMFleet) может привести к хуже результатам с помощью CSV-файла в память прочитать кэш включен чем без него. По умолчанию флота виртуальных Машин создает один 10 головку VHDX на каждую виртуальную машину — около 1 Тиб общее количество для 100 виртуальных машин — и выполняет *равномерно* операциями чтения и записи их. В отличие от реальных рабочих нагрузок операции чтения не будете следовать любым шаблоном прогнозируемый или повторяющееся кэша в памяти не является эффективным и просто снижает производительность.

## Настройка в памяти кэш чтения

CSV-файла в память чтения кэша же функциональность доступна в Windows Server 2016 и Windows Server 2019. В Windows Server 2016 она отключена по умолчанию. В Windows Server 2019 она включена по умолчанию с 1 ГБ выделенных.

| Версия ОС          | Размер кэша CSV-файла по умолчанию |
|---------------------|------------------------|
| WindowsServer2016 | 0 (отключено)           |
| WindowsServer2019 | 1 головку                   |

Чтобы узнать, сколько памяти выделяется с помощью PowerShell, выполните:

```PowerShell
(Get-Cluster).BlockCacheSize
```

Возвращаемое значение в mebibytes (размером Миб) на сервер. Например `1024` представляет 1 gibibyte (головку).

Чтобы изменить объем памяти, измените это значение, с помощью PowerShell. Например чтобы распределить 2 головку на сервер, выполните следующую команду:

```PowerShell
(Get-Cluster).BlockCacheSize = 2048
```

Для изменения вступили в силу немедленно, приостановить, а затем продолжить томов CSV-файла или перемещать их между серверами. Например используйте этот фрагмент PowerShell для перемещения каждого CSV-файла на другой узел сервера и снова:

```PowerShell
Get-ClusterSharedVolume | ForEach {
    $Owner = $_.OwnerNode
    $_ | Move-ClusterSharedVolume
    $_ | Move-ClusterSharedVolume -Node $Owner
}
```

## См. также

- [Обзор локальных дисковых пространств](storage-spaces-direct-overview.md)
