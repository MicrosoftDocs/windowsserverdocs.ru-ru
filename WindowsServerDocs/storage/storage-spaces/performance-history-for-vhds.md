---
title: Журнал производительности для виртуальных жестких дисков
ms.author: cosdar
manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: cosmosdarwin
ms.date: 02/09/2018
ms.localizationpriority: medium
ms.openlocfilehash: d917c2d75c1e4078438b94e8aa4a6f921019af5a
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80856167"
---
# <a name="performance-history-for-virtual-hard-disks"></a>Журнал производительности для виртуальных жестких дисков

> Область применения: Windows Server 2019

В этом подразделе [журнала производительности для Локальные дисковые пространства](performance-history.md) подробно описывается журнал производительности, собранный для файлов виртуального жесткого диска (VHD). Журнал производительности доступен для каждого виртуального жесткого диска, подключенного к работающей кластеризованной виртуальной машине. Журнал производительности доступен для форматов VHD и VHDX, однако он недоступен для общих VHDX-файлов.

   > [!NOTE]
   > Запуск сбора для новых или перемещенных VHD-файлов может занять несколько минут.

## <a name="series-names-and-units"></a>Имена и единицы рядов

Эти серии собираются для каждого подходящего виртуального жесткого диска:

| Ряд                    | Единица измерения             |
|---------------------------|------------------|
| `vhd.iops.read`           | в секунду       |
| `vhd.iops.write`          | в секунду       |
| `vhd.iops.total`          | в секунду       |
| `vhd.throughput.read`     | байт в секунду |
| `vhd.throughput.write`    | байт в секунду |
| `vhd.throughput.total`    | байт в секунду |
| `vhd.latency.average`     | секунд          |
| `vhd.size.current`        | байты            |
| `vhd.size.maximum`        | байты            |

## <a name="how-to-interpret"></a>Как интерпретировать

| Ряд                    | Как интерпретировать                                                                                                 |
|---------------------------|------------------------------------------------------------------------------------------------------------------|
| `vhd.iops.read`           | Число операций чтения в секунду, выполненных виртуальным жестким диском.                                         |
| `vhd.iops.write`          | Число операций записи в секунду, выполненных виртуальным жестким диском.                                        |
| `vhd.iops.total`          | Общее число операций чтения или записи в секунду, выполненных виртуальным жестким диском.                          |
| `vhd.throughput.read`     | Количество данных, считанных с виртуального жесткого диска в секунду.                                                     |
| `vhd.throughput.write`    | Количество данных, записанных на виртуальный жесткий диск в секунду.                                                    |
| `vhd.throughput.total`    | Общее количество данных, считанных или записанных на виртуальный жесткий диск в секунду.                                 |
| `vhd.latency.average`     | Средняя задержка всех операций на виртуальный жесткий диск или с него.                                              |
| `vhd.size.current`        | Текущий размер файла виртуального жесткого диска, если он динамически развертывается. Если этот параметр зафиксирован, ряд не собирается. |
| `vhd.size.maximum`        | Максимальный размер виртуального жесткого диска при динамическом расширении. Если параметр имеет значение Fixed, то — это размер.                  |

## <a name="where-they-come-from"></a>Откуда они приходят

Ряды `iops.*`, `throughput.*`и `latency.*` собираются из счетчика производительности `Hyper-V Virtual Storage Device`, установленного на сервере, где работает виртуальная машина, по одному экземпляру на каждый виртуальный жесткий диск или VHDX.

| Ряд                    | Счетчик источника         |
|---------------------------|------------------------|
| `vhd.iops.read`           | `Read Operations/Sec`  |
| `vhd.iops.write`          | `Write Operations/Sec` |
| `vhd.iops.total`          | *сумма приведенной выше*     |
| `vhd.throughput.read`     | `Read Bytes/sec`       |
| `vhd.throughput.write`    | `Write Bytes/sec`      |
| `vhd.throughput.total`    | *сумма приведенной выше*     |
| `vhd.latency.average`     | `Latency`              |

   > [!NOTE]
   > Счетчики измеряются для всего интервала, а не для выборки. Например, если виртуальный жесткий диск неактивен в течение 9 секунд, но завершает 30 IOs в десятой секунде, его `vhd.iops.total` будет записываться в среднем 3 IOs в секунду в течение этого интервала в 10 секунд. Это гарантирует, что журнал производительности захватывает все действия и является надежным для шума.

## <a name="usage-in-powershell"></a>Использование в PowerShell

Используйте командлет [Get-VHD](https://docs.microsoft.com/powershell/module/hyper-v/get-vhd) :

```PowerShell
Get-VHD <Path> | Get-ClusterPerf
```

Чтобы получить путь к каждому виртуальному жесткому диску из виртуальной машины, сделайте следующее:

```PowerShell
(Get-VM <Name>).HardDrives | Select Path
```

   > [!NOTE]
   > Для командлета Get-VHD требуется указать путь к файлу. Он не поддерживает перечисление.

## <a name="see-also"></a>См. также:

- [Журнал производительности для Локальные дисковые пространства](performance-history.md)
