---
ms.assetid: 1368bc83-9121-477a-af09-4ae73ac16789
title: Выбор дисков для локальных дисковых пространств
ms.prod: windows-server-threshold
ms.author: cosdar
ms.manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: cosmosdarwin
ms.date: 10/08/2018
ms.localizationpriority: medium
ms.openlocfilehash: eb19e7ecf89f02200d3393dc1a4a9e5cd85cf598
ms.sourcegitcommit: 1bc3c229e9688ac741838005ec4b88e8f9533e8a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/18/2019
ms.locfileid: "68314992"
---
# <a name="choosing-drives-for-storage-spaces-direct"></a>Выбор дисков для локальных дисковых пространств

>Относится к: Windows 2019, Windows Server 2016

В этом разделе приведены рекомендации по выбору носителей для [локальных дисковых пространств](storage-spaces-direct-overview.md), которые будут соответствовать вашим требованиям к производительности и емкости.

## <a name="drive-types"></a>Типы дисков

Локальные дисковые пространства в настоящее время поддерживают работу с тремя типами дисков:

<table>
    <tr style="border: 0;">
        <td style="padding: 10px; border: 0; width:70px">
            <img src="media/understand-the-cache/NVMe-100px.png">
        </td>
        <td style="padding: 10px; border: 0;" valign="middle">
            <b>NVMe</b> (Non-Volatile Memory Express) — это твердотельные диски, подключенные непосредственно к шине PCIe. Распространенные форм-факторы: 2,5 дюйма U.2, плата расширения PCIe (AIC) и M.2. NVMe обеспечивает повышенный уровень IOPS и производительности ввода-вывода и IO с минимальной среди всех поддерживаемых на сегодня дисков задержкой.
        </td>
    </tr>
    <tr style="border: 0;">
        <td style="padding: 10px; border: 0; width:70px" >
            <img src="media/understand-the-cache/SSD-100px.png">
        </td>
        <td style="padding: 10px; border: 0;" valign="middle">
            <b>SSD</b> — это твердотельные накопители, которые подключаются к стандартным разъемам SATA и SAS.
        </td>
    </tr>
    <tr style="border: 0;">
        <td style="padding: 10px; border: 0; width:70px">
            <img src="media/understand-the-cache/HDD-100px.png">
        </td>
        <td style="padding: 10px; border: 0;" valign="middle">
            <b>Жесткие диски</b> — это вращающиеся механические магнитные диски большой емкости.
        </td>
    </tr>
</table>

## <a name="built-in-cache"></a>Встроенный кэш

Локальные дисковые пространства обладают встроенным серверным кэшем. Это большой, постоянно работающий в режиме реального времени кэш чтения и записи. При развертывании с несколькими типами дисков он автоматически использует все самые быстрые диски. Остальные накопители используются для емкости.

Подробнее см. в разделе [Общие сведения о кэше локальных дисковых пространств](understand-the-cache.md).

## <a name="option-1--maximizing-performance"></a>Вариант 1 — оптимизация производительности

Чтобы получить предсказуемую и согласованную задержку менее миллисекунды между случайными операциями чтения и записи любых данных, очень высокое значение IOPS (мы получили [более шести миллионов](https://www.youtube.com/watch?v=0LviCzsudGY&t=28m)!) или пропускную способность ввода-вывода (мы добились значения более [1 ТБ/с](https://www.youtube.com/watch?v=-LK2ViRGbWs&t=16m50s)!), необходимо полностью перейти на флэш-накопители.

Это можно сделать тремя способами:

![Варианты развертывания только с флэш-накопителями](media/choosing-drives-and-resiliency-types/All-Flash-Deployment-Possibilities.png)

1. **Все NVMe.** Использование только накопителей NVMe обеспечивает непревзойденную производительность и наиболее предсказуемую задержку. Если все диски одной модели, кэш отсутствует. Вы также можете смешивать модели NVMe с высоким и низким уровнем износостойкости и настроить первые для кэширования операций записи вторых ([требуется настройка](understand-the-cache.md#manual-configuration)).

2. **NVMe + SSD.** При использовании NVMe вместе с SSD накопители NVMe автоматически кэшируют операции записи на SSD. Это позволяет объединить операции записи в кэше и переносить их только при необходимости, чтобы уменьшить износа SSD. Так можно получить характеристики, аналогичные NVMe, при этом операции чтения обслуживаются непосредственно на быстрых SSD.

3. **Все SSD.** Как и при использовании только накопителей NVMe, кэш отсутствует, если все диски одной модели. Вы также можете смешивать накопители с высоким и низким уровнем износостойкости и настроить первые для кэширования операций записи вторых ([требуется настройка](understand-the-cache.md#manual-configuration)).

   >[!NOTE]
   > Преимущество использования только NVMe или SSD без кэша состоит в том, что вы получаете доступную емкость с каждого диска. Место не «тратится» на кэширование, что может быть привлекательным при небольших масштабах.

## <a name="option-2--balancing-performance-and-capacity"></a>Вариант 2 — балансировка производительности и емкости

В средах с различными приложениями и рабочими нагрузками, одни из которых отличаются жесткими требованиями к производительности, а другим необходима значительная емкость хранилища, следует выбрать "гибридный" вариант с кэшированием на NVMe или SSD для больших жестких дисков.

![Варианты гибридного развертывания](media/choosing-drives-and-resiliency-types/Hybrid-Deployment-Possibilities.png)

1. **NVMe + жесткие диски**. Диски NVMe ускоряют операции чтения и записи, кэшируя их. Кэширование операций чтения позволяет жестким дискам сосредоточиться на записи. Кэширование операций записи помогает справиться с пиками, объединить операции записи и переносить их только при необходимости искусственно сериализованным способом, который оптимизирует IOPS и пропускную способность ввода-вывода жестких дисков. Это позволяет получить характеристики записи, аналогичные NVMe, а для часто или недавно прочитанных данных — и характеристики чтения, аналогичные NVMe.

2. **SSD + жесткий диск**. Аналогично сказанному выше, SSD-диски ускоряют операции чтения и записи, кэшируя их. Это обеспечивает характеристики записи, аналогичные SSD, а для часто или недавно прочитанных данных — характеристики чтения, аналогичные SSD.

    Существует еще один, довольно экзотический вариант: использовать диски *всех трех* типов.

3. **NVMe + SSD + HDD.** В таком случае диски NVMe кэшируют данные для дисков остальных типов. Преимущество состоит в том, что вы можете создавать тома на SSD и на жестких дисках параллельно в одном кластере, все из которых будут ускоряться NVMe. Тома на SSD совпадают с конфигурацией в развертывании только с флэш-накопителями, а тома на жестких дисках — с «гибридными» развертываниями, описанными выше. По смыслу это похоже два пула с независимым управлением емкостью, циклами сбоев и восстановления и т. д.

   >[!IMPORTANT]
   > Рекомендуем использовать уровень SSD для размещения самых требовательных к производительности рабочих нагрузок в системе только с флэш-накопителями.

## <a name="option-3--maximizing-capacity"></a>Вариант 3 — максимальное увеличение емкости

Для рабочих нагрузок, которые требуют большой емкости и редко используются для записи (например, архивация, резервное копирование, хранилище данных, автономное неструктурированное защищенное хранилище), нужно комбинировать несколько дисков SSD для кэширования со множеством больших жестких дисков для хранения.

![Варианты развертывания для максимального увеличения емкости](media/choosing-drives-and-resiliency-types/maximizing-capacity.png)

1. **SSD + жесткий диск**. SSD-диски кэшируют операции чтения и записи для обработки пиков, получения высокой производительности записи и оптимизированного переноса на жесткие диски в дальнейшем.

>[!IMPORTANT]
>Конфигурация только с дисковыми настройками не поддерживается. Высокий уровень кэширования ендуранце твердотельных накопителей для малых ендуранце твердотельных накопителей не рекомендуется.

## <a name="sizing-considerations"></a>Вопросы, связанные с определением размера

### <a name="cache"></a>Кэш

У каждого сервера должно быть по крайней мере два диска кэша (это минимум, необходимый для обеспечения избыточности). Рекомендуется делать число накопителей-хранилищ кратным числу кэш-накопителей. Например, если у вас четыре кэш-накопителя, то при наличии восьми накопителей-хранилищ (соотношение 1:2) производительность будет более стабильной, чем при семи или девяти.

Размер кэша должен соответствовать рабочему набору приложений и рабочих нагрузок, т. е. ко всем данным, которые они активно считывают и записывают в любое заданное время. Других требований к размеру кэша не существует. Для развертываний с жестких дисками достаточно места — 10% емкости. Например, если на каждом сервере имеется 4 жестких диска объемом 4 ТБ = 16 ТБ, то 2 x 800 ГБ SSD = 1,6 ТБ кэша на сервер. Для всех развертываний Flash, особенно с очень [высокими ендуранце](https://blogs.technet.microsoft.com/filecab/2017/08/11/understanding-dwpd-tbw/) твердотельными накопителями, можно начать с более чем на 5% емкости. Например, если на каждом сервере имеется 24 x 1,2 ТБ SSD = 28,8 ТБ емкости, то 2 x 750 ГБ NVMe = 1,5 ТБ кэша на сервер. Вы всегда можете добавить или удалить кэш-накопители позже для оптимизации.

### <a name="general"></a>Общие

Мы рекомендуем ограничить общий объем хранилища на сервер — приблизительно до 100 терабайт (ТБ). Чем больше объем хранилища на сервер, тем больше времени необходимо для повторной синхронизации данных после простоя или перезагрузки, например при применении обновлений программного обеспечения.

Текущий максимальный размер для пула носителей составляет 4 петабайтного уровня (PB) (4 000 ТБ) для Windows Server 2019 или 1 петабайтного уровня для Windows Server 2016.

## <a name="see-also"></a>См. также

- [Обзор Локальные дисковые пространства](storage-spaces-direct-overview.md)
- [Общие сведения о кэше в Локальные дисковые пространства](understand-the-cache.md)
- [Требования к оборудованию Локальные дисковые пространства](storage-spaces-direct-hardware-requirements.md)
- [Планирование томов в Локальные дисковые пространства](plan-volumes.md)
- [Отказоустойчивость и эффективность хранения](storage-spaces-fault-tolerance.md)
