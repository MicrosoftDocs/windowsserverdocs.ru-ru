---
title: Наборы кластеров
ms.prod: windows-server-threshold
ms.manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: johnmarlin-msft
ms.date: 01/30/2019
description: В этой статье описывается сценарий наборов кластера
ms.localizationpriority: medium
ms.openlocfilehash: 2deeb6968f910e80bacb2354ad2e575060a7797a
ms.sourcegitcommit: 07aefbdbb0eedb42aaed3d195c2429310c761da0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/31/2019
ms.locfileid: "9041010"
---
# Наборы кластеров

> Область применения: 17650 и более поздних версиях сборки предварительной оценки Windows Server

Наборы кластера — новая технология масштабируемого облака в этом выпуске предварительного просмотра, что увеличивает количество узла кластера в облаке единый центр определенных данных (SDDC) программного обеспечения на несколько порядков. Набор кластера — слабо совокупность нескольких отказоустойчивых кластеров: вычисления, хранение или гиперконвергентная. Кластера задает технология позволяет виртуальной машине динамичность кластерам элементов в наборе кластера и пространства имен единый хранилища распределяя поддержки динамичность виртуальной машины. 

Во время сохранения существующих Управление отказоустойчивым кластером возникают в кластерах члена, экземпляр набор кластера Кроме того предлагает случаев использования ключей вокруг управление жизненным циклом в объединить данные. Это ознакомительная версия сценария оценки руководство по Windows Server предоставляет необходимые сведения вместе с пошаговые инструкции для оценки возможностей наборов кластера с помощью PowerShell. 

## Введение в технологию

Технология наборов кластера разработана для удовлетворения запросов клиентами для конкретных эксплуатация облаках программного обеспечения определенные центра обработки данных (SDDC) в масштабе. Ценность наборов кластера в этом выпуске предварительного просмотра может описываемый следующим:  

- Значительно увеличьте масштаб поддерживаемых облачных SDDC для запуска виртуальных машин путем объединения нескольких кластеров меньшего размера в единой структуры большой, даже сохранив при этом границы сбоя программное обеспечение в одном кластере
- Управление всего жизненного цикла отказоустойчивый кластер, в том числе подключения и прекращено кластеры, без влияния на доступность виртуальной машины клиента, через адаптацию миграции виртуальных машин на этот большой структуры
- Легко изменить соотношение вычислений для хранения в вашей гиперконвергентной I
- Преимущества [доменов сбоя подобного Azure и доступности задает](htttps://docs.microsoft.com/azure/virtual-machines/windows/manage-availability) кластерам в размещения начального виртуальной машины и последующих виртуальной машины миграции
- Оптимальное сочетание разные поколения ЦП в одном кластере задать структуры, даже сохранив при этом отдельных сбоя однородные для максимальной эффективности.  Обратите внимание, что рекомендация существующее оборудование по-прежнему присутствует в каждом отдельных кластера, а также набор всего кластера.

Из представления верхнего уровня это какие наборы могут выглядеть такие кластера.

![Кластер задает решение представления](media\Cluster-sets-Overview\Cluster-sets-solution-View.png)

В этом разделе представлены краткое описание каждого из элементов в образе выше:

**Управление кластера**

Управление кластер в наборе кластера — отказоустойчивого кластера, на котором размещена плоскость высокодоступные управления установите весь кластер и рекомендации пространство имен (пространство имен задать кластера) единый хранилища масштабируемый файловый сервер (SOFS). Кластер управления — логически отделенный от члена кластеров под управлением рабочие нагрузки виртуальной машины. Это позволяет кластеру значение плоскости управления устойчивыми локализованные сбои всего кластера, например потеря питания членов кластера.   

**Член кластера**

Член кластера в наборе кластера обычно является традиционных гиперконвергентными кластерами под управлением виртуальной машины и локальных дисковых пространств рабочих нагрузок. Несколько кластеров член участвуют в развертывании набор один кластер, формирующих больших структуры облачных SDDC. Член кластеры отличаются от управления кластером в две ключевые аспекты: член кластеров участвовать в домен сбоя и доступности набором конструкции, а кластеры член также размеры для узла виртуальной машины и локальных дисковых пространств рабочих нагрузок. Кластер набор виртуальных машин, переместить через границы кластера в наборе кластера не должен быть размещен в кластере управления по этой причине.

**Кластер настроить рекомендацию имен SOFS**

Ссылка имен набор кластера (кластера задать пространство имен) SOFS — это масштабируемого файлового сервера при котором каждый SMB совместно использовать на SOFS имен задать кластера — это общая папка рекомендацию — типа SimpleReferral новых представленных в этом выпуске предварительного просмотра.  Это ссылка позволяет клиентам блок сообщений сервера (SMB) доступ к целевой объект совместно использовать SMB размещенных в кластере члена SOFS. Кластера настроить рекомендацию имен SOFS — это механизм облегченной рекомендаций и таким образом, не участвует в пути ввода-вывода. Рекомендации SMB постоянное кэшируются на всех узлах клиента и пространство имен наборов кластера динамически автоматическое обновление эти рекомендации при необходимости.

**Задайте главного узла кластера**

В набор кластера обмена данными между кластерами члена слабо и согласуется с новый кластер ресурс с именем «Кластера задать образец» (CS-образец). Как и любой другой ресурс кластера CS-Master высокой доступности и устойчивым к отдельных членов кластера ошибок и сбоев узлов кластера управления. Через новый поставщик WMI задать кластера CS-Master предоставляет конечной точки управления для всех задать кластера управляемости видов взаимодействия.

**Рабочий набор кластера**

При развертывании задать кластера в CS-образец взаимодействует с новый ресурс кластера в члене кластерами под названием «Кластера задать рабочий процесс» (CS-работник). CS-рабочий действует только звеном в кластере для координации таких действий взаимодействие с помощью локального кластера по запросу CS-главного узла. Примеры таких взаимодействий: размещения виртуальных машин и инвентаризация кластера локальных ресурсов. Существует только один экземпляр CS-работник для каждого члена кластеров в наборе кластера. 

**Домен сбоя**

Домен сбоя — это совокупность программного обеспечения и оборудования артефактов, которые администратор определяет, может дать сбой друг с другом при возникновении сбоя.  Когда администратор может назначить одному или нескольким кластерам друг с другом домене сбоя, каждый узел может участвовать в домен сбоя в наборе доступности. Кластера задает, листья проектирования решение определение границы домен сбоя для администратора, хорошо versed с данными центра некоторые аспекты топологии — например блоку распределения Питания, сеть — член кластеров общего доступа. 

**Настройка доступности**

Набор доступность позволяет администратору настроить нужный избыточность кластерных рабочих нагрузок через доменов сбоя, упорядочивая их в коллекцию доступности и развертыванию рабочих нагрузок в этот набор доступности. Предположим, если вы развертываете 2 уровня приложения, рекомендуется настроить по крайней мере два виртуальных машин в доступности для каждой категорией, который будет убедитесь, что когда один домен сбоя в этом наборе доступность отключается, ваше приложение будет по крайней мере Задайте одна виртуальная машина в каждой категорией, размещенного в домене различных сбоя этой же доступности.

## Зачем использовать наборы кластера

Наборы кластера преимущество этого масштаба без ущерба для отказоустойчивости.  

Наборы кластера позволяет кластеризации несколько кластеров друг с другом для создания большой структуры, а каждый кластер продолжает независимо для обеспечения устойчивости.  Например, у вас есть несколько HCI 4-узловой кластерах виртуальных машин.  Каждый кластер обеспечивает устойчивости, необходимые для себя.  Если хранилища или памяти запускается заполнения, масштабирование является к следующему шагу.  С помощью вертикальное масштабирование, существует ряд вариантов и рекомендации.

1. Добавьте дополнительные хранилище для текущего кластера.  С помощью локальных дисковых пространств это может быть сложным точное диски одной модели или встроенного по могут быть недоступны.  Задуматься о времени перестроения также необходимо принимать во внимание.
2. Увеличить объем памяти.  Что делать, если вы израсходован в памяти, которые можно обрабатывать компьютеров?  Что делать, если все доступной памяти ячейки полный?
3. Добавьте дополнительные вычислительные узлы с дисками в текущего кластера.  Это вернетесь нам вариант 1 необходимости учитывать.
4. Приобретение совершенно новый кластер

Это где наборов кластера преимущество масштабирования.  Если добавить моих кластеров в набор кластера, я могут воспользоваться хранилища или памяти, которые могут быть доступны на другой кластер без все дополнительные покупки.  С точки зрения устойчивости Добавление дополнительных узлов в локальных дисковых пространств не будет предоставлять дополнительные голосов для кворума.  Как упоминалось [здесь](drive-symmetry-considerations.md)дисковых пространств кластер хранилища продолжают работать способ справиться с 2 узлами перед началом.  Если у вас 4-узловой кластер HCI, 3 узлы неработоспособным займет всего кластера.  Если у вас есть 8 узлами кластера, 3 узлы неработоспособным займет всего кластера.  С помощью sets кластера, имеет два кластера HCI 4-узловой в наборе неработоспособным двух узлов в один HCI и неработоспособным 1 узла в других HCI, обоих кластерах остаются вверх.  Что лучше: создание один большой 16-узла кластера локальных дисковых пространств или разбить его на четыре 4-узловой кластеров и использование наборов кластера?  Наличие четыре 4-узловой кластеров с предоставляет наборы кластера же масштаб, но лучше устойчивости, так как несколько вычислительные узлы можно перейти (неожиданно или для обслуживания) и остается в рабочей среде.

## Рекомендации по развертыванию наборов кластера

При рассмотрении, если наборов кластера является то, что необходимо использовать, рассмотрите следующие вопросы.

- Требуется выходит за пределы HCI вычислений и хранения данных масштабирования ограничения по?
- Все вычислений и хранения данных не совпадают одинаково?
- Динамической миграции виртуальных машин между кластерами?
- Вы хотите наборы доступность подобного Azure компьютеров и доменов сбоя нескольким кластерам?
- Вам необходимо выполнить времени на просмотр всех кластеров, чтобы определить, где необходимо разместить все новые виртуальные машины?

Если ваш ответ Да, затем устанавливает кластера вам нужен.

Существует несколько других элементов необходимо учитывать, где больших SDDC может изменить стратегии центра данных в целом.  SQL Server является хорошим примером.  Перемещение виртуальных машин SQL Server между кластерами требует лицензирования SQL для запуска на дополнительных узлов?  

## Масштабируемый файловый сервер и наборов кластера

В Windows Server 2019 есть новую роль масштабируемого файлового сервера под названием инфраструктуры масштабируемый файловый сервер (SOFS). 

Действуют следующие играет роль SOFS инфраструктуры:

1.  В отказоустойчивом кластере может быть не более только одна роль кластера SOFS инфраструктуры. Роль SOFS инфраструктуры создается путем указания "**-инфраструктуры**" переключения параметров для командлета **Add-ClusterScaleOutFileServerRole** .  Пример.

        Add-ClusterScaleoutFileServerRole -Name "my_infra_sofs_name" -Infrastructure

2.  Каждый том CSV-файла, автоматически создается в отказоустойчивом инициирует создание общей папки SMB с именем автоматически созданный на основе имени тома CSV-файла. Администратор нельзя напрямую создавать или изменять общие ресурсы SMB в разделе играет роль SOFS, отличный от через операции Создание или изменение тома CSV-файла.

3.  В гиперконвергентной конфигурации SOFS инфраструктуры позволяет клиент SMB (узел Hyper-V) для связи с гарантированной непрерывной доступности (ЦС) к серверу SMB SOFS инфраструктуры. Это гиперконвергентной SMB замыкания на себя ЦС обеспечивается путем виртуальных машин, доступ к их файлам виртуального диска (VHDx), где-владельцем идентификатор виртуальной машины перенаправляется между клиентом и сервером. Такой способ пересылки удостоверение позволяет ACL применения всех этих файлов, как и стандартные кластера конфигураций перед.

После создания кластера набор пространство имен набор кластера зависит от SOFS инфраструктуры на каждом из кластеров элементов, а кроме того SOFS инфраструктуры управления кластера.

Во время членов кластера добавляется к набору кластера, администратор указывает имя SOFS инфраструктуры в этом кластере, если он уже существует. Если SOFS инфраструктуры не существует, новая роль SOFS инфраструктуры на новый кластер члена создается этой операцией. Если в кластере член уже существует играет роль SOFS инфраструктуры, операции добавления неявно переименовывается в указанное имя при необходимости. Все существующие серверы SMB Singleton-объект, или SOFS, не являющихся инфраструктура ролей на член, который остается кластеров unutilized заданное кластера. 

Во время создания набора кластера администратор имеет возможность использования объекта существующей AD компьютера в качестве корня пространства имен в кластере управления. Операции set создания кластера создать роль кластера SOFS инфраструктуры в кластере управления или переименовывает существующей инфраструктуры SOFS роли, так же как описано выше кластеров члена. SOFS инфраструктуры в кластере управления используется как кластера с набором имен ссылок (кластера задать пространство имен) SOFS. Он просто означает, что каждый SMB общего доступа в кластере пространства имен, SOFS — это ссылка общая папка — типа, «SimpleReferral» - новых представленных в этом выпуске предварительного просмотра.  Это рекомендаций позволяет SMB клиентам доступ к назначению совместно использовать SMB размещенных в кластере члена SOFS. Кластера настроить рекомендацию имен SOFS — это механизм облегченной рекомендаций и таким образом, не участвует в пути ввода-вывода. Рекомендации SMB постоянное кэшируются на всех узлах клиента и пространство имен наборов кластера динамически автоматическое обновление эти рекомендации при необходимости

## Создание набора кластера

### Необходимые условия

При создании кластера, выполнив необходимые условия, рекомендуется:

1. Настройка клиента управления выполняется последний выпуск программы предварительной оценки Windows Server.
2. Установите средства отказоустойчивого кластера на этот сервер управления.
3. Создание членов кластера (по крайней мере два кластера с по крайней мере два общих томов кластера в каждом кластере)
4. Создайте кластер управления (физическая или гостей), состоящего кластеров члена.  Этот подход гарантирует, что наборы кластера, которые плоскости управления по-прежнему доступны несмотря на сбои возможных членов кластера.

### Действия

1. Создайте новый кластер задать из трех кластеров, как указано в предварительных.  Ниже диаграмме приведен пример кластеров для создания.  Имя кластера, задайте в этом примере будет **CSMASTER**.

   | Имя кластера               | Имя SOFS инфраструктуры для использования в будущем | 
   |----------------------------|-------------------------------------------|
   | НАСТРОЙКА КЛАСТЕРА                | SOFS CLUSTERSET                           |
   | CLUSTER1                   | SOFS CLUSTER1                             |
   | CLUSTER2                   | SOFS CLUSTER2                             |

2. После создания всех кластера используйте следующие команды для создания набора главного узла кластера.

        New-ClusterSet -Name CSMASTER -NamespaceRoot SOFS-CLUSTERSET -CimSession SET-CLUSTER

3. Добавление сервера кластера в наборе кластера ниже будет использоваться.

        Add-ClusterSetMember -ClusterName CLUSTER1 -CimSession CSMASTER -InfraSOFSName SOFS-CLUSTER1
        Add-ClusterSetMember -ClusterName CLUSTER2 -CimSession CSMASTER -InfraSOFSName SOFS-CLUSTER2

   > [!NOTE]
   > Если вы используете схему статический IP-адрес, необходимо включить *x.x.x.x - StaticAddress* о команде **New-ClusterSet** .

4. После создания кластера задать за пределы членов кластера, можно перечислить набор узлов и его свойства.  Для перечисления всех кластеров элементов в наборе кластера:

        Get-ClusterSetMember -CimSession CSMASTER

5. Для перечисления всех кластеров элементов в кластере, установить, включая управление узлами кластера:

        Get-ClusterSet -CimSession CSMASTER | Get-Cluster | Get-ClusterNode

6. Получить список всех узлов из кластеров члена:

        Get-ClusterSetNode -CimSession CSMASTER

7. Чтобы получить список всех групп ресурсов в кластере задать:

        Get-ClusterSet -CimSession CSMASTER | Get-Cluster | Get-ClusterGroup 

8. Для проверки кластера задания создания общих папок SMB (определяется как Volume1 или любую папку CSV помечается ScopeName, что имя инфраструктуры файловый сервер и путь как) процесс создания SOFS инфраструктуры для каждого члена кластера Тома CSV-файла:

        Get-SmbShare -CimSession CSMASTER

8. Наборы кластера имеет журналов отладки, которые могут быть собраны для проверки.  Как задать кластера и для всех участников и управления кластером можно собирать журналы отладки кластера.

        Get-ClusterSetLog -ClusterSetCimSession CSMASTER -IncludeClusterLog -IncludeManagementClusterLog -DestinationFolderPath <path>

9. Настройка Kerberos [ограниченное делегирование](https://blogs.technet.microsoft.com/virtualization/2017/02/01/live-migration-via-constrained-delegation-with-kerberos-in-windows-server-2016/) между всеми членами набора кластера.

10. Задайте тип кросс cluster виртуальной машины динамической миграции проверки подлинности Kerberos на каждом узле в кластере.

        foreach($h in $hosts){ Set-VMHost -VirtualMachineMigrationAuthenticationType Kerberos -ComputerName $h }

11. Добавьте управления кластера в группу локальных администраторов на каждом узле в наборе кластера.

        foreach($h in $hosts){ Invoke-Command -ComputerName $h -ScriptBlock {Net localgroup administrators /add <management_cluster_name>$} }

## Создание новых виртуальных машин и добавление наборов кластера

После создания кластера, следующий шаг — для создания новых виртуальных машин.  Как правило когда наступает время для создания виртуальных машин и добавить их в кластере, необходимо выполнить некоторые проверки в кластерах, чтобы узнать, что он может быть лучше всего работать на.  Включить следующие проверки:

- Сколько памяти доступен на узлах кластера?
- Объем места на диске доступен на узлах кластера?
- Требует ли виртуальная машина требования хранилища (т. е. я хочу моих виртуальных машин SQL Server, чтобы перейти в кластер под управлением более быстрых дисках; или виртуальной машине инфраструктуры не как критические и могут работать на более медленных дисках).

После этого ответы, можно создать виртуальную машину в кластере, оно будет необходимо.  Одно из преимуществ наборов кластера является наборов кластера выполните эти проверки для вас и поместить на виртуальной машине на узле оптимальными.

Ниже команды будет выявлять оптимальной кластера и развертывание виртуальной машины к нему.  В следующем примере создается новую виртуальную машину указав что менее 4 ГБ памяти для виртуальной машины и что ему придется использовать 1 виртуального процессора.

- Убедитесь, что 4 ГБ для виртуальной машины
- Задайте виртуального процессора, используемый на 1
- Убедитесь в наличии по крайней мере 10% времени ЦП, доступному для виртуальной машины

   ```PowerShell
   # Identify the optimal node to create a new virtual machine
   $memoryinMB=4096
   $vpcount = 1
   $targetnode = Get-ClusterSetOptimalNodeForVM -CimSession CSMASTER -VMMemory $memoryinMB -VMVirtualCoreCount $vpcount -VMCpuReservation 10
   $secure_string_pwd = convertto-securestring "<password>" -asplaintext -force
   $cred = new-object -typename System.Management.Automation.PSCredential ("<domain\account>",$secure_string_pwd)

   # Deploy the virtual machine on the optimal node
   Invoke-Command -ComputerName $targetnode.name -scriptblock { param([String]$storagepath); New-VM CSVM1 -MemoryStartupBytes 3072MB -path $storagepath -NewVHDPath CSVM.vhdx -NewVHDSizeBytes 4194304 } -ArgumentList @("\\SOFS-CLUSTER1\VOLUME1") -Credential $cred | Out-Null
   
   Start-VM CSVM1 -ComputerName $targetnode.name | Out-Null
   Get-VM CSVM1 -ComputerName $targetnode.name | fl State, ComputerName
   ```

Когда он завершает работу, он получит сведения о виртуальной машине и где он был помещен.  В приведенном выше примере он отображается как:

        State         : Running
        ComputerName  : 1-S2D2

Если вы не имеют достаточный объем памяти, ЦП или места на диске для добавления на виртуальной машине, вы получите ошибку:

      Get-ClusterSetOptimalNodeForVM : A cluster node is not available for this operation.  

После создания виртуальной машины, отображается в диспетчере Hyper-V на заданного конкретного узла.  Чтобы добавить его как кластер с набором виртуальной машины и в кластер, команда будет ниже.  

        Register-ClusterSetVM -CimSession CSMASTER -MemberName $targetnode.Member -VMName CSVM1

Когда он завершает работу, выходными данными будет:

         Id  VMName  State  MemberName  PSComputerName
         --  ------  -----  ----------  --------------
          1  CSVM1      On  CLUSTER1    CSMASTER

Если вы добавили в кластер с помощью существующих виртуальных машин, виртуальные машины также должна должно быть зарегистрировано с кластером, наборы таким образом зарегистрировать все виртуальные машины одновременно, который команда будет использовать:

        Get-ClusterSetMember -name CLUSTER3 -CimSession CSMASTER | Register-ClusterSetVM -RegisterAll -CimSession CSMASTER

Тем не менее процесс не полный путь к виртуальной машине нужны добавляемых в пространстве имен набор кластера.

Например, добавляется существующий кластер и на нем установлены предварительно настроенные виртуальной машины расположенные на локальном общего тома кластера (CSV) пути для всех этих будет что-то вроде «C:\ClusterStorage\Volume1\MYVM\Virtual жесткого Disks\MYVM.vhdx.  Переноса данных из хранилища необходимо будет осуществляться как CSV пути конструктивно локального в кластер одного элемента. Таким образом будут недоступны в виртуальную машину после их динамической миграции кластерам члена. 

В этом примере CLUSTER3 был добавлен в кластер, настраиваются с помощью Add-ClusterSetMember в инфраструктуре масштабируемого файлового сервера как SOFS CLUSTER3.  Чтобы переместить конфигурации виртуальной машины и хранилища, команда имеет вид:

        Move-VMStorage -DestinationStoragePath \\SOFS-CLUSTER3\Volume1 -Name MYVM

После завершения вы получите предупреждение:

        WARNING: There were issues updating the virtual machine configuration that may prevent the virtual machine from running.  For more information view the report file below.
        WARNING: Report file location: C:\Windows\Cluster\Reports\Update-ClusterVirtualMachineConfiguration '' on date at time.htm.

Это предупреждение можно игнорировать как это предупреждение «изменения в конфигурации хранилища роль виртуальной машины не обнаружены».  Причина предупреждение как фактическое физическое расположение не меняется; только пути конфигурации. 

Дополнительные сведения о VMStorage перемещения Просмотрите эту [ссылку](https://docs.microsoft.com/powershell/module/hyper-v/move-vmstorage?view=win10-ps). 

Live перенос виртуальной машины между кластерами набор другой кластер — это не так же, как и раньше. В сценариях без кластера набор будет действия:

1. Удалите роль виртуальной машины из кластера.
2. Динамическая миграция виртуальной машины на узел члена другого кластера.
3. Добавьте виртуальную машину в кластер как новую роль виртуальной машины.

С наборами кластера эти действия не являются обязательными и требуется только одна команда.  Например необходимо перейти на виртуальной машине задать кластера из CLUSTER1 узла 2-CL3 на CLUSTER3.  Бы одной команды:

        Move-ClusterSetVM -CimSession CSMASTER -VMName CSVM1 -Node NODE2-CL3

Обратите внимание, что это не будет перемещать файлы хранилища или конфигурации виртуальной машины.  Это нет необходимости, так как путь к виртуальной машине остается как \\SOFS-CLUSTER1\VOLUME1.  После регистрации на виртуальной машине с наборами кластера содержит путь к общей папке инфраструктуры файлового сервера, дисков и виртуальной машины не требуют будет размещено на том же компьютере на виртуальной машине.

## Создание доступность наборов доменов сбоя

Как описано в появлением доменов сбоя подобного Azure и доступности наборы можно настроить в наборе кластера.  Это полезно для размещения начального виртуальной машины и миграции между кластерами.  

В приведенном ниже примере существует четыре кластеров, участвующих в наборе кластера.  В наборе домен сбоя логические будет создан с двумя кластерами и домен сбоя была создана с помощью других два кластера.  Эти два сбоя будет входить набор Availabiilty. 

В приведенном ниже примере CLUSTER1 и CLUSTER2 будет в вызове **FD1** во время CLUSTER3 и CLUSTER4 будет находиться в домен сбоя под названием **FD2**домен сбоя.  Доступность набор будет вызываться **CSMASTER-AS** и состоять из двух сбоя.

Чтобы создать доменов сбоя, являются команды:

        New-ClusterSetFaultDomain -Name FD1 -FdType Logical -CimSession CSMASTER -MemberCluster CLUSTER1,CLUSTER2 -Description "This is my first fault domain"

        New-ClusterSetFaultDomain -Name FD2 -FdType Logical -CimSession CSMASTER -MemberCluster CLUSTER3,CLUSTER4 -Description "This is my second fault domain"

Чтобы убедиться, что они были созданы успешно, Get-ClusterSetFaultDomain выполнить своими выводимыми показано.

        PS C:\> Get-ClusterSetFaultDomain -CimSession CSMASTER -FdName FD1 | fl *

        PSShowComputerName    : True
        FaultDomainType       : Logical
        ClusterName           : {CLUSTER1, CLUSTER2}
        Description           : This is my first fault domain
        FDName                : FD1
        Id                    : 1
        PSComputerName        : CSMASTER

Теперь, когда были созданы доменов сбоя, доступность задать необходимо создать.

        New-ClusterSetAvailabilitySet -Name CSMASTER-AS -FdType Logical -CimSession CSMASTER -ParticipantName FD1,FD2

Для проверки, он будет создан, затем используйте:

        Get-ClusterSetAvailabilitySet -AvailabilitySetName CSMASTER-AS -CimSession CSMASTER

При создании новых виртуальных машин, затем вам необходимо использовать параметр - AvailabilitySet как часть Определение оптимального узла.  Таким образом оно будет выглядеть примерно следующим образом:

        # Identify the optimal node to create a new virtual machine
        $memoryinMB=4096
        $vpcount = 1
        $av = Get-ClusterSetAvailabilitySet -Name CSMASTER-AS -CimSession CSMASTER
        $targetnode = Get-ClusterSetOptimalNodeForVM -CimSession CSMASTER -VMMemory $memoryinMB -VMVirtualCoreCount $vpcount -VMCpuReservation 10 -AvailabilitySet $av
        $secure_string_pwd = convertto-securestring "<password>" -asplaintext -force
        $cred = new-object -typename System.Management.Automation.PSCredential ("<domain\account>",$secure_string_pwd)

Удаление кластера из кластера задает из-за различных жизненного цикла. Иногда возникают ситуации, когда кластер должен быть удален из набора кластера. Рекомендуется необходимо переместить всех виртуальных машин кластера набор из кластера. Это можно сделать с помощью команды **Перемещения ClusterSetVM** и **VMStorage перемещения** .

Тем не менее если виртуальные машины также не будут перемещаться, наборов кластера выполняет ряд действий для предоставления интуитивно понятный результат администратору.  При удалении кластера из набора всех остальных кластера набор виртуальных машин, размещенных в кластере удаления просто станет высокодоступные виртуальные машины, привязанного к этому кластеру, при условии, что у них есть доступ к их хранения.  Наборы кластера также автоматически обновит его инвентаризации по:

- Больше не отслеживает работоспособность кластера удален теперь и виртуальным машинам, работающим на нем
- Удаляет из пространства имен набор кластера и все ссылки на общих ресурсов, размещенных в кластере теперь удален

Например будет иметь команду, чтобы удалить кластера CLUSTER1 из наборов кластера:

        Remove-ClusterSetMember -ClusterName CLUSTER1 -CimSession CSMASTER

## Вопросы и ответы

**Вопрос:** В набор Мои кластера являюсь ли ограничен только с помощью гиперконвергентными кластерами? <br>
**Ответов:** Нет.  Локальные дисковые пространства можно комбинировать с традиционными кластерами.

**Вопрос:** Можно управлять Мои кластера задать через диспетчер виртуальных машин System Center? <br>
**Ответов:** Диспетчер виртуальных машин System Center в настоящее время не поддерживает наборы кластера <br><br> **Вопрос:** Можно Windows Server 2012 R2 или кластеры 2016 сосуществовать в один и тот же набор кластера? <br>
**Вопрос:** Можно провести миграцию рабочих нагрузок из системы Windows Server 2012 R2 или 2016 кластеров просто предложенному этих кластеров присоединиться к одного набора кластера? <br>
**Ответов:** Наборы кластера — это новая технология, представленной в предварительной версии Windows Server сборки, поэтому таким образом, не существует в предыдущих выпусках. Кластеры под управлением ОС нижнего уровня не может присоединиться к набор кластера. Тем не менее технологии последовательного обновления кластера операционной системы должны предоставлять возможности миграции, вы ищете по обновлению этих кластеров в Windows Server 2019.

**Вопрос:** Можно наборов кластера разрешает масштабировать хранилище и вычислений (отдельно)? <br>
**Ответов:** Да, позволяя просто добавлять прямой пространства хранилища или традиционного кластера Hyper-V. С наборами кластера это очень просто изменение соотношение вычислений для хранения данных даже в наборе гиперконвергентного кластера.

**Вопрос:** Что такое инструменты управления оптовым кластера <br>
**Ответов:** PowerShell или WMI в этом выпуске.

**Вопрос:** Динамическая миграция кросс cluster работы с процессорами различных поколений?  <br>
**Ответов:** Кластера наборов не обойти различия процессора и замены, что в настоящее время поддерживает Hyper-V.  Таким образом с помощью быстрого миграции необходимо использовать режим совместимости процессора.  Для кластера наборов рекомендуется использовать существующее оборудование процессора в каждом отдельных кластера, а также всего кластера, задайте для динамической миграции между кластерами выполнялся.

**Вопрос:** Можно моих виртуальных набор кластера "компьютеры" автоматически отработки отказа в случае сбоя кластера?  <br>
**Ответов:** В этом выпуске кластера набор виртуальных машин можно только вручную live перенести кластерам; Однако невозможно автоматически отработки отказа. 

**Вопрос:** Как обеспечить вовремя устойчивым к сбоев кластера хранилища? <br>
**Ответов:** Используйте решение реплики хранилища (SR) кросс cluster кластерам член реализовать хранилища устойчивы к кластеру.

**Вопрос:** Я использую реплики хранилища (SR) для репликации кластерам члена. Кластера хранения имен набор изменение пути UNC на SR отказоустойчивого кластера локальных дисковых пространств целевой реплики? <br>
**Ответов:** В этом выпуске такого кластера набор имен рекомендацию изменения не возникает SR отказоустойчивости. Дайте Microsoft знать, если в этом сценарии важно для вас и как вы планируете использовать его.

**Вопрос:** Существует отработки отказа виртуальных машин на разных доменов сбоя в случае аварийного восстановления (скажем, домен сбоя всего прошло)? <br>
**Ответов:** Нет, обратите внимание, отказоустойчивого кластера между в логические сбоя домена не поддерживается. 

**Вопрос:** Можно моем кластере задать span кластеры в нескольких узлов (или домены DNS) <br> 
**Ответов:** Это относится к сценариям недоверенными и не сразу планируется поддержка в рабочей среде. Дайте Microsoft знать, если в этом сценарии важно для вас и как вы планируете использовать его.

**Вопрос:** Кластера задается работают со IPv6? <br>
**Ответов:** IPv4 и IPv6 поддерживаются с наборами кластера с помощью отказоустойчивых кластеров.

**Вопрос:** Каковы требования к леса Active Directory для кластера задает <br>
**Ответов:** Все кластеры элемент должен быть в одном лесу AD.

**Вопрос:** Сколько кластеров узлы могут быть частью одного кластера установлены или? <br>
**Ответов:** В режиме предварительного просмотра, кластера наборов протестирован и поддерживается до 64 узлов всего кластера. Тем не менее кластера задает масштабов архитектуры гораздо больше ограничений для и не является то, что жестко для ограничение. Следует сообщить корпорации Майкрософт при более масштабные важна для вас и как вы планируете использовать его.

**Вопрос:** Все кластеров локальных дисковых пространств в наборе кластера сформирует одного пула носителей? <br>
**Ответов:** Нет. Локальные дисковые технологии по-прежнему работают в одном кластере, а не в разных кластерах элементов в наборе кластера.

**Вопрос:** Задается кластера уровнем доступности пространства имен <br>
**Ответов:** Да, пространство имен набор кластера осуществляет через сервер пространства имен постоянно доступны (ЦС) рекомендация SOFS выполняется в кластере управления. Корпорация Майкрософт рекомендует назначать достаточно число виртуальных машин из кластеров член стал устойчивыми локализованные сбоев всего кластера. Тем не менее, с учетом непредвиденных сбоев понести — например всех виртуальных машин в кластере управления перейдите, в то же время — сведения о перенаправлении постоянно Кроме того кэшируются на каждом узле кластера набор, даже между перезагрузками.
 
**Вопрос:** Кластера Выбор хранения данных на основе имен замедлению производительность устройств хранения данных в наборе кластера? <br>
**Ответов:** Нет. Пространство имен набора кластера предлагает пространство имен рекомендацию наложения в наборе кластера — концептуально как распределенных файл системы пространств имен (DFSN). И, в отличие от DFSN, все кластера набор имен рекомендацию метаданные автоматически заполнено и автоматически обновляться на всех узлах без вмешательства администратора, поэтому нет практически отсутствуют производительность в пути доступа хранилища. 

**Вопрос:** Как можно резервного копирования метаданных набором кластера? <br>
**Ответов:** Это руководство будет тот же, что отказоустойчивого кластера. Резервное копирование состояния системы будет создана резервная копия состояние кластера.  Через архивации данных Windows Server, можно выполнить восстановление просто узла кластера базы данных (который понадобится никогда не из-за автоматического логику, имеется ряд улучшений) или выполнить принудительного восстановления для возврата в базу данных кластера на всех узлах. В случае наборов кластера корпорация Майкрософт рекомендует выполняют принудительное восстановление сначала на членов кластера, а затем кластера управления, при необходимости. 
