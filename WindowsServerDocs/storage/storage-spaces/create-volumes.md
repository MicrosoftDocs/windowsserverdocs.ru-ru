---
title: Создание томов в локальных дисковых пространствах
description: Создание томов в Локальные дисковые пространства с помощью Windows Admin Center и PowerShell.
ms.prod: windows-server
ms.reviewer: cosmosdarwin
author: cosmosdarwin
ms.author: cosdar
manager: eldenc
ms.technology: storage-spaces
ms.date: 06/06/2019
ms.openlocfilehash: 8c17671f2f15d1373973dcf2fbafc753f0a163a6
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71402882"
---
# <a name="creating-volumes-in-storage-spaces-direct"></a>Создание томов в локальных дисковых пространствах

> Относится к: Windows Server 2019, Windows Server 2016

В этом разделе описывается создание томов в кластере Локальные дисковые пространства с помощью центра администрирования Windows, PowerShell или диспетчер отказоустойчивости кластеров.

> [!TIP]
> Сначала просмотрите статью [Планирование томов в локальных дисковых пространствах](plan-volumes.md).

## <a name="create-a-three-way-mirror-volume"></a>Создание трехуровневого зеркального тома

Чтобы создать трехстороннее зеркальный том в центре администрирования Windows, выполните следующие действия. 

1. В центре администрирования Windows подключитесь к кластеру Локальные дисковые пространства, а затем выберите **тома** в области **инструменты** .
2. На странице тома выберите вкладку **Инвентаризация** и щелкните **создать том**.
3. В области **создать том** введите имя тома **и оставьте для** него **трехстороннее зеркало**.
4. В поле **Размер на жестком диске**укажите размер тома. Например, 5 ТБ (терабайты).
5. Щелкните **Создать**.

В зависимости от размера создание тома может занять несколько минут. Уведомления, расположенные в правом верхнем углу, позволят вам получить сведения о создании тома. Новый том появится в списке Инвентаризация.

Ознакомьтесь с кратким видео о том, как создать трехстороннее зеркальный том.

> [!VIDEO https://www.youtube-nocookie.com/embed/o66etKq70N8]

## <a name="create-a-mirror-accelerated-parity-volume"></a>Создание тома четности с ускорением зеркального отображения

Контроль четности с зеркальным отображением сокращает объем жесткого диска. Например, трехстороннее зеркальный том означает, что для каждых 10 терабайтов размера потребуется 30 ТБ. Чтобы снизить издержки в объеме памяти, создайте том с контролем четности с зеркальным отображением. Это сокращает объем памяти от 30 терабайт до 22 терабайт, даже если всего 4 сервера, зеркальное отображение наиболее активных 20 процентов данных и использование четности, что является более эффективным, чтобы сохранить оставшуюся часть памяти. Вы можете настроить это соотношение четности и зеркала, чтобы обеспечить оптимальный компромисс производительности и емкости для вашей рабочей нагрузки. Например, на 90% четности и на 10 процентов зеркальное отображение приводит к снижению производительности, но еще более упрощает этот объем.

Чтобы создать том с контролем четности с зеркальным отображением в центре администрирования Windows, выполните следующие действия.

1. В центре администрирования Windows подключитесь к кластеру Локальные дисковые пространства, а затем выберите **тома** в области **инструменты** .
2. На странице тома выберите вкладку **Инвентаризация** и щелкните **создать том**.
3. В области **создать том** введите имя тома.
4. В списке **устойчивость**выберите **контрольные суммы с зеркальным ускорением**.
5. В поле **процент четности**выберите процент четности.
6. Щелкните **Создать**.

Ознакомьтесь с быстрым видео о том, как создать том с контролем четности с зеркальным ускорением.

> [!VIDEO https://www.youtube-nocookie.com/embed/R72QHudqWpE]

## <a name="open-volume-and-add-files"></a>Открыть том и добавить файлы

Чтобы открыть том и добавить файлы в том в центре администрирования Windows, выполните следующие действия.

1. В центре администрирования Windows подключитесь к кластеру Локальные дисковые пространства, а затем выберите **тома** в области **инструменты** .
2. На странице тома выберите вкладку **Инвентаризация** .
2. В списке томов выберите имя тома, который требуется открыть.

    На странице сведения о томе можно увидеть путь к тому.

4. В верхней части страницы выберите **Открыть**. Это приведет к запуску средства "файлы" в центре администрирования Windows.
5. Перейдите по пути к тому. Здесь можно просмотреть файлы в томе.
6. Выберите **Отправить**, а затем выберите файл для отправки.
7. Используйте кнопку **назад** в браузере, чтобы вернуться на панель средства в центре администрирования Windows.

Ознакомьтесь с кратким видео о том, как открыть том и добавить файлы.

> [!VIDEO https://www.youtube-nocookie.com/embed/j59z7ulohs4]

## <a name="turn-on-deduplication-and-compression"></a>Включить дедупликацию и сжатие

Управление дедупликацией и сжатием выполняется для каждого тома. При дедупликации и сжатии используется модель последующей обработки. Это означает, что экономия не будет видна до ее запуска. Если это так, он будет работать над всеми файлами, даже если они существовали ранее.

1. В центре администрирования Windows подключитесь к кластеру Локальные дисковые пространства, а затем выберите **тома** в области **инструменты** .
2. На странице тома выберите вкладку **Инвентаризация** .
3. В списке томов выберите имя тома, которым требуется управлять.
4. На странице сведения о томе щелкните коммутатор с меткой **Дедупликация и сжатие**.
5. В области включить дедупликацию выберите режим дедупликации.

    Вместо сложных параметров центр администрирования Windows позволяет выбирать между готовыми профилями для разных рабочих нагрузок. Если вы не уверены, используйте параметр по умолчанию.

6. Выберите вариант **Включить**.

Ознакомьтесь с кратким видео о том, как включить дедупликацию и сжатие.

> [!VIDEO https://www.youtube-nocookie.com/embed/PRibTacyKko]

## <a name="create-volumes-using-powershell"></a>Создание томов с помощью PowerShell

Рекомендуем создавать тома для локальных дисковых пространств с помощью командлета **New-Volume**. Это самый простой и быстрый способ. Этот командлет автоматически создает виртуальный диск, разбивает и форматирует его, создает том с соответствующим именем и добавляет его в общие тома кластера — и все это за один шаг.

Командлет **New-Volume** имеет четыре обязательных параметра:

- **FriendlyName** Любая требуемая строка, например *"Volume1"*
- **Системой** Либо **CSVFS_ReFS** (рекомендуется), либо **CSVFS_NTFS**
- **Сторажепулфриендлинаме:** Имя пула носителей, например *"S2D on имя_кластера"*
- **Размер:** Размер тома, например *"10 ТБ"*

   > [!NOTE]
   > Вычисления в Windows, в том числе PowerShell, выполняются с помощью двоичных чисел (с основанием 2), а диски обычно помечаются с помощью десятичных чисел (с основанием 10). Поэтому диск размером 1 ТБ (1 000 000 000 000 байтов) отображается в Windows как приблизительно 909 ГБ. Это нормально. При создании томов с помощью командлета **New-Volume** параметр **Size** следует указывать с помощью двоичных чисел (с основанием 2). Например, укажите "909 ГБ" или "0,909495 ТБ", чтобы создать том размером примерно 1 000 000 000 000 байтов.

### <a name="example-with-2-or-3-servers"></a>Пример. С 2 или 3 серверами

Если в развертывании только два сервера, локальные дисковые пространства будут автоматически использовать двустороннее зеркальное отображение. Если в развертывании только три сервера, они будут автоматически использовать трехстороннее зеркальное отображение.

```PowerShell
New-Volume -FriendlyName "Volume1" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -Size 1TB
```

### <a name="example-with-4-servers"></a>Пример. С 4 + серверами

Если у вас четыре или больше серверов, вы можете использовать дополнительный параметр **ResiliencySettingName**, чтобы выбрать тип устойчивости.

-   **Ресилиенцисеттингнаме:** **Зеркало** или **четность**.

В следующем примере *"Volume2"* использует трехстороннее зеркальное отображение, а *"Volume3"*  — двойную четность (также называется "помехоустойчивым кодированием").

```PowerShell
New-Volume -FriendlyName "Volume2" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -Size 1TB -ResiliencySettingName Mirror
New-Volume -FriendlyName "Volume3" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -Size 1TB -ResiliencySettingName Parity
```

### <a name="example-using-storage-tiers"></a>Пример. Использование уровней хранилища

В развертываниях с дисками трех типов один том может частично располагаться на уровнях SSD и HDD. Аналогично, в развертываниях с четырьмя или более серверами один том может частично располагаться на каждом из них (при сочетании зеркального отображения и двойной четности).

Для создания таких томов в локальных дисковых пространствах есть шаблоны уровней по умолчанию *Производительность* и *Емкость*. Они объединяют в себе определения для трехстороннего зеркального отображения на более быстрых дисках хранения (если применимо) и двойной четности на более медленных дисках хранения (если применимо).

Чтобы просмотреть их, выполните командлет **Get-StorageTier**.

```PowerShell
Get-StorageTier | Select FriendlyName, ResiliencySettingName, PhysicalDiskRedundancy
```

![PowerShell уровней хранилища: снимок экрана](media/creating-volumes/storage-tiers-screenshot.png)

Чтобы создать многоуровневые тома, сошлитесь на эти шаблоны уровней с помощью параметров **StorageTierFriendlyNames** и **StorageTierSizes** командлета **New-Volume**. Например, следующий командлет создает один том, в котором трехстороннее зеркальное отображение и двойная четность распределены в пропорции 30:70.

```PowerShell
New-Volume -FriendlyName "Volume4" -FileSystem CSVFS_ReFS -StoragePoolFriendlyName S2D* -StorageTierFriendlyNames Performance, Capacity -StorageTierSizes 300GB, 700GB
```

## <a name="create-volumes-using-failover-cluster-manager"></a>Создание томов с помощью диспетчера отказоустойчивости кластеров

Вы также можете создавать тома с помощью *мастера создания виртуального диска (локальные дисковые пространства)* и *мастера создания томов* из диспетчера отказоустойчивости кластеров, хотя при этом много действий придется выполнять вручную. Этот способ не рекомендуется.

Существуют три основных шага:

### <a name="step-1-create-virtual-disk"></a>Шаг 1. Создание виртуального диска

![Создать виртуальный диск](media/creating-volumes/GUI-Step-1.png)

1. В диспетчере отказоустойчивости кластеров выберите **Хранилище** -> **Пулы**.
2. Выберите **Создать виртуальный диск** в области действий справа или щелкните правой кнопкой мыши пул и выберите **Создать виртуальный диск**.
3. Выберите пул носителей и нажмите **ОК**. Откроется *мастер создания виртуального диска (локальные дисковые пространства)* .
4. Назовите виртуальный диск и укажите его размер.
5. Просмотрите выбранные параметры и нажмите кнопку **Создать**.
6. Перед закрытием установите флажок **Создать том при закрытии мастера**.

### <a name="step-2-create-volume"></a>Шаг 2. Создать том

Откроется *мастер создания томов*.

7. Выберите виртуальный диск, который вы только что создали, и нажмите кнопку **Далее**.
8. Укажите размер тома (по умолчанию: соответствует размеру виртуального диска) и нажмите кнопку **Далее**. 
9. Назначьте том букве диска или выберите **Не назначать букве диска** и нажмите кнопку **Далее**.
10. Укажите необходимую файловую систему, оставьте размер кластера *по умолчанию*, назовите том и нажмите кнопку **Далее**.
11. Просмотрите выбранные параметры и нажмите **Создать**, а затем **Закрыть**.

### <a name="step-3-add-to-cluster-shared-volumes"></a>Шаг 3. Добавить в общие тома кластера

![Добавить в общие тома кластера](media/creating-volumes/GUI-Step-2.png)

12. В диспетчере отказоустойчивости кластеров выберите **Хранилище** -> **Диски**.
13. Выберите виртуальный диск, который вы только что создали, и выберите **Добавить в общие тома кластера** в области действий справа или щелкните виртуальный диск правой кнопкой мыши и выберите **Добавить в общие тома кластера**.

Готово! При необходимости повторите, чтобы создавать несколько томов.

## <a name="see-also"></a>См. также

- [Обзор Локальные дисковые пространства](storage-spaces-direct-overview.md)
- [Планирование томов в Локальные дисковые пространства](plan-volumes.md)
- [Расширение томов в Локальные дисковые пространства](resize-volumes.md)
- [Удаление томов в Локальные дисковые пространства](delete-volumes.md)
