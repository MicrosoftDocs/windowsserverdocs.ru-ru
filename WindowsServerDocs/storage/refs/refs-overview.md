---
title: Обзор файловой системы ReFS
ms.prod: windows-server
ms.author: gawatu
manager: mchad
ms.technology: storage-file-systems
ms.topic: article
author: gawatu
ms.date: 06/17/2019
ms.openlocfilehash: daa766b63cd99b86abb5a9fad791061c21aba766
ms.sourcegitcommit: be4f67ae8e40a0bf1086881ba8963c69d7ea889f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2020
ms.locfileid: "82986030"
---
# <a name="resilient-file-system-refs-overview"></a>Обзор файловой системы ReFS

>Область применения: Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows Server (половина ежегодного канала)

ReFS — это новейшая файловая система Майкрософт, которая повышает уровень доступности данных, обеспечивает эффективное масштабирование для очень крупных наборов данных и различных вариантов нагрузки и гарантирует целостность данных благодаря устойчивости к повреждениям. Она используется для растущего числа сценариев хранения данных и служит основой для будущих нововведений.

## <a name="key-benefits"></a>Основные преимущества

### <a name="resiliency"></a>Устойчивость

ReFS представляет новые функции, которые позволяют точно определить повреждения и исправить их, сохраняя систему в оперативном режиме и обеспечивая целостность и доступность данных. 

- **Потоки целостности** — ReFS использует контрольные суммы для метаданных и, при необходимости, для данных файлов, что дает возможность точно определить повреждения ReFS. 
- **Интеграция дисковых пространств** — при использовании в сочетании с зеркальным пространством или пространством с контролем четности ReFS может автоматически исправлять обнаруженные повреждения с помощью альтернативной копии данных, предоставляемой дисковыми пространствами. Процессы восстановления локализованы в области повреждения и выполняются в оперативном режиме без простоя томов.
- **Утилизация данных** — если том поврежден, а альтернативная копия данных не существует, ReFS удаляет поврежденные данные из пространства имен. ReFS сохраняет том в оперативном режиме при обработке большинства неисправляемых повреждений, но в редких случаях ReFS необходимо перевести том в автономный режим.
- **Упреждающее исправление ошибок** — помимо проверки данных перед операциями чтения и записи, ReFS предоставляет сканер целостности данных, который называют <i>средством очистки</i>. Оно периодически сканирует том, пытаясь выявить скрытые повреждения и профилактически запуская процесс восстановления поврежденных данных. 

### <a name="performance"></a>Производительность

Помимо улучшения устойчивости, ReFS представляет новые функции для рабочих нагрузок, требующих высокой производительности, и виртуализированных рабочих нагрузок. Оптимизация уровней в режиме реального времени, клонирование блоков и разреженный метод VDL — вот примеры развивающихся возможностей ReFS, которые предназначены для поддержки динамических и разнообразных рабочих нагрузок.

- **[Четность с зеркальным ускорением](./mirror-accelerated-parity.md)**. Четность с зеркальным ускорением обеспечивает высокую производительность и эффективное хранение данных. 

    - Для обеспечения высокой производительности и эффективного хранения данных ReFS делит том на две логические группы памяти, которые называются уровнями. У них могут быть собственные типы диска и устойчивости, что позволяет каждому уровню оптимизировать производительность или емкость. Вот некоторые примеры конфигурации: 
    
      | Уровень производительности | Уровень емкости |
      | ---------------- | ----------------- |
      | Зеркальный SSD | Зеркальный жесткий диск |
      | Зеркальный SSD | SSD с контролем четности |
      | Зеркальный SSD | Жесткий диск с контролем четности |
            
    - После настройки этих уровней ReFS использует их для реализации быстрого хранилища для «горячих» данных и объемного хранилища «холодных» данных:
        - Все операции записи происходят на уровне производительности, а большие блоки данных, которые остаются на уровне производительности, перемещаются на уровень емкости в режиме реального времени.
        - Если используется гибридное развертывание (смешивание дисков флэш-памяти и жесткого диска), [кэш в Локальные дисковые пространства](../storage-spaces/understand-the-cache.md) помогает ускорить операции чтения, уменьшая воздействие характеристик фрагментации данных виртуализованных рабочих нагрузок. В противном случае при использовании развертывания «все-Flash» операции чтения также выполняются на уровне производительности.

> [!NOTE]
> В средах Windows Server четность с зеркальным ускорение поддерживается только для [локальных дисковых пространств](../storage-spaces/storage-spaces-direct-overview.md). Мы советуем использовать четность с ускорением зеркального отображения только с рабочими нагрузками архивации и резервного копирования. Для виртуализированных и других высокопроизводительных произвольных рабочих нагрузок рекомендуется использовать трехстороннее зеркала для повышения производительности.

- **Ускорение операций виртуальных машин**. В ReFS реализованы новые возможности, предназначенные для повышения производительности виртуализированных рабочих нагрузок.
    - [Клонирование блоков](./block-cloning.md) — эта функция ускоряет операции копирования, позволяя выполнять быстрые операции слияния ВМ.
    - Разреженный метод VDL — этот метод позволяет ReFS быстро обнулять файлы, что уменьшает время, необходимое для создания фиксированных VHD, с десятков минут до нескольких секунд.

- **Переменный размер кластера** — ReFS поддерживает размер кластера 4 КБ и 64 КБ. Рекомендуемый для большинства развертываний размер кластера — 4 КБ, а кластеры размером 64 КБ подходят для работы с крупными, последовательными рабочими нагрузками ввода-вывода.

### <a name="scalability"></a>Масштабируемость

Файловая система ReFS предназначена для поддержки очень больших наборов данных (до миллионов терабайтов) без снижения производительности и с недоступным ранее уровнем масштабирования.

## <a name="supported-deployments"></a>Поддерживаемые развертывания

Корпорация Майкрософт разработала NTFS специально для общего назначения с широким спектром конфигураций и рабочих нагрузок, но для клиентов, которым специально требуются доступность, устойчивость и (или) масштабирование, предоставляемые ReFS, корпорация Майкрософт поддерживает ссылки для использования в следующих конфигурациях и сценариях. 

> [!NOTE]
> Все поддерживаемые конфигурации ReFS должны использовать сертифицированное оборудование [Windows Server Catalog](https://www.WindowsServerCatalog.com) и удовлетворять требованиям приложений.

### <a name="storage-spaces-direct"></a>Локальные дисковые пространства

Развертывать ReFS в локальных дисковых пространствах рекомендуется для виртуализированных рабочих нагрузок либо запоминающих устройств, подключенных к сети: 
- Четность с зеркальным ускорением и [кэш в локальных дисковых пространствах](../storage-spaces/understand-the-cache.md) обеспечивают высокую производительность и эффективное хранение данных. 
- Благодаря клонированию блоков и разреженным VDL значительно ускоряются операции с VHDX-файлами, такие как создание, объединение и расширение.
- Целостность — потоки, оперативное восстановление и альтернативные копии данных позволяют ReFS и Локальные дисковые пространства совместно обнаруживать и исправлять повреждения контроллера хранилища и носителей в метаданных и данных. 
- ReFS предоставляет возможности масштабирования и поддержки крупных наборов данных. 

### <a name="storage-spaces"></a>Дисковые пространства

- Целостность — потоки, оперативное восстановление и альтернативные копии данных позволяют раздельно обнаруживать и исправлять повреждения контроллеров хранилища и носителей в метаданных и данных с помощью ссылок и [дисковых пространств](../storage-spaces/overview.md) .
- Кроме того, в средах дисковых пространств можно использовать функции клонирования блоков и масштабирования, доступные в ReFS.
- Развертывание ReFS на дисковых пространствах с общими вложениями SAS подходит для размещения архивных данных и хранения пользовательских документов.

> [!NOTE]
> Дисковые пространства поддерживают локальные несъемные диски с прямым подключением через Бустипес SATA, SAS, NVME или подключенные через адаптер шины (RAID-контроллер в сквозном режиме).

### <a name="basic-disks"></a>Базовые диски

Развертывание ReFS на базовых дисках лучше всего подходит для приложений, которые реализуют собственные решения по обеспечению устойчивости и доступности программного обеспечения. 
- Приложения, в которых реализованы собственные программные решения для устойчивости и доступности, могут использовать потоки целостности, клонирование блоков и возможность масштабирования и поддержки крупных наборов данных. 

> [!NOTE]
> К базовым дискам относятся локальные несъемные диски с прямым подключением через Бустипес SATA, SAS, NVME или RAID. Базовые диски не включают дисковые пространства.

### <a name="backup-target"></a>Цель резервного копирования

Развертывание ReFS в качестве целевого объекта резервного копирования лучше всего подходит для приложений и оборудования, которые реализуют собственные решения устойчивости и доступности.
- Приложения, в которых реализованы собственные программные решения для устойчивости и доступности, могут использовать потоки целостности, клонирование блоков и возможность масштабирования и поддержки крупных наборов данных.

> [!NOTE]
> Целевые объекты резервного копирования включают указанные выше поддерживаемые конфигурации. Свяжитесь с поставщиками массивов приложений и хранилища для получения сведений о поддержке по оптоволоконному каналу и сетям хранения данных iSCSI. Для сетей SAN, если требуются такие функции, как тонкая подготовка, обрезка, отмена СОПОСТАВЛЕНИЯ или Передача данных (ODX), необходимо использовать NTFS.   

## <a name="feature-comparison"></a>Сравнение возможностей

### <a name="limits"></a>Ограничения

| Компонент       | ReFS                                        | NTFS |
|----------------|------------------------------------------------|-----------------------|
| Максимальная длина имени файла | 255 символов Юникода  | 255 символов Юникода               |
| Максимальная длина имени пути |32 КБ символов Юникода | 32 КБ символов Юникода                |
| Максимальный размер файла | 35 PB (петабайтов)  | 256 ТБ               |
| Максимальный размер тома | 35 ПБ                           | 256 ТБ                |

### <a name="functionality"></a>Функциональность

#### <a name="the-following-features-are-available-on-refs-and-ntfs"></a>В ReFS и NTFS доступны следующие функции:

| Функциональность       | ReFS                                        | NTFS |
|---------------------------|------------------|-----------------------|
| шифрование BitLocker; | Да | Да |
| дедупликация данных; | Да<sup>1</sup> | Да |
| Поддержка общих томов кластера (CSV) | Да<sup>2</sup> | Да |
| Гибкие ссылки | Да | Да |
| Поддержка отказоустойчивого кластера | Да | Да |
| Списки управления доступом | Да | Да |
| Журнал USN | Да | Да |
| Уведомления об изменениях | Да | Да |
| Точки соединения | Да | Да |
| Точки подключения | Да | Да |
| Точки повторного анализа | Да | Да |
| Моментальные снимки томов | Да | Да |
| Идентификаторы файлов | Да | Да |
| Операционные блокировки | Да | Да |
| Разреженные файлы | Да | Да |
| Именованные потоки | Да | Да |
| Тонкая подготовка | Да<sup>3</sup> | Да |
| Обрезать/отменить сопоставление | Да<sup>3</sup> | Да |
1. Доступно в Windows Server версии 1709 и более поздних версиях.
2. Доступно в Windows Server 2012 R2 и более поздних версиях.
3. Только дисковые пространства

#### <a name="the-following-features-are-only-available-on-refs"></a>Следующие функции доступны только в ReFS:

| Функциональность       | ReFS                                        | NTFS |
|---------------------------|------------------|-----------------------|
| Клонирование блоков | Да | нет |
| Разреженный метод VDL | Да | нет |
| Четность с зеркальным ускорением| Да (в локальных дисковых пространствах) | нет |

#### <a name="the-following-features-are-unavailable-on-refs-at-this-time"></a>Следующие функции недоступны в ReFS в настоящее время:

| Функциональность       | ReFS                                        | NTFS |
|---------------------------|------------------|-----------------------|
| Сжатие файловой системы | нет | Да |
| Шифрование файловой системы | нет | Да |
| Transactions | нет | Да |
| Жесткие связи. | нет | Да |
| идентификаторы объектов; | нет | Да |
| Разгрузка Передача данных (ODX) | нет | Да |
| Краткие имена | нет | Да |
| Дополнительные атрибуты. | нет | Да |
| Дисковые квоты | нет | Да |
| Загружаемый | нет | Да |
| Поддержка файла подкачки | нет | Да |
| Поддерживается на съемном носителе | нет | Да |

## <a name="see-also"></a>См. также

- [Cluster size recommendations for ReFS and NTFS](https://techcommunity.microsoft.com/t5/Storage-at-Microsoft/Cluster-size-recommendations-for-ReFS-and-NTFS/ba-p/425960) (Рекомендации по размеру кластера для ReFS и NTFS).
- [Обзор Локальные дисковые пространства](../storage-spaces/storage-spaces-direct-overview.md)
- [Клонирование блоков ReFS](block-cloning.md)
- [Потоки целостности ReFS](integrity-streams.md)
