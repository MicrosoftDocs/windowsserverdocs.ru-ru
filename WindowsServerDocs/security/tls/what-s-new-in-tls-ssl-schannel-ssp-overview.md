---
title: TLS - Общие сведения о SSL (Schannel SSP)
description: Безопасность Windows Server
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-tls-ssl
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: c8836345-16bb-4dcc-8d2b-2b9b687456a3
author: justinha
ms.author: justinha
manager: brianlic-msft
ms.date: 05/16/2018
ms.openlocfilehash: b1af556200c9dd497bac835f1480479cca075dab
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66447284"
---
# <a name="overview-of-tls---ssl-schannel-ssp"></a>Общие сведения о TLS - SSL (Schannel SSP)

>Область применения. Windows Server (полугодовой канал), Windows Server 2016, Windows 10

В этом разделе для ИТ-специалистов описаны изменения функциональных возможностей в безопасности поддержки Provider (SSP) Schannel, включая безопасности транспортного уровня (TLS), Secure Sockets Layer (SSL) и безопасности уровня транспорта датаграмм (DTLS) протоколы проверки подлинности для Windows Server 2012 R2, Windows Server 2012, Windows 8.1 и Windows 8.

Канал Schannel — это безопасности поддержки поставщика (SSP), реализующий SSL, TLS и DTLS Internet стандартные протоколы проверки подлинности. Интерфейс поставщика поддержки безопасности (SSPI) является интерфейсом API, используемым системами Windows для выполнения функций, связанных с безопасностью, включая проверку подлинности. Интерфейс SSPI работает как общий интерфейс для нескольких поставщиков поддержки безопасности (SSP), включая поставщика SCHANNEL SSP.

Дополнительные сведения о реализации Майкрософт TLS и SSL в поставщике Schannel SSP, см. в разделе [Технический справочник по TLS/SSL (2003)](https://technet.microsoft.com/library/cc784149(v=ws.10).aspx).


## <a name="tlsssl-schannel-ssp-features"></a>Возможности TLS/SSL (Schannel SSP)
Ниже описаны возможности TLS в Schannel SSP.

### <a name="tls-session-resumption"></a>Возобновление сеанса TLS
Протокол безопасности транспортного уровня (TLS), в состав поставщика поддержки безопасности Schannel, используется для защиты данных, передаваемых между приложениями по ненадежной сети. Протокол TLS/SSL можно использовать для проверки подлинности серверов и клиентских компьютеров, а также для шифрования сообщений между проверенными сторонами.

Устройства, подключающие TLS к серверам, часто требуют переподключения из-за истечения срока действия сеанса. Windows 8.1 и Windows Server 2012 R2 теперь поддерживает RFC 5077 (возобновление сеанса TLS без состояния на стороне сервера). Это изменение обеспечивает устройств Windows Phone и Windows RT с помощью:

-   Использование ограниченной ресурсов на сервере

-   Ограниченной пропускной способности, которая повышает эффективность использования клиентских подключений

-   Снизила время, затрачиваемое для подтверждения TLS, из-за возобновления соединения.

> [!NOTE]
> Реализация клиентского RFC 5077 была добавлена в Windows 8.

Сведения о без отслеживания состояния возобновление сеанса TLS, см. в документе IETF [RFC 5077.](http://www.ietf.org/rfc/rfc5077)

### <a name="application-protocol-negotiation"></a>Согласование протокола приложения
 Windows Server 2012 R2 и Windows 8.1 поддерживает согласование протокола приложений клиентского TLS, приложения могут использовать протоколы в рамках стандартной разработки HTTP 2.0, и пользователи могут обращаться к веб-служб, таких как Google и Twitter с помощью приложения, работающие протокол SPDY.

**Принцип работы**

Клиентские и серверные приложения включают расширение согласования протокола приложения путем предоставления списков поддерживаемых идентификаторов протоколов приложений в порядке убывания приоритета. Клиент TLS указывает, что он поддерживает согласование протокола приложения, включая расширение согласования протокола уровня приложений (ALPN) со списком протоколов, поддерживаемых клиентом, в сообщении ClientHello.

Когда TLS клиент отправляет запрос на сервер, сервер TLS считывает список поддерживаемых протоколов для поиска наиболее предпочтительного протокола приложения, также поддерживаемого клиентом. Если протокол найден, сервер отвечает с идентификатором выбранного протокола и продолжает подтверждение обычным образом. Если общего протокола приложений нет, сервер отправляет оповещение о неустранимом сбое подтверждения.

### <a name="BKMK_TrustedIssuers"></a>Управление доверенными издателями для проверки подлинности клиента
Если требуется проверить подлинность клиентского компьютера с использованием SSL или TLS, можно настроить сервер для отправки списка доверенных издателей сертификатов. Этот список содержит набор издателей сертификатов, которым будет доверять сервер. Кроме того, в нем приводятся рекомендации по выбору нужного клиентского сертификата, если существует несколько сертификатов. Кроме того, цепочку сертификатов, отправляемую клиентским компьютером на сервер, необходимо проверить на соответствие списку настроенных доверенных издателей.

До Windows Server 2012 и Windows 8 приложения или процессы, которые использовали Schannel SSP (включая HTTP.sys и IIS), могли предоставлять список доверенных издателей, поддерживаемых для проверки подлинности клиента через доверия сертификатов списка (CTL).

В Windows Server 2012 и Windows 8, были внесены изменения, чтобы базовый процесс проверки подлинности, чтобы:

-   Управление списком доверенных издателей на основе списка доверия сертификатов больше не поддерживается.

-   действие отправки списка доверенных издателей по умолчанию отключено: теперь значением по умолчанию для раздела реестра SendTrustedIssuerList является 0 (отключено по умолчанию) вместо 1;

-   сохранена совместимость с предыдущими версиями операционных систем Windows.

**Какой это эффект дает?**

Начиная с Windows Server 2012, использование CTL было замещено с реализацией на основе хранилища сертификатов. Это обеспечивает хорошо знакомую управляемость с помощью существующих командлетов управления сертификатами поставщика PowerShell, а также с помощью средств командной строки, например certutil.exe.

Несмотря на то, что максимальный размер списка доверенных центров сертификации (16 КБ), поддерживаемых Schannel SSP остается тем же, как и в Windows Server 2008 R2, Windows Server 2012 имеется новое выделенное хранилище сертификатов для издателей проверки подлинности клиента, чтобы несвязанные сертификаты не включаются в сообщение.

**Как это работает?**

В Windows Server 2012 список доверенных издателей настраивается с помощью хранилищ сертификатов; одно значение по умолчанию глобального хранилища сертификатов компьютера и одного дополнительного для каждого сайта. Источник списка определяется следующим образом.

-   Если существует конкретное хранилище учетных данных, настроенное для сайта, оно будет использоваться в качестве источника.

-   Если в хранилище, определяемом приложением, отсутствуют сертификаты, Schannel проверяет хранилище **поставщиков проверки подлинности клиента** на локальном компьютере и при наличии в нем сертификатов использует это хранилище в качестве источника. Если сертификат не обнаружен ни в одном из хранилищ, выполняется проверка хранилища доверенных корневых центров.

-   Если ни одна из глобального или локального хранилища сертификатов, поставщик Schannel будет использовать **доверенные корневые центры сертификации** хранения в качестве источника списка доверенных издателей. (Это поведение для Windows Server 2008 R2).

Если **доверенные корневые центры сертификации** магазина, который был использован содержит сочетание корневых (самозаверяющих) сертификатов и сертификатов издателя центра сертификации (ЦС) сертификации, только сертификаты издателя ЦС будут отправляться на сервер по умолчанию.

**Настройка Schannel для использования в хранилище сертификатов доверенных издателей**

Архитектура Schannel SSP в Windows Server 2012 будет по умолчанию использовать хранилища, как описано выше для управления списком доверенных издателей. Можно по-прежнему использовать существующие командлеты управления сертификатами поставщика PowerShell, а также средства командной строки, например certutil.exe.

Сведения об управлении сертификатами с помощью поставщика PowerShell, см. в разделе [командлеты администрирования AD CS в Windows](https://technet.microsoft.com/library/hh848365(v=wps.620).aspx).

Сведения об управлении сертификатами с помощью служебной программы сертификатов см. в разделе [certutil.exe](https://technet.microsoft.com/library/cc732443.aspx).

Сведения о данных, включая определяемое приложением хранилище, определяется учетных данных Schannel, см. в разделе [структура SCHANNEL_CRED (Windows)](https://msdn.microsoft.com/library/windows/desktop/aa379810(v=vs.85).aspx).

**Режимы доверия по умолчанию**

Существует три режима доверия при проверке подлинности клиента, поддерживаемых поставщиком Schannel. Режим доверия контролирует, каким образом выполняется проверка цепочки сертификатов клиента и параметр уровня системы управляется параметром реестра REG_DWORD «ClientAuthTrustMode» в разделе реестра HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel .

|Значение|Режим доверия|Описание|
|-----|-------|--------|
|0|Доверие компьютера (по умолчанию)|Требует, чтобы сертификат клиента выдавался сертификатом из списка доверенных издателей.|
|1|Монопольное корневое доверие|Требует, чтобы клиентский сертификат связывался с корневым сертификатом, содержащимся в определенном вызывающей стороной хранилище доверенного издателя. Сертификат также должен быть выдан издателем из списка доверенных издателей.|
|2|Монопольное доверие ЦС|Требует, чтобы клиентский сертификат связывался либо с промежуточным сертификатом ЦС, либо с корневым сертификатом, содержащимся в определенном вызывающей стороной хранилище доверенного издателя.|

Сведения о сбоях проверки подлинности из-за проблем конфигурации доверенных издателей см. статью базы знаний [280256](https://support.microsoft.com/kb/2802568).

### <a name="BKMK_SNI"></a>Протокол TLS поддерживает расширения индикатора имени сервера (SNI)
Компонент индикации имени сервера расширяет возможности протоколов SSL и TLS для правильной идентификации сервера в случае, когда на одном сервере запущено несколько виртуальных образов. Чтобы правильно обеспечить безопасность канала связи между клиентским компьютером и сервером, клиентский компьютер запрашивает от сервера цифровой сертификат. После того как сервер ответит на запрос и отправит сертификат, клиентский компьютер проверяет его, использует для шифрования канала связи и продолжает обычный обмен запросами и ответами. Однако в сценарии использования виртуальных систем несколько доменов, каждый из которых имеет свой индивидуальный сертификат, размещаются на одном сервере. В этом случае сервер не может заранее определить, какой сертификат был передан клиентскому компьютеру. С помощью индикатора SNI клиентский компьютер заранее в протоколе может уведомить целевой домен, что позволит серверу правильно выбрать надлежащий сертификат.

**Какой это эффект дает?**

Дополнительные функциональные возможности:

-   Размещение нескольких веб-сайтов, работающих по протоколу SSL, с одним IP-адресом и портом.

-   Сниженное использование памяти при размещении нескольких веб-сайтов, работающих по протоколу SSL, на единственном веб-сервере.

-   Возможность одновременного подключения дополнительного числа пользователей к веб-сайтам, работающим по протоколу SSL.

-   Возможность предоставлять пользователям подсказки посредством компьютерного интерфейса для выбора правильного сертификата в процессе проверки подлинности клиента.

**Принцип работы**

Поставщик Schannel SSP поддерживает кэш в памяти, в котором сохраняются состояния клиентских подключений, разрешенные клиентам. Это позволяет клиентским компьютерам повторно подключиться к SSL-серверу без задержек и без полного подтверждения протокола SSL при последующих посещениях.  Такое эффективное использование процесса управления сертификатами допускает к созданию большего числа сайтов, должен размещаться в одном по сравнению с предыдущими версиями операционной системы Windows Server 2012.

Улучшен выбор сертификата пользователем. Это позволяет составлять список возможных имен издателей сертификатов с подсказками для пользователя, из которого пользователь выберет одно имя. Этот список настраивается с помощью групповой политики.

### <a name="BKMK_DTLS"></a>Датаграмма Transport Layer Security (DTLS)
В поставщик поддержки безопасности SCHANNEL добавлен протокол DTLS версии 1.0 Протокол DTLS обеспечивает конфиденциальность каналов связи для протоколов датаграмм. Данный протокол позволяет приложениям типа клиент-сервер взаимодействовать по определенному методу, обеспечивающему защиту от перехвата, взлома или подделки сообщений. Протокол DTLS основывается на протоколе TLS и предоставляет аналогичные гарантии безопасности, которые сокращают потребность в использовании IPsec или разработке пользовательского протокола безопасности на уровне приложений.

**Какой это эффект дает?**

Датаграммы являются обычным в потоковой передачи мультимедиа, такие как игры или безопасные видеоконференции. Добавление протокола DTLS к поставщику SCHANNEL позволяет использовать знакомую модель Windows SSPI для создания безопасного канала связи между клиентскими компьютерами и серверами. Протокол DTLS специально разработан таким образом, чтобы быть максимально похожим на протокол TLS, что позволяет сократить до минимума написание нового кода для системы безопасности и увеличить объем повторно используемых элементов инфраструктуры и кода.

**Принцип работы**

Приложения, использующие протокол DTLS по UDP, могут использовать модель SSPI в Windows Server 2012 и Windows 8. Определенные наборы шифров можно настраивать таким же образом, как и протокол TLS. В канале безопасности SCHANNEL продолжается использование поставщика служб шифрования CNG, который в свою очередь работает с сертификацией FIPS 140, реализованной в ОС Windows Vista.

### <a name="BKMK_Deprecated"></a>Нерекомендуемые функции
В Schannel SSP для Windows Server 2012 и Windows 8 отсутствуют устаревшие компоненты или функциональные возможности.

## <a name="see-also"></a>См. также
-   [Модель безопасности частного облака — функциональные возможности программы-оболочки](https://social.technet.microsoft.com/wiki/contents/articles/6756.private-cloud-security-model-wrapper-functionality.aspx)



