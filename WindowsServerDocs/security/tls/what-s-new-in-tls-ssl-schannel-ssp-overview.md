---
title: "TLS - Обзор SSL (Schannel SSP)"
description: "Безопасность Windows Server"
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-tls-ssl
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: c8836345-16bb-4dcc-8d2b-2b9b687456a3
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: b846ed54a1f7c8ef7a85ea9f836ffa75d0036ae6
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="overview-of-tls---ssl-schannel-ssp"></a>Обзор протокола TLS - SSL (Schannel SSP)

>Область применения: Windows Server (канал точками годовой), Windows Server 2016

В этом разделе для ИТ-специалистов описаны изменения в функциональных возможностях в безопасности поддержки поставщика (SSP) Schannel, который включает безопасности транспортного уровня (TLS), Secure Sockets Layer (SSL) и протоколов проверки подлинности безопасности уровня транспорта датаграмм (DTLS), для Windows Server 2012 R2, Windows Server 2012, Windows 8.1 и Windows 8.

Канал Schannel — поддержки безопасности поставщика (SSP), реализующий SSL, TLS и DTLS Internet стандартные протоколы проверки подлинности. Интерфейс поставщика поддержки безопасности (SSPI) является интерфейсом API, используемым системами Windows для выполнения связанных с безопасностью функций, включая проверку подлинности. Интерфейс SSPI работает как общий интерфейс для нескольких поставщиков поддержки безопасности (SSP), включая поставщика Schannel SSP.

Дополнительные сведения о реализации Майкрософт протоколов TLS и SSL в поставщике Schannel SSP см. в разделе [Технический справочник протоколов TLS и SSL (2003)](https://technet.microsoft.com/library/cc784149(v=ws.10).aspx).


##<a name="tlsssl-schannel-ssp-features"></a>Средства TLS/SSL (Schannel SSP)
Ниже описываются возможности TLS в Schannel SSP.

### <a name="tls-session-resumption"></a>Возобновление сеанса TLS
Протокол безопасности TLS (Transport Layer), компонент поставщика поддержки безопасности Schannel, используется для защиты данных, передаваемых между приложениями по ненадежной сети. Протокол TLS/SSL можно использовать для проверки подлинности серверов и клиентских компьютеров, а также для шифрования сообщений между проверенными сторонами.

Устройства, подключающие TLS к серверам, часто требуют переподключения из-за истечения срока действия сеанса. Windows 8.1 и Windows Server 2012 R2 теперь поддерживают RFC 5077 (возобновления сеансов TLS без состояния на стороне сервера). Это изменение предоставляет устройств Windows Phone и Windows RT с помощью:

-   Использование ограниченной ресурсов на сервере

-   Снижение пропускной способности, которая повышает эффективность использования клиентских подключений

-   Уменьшить время, затрачиваемое для подтверждения TLS из-за resumptions подключения.

> [!NOTE]
> Реализация клиентского RFC 5077 был добавлен в Windows 8.

Сведения о без учета состояния возобновление сеанса TLS см. в документе IETF [RFC 5077.](http://www.ietf.org/rfc/rfc5077)

### <a name="application-protocol-negotiation"></a>Согласование протокола приложения
 Windows Server 2012 R2 и Windows 8.1 поддерживает согласование протокола приложений клиентского TLS, приложения могут использовать протоколы в рамках стандартной разработки HTTP 2.0 и пользователям online services, например Google и Twitter, с помощью приложений, использующих протокол SPDY.

**Принцип работы**

Клиентские и серверные приложения включают расширение согласования протокола приложения путем предоставления списков поддерживаемых идентификаторов протоколов приложений, в порядке убывания приоритета. Клиент TLS указывает, что он поддерживает согласование протокола приложения, включая расширение согласования протокола уровня приложений (ALPN) со списком протоколов, поддерживаемых клиентом в сообщении ClientHello.

Когда TLS клиент отправляет запрос на сервер, сервер TLS считывает, что это список поддерживаемых протоколов для наиболее предпочтительного протокола приложения, также поддерживаемого клиентом. Если протокол найден, сервер отвечает с Идентификатором выбранного протокола и продолжает подтверждение обычным образом. Если общего протокола приложений нет, сервер отправляет оповещение о неустранимом сбое.

### <a name="BKMK_TrustedIssuers"></a>Управление доверенными издателями для проверки подлинности клиента
При использовании SSL или TLS, необходима проверка подлинности клиентского компьютера, можно настроить сервер для отправки списка доверенных издателей сертификатов. Этот список содержит набор издателей сертификатов, которым будет доверять сервер и является подсказки на клиентском компьютере, выбору нужного клиентского сертификата, если существует несколько сертификатов. Кроме того цепочку сертификатов, клиентский компьютер отправляет серверу необходимо проверить на соответствие списку настроенных доверенных издателей.

До выхода Windows Server 2012 и Windows 8 приложения или процессы, которые использовали Schannel SSP (включая HTTP.sys и IIS), могли предоставлять список доверенных издателей, поддерживаемых для проверки подлинности клиента в сертификат доверия списка (CTL).

В Windows Server 2012 и Windows 8, были внесены изменения в базовый процесс проверки подлинности, чтобы:

-   Управление списком доверенных издателей на основе списка доверия Сертификатов больше не поддерживается.

-   Действие отправки списка доверенных издателей по умолчанию отключено: теперь значением по умолчанию для раздела реестра sendtrustedissuerlist является 0 (отключено по умолчанию) вместо 1.

-   Сохранена совместимость с предыдущими версиями операционных систем Windows.

**Какой эффект дает это?**

Начиная с Windows Server 2012, использование CTL было заменено реализацией на основе хранилища сертификатов. Это обеспечивает знакомую управляемость с помощью существующих командлетов управления сертификатами поставщика PowerShell, а также средства командной строки, например certutil.exe.

Хотя максимальный размер списка доверенных центров сертификации (16 КБ), поддерживаемых Schannel SSP, остается таким же, как и в Windows Server 2008 R2, Windows Server 2012, существует нового выделенного хранилище сертификатов для издателей проверки подлинности клиента, чтобы несвязанные сертификаты не включаются в сообщение.

**Как она работает?**

В Windows Server 2012 список доверенных издателей настраивается с помощью хранилищ сертификатов; одного заданного по умолчанию глобального хранилища сертификатов компьютера и одного дополнительного для каждого сайта. Источник списка определяется следующим образом:

-   Если существует конкретное хранилище учетных данных настроенные для сайта, он будет использоваться как источник

-   Если сертификаты не существует в хранилище, определяемом приложением, то Schannel проверяет **издателей проверки подлинности клиента** хранить на локальном компьютере и, если сертификаты присутствуют, использует это хранилище в качестве источника. Если сертификат не найден в одном из хранилищ, в хранилище доверенных корневых проверяется.

-   Если сертификатов нет ни глобальные или локальные хранилище, поставщик Schannel будет использовать **доверенные корневые центры сертификации** хранилище в качестве источника списка доверенных издателей. (Это поведение для Windows Server 2008 R2).

Если **доверенные корневые центры сертификации** хранилища, который использовался содержит сочетание корневых (самозаверяющих) сертификатов и сертификатов издателя центра сертификации (ЦС) сертификации, будут отправляться только сертификаты издателя ЦС на сервер по умолчанию.

**Настройка Schannel для использования в хранилище сертификатов доверенных издателей.**

В Windows Server 2012 архитектура Schannel SSP будет по умолчанию использовать хранилища, как описано выше для управления списком доверенных издателей. Можно по-прежнему использовать существующие управления сертификатами поставщика PowerShell, а также средства командной строки, например Certutil.exe для управления сертификатами.

Сведения об управлении сертификатами с помощью поставщика PowerShell см. в разделе [командлеты администрирования AD CS в Windows](https://technet.microsoft.com/library/hh848365(v=wps.620).aspx).

Сведения об управлении сертификатами с помощью служебной программы сертификатов см. в разделе [certutil.exe](https://technet.microsoft.com/library/cc732443.aspx).

Сведения о данных, включая определяемое приложением хранилище, определяются в качестве учетных данных Schannel см. в разделе [структура SCHANNEL_CRED (Windows)](https://msdn.microsoft.com/library/windows/desktop/aa379810(v=vs.85).aspx).

**Режимы доверия по умолчанию**

Существует три режима проверки подлинности клиента доверия поддерживаемых поставщиком Schannel. Режим доверия контролирует выполнение проверки цепочки сертификатов клиента и является системных настройкой, управляемой параметром реестра REG_DWORD «ClientAuthTrustMode» в разделе реестра HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel.

|Значение|Режим доверия|Описание|
|-----|-------|--------|
|0|Доверие компьютера (по умолчанию)|Требует, что сертификат клиента выдавался сертификатом из списка доверенных издателей.|
|1|Монопольное корневое доверие|Требует, чтобы клиентский сертификат связывался с корневым сертификатом, содержащимся в хранилище доверенных издателей, указанными вызывающей стороной. Сертификат также должен быть выдан издателем из списка доверенных издателей.|
|2|Монопольное доверие ЦС|Требует, чтобы клиентский сертификат связывался либо с промежуточным сертификатом ЦС, либо корневой сертификат в указанном вызывающей стороной хранилище доверенного издателя.|

Сведения о сбоях проверки подлинности из-за проблем конфигурации доверенных издателей см. статью базы знаний [280256](https://support.microsoft.com/kb/2802568).

### <a name="BKMK_SNI"></a>Поддержка протокола TLS для расширений индикатора имени сервера (SNI)
Компонент индикации имени сервера расширяет возможности протоколов SSL и TLS для правильной идентификации сервера, когда на одном сервере запущено несколько виртуальных образов. Чтобы обеспечить безопасность взаимодействия между клиентским компьютером и сервером, клиентский компьютер запрашивает цифровой сертификат с сервера. После сервер отвечает на запрос и отправит сертификат, клиентский компьютер проверяет его, использует его для шифрования передаваемых данных и выполняет обычный запрос ответ exchange. Однако в сценарии использования виртуальных систем, несколько доменов, каждый из которых имеет свой индивидуальный сертификат, размещаются на одном сервере. В этом случае сервер имеет не может заранее определить, какой сертификат для отправки на клиентском компьютере. Позволяет SNI клиентский компьютер может уведомить целевой домен заранее в протоколе, и это позволит серверу правильно выбрать надлежащий сертификат.

**Какой эффект дает это?**

Дополнительные функциональные возможности:

-   Размещение нескольких веб-сайтов SSL одним IP-адресом и портом

-   Сниженное использование памяти при размещении нескольких веб-сайтов SSL, работающих на одном веб-сервере

-   Дополнительные позволяет одновременно подключаются Мои SSL веб-сайты

-   Позволяет предоставлять подсказки для конечных пользователей посредством компьютерного интерфейса для выбора правильного сертификата в процессе проверки подлинности клиента.

**Принцип работы**

Schannel SSP поддерживает кэш в памяти состояния клиентских подключений, разрешенные клиентам. Это позволяет клиентским компьютерам повторно подключиться к SSL серверу без задержек и без полного подтверждения протокола SSL при последующих посещениях.  Такое эффективное использование процесса управления сертификатами допускает большего числа сайтов размещаться на одном по сравнению с предыдущими версиями операционной системы Windows Server 2012.

Позволяет составлять список возможных имен издателей сертификатов, предоставляющий пользователю с указания по выбору одного улучшен Выбор сертификата пользователем. Этот список настраивается с помощью групповой политики.

### <a name="BKMK_DTLS"></a>Датаграммы Transport Layer Security (DTLS)
Поставщик поддержки безопасности Schannel добавлен протокол DTLS версии 1.0. Протокол DTLS обеспечивает конфиденциальность каналов связи для протоколов датаграмм. Данный протокол позволяет приложениям взаимодействовать способом, предназначенную для предотвращения перехвата, взлома или подделки сообщений клиента или сервера. Протокол DTLS основан на протокол безопасности транспортного уровня (TLS) и предоставляет аналогичные гарантии безопасности, что сокращает потребность в использовании IPsec или разработке пользовательского протокола безопасности прикладного уровня.

**Какой эффект дает это?**

Датаграммы являются обычным объектом в потоковой передачи, такой как игры или безопасные видеоконференции. Добавление протокола DTLS к поставщику Schannel дает возможность использовать знакомую модель Windows SSPI обеспечения безопасной связи между клиентскими компьютерами и серверами. Протокол DTLS специально разработан таким образом, чтобы быть максимально похожим на протокол TLS, что позволяет свести к минимуму новый изобретения безопасности и увеличить объем повторно используемых элементов инфраструктуры и кода.

**Принцип работы**

Приложения, использующие протокол DTLS по UDP, могут использовать модель SSPI в Windows Server 2012 и Windows 8. Определенные наборы шифров доступные для настройки, аналогично настройки TLS. Schannel продолжается использование поставщика служб шифрования CNG, который принимает сертификацией FIPS 140, которая была введена в Windows Vista.

### <a name="BKMK_Deprecated"></a>Устаревшие функциональные возможности
В поставщике Schannel SSP для Windows Server 2012 и Windows 8 отсутствуют устаревшие компоненты или функциональные возможности.

## <a name="see-also"></a>См. также:
-   [Модель безопасности частного облака — функциональные возможности программы-оболочки](https://social.technet.microsoft.com/wiki/contents/articles/6756.private-cloud-security-model-wrapper-functionality.aspx)



