---
title: "Процедуры с учетными данными в проверке подлинности Windows"
description: "Безопасность Windows Server"
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-windows-auth
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 48c60816-fb8b-447c-9c8e-800c2e05b14f
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: 52d50a1bb6bfbe9d35146f362a2a5184df0a6504
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="credentials-processes-in-windows-authentication"></a>Процедуры с учетными данными в проверке подлинности Windows

>Область применения: Windows Server (канал точками годовой), Windows Server 2016

Этот справочный раздел для ИТ-специалистов описывается, как проверка подлинности Windows обрабатывает учетные данные.

Управление учетными данными Windows — это процесс, в котором операционной системы получает учетные данные от службы или пользователя, а также обеспечивает защиту эту информацию для будущих презентации целевой объект проверки подлинности. В случае компьютеров, присоединенных к домену целевой объект проверки подлинности — контроллер домена. Учетные данные, используемые в проверке подлинности, цифровые документы, которые связать удостоверение пользователя в некоторую форму проверки подлинности, такие как сертификат, пароль или ПИН-код.

По умолчанию Windows проверки учетных данных в базе данных диспетчера учетных записей безопасности (SAM) на локальном компьютере или от Active Directory на компьютере, присоединенном к домену, через службу Winlogon. Учетные данные собираются посредством ввода пользователя на пользовательский интерфейс входа в систему или программными средствами с помощью интерфейсу прикладного программирования (API), представлены в целевой объект проверки подлинности.

Локальная политика безопасности хранятся в разделе реестра **HKEY_LOCAL_MACHINE\SECURITY**. Хранимые данные включает параметры политики, значения безопасности по умолчанию и сведения об учетной записи, например кэшированных учетных данных. Несмотря на то, что он защищен от записи копия базы данных SAM хранятся здесь.

Следующая схема показывает путей и компоненты, которые необходимы использовать учетные данные через систему для проверки подлинности пользователя или процесса, для успешного входа в систему.

![Диаграмма, показывающая компоненты, которые необходимы и пути, что учетные данные имеют через систему для проверки подлинности пользователя или процесса, для успешного входа в систему.](../media/credentials-processes-in-windows-authentication/AuthN_LSA_Architecture_Client.gif)

В следующей таблице описаны каждого компонента, который управляет учетными записями в процессе проверки подлинности в момент входа в систему.

**Компоненты проверки подлинности для всех систем**

|Компонент|Описание|
|-------|--------|
|Вход пользователя|Winlogon.exe является исполняемым файлом, ответственных за управление взаимодействия с пользователем безопасного. Службе Winlogon инициирует процесс входа в операционные системы Windows, передав учетные данные, полученные действием пользователя на безопасном рабочем столе (пользовательский Интерфейс входа в систему) для локального администратора безопасности (LSA) через Secur32.dll.|
|Приложения входа|Приложение или служба входа в систему, не требующие интерактивный вход в систему. Большинство процессов пользователем работы в режиме пользователя с помощью Secur32.dll, тогда как инициировал во время запуска, таких как службы, процессы запуска в режиме ядра с помощью Ksecdd.sys.<br /><br />Дополнительные сведения о пользовательском режиме и режиме ядра см. в подразделе приложения и режим пользователя или службы и режима ядра.|
|Secur32.dll|Несколько поставщиков проверки подлинности, обрабатывающих с foundation проверки подлинности.|
|Lsasrv.dll|Служба сервера LSA, которая обеспечивает применение политик безопасности и действует как диспетчер пакетов безопасности для LSA. LSA содержит функцию Negotiate, который выбирает протокол Kerberos или NTLM после определить, какой протокол для успешной.|
|Поставщики поддержки безопасности|Набор поставщиков, которые по отдельности можно вызвать один или несколько протоколов проверки подлинности. Набор поставщиков по умолчанию можно изменить в каждой версии операционной системы Windows, и настраиваемые поставщики могут быть записаны.|
|Netlogon.dll|Ниже приведены службы, которые выполняет служба сетевого входа в систему.<br /><br />-Поддерживает безопасный канал компьютера (не следует путать с Schannel) до уровня контроллера домена.<br />-Передает учетные данные пользователя через безопасный канал к контроллеру домена и возвращает домена идентификаторы безопасности (SID) и права доступа для пользователя.<br />-Публикует записи ресурсов в системе доменных имен (DNS) и использует DNS-сервера для разрешения имен в адреса протокола Интернета (IP) контроллеров домена.<br />-Реализует протокол репликации, основанную на удаленный вызов процедур (RPC) для синхронизации основных контроллеров домена (PDC) и резервные контроллеры домена (BDC).|
|Samsrv.dll|Диспетчером (SAM), который хранит учетные записи локальной системы безопасности, применяет локальные политики и поддерживает API.|
|Реестра|В реестре содержатся копию базы данных SAM, параметры локальной политики безопасности, значения по умолчанию безопасности и сведения об учетной записи, которая доступна только в системе.|

Этот раздел содержит следующие разделы:

-   [Ввод учетных данных для входа пользователя в систему](#BKMK_CrentialInputForUserLogon)

-   [Ввод учетных данных для приложения и вход в службу](#BKMK_CredentialInputForApplicationAndServiceLogon)

-   [Локальная система безопасности](#BKMK_LSA)

-   [Проверка и кэшированных учетных данных](#BKMK_CachedCredentialsAndValidation)

-   [Проверка и хранение учетных данных](#BKMK_CredentialStorageAndValidation)

-   [База данных диспетчера учетных записей безопасности](#BKMK_SAM)

-   [Локальных доменов и доверенных доменов](#BKMK_LocalDomainsAndTrustedDomains)

-   [Сертификаты проверки подлинности Windows](#BKMK_CertificatesInWindowsAuthentication)

## <a name="BKMK_CrentialInputForUserLogon"></a>Ввод учетных данных для входа пользователя в систему
В Windows Server 2008 и Windows Vista архитектура Graphical Identification and Authentication (GINA) была заменена модель поставщика учетных данных позволяет перечислять типы различных входа с помощью плитки для входа. Ниже описаны обе модели.

**Архитектура Graphical Identification и проверки подлинности**

Архитектура Graphical Identification and Authentication (GINA) применяется к операционным системам Windows Server 2003, Microsoft Windows 2000 Server, Windows XP и Windows 2000 Professional. В этих системах каждый сеанс для интерактивного входа в систему создает отдельный экземпляр службы Winlogon. GINA архитектуре загружается в процесс место, занимаемое Winlogon, получает и обрабатывает учетные данные и вызывает в интерфейсы проверки подлинности через LSALogonUser.

Экземпляры Winlogon для интерактивного входа в систему выполняется в сеансе 0. Сеанс 0 узлов системных служб и других важных процессов, включая процесс локального администратора безопасности (LSA).

На схеме показан процесс учетных данных для Windows Server 2003, Microsoft Windows 2000 Server, Windows XP и Microsoft Windows 2000 Professional.

![Схема, показывающая процесс обработки учетных данных для Windows Server 2003, Microsoft Windows 2000 Server, Windows XP и Microsoft Windows 2000 Professional](../media/credentials-processes-in-windows-authentication/AuthN_GINA_Architecture.gif)

**Архитектура поставщика учетных данных**

Архитектура поставщика учетных данных применяется к версиями, указанными в **применяется к** в начале этой статьи. В этих системах архитектура ввода учетных данных изменено на расширяемый разработки с помощью поставщиков учетных данных. Эти поставщики представлены различные плитки для входа на безопасном рабочем столе, обеспечивающих любое количество сценарии входа в систему - различные учетные записи для одного пользователя и разные методы проверки подлинности, такие как пароль и смарт-карты, биометрические данные.

Архитектура поставщика учетных данных Winlogon всегда начинается пользовательского интерфейса входа в систему после получения последовательности специальное событие. Пользовательский Интерфейс входа запрашивает у каждого поставщика учетных данных, числа различных типов учетных данных поставщика настроена для перечисления. Поставщики учетных данных у выбрать один из этих плитки по умолчанию. После перечислении плитках всех поставщиков пользовательского интерфейса входа показывает их пользователю. Пользователь взаимодействует с плитки, чтобы предоставить свои учетные данные. Пользовательский Интерфейс входа передает эти учетные данные для проверки подлинности.

Поставщики учетных данных не механизмы принудительного применения. Они используются для сбора и сериализации учетные данные. Пакеты локальной системы безопасности и проверки подлинности применение политик безопасности.

Поставщики учетных данных, зарегистрированных на компьютере и несете ответственность за следующие:

-   Описания учетные данные, необходимые для проверки подлинности.

-   Обработка связи и логику для центров внешней проверки подлинности.

-   Упаковка учетные данные для интерактивного и входа в сеть.

Упаковка учетные данные для интерактивного и входа в сеть включает процесс сериализации. Путем сериализации учетные данные могут отображаться несколько плитки для входа на пользовательский Интерфейс входа. Таким образом вашей организации могут управлять отображения входа в систему, например пользователи, целевые системы, для входа в систему, предварительного доступа к сети и рабочей станции заблокируйте и разблокируйте политик — с использованием поставщиков настраиваемой учетных данных. Несколько поставщиков учетных данных могут сосуществовать на одном компьютере.

Как поставщик стандартных учетных данных или поставщиком доступа до входа систему, может быть разработан единого входа (SSO) поставщиков.

Каждой версии Windows содержит поставщик учетных данных одного заданного по умолчанию и одного заданного по умолчанию входа систему доступа до поставщика (PLAP), также известный как поставщика единого входа. Поставщик единого входа разрешает пользователям для подключения к сети, перед входом в систему на локальном компьютере. При реализации этого поставщика, поставщик не выполняет перечисление плитки на пользовательский Интерфейс входа в систему.

Поставщик единого входа предназначен для использования в следующих случаях:

-   **Вход в сеть проверки подлинности и компьютера обрабатываются поставщиков различных учетных данных.** Ниже перечислены варианты для этого сценария.

    -   Пользователь имеет возможность подключения к сети, например подключение к виртуальной частной сети (VPN), прежде чем входить в систему, но для данного подключения не требуется.

    -   Чтобы получить сведения, используемые во время интерактивной проверки подлинности на локальном компьютере требуется проверка подлинности сети.

    -   В других случаях следуют различных видов проверки подлинности сети. Например пользователь проходит проверку подлинности для поставщика услуг Интернета (ISP), выполняет проверку подлинности на VPN-Подключение, а затем использует свои учетные данные учетной записи пользователя войти в систему локально.

    -   Кэшированные учетные данные будут отключены, и подключения служб удаленного доступа через VPN, необходимые для проверки подлинности пользователя перед локальный вход в систему.

    -   Пользователь домена не имеет локальную учетную запись на компьютере, присоединенном к домену и необходимо установить подключение служб удаленного доступа через VPN-подключение до завершения интерактивного входа в систему.

-   **Вход в сеть проверки подлинности и компьютера, обрабатываются того же поставщика учетных данных.** В этом сценарии пользователь необходим для подключения к сети до входа в систему.

**Перечисления плитки для входа в систему**

Поставщик учетных данных перечисляет плитки для входа в следующих случаях:

-   Для этих операционных систем, указанных в **относится к** в начале этой статьи.

-   Поставщик учетных данных перечисляет плитки для входа в рабочую станцию. Поставщик учетных данных обычно сериализует учетные данные для проверки подлинности для подсистемы LSA. Этот процесс показывает плитки индивидуально для каждого пользователя, так и определенных целевых систем для каждого пользователя.

-   Архитектура входа и проверки подлинности позволяет использовать плитки, перечисленные поставщик учетных данных для разблокировки рабочей станции пользователя. Как правило пользователя, находящегося в системе является плитки по умолчанию, но если более одного пользователь вошел в систему, многочисленные плитки отображаются.

-   Поставщик учетных данных перечисляет плитки в ответ на запрос пользователя изменить свой пароль или других личных сведений, например ПИН-код. Как правило находящегося в системе он плитки по умолчанию; Тем не менее, если несколько пользователей вошел в систему, многочисленные плитки отображаются.

-   Поставщик учетных данных перечисляет плитки, на основе сериализованных учетных данных, используемый для проверки подлинности на удаленных компьютерах. Пользовательский Интерфейс учетных данных не используют один экземпляр поставщика пользовательского интерфейса входа в систему, разблокировка рабочей станции или изменить пароль. Таким образом сведения о состоянии не будут сохранены в поставщике между экземплярами пользовательского интерфейса учетных данных. Эта структура приводит одну плитку, для каждого удаленного компьютера входа в систему, при условии, что учетные данные правильно сериализованных. Этот сценарий также используется в (Учетных записей), который помогает предотвратить несанкционированные изменения компьютера, запрашивая у пользователя разрешение или пароль администратора перед предоставлением действий, которые могут сказаться на работе компьютера может изменением параметров, влияющих на других пользователей компьютера.

На следующей схеме показан процесс обработки учетных данных для операционных систем, указанных в **применяется к** в начале этой статьи.

![Диаграмма, показывающая процесс обработки учетных данных для операционных систем, указанных в ** применяется к ** в начале этого раздела](../media/credentials-processes-in-windows-authentication/AuthN_CredMan_CredProv.gif)

## <a name="BKMK_CredentialInputForApplicationAndServiceLogon"></a>Ввод учетных данных для приложения и вход в службу
Проверка подлинности Windows предназначена для управления учетными данными для приложений или служб, которые не требуют участия пользователя. С точки зрения, какие ресурсы системы они имеют доступ к, пока служб может иметь неограниченный доступ к системной памяти и внешними устройствами ограничены приложений в пользовательском режиме.

Системные службы и приложения на уровне транспорта получить доступ к поставщик поддержки безопасности (SSP) через поддержки поставщика интерфейс безопасности (SSPI) в Windows, который предоставляет функции для пакетов безопасности, доступных в системе, выберите пакет и с помощью этого пакета и получить подключение с проверкой подлинности.

После проверки подлинности подключения клиента или сервера:

-   Приложения на клиентской стороне соединения отправляет учетные данные на сервер с помощью функции SSPI `InitializeSecurityContext (General)`.

-   Приложения на стороне сервера подключения отвечает функция SSPI `AcceptSecurityContext (General)`.

-   Функции SSPI `InitializeSecurityContext (General)`и `AcceptSecurityContext (General)`повторяются, пока все необходимые проверки подлинности сообщения обмена на выполнение или сбой проверки подлинности.

-   После проверки подлинности подключения для создания контекст безопасности, который содержит маркер доступа LSA на сервере используются сведения от клиента.

-   Сервер затем может вызывать функцию SSPI `ImpersonateSecurityContext`для присоединения маркер доступа потоку олицетворения для службы.

**Приложения и режим пользователя**

Режим пользователя в Windows состоит из двух систем для передачи запросов ввода-вывода в соответствующие в режиме ядра драйверы: среды, он выполняет приложения, написанные для различных типов операционных систем, и неотъемлемая системы, работающий функции, связанные с системы от имени системой среды.

Составной система управляет работы функции system'specific от имени среды системы и состоит из системы безопасности (LSA), служба рабочей станции и служба сервера. Процесс обеспечения безопасности системы воспринимает маркеры безопасности, предоставляет или запрещает разрешения доступа к учетным записям пользователей на основе разрешений ресурсов, обрабатывает запросы на вход в систему и инициирует проверку подлинности и определяет, какие ресурсы системы, операционной системы необходимо аудита.

Приложения могут выполняться в пользовательском режиме, где приложение может работать как любой субъекта, включая в контексте безопасности из Local System (SYSTEM). Приложения можно также запустить в режиме ядра которой приложение может работать в контексте безопасности из Local System (SYSTEM).

SSPI — через Secur32.dll модуля, который является интерфейсом API, используемым для получения интегрированных служб безопасности для проверки подлинности, целостность и конфиденциальность сообщений. Он обеспечивает уровень абстракции между протоколов уровня приложения и протоколов безопасности. Так как различных приложений требуются различные способы идентификации или проверки подлинности пользователей и различные способы шифрования данных, передаваемого по сети, SSPI предоставляет способ доступа к библиотек динамической компоновки (DLL), содержащие разные проверки подлинности и криптографических функций. Эти DLL-файлы называются поставщиков поддержки безопасности (SSP).

Управляемые учетные записи и виртуальные учетные записи были представлены в Windows Server 2008 R2 и Windows 7 для предоставления важных приложений, таких как Microsoft SQL Server и Internet Information Services (IIS), изолировать их собственные учетные записи домена, во время, избавляя от необходимости администратору возможность вручную администрирования имя участника службы (SPN) и учетные данные для этих учетных записей. Дополнительные сведения об этих возможностях и их роли в проверке подлинности см. в разделе [управляемые службы учетных записей документации для Windows 7 и Windows Server 2008 R2](https://technet.microsoft.com/library/ff641731(v=ws.10).aspx) и [группы обзор управляемых учетных записей служб](../group-managed-service-accounts/group-managed-service-accounts-overview.md).

**Режим служб и ядра**

Несмотря на то, что большинство приложений Windows выполняются в контексте безопасности пользователя, который запускает их, это не относится служб. Многие службы Windows, таких как сети и служб печати, запускаются контроллером службы при запуске компьютера. Эти службы могут работать в качестве локальной службы или локальной системы и могут продолжать работать после выхода из системы последнего пользователя.

> [!NOTE]
> Обычно выполняются в контексте безопасности, известные как Local System (SYSTEM), Network Service или Local Service.  Windows Server 2008 R2 появился служб, работающих управляемой учетной записи службы, которые являются участниками домена.

Перед запуском службы, в контроллер служб входит в систему с помощью учетной записи, которые указаны для службы, а также предоставляет службы учетные данные для проверки подлинности с помощью LSA. Служба Windows реализует программный интерфейс, используемый диспетчером управления службами для управления этой службой. Служба Windows запускается автоматически при запуске системы, или вручную с помощью программы управления службы. Например когда клиентский компьютер Windows присоединяется к домену, служба сообщений на компьютер подключается к контроллеру домена и открывает безопасного канала, чтобы его. Для получения подключение с проверкой подлинности, служба необходимо иметь учетные данные, которым доверяет локального администратора безопасности (LSA) удаленного компьютера. При взаимодействии с другими компьютерами в сети, LSA использует учетные данные для учетной записи домена локального компьютера, как и все остальные службы, работающие в контексте безопасности локальной системы и сетевой службы. Службы на локальном компьютере, запустите систему, чтобы учетные данные не обязательно должны быть представлены в LSA.

Файл Ksecdd.sys управляет и шифрует эти учетные данные и использует вызов локальной процедуры в LSA. Тип файла DRV (драйвер) и известна как поставщик поддержки безопасности в режиме ядра (SSP) и в версиями, указанными в **применяется к** в начале этой статьи, является FIPS 140-2 уровня 1-совместимым.

Режим ядра имеет полный доступ к ресурсам оборудования и системы компьютера. Режим ядра останавливает пользовательского режима службы и приложения, доступ к критически важных областях операционной системы, они не должны иметь доступ к.

## <a name="BKMK_LSA"></a>Локальная система безопасности
Локального администратора безопасности (LSA) — это процесс защищенную систему, которая проверяет подлинность и вход пользователей в систему на локальном компьютере. Кроме того LSA содержит сведения обо всех аспектах локальной безопасности компьютера (эти аспекты которые в совокупности называются локальной политикой безопасности), и предоставляет различные службы для преобразования между имена и идентификаторы безопасности (SID). Процесс системы безопасности локальной системы безопасности центра сервера службы (LSASS), сохраняет сведения об политик безопасности и учетные записи, которые действуют в системе компьютера.

LSA проверяет удостоверение пользователя, какие из следующих двух объектов, выданных учетной записи пользователя на основе:

-   **Локальная система безопасности.** LSA можно проверить сведения о пользователе, проверка базы данных диспетчера учетных записей безопасности (SAM), расположенных на том же компьютере. Любой рабочей станции или рядового сервера можно хранить учетные записи локальных пользователей и сведения о локальных группах. Однако эти учетные записи могут использоваться для доступа к этой рабочей станции или компьютера.

-   **Центр безопасности для локального домена или доверенного домена.** LSA обращается сущности, который выдал учетной записи и проверки запросов, что учетная запись является допустимым и что запрос поступил от владелец учетной записи.

Локальные службы подсистемы безопасности центра (LSASS) сохраняет в памяти учетные данные пользователей с активными сеансами Windows. Сохраненные учетные данные позволяют пользователям легко получить доступ к сетевым ресурсам, например, общие файловые ресурсы, почтовые ящики Exchange Server и сайтам SharePoint, без необходимости повторного ввода учетных данных для каждой удаленной службы.

Служба LSASS способна хранить учетные данные в нескольких форматах, включая:

-   Обратимого шифрования в виде обычного текста

-   Билеты Kerberos (билет предоставления билетов (TGT), билеты служб)

-   NT-хэш

-   Хэш LAN Manager (LM)

Если пользователь выполняет вход в Windows с помощью смарт-карт, служба LSASS не хранить пароль в виде обычного текста, но сохраняется соответствующий NT-хэш для учетной записи и в виде обычного текста ПИН-код смарт-карты. Если для смарт-карты, необходимой для интерактивного входа, включается атрибут учетной записи случайных NT-хэш автоматически создается для учетной записи вместо изначального хэша пароля. Хэш пароля, автоматически сгенерированный при установке атрибута не изменяется.

Если пользователь выполняет вход на компьютер под управлением Windows, с помощью пароля, совместимого с хеш-значения LAN Manager (LM), эта структура проверки подлинности находится в памяти.

Хранение учетных данных в виде обычного текста в памяти нельзя выключить, даже если поставщики учетных данных, где они необходимы.

Сохраненные учетные данные напрямую связываются с локальной безопасности центра подсистемы службы () незавершенными сеансами LSASS, начатыми после последнего перезапуска и не была закрыта. Например сеансы с сохраненными учетными данными LSA создаются, когда пользователь выполняет одно из следующих:

-   Журналы локальному сеансу или сеансу удаленного рабочего стола (RDP) на компьютере

-   Запускает задание с помощью **RunAs** параметр

-   Запускает на компьютере активную службу Windows

-   Запускает назначенное или пакетное задание

-   Запускает задание на локальном компьютере с помощью средства удаленного администрирования

В некоторых случаях секретов LSA, которые секретный части данных, которые доступны только для учетной записи СИСТЕМНЫМ процессам, хранятся на жестком диске. Некоторые из этих секретов представляют собой учетные данные, которые должны сохраниться после перезагрузки и хранящиеся на жестком диске в зашифрованном виде. Учетные данные, хранящиеся в виде секретов LSA, могут включать:

-   Пароль учетной записи для учетных записей доменных служб Active Directory (AD DS)

-   Пароли учетных записей служб Windows, настроенных на компьютере

-   Пароли учетных записей настроенных назначенных заданий

-   Пароли учетных записей для пулов приложений IIS и веб-сайтов

-   Пароли для учетных записей Майкрософт

В Windows 8.1 появился клиентской операционной системы обеспечивает дополнительную защиту для LSA, предотвращая считывание памяти и внедрение кода незащищенными процессами. Эта защита повышает безопасность учетных данных, которые хранит LSA и управляет.

Дополнительные сведения об этих дополнительных средств защиты см. в разделе [Настройка дополнительной защиты LSA](../credentials-protection-and-management/configuring-additional-lsa-protection.md).

## <a name="BKMK_CachedCredentialsAndValidation"></a>Проверка и кэшированных учетных данных
Механизмы проверки зависит от презентации учетных данных во время входа в систему. Тем не менее если компьютер отключен от контроллера домена, и пользователь является представление учетные данные домена, Windows использует процесс кэшированные учетные данные в механизм проверки.

При каждом входе пользователя в домен Windows кэширует учетные данные и сохраняет их в безопасности в кусте реестра операционной системы.

С помощью кэшированных учетных данных пользователь может войти члену домена без подключения к контроллеру домена в рамках этого домена.


## <a name="BKMK_CredentialStorageAndValidation"></a>Проверка и хранение учетных данных
Это не всегда желательно использовать один набор учетных данных для доступа к различным ресурсам. Например администратор может потребоваться использовать правами администратора, а не учетные данные пользователя при входе на удаленный сервер. Аналогично Если пользователь обращается к внешним ресурсам, таким как банковский счет, он или она можно использовать только учетные данные, которые отличаются от свои учетные данные домена. В следующих разделах различия в управление учетными данными между текущих версиях операционных систем Windows и операционных систем Windows Vista и Windows XP.

### <a name="remote-logon-credential-processes"></a>Процессы учетных данных удаленного входа
Протокол удаленного рабочего стола (RDP) управляет учетными данными пользователя, который подключается к удаленному компьютеру с помощью клиента удаленного рабочего стола, которая была введена в Windows 8. Учетные данные в виде открытого текста отправляются на узел назначения, где узел пытается выполнить процесс проверки подлинности и, в случае успешного выполнения пользователь подключается к допустимые ресурсы. Протокол удаленного рабочего СТОЛА не сохраняет учетные данные на клиентском компьютере, но учетные данные пользователя домена, хранятся в LSASS.

В Windows Server 2012 R2 и Windows 8.1 появился ограниченный режим администратора обеспечивает дополнительную безопасность для сценариев удаленного входа в систему. Этот режим удаленного рабочего стола в результате клиентское приложение для выполнения сетевого входа в систему запрос ответ с необратимой функции NT (NTOWF) или использовать билет службы Kerberos при проверке подлинности на удаленном узле. После проверки подлинности администратора, администратор имеет учетных данных соответствующей учетной записи в LSASS, так как они не были предоставлены к удаленному узлу. Вместо этого администратор имеет учетные данные учетной записи компьютера для сеанса. Учетные данные администратора не предоставляются к удаленному узлу, так как учетная запись компьютера выполняются действия. Ресурсы ограничены также учетной записи компьютера, и администратор не имеют доступа к ресурсам с собственную учетную запись.

### <a name="automatic-restart-sign-on-credential-process"></a>Автоматический перезапуск процесса учетных данных входа
При входе пользователя на устройстве Windows 8.1 LSA сохраняет учетные данные пользователя в зашифрованном памяти, которые доступны только с LSASS.exe. Если центра обновления Windows инициирует автоматический перезапуск без присутствия пользователя, эти учетные данные используются для настройки автоматического входа для пользователя.

При перезагрузке компьютера пользователь автоматически входит через механизм автоматического входа в систему и затем компьютера, кроме того заблокировано для защиты сеанс пользователя. Блокировка инициируется через функцию Winlogon в то время как управление учетными данными осуществляется LSA. Автоматически входа в систему и блокировка сеанса пользователя на консоли приложений экрана блокировки пользователя перезапуск и доступность.

Дополнительные сведения о ARSO см. в разделе [Winlogon автоматического перезапуска входа & #40; ARSO & #41;](winlogon-automatic-restart-sign-on-arso.md).

### <a name="stored-user-names-and-passwords-in-windows-vista-and-windows-xp"></a>Сохранение имен пользователей и паролей в Windows Vista и Windows XP
В Windows Server 2008, Windows Server 2003, Windows Vista и Windows XP **Сохранение имен пользователей и паролей** в панели управления упрощает управление и использовать несколько наборов учетных данных, включая сертификаты X.509, используемые со смарт-картами и учетные данные Windows (теперь называется учетной записью Майкрософт). Учетные данные - части профиля пользователя - сохраняются, пока не требуется. Это действие может повысить безопасность на основе каждого ресурса, гарантируя, что в случае компрометации один пароль, он не нарушить безопасность все.

Когда пользователь входит в систему и пытается получить доступ к дополнительные ресурсы, защищенные паролем, например, общую папку на сервере, и если учетные данные для входа по умолчанию пользователя недостаточны для доступа, **Сохранение имен пользователей и паролей** запрашивается. Если альтернативные учетные данные с правильные учетные данные были сохранены в **Сохранение имен пользователей и паролей**, эти учетные данные используются для получения доступа. В противном случае пользователю будет предложено ввести новые учетные данные, которые можно сохранить для повторного использования далее в сеанс входа в систему или во время последующего сеанса.

Применяются следующие ограничения.

-   Если **Сохранение имен пользователей и паролей** содержит недопустимый или неправильный учетные данные для определенного ресурса, доступ к ресурсу запрещен и **Сохранение имен пользователей и паролей** диалоговое окно не отображается.

-   **Сохранение имен пользователей и паролей** сохраняет учетные данные только для NTLM, протокол Kerberos, учетной записи Майкрософт (ранее Windows Live ID) и проверки подлинности Secure Sockets Layer (SSL). Некоторые версии Internet Explorer Ведение собственный кэш для обычной проверки подлинности.

Эти учетные данные станут зашифрованные часть в локальном профиле пользователя в \Documents and Settings\Username\Application Data\Microsoft\Credentials каталога. В результате эти учетные данные можно перемещаться с пользователем, если политика пользователя сети поддерживает перемещаемых профилей пользователей. Тем не менее если у пользователя есть копии **Сохранение имен пользователей и паролей** на двух различных компьютеров и изменения учетных данных, которые связаны с ресурса на одном из этих компьютеров, это изменение не распространяется на **Сохранение имен пользователей и паролей** на другом компьютере.

### <a name="windows-vault-and-credential-manager"></a>Хранилище Windows и диспетчер учетных данных
Диспетчер учетных данных впервые появился в Windows Server 2008 R2 и Windows 7 как компонент панели управления для хранения и управления имена пользователей и пароли. Диспетчер учетных данных позволяет хранить учетные данные, относящиеся к другим системам и веб-сайты в безопасной хранилище Windows. Некоторые версии Internet Explorer использовать данную функцию для проверки подлинности на веб-сайты.

Управление учетными данными с помощью диспетчера учетных данных контролируется пользователем локального компьютера. Пользователи могут сохранять и хранить учетные данные из поддерживаемых браузерах и приложениях Windows, чтобы пользователям было удобно им необходимо войти на эти ресурсы. Учетные данные сохраняются в специальных зашифрованных папках на компьютере в профиль пользователя. Приложения, поддерживающие этот компонент (через использование API диспетчера учетных данных), такие как веб-браузеры и приложения, могут предоставлять правильные учетные данные другим компьютерам и веб-сайты при входе в систему.

Когда веб-сайт, приложение или другой запросы проверки подлинности компьютера через протокол Kerberos или NTLM, диалоговое окно, в которой можно выбрать **учетные данные по умолчанию обновления** или **сохранить пароль** флажок. Это диалоговое окно, которое дает пользователю возможность сохранять учетные данные локально создается приложением, поддерживающим API диспетчера учетных данных. Если пользователь выбирает **сохранить пароль** флажок, диспетчер учетных данных сохраняет сведения об имени пользователя, пароль, и сведения, относящиеся к для службы проверки подлинности, который используется.

Время следующего обращения в службу, диспетчер учетных данных автоматически предоставляет учетные данные, которые хранятся в хранилище Windows. Если данные не принимаются, пользователю предлагается ввести правильную доступ к информации. Если с новыми учетными данными доступ разрешен, диспетчер учетных данных меняет предыдущие учетные данные на новые и хранит новые учетные данные в хранилище Windows.

## <a name="BKMK_SAM"></a>База данных диспетчера учетных записей безопасности
Диспетчер учетных записей безопасности (SAM) — это база данных, в которой хранятся учетные записи локальных пользователей и групп. Оно присутствует в каждой операционной системы Windows; Тем не менее если компьютер присоединен к домену, Active Directory управляет учетных записей домена в доменах Active Directory.

Например клиентские компьютеры под управлением операционной системы Windows принять участие в сетевой домен, связываясь с контроллером домена, даже в том случае, если человека пользователь не вошел в систему. Взаимодействовать, компьютер необходимо иметь активную учетную запись в домене. Прежде чем принимать подключения от компьютера, LSA на контроллере домена проверяет подлинность удостоверения компьютера и затем создает контекст безопасности компьютера, так же, как для субъекта безопасности человека. Контекст безопасности определяет удостоверение и возможности службы или пользователя на определенный компьютер или пользователя, служба или компьютер в сети. Например маркер доступа, содержащихся в контексте безопасности определяет ресурсы (например, общая папка или принтер), доступных и действия (например, чтение, запись или изменение), которые могут выполняться с этого участника - пользователя, компьютера или службы, что ресурс.

Контекст безопасности пользователя или компьютера может изменяться от одного компьютера на другой, например, при входе в систему на сервер или рабочую станцию, отличных от основной рабочей станции пользователя. Оно также может меняться из одного сеанса в другой, например, если администратор изменяет права и разрешения пользователя. Кроме того контекст безопасности обычно отличается, если пользователь или компьютер работает отдельно, в сети или в составе домена Active Directory.

## <a name="BKMK_LocalDomainsAndTrustedDomains"></a>Локальных доменов и доверенных доменов
При наличии доверия между двумя доменами, механизмы проверки подлинности для каждого домена полагаться на правильность проверки подлинности, поступающих из другого домена. Доверяющий помогают управляемый доступ к общим ресурсам в домене ресурсов (доверяющий домен), проверяя, что входящие запросы проверки подлинности поступают из доверенного центра сертификации (доверенного домена). Таким образом доверие действовать как мосты, которые позволяют только проверенных путешествия запросов проверки подлинности между доменами.

Как определенных отношений доверия передает запросы проверки подлинности зависит от того, как оно настроено. Отношения доверия можно, предоставляя доступ к ресурсам в доверяющем домене из доверенного домена,- или двусторонним, предоставляя доступ к ресурсам в другой домен из каждого домена. Отношения доверия можно либо нетранзитивными, в таком случае существует отношение доверия только между доменами партнеров два отношения доверия, либо транзитивными, в этом случае отношение доверия автоматически расширяет на другие домены, которым доверяет любому из участников.

Сведения об отношениях доверия домена и леса, касающиеся проверки подлинности см. в разделе [делегированной проверки подлинности и отношения доверия](https://technet.microsoft.com/library/dn169022.aspx).

## <a name="BKMK_CertificatesInWindowsAuthentication"></a>Сертификаты проверки подлинности Windows
Инфраструктуры открытых ключей (PKI) — это комбинация программного обеспечения, технологии шифрования, процессов и служб, которые позволяют организации для защиты его связи и деловых операций. Возможность PKI безопасной связи и деловых операций основана на бирже цифровые сертификаты между с проверкой подлинности пользователей и доверенных ресурсов.

Цифровой сертификат — это электронный документ, содержащий сведения о объект, к которому он принадлежит, объект, который был выдан, уникальный серийный номер или других уникальный идентификатор, выдачи и дат истечения срока действия и цифровой отпечаток.

Проверка подлинности — процесс определения того, если удаленный узел можно доверять. Чтобы установить его надежность, удаленного узла необходимо указать сертификат проверки подлинности.

Удаленными узлами установить их надежность, получения сертификата от центра сертификации (ЦС). ЦС в свою очередь, имеет сертификат от центра более высокого уровня, который создает цепочку сертификатов. Чтобы определить, заслуживает ли сертификат, приложение необходимо определить удостоверение корневого ЦС и определить, является ли надежными.

Аналогичным образом удаленного узла или локальный компьютер должен определить ли сертификат, предъявленный пользователем или приложением подлинной. Сертификат, предъявленный пользователя в LSA и SSPI оценивается подлинность на локальном компьютере для локального входа в систему, в сети или в домене через хранилищ сертификатов в Active Directory.

Для получения сертификата, данные проверки подлинности проходит хэш-алгоритмы, такие как защитить хэша алгоритм (SHA1 1), для создания дайджест сообщения. Дайджест сообщения цифровую подпись с помощью закрытого ключа отправителя, чтобы доказать, что отправитель создано дайджест сообщения.

> [!NOTE]
> SHA1 по умолчанию в Windows 7 и Windows Vista, но была изменена, чтобы SHA2 в Windows 8.

**Проверка подлинности смарт-карты**

Технологии смарт-карт — пример проверки подлинности на основе сертификатов. Входа в сеть с помощью смарт-карта обеспечивает строгую проверку подлинности, так как использует криптографических кода и подтверждения собственности, при входе пользователя в домен. Службы сертификации Active Directory (AD CS) обеспечивает идентификацию шифрования на основе до выдачи сертификата для входа в систему для каждого смарт-карты.

Сведения о проверке подлинности смарт-карты см. в разделе [Технический справочник по смарт-карт Windows](https://technet.microsoft.com/library/ff404297.aspx).

Технологии виртуальных смарт-карты появился в Windows 8. Сохраняет сертификат смарт-карты в компьютер и затем защищает его с помощью микросхемы безопасности доверенного платформенного модуля (TPM) устройства от взлома. Таким образом компьютер становится фактически смарт-карты, которые должны принимать ПИН-код, чтобы пройти проверку подлинности.

**Проверка подлинности удаленных и беспроводной сети**

Проверка подлинности удаленных и беспроводной сети — другой технологии, которая использует сертификаты для проверки подлинности. Службы проверки подлинности в Интернете (IAS) и серверы виртуальной частной сети используйте расширяемый протокол транспорта уровень обеспечения безопасности проверки подлинности (EAP-TLS), проверки подлинности протокол PEAP (Protected Extensible) или безопасность протокола IP (IPsec) для выполнения проверки подлинности на основе сертификатов для многих типов доступа к сети, включая виртуальной частной сети (VPN) и беспроводных подключений.

Сведения о проверке подлинности на основе сертификатов в сети см. в разделе [сети сертификаты и проверка подлинности](https://technet.microsoft.com/library/cc759575(WS.10).aspx).

## <a name="BKMK_SeeAlso"></a>См. также:
[Основные понятия проверки подлинности Windows](https://technet.microsoft.com/library/d169018.aspx)


