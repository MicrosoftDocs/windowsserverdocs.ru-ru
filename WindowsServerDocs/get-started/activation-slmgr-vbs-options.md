---
title: Параметры slmgr.vbs для получения сведений об активации корпоративных лицензий
description: Список доступных параметров скрипта Slmg.vbs и описание способов их использования
ms.date: 09/24/2019
ms.technology: server-general
ms.topic: article
author: Teresa-Motiv
ms.author: v-tea
manager: dcscontentpm
ms.localizationpriority: medium
appliesto:
- Windows Server 2012 R2
- Windows 10
- Windows 8.1
ms.openlocfilehash: e3e4b4d236672ce310c8a0eb038d0e19f936a5d2
ms.sourcegitcommit: 3a3d62f938322849f81ee9ec01186b3e7ab90fe0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2020
ms.locfileid: "80826347"
---
# <a name="slmgrvbs-options-for-obtaining-volume-activation-information"></a>Параметры slmgr.vbs для получения сведений об активации корпоративных лицензий

Ниже описывается синтаксис сценария Slmgr.vbs, а в таблицах в этой статье приведено описание всех параметров командной строки.

```cmd
slmgr.vbs [<ComputerName> [<User> <Password>]] [<Options>]
```

> [!NOTE]
> В этой статье в квадратных скобках, \[], указаны необязательные аргументы, а в угловых скобках, \<>, указаны заполнители. При вводе этих инструкций опустите квадратные скобки и замените заполнители соответствующими значениями.

> [!NOTE]
> Сведения о других программных продуктах, использующих активацию корпоративных лицензий, приведены в документации по этим приложениям.

## <a name="using-slmgr-on-remote-computers"></a>Использование сценария Slmgr на удаленных компьютерах

Для управления удаленными клиентами используйте средство управления активацией корпоративных лицензий (VAMT) 1.2 или более поздней версии либо создайте собственные сценарии WMI, в которых учитываются отличия платформ. Дополнительные сведения о свойствах и методах WMI для активации корпоративных лицензий см. в разделе [Свойства и методы WMI для активации корпоративных лицензий](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn502536(v=ws.11)).

> [!IMPORTANT]
> Из-за изменений WMI в Windows 7 и Windows Server 2008 R2 сценарий Slmgr.vbs не предназначен для работы на разных платформах. Использование скрипта Slmgr.vbs для управления системой Windows 7 или Windows Server 2008 R2 из операционной системы Windows Vista&reg; не поддерживается. При попытке управления системой предыдущих версий из Windows 7 или Windows Server 2008 R2 произойдет ошибка несоответствия версий. Например, результат выполнения команды **cscript slmgr.vbs \<имя\_компьютера\_vista\> /dlv** будет следующим.
>  
>> Сервер сценариев Windows (Microsoft (R)) версия 5.8. (C) Корпорация Майкрософт (Microsoft Corp.). Все права защищены.
>>  
>> Удаленный компьютер не поддерживает эту версию SLMgr.vbs

## <a name="general-slmgrvbs-options"></a>Общие параметры Slmgr.vbs

|Параметр |Описание |
| - | - |
|\[\<имя_компьютера\>] |Имя удаленного компьютера (по умолчанию используется локальный компьютер) |
|\[\<пользователь\>] |Учетная запись с необходимыми разрешениями на удаленном компьютере. |
|\[\<пароль\>] |Пароль учетной записи с необходимыми разрешениями на удаленном компьютере. |

## <a name="global-options"></a>Глобальные параметры

|Параметр |Описание |
| - | - |
|\/ipk&nbsp;&lt;ключ_продукта&gt; |Попытки установить ключ продукта 5×5. Ключ продукта, заданный параметром, проверяется на допустимость и применимость для установленной операционной системы.<br />Если это не так, возвращается ошибка.<br />Если ключ допустим и применим, он устанавливается. Если ключ уже установлен, он автоматически заменяется.<br />Во избежание нестабильной работы службы лицензий необходимо перезапустить систему или службу защиты программного обеспечения.<br />Эту операцию нужно выполнять в командной строке с повышенными привилегиями, либо должно быть задано значение реестра "Standard User Operations" (Стандартные операции пользователя), позволяющее непривилегированным пользователям получать расширенный доступ к службе защиты программного обеспечения. |
|/ato&nbsp;\[\<ИД&nbsp;активации\>] |Для розничных выпусков и корпоративных систем с установленным ключом узла KMS или ключом многократной активации (MAK) параметр **/ato** указывает Windows попытаться выполнить активацию через Интернет.<br />Для систем с установленным универсальным ключом многократной установки (GVLK) выдается запрос на активацию KMS. Если в системе приостановлена автоматическая активация KMS ( **/stao**), при выполнении с параметром **/ato** все равно будет осуществлена попытка активации KMS.<br />**Примечание**. Начиная с Windows 8 (и Windows Server 2012), параметр **/stao** является устаревшим. Вместо него используется параметр **/act-type**.<br />\<**ИД активации**\> в **/ato** позволяет определить выпуск Windows, установленный на компьютере. Когда указан \<**ИД активации**\>, параметр /ato действует только для выпуска, связанного с этим атрибутом. Выполните команду **Slmgr.vbs /dlv all**, чтобы получить все значения Activation ID для установленной версии Windows. Если требуется организовать поддержку других приложений, дополнительные инструкции приведены в руководстве для соответствующего приложения.<br />Активация KMS не требует повышенных привилегий. Однако повышенные привилегии нужны для активации через Интернет, либо должно быть задано значение реестра Standard User Operations (Стандартные операции пользователя), позволяющее непривилегированным пользователям получать расширенный доступ к службе защиты программного обеспечения. |
|\/dli&nbsp;\[<ИД&nbsp;активации\>&nbsp;\|&nbsp;All\] |Показывает сведения о лицензии.<br />По умолчанию **/dli** показывает сведения о лицензии для установленного активного выпуска Windows. Если указать атрибут \<**ИД активации**\>, будут показаны сведения о лицензии для заданного выпуска, связанного с этим атрибутом. Если указать атрибут **All**, будут показаны сведения о лицензиях для всех применимых установленных продуктах.<br />Эта операция не требует повышенных привилегий. |
|\/dlv&nbsp;\[<ИД&nbsp;активации\>&nbsp;\|&nbsp;All\] |Показывает подробные сведения о лицензии.<br />По умолчанию **/dlv** показывает сведения о лицензии для установленной операционной системы. Если указать атрибут \<**ИД активации**\>, будут показаны сведения о лицензии для заданного выпуска, связанного с этим атрибутом. Если указать атрибут **All**, будут показаны сведения о лицензиях для всех применимых установленных продуктах.<br />Эта операция не требует повышенных привилегий. |
|\/xpr \[\<ИД&nbsp;активации\>] |Показывает дату истечения срока действия активации для продукта. По умолчанию это касается текущего выпуска Windows и в основном удобно для клиентов KMS, поскольку активация MAK и розничного выпуска является постоянной.<br />Если указать атрибут \<**ИД активации**\>, будет показана дата истечения срока действия активации указанного выпуска, связанного с этим атрибутом. Эта операция не требует повышенных привилегий. |

## <a name="advanced-options"></a>Дополнительные параметры.

|Параметр |Описание |
| - | - |
|\/cpky |Некоторые операции обслуживания требуют доступа к ключу продукта в реестре во время выполнения операций при первом включении компьютера (OOBE). Параметр **/cpky** удаляет ключ продукта из реестра во избежание кражи ключа вредоносным кодом.<br />Для розничных продуктов, в которых используются ключи, рекомендуется использовать этот параметр. Этот параметр не требуется для ключей MAK и ключей узла KMS, поскольку для таких ключей это порядок действий по умолчанию. Этот параметр требуется только для других типов ключей, для которых порядок действий по умолчанию не предусматривает удаления ключа из реестра.<br />Эта операция должна запускаться из командной строки с повышенными привилегиями. |
|\/ilc&nbsp;&lt;файл_лицензии&gt; |Этот параметр устанавливает файл лицензии, заданный в необходимом параметре. Эти лицензии могут устанавливаться в качестве меры по борьбе с неполадками, для поддержки активации на основе маркеров или при установке стандартного приложения вручную.<br />Во время этого процесса проверка лицензий не осуществляется: Сценарий Slmgr.vbs проверку лицензий не осуществляет. Проверка осуществляется службой защиты программного обеспечения во время выполнения.<br />Эту операцию нужно выполнять в командной строке с повышенными привилегиями, либо должно быть задано значение реестра **Standard User Operations** (Стандартные операции пользователя), позволяющее непривилегированным пользователям получать расширенный доступ к службе защиты программного обеспечения. |
|\/rilc |Этот параметр переустанавливает все лицензии, хранящиеся в каталогах %SystemRoot%\system32\oem и %SystemRoot%\System32\spp\tokens. Это заведомо хорошие копии, сохраняемые во время установки.<br />Все соответствующие лицензии в надежном хранилище заменяются. Все другие лицензии, например лицензии на выдачу доверенного центра сертификации и лицензии для приложений, не затрагиваются.<br />Эту операцию нужно выполнять в командной строке с повышенными привилегиями, либо должно быть задано значение реестра **Standard User Operations** (Стандартные операции пользователя), позволяющее непривилегированным пользователям получать расширенный доступ к службе защиты программного обеспечения. |
|\/rearm |Этот параметр сбрасывает таймеры активации. Процесс **/rearm** также вызывается **sysprep /generalize**.<br />Эта операция не выполняет никаких действий, если запись реестра **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SoftwareProtectionPlatform\SkipRearm** имеет значение **1**. Дополнительные сведения об этой записи реестра см. в разделе [Параметры реестра для активации корпоративных лицензий](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn502532(v=ws.11)).<br />Эту операцию нужно выполнять в командной строке с повышенными привилегиями, либо должно быть задано значение реестра **Standard User Operations** (Стандартные операции пользователя), позволяющее непривилегированным пользователям получать расширенный доступ к службе защиты программного обеспечения. |
|\/rearm-app &lt;ИД&nbsp;приложения&gt; |Сбрасывает состояние лицензирования для указанного приложения. |
|\/rearm-sku &lt;ИД&nbsp;приложения&gt; |Сбрасывает состояние лицензирования для указанного SKU. |
|\/upk&nbsp;\[&lt;ИД&nbsp;приложения&gt;] |Этот параметр удаляет ключ продукта для текущего выпуска Windows. После перезапуска система окажется в состоянии "Не имеет лицензии", если не установить новый ключ продукта.<br />При желании можно использовать атрибут \<**Activation ID**\>, чтобы указать другой установленный продукт.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/dti&nbsp;\[\<ИД&nbsp;активации\>] |Показывает идентификатор установки для автономной активации. |
|\/atp &lt;ИД&nbsp;подтверждения&gt; |Активирует продукт с предоставленным пользователем идентификатором подтверждения. |

## <a name="kms-client-options"></a>Параметры клиента KMS

|Параметр |Описание |
| - | - |
|\/skms \<имя\[:порт]&nbsp;\|&nbsp;\:&nbsp;порт\> \[\<идентификатор&nbsp;активации\>] |Этот параметр задает имя и при необходимости порт компьютера узла KMS, с которым устанавливается соединение. Когда выбрано это значение, автоматическое определение узла KMS отменяется.<br />Если на узле KMS используется только протокол IPv6, адрес нужно указать в формате \<имя_узла\>:\<порт\>. IPv6-адреса содержат двоеточия (:), которые сценарий Slmgr.vbs неправильно анализирует.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/skms-domain&nbsp;&lt;полное доменное имя&gt; \[\<идентификатор&nbsp;активации\>] |Задает конкретный DNS-домен, в котором можно найти все записи KMS SRV. Этот параметр не оказывает никакого влияния, если конкретный единственный узел KMS настроен с параметром **/skms**. Используйте этот параметр, особенно в несвязанных пространствах имен, чтобы сервер KMS игнорировал список DNS-суффиксов и вместо этого искал записи узла KMS в указанном DNS-домене. |
|\/ckms&nbsp;\[\<ИД&nbsp;активации\>] |Этот параметр удаляет имя, адрес и порт указанного узла KMS из реестра и восстанавливает режим автоматического обнаружения KMS.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/skhc |Этот параметр отключает кэширование узлов KMS (по умолчанию). После того как клиент обнаружит работающий узел KMS, этот параметр не позволит приоритету и весу службы доменных имен (DNS) влиять на обмен данными с этим узлом. Если система больше не может связаться с работающим узлом KMS, клиент пытается обнаружить новый узел.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/ckhc |Этот параметр отключает кэширование узла KMS. Этот параметр предписывает клиенту использовать автоматическое обнаружение DNS при каждой попытке активации KMS (рекомендуется при использовании приоритета и веса).<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |

## <a name="kms-host-configuration-options"></a>Параметры конфигурации узла KMS

|Параметр |Описание |
| - | - |
|\/sai&nbsp;&lt;интервал&gt; |Этот параметр задает интервал в минутах, через который неактивированные клиенты пытаются подключиться к KMS. Интервал активации должен находиться в диапазоне от 15 минут до 30 дней. Рекомендуется использовать интервал по умолчанию — 2 часа.<br />Изначально клиент KMS извлекает этот интервал из реестра, но после получения первого ответа KMS переходит на параметр KMS.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/sri &lt;интервал&gt; |Этот параметр задает интервал продления в минутах, через который активированные клиенты пытаются подключиться к KMS. Интервал обновления должен находиться в диапазоне от 15 минут до 30 дней. Этот параметр изначально задается и на стороне сервера, и на стороне клиента KMS. По умолчанию используется значение "10 080 минут (7 дней)".<br />Клиент KMS первоначально извлекает этот интервал из реестра, но после получения первого ответа KMS переходит на параметр KMS.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/sprt&nbsp;&lt;порт&gt; |Этот параметр задает порт, по которому узел KMS прослушивает запросы активации клиентов. Номер порта TCP по умолчанию — 1688.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/sdns |Включает публикацию DNS узлом KMS (по умолчанию).<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/cdns |Отключает публикацию DNS узлом KMS.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/spri |Устанавливает приоритет KMS в значение "Обычный" (по умолчанию).<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/cpri |Устанавливает приоритет KMS в значение "Низкий".<br />Используйте этот параметр, чтобы минимизировать конфликты со стороны KMS в связанной среде. Имейте в виду, что это может привести к нехватке ресурсов для KMS в зависимости от активности других приложений или ролей сервера. Следует использовать с осторожностью.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/act-type \[\<тип_активации\>] \[\<ИД&nbsp;активации\>] |Этот параметр задает значение реестра, которое ограничивает многопользовательскую активацию одним типом. Тип активации **1** разрешает только активацию Active Directory, **2** — только активацию KMS, **3** — активацию на основе маркеров. **0** разрешает активацию любого типа и является значением по умолчанию. |

## <a name="token-based-activation-configuration-options"></a>Параметры конфигурации активации на основе маркеров

|Параметр |Описание |
| - | - |
|/lil |Выводит список установленных лицензий на выдачу с активацией на основе маркеров. |
|\/ril&nbsp;&lt;ILID&gt;&nbsp;&lt;ILvID&gt; |Удаляет установленную лицензию на выдачу с активацией на основе маркеров.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями. |
|\/stao |Устанавливает флаг **Token-based Activation Only**, отключая автоматическую активацию KMS.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями.<br />Этот параметр был удален в Windows Server 2012 R2 и Windows 8.1. Вместо него используется **/act–type**. |
|\/ctao |Снимает флаг **Token-based Activation Only** (по умолчанию), разрешая автоматическую активацию KMS.<br />Эта операция должна выполняться из командной строки с повышенными привилегиями.<br />Этот параметр был удален в Windows Server 2012 R2 и Windows 8.1. Вместо него используется параметр **/act-type**</strong>. |
|\/ltc |Выводит список действительных сертификатов с активацией на основе маркеров, которые могут активировать установленное программное обеспечение. |
|\/fta &lt;отпечаток&nbsp;сертификата&gt; \[&lt;PIN-код&gt;] |Принудительно задает активацию на основе маркеров с использованием указанного сертификата. Необязательный персональный идентификационный код (ПИН-код) предоставляется для снятия блокировки закрытого ключа без запроса ПИН-кода при использовании сертификатов с аппаратной защитой (например, смарт-карт). |

## <a name="active-directory-based-activation-configuration-options"></a>Параметры конфигурации активации с помощью Active Directory

|Параметр |Описание |
| - | - |
|\/ad-activation-online &lt;ключ&nbsp;продукта&gt; \[\<имя&nbsp;объекта&nbsp;активации\>] |Собирает данные Active Directory и запускает активацию леса Active Directory с помощью учетных данных, использованных для запуска командной строки. Доступ с правами локального администратора не требуется. Однако необходим доступ на чтение и запись для контейнера объекта активации в корневом домене леса. |
|\/ad-activation-get-IID &lt;ключ&nbsp;продукта&gt; |Этот параметр запускает активацию леса Active Directory в режиме телефона. Результатом является идентификатор установки (IID), который может использоваться для активации леса по телефону, когда отсутствует подключение к Интернету. При предоставлении IID во время телефонного звонка для активации возвращается CID, который используется для завершения активации. |
|\/ad-activation-apply-cid &lt;ключ&nbsp;продукта&gt; &lt;идентификатор&nbsp;подтверждения&gt; \[\<имя&nbsp;объекта&nbsp;активации>] |При использовании этого параметра, чтобы завершить активацию, введите CID, предоставленный при телефонном звонке для активации. |
|\[/name: &lt;имя_объекта_активации&gt;] |Также в конец любой из этих команд можно добавить параметр **/name**, чтобы задать имя объекта активации, хранящегося в Active Directory. Его длина не должна превышать 40 знаков Юникода. Используйте двойные кавычки для явного определения строки имени.<br />В Windows Server 2012 R2 и Windows 8.1 имя можно добавить непосредственно после команд **/ad-activation-online &lt;ключ&nbsp;продукта&gt;** и **/ad-activation-apply-cid** без необходимости использовать параметр **/name**. |
|\/ao-list |Показывает все объекты активации, доступные локальному компьютеру. |
|\/del-ao &lt;AO_DN&gt;<br />\/del-ao &lt;AO_RDN&gt; |Удаляет указанный объект активации из леса. |

## <a name="see-also"></a>См. также статью

- [Технический справочник по активации корпоративных лицензий](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn502529%28v%3dws.11%29)
- [Обзор активации корпоративных лицензий](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/hh831612%28v%3dws.11%29)

