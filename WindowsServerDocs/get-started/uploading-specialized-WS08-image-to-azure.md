---
title: Отправка специализированного образа Windows Server 2008 или 2008 R2 в Azure
description: Поддержка Windows Server 2008 и 2008 R2 вскоре будет прекращена. Узнайте, как перейти в Azure путем размещения Windows Server в облаке.
ms.prod: windows-server-threshold
ms.mktglfcycl: manage
ms.sitesec: library
author: mikeblodge
ms.author: mikeblodge
ms.date: 07/11/2018
ms.tgt_pltfrm: na
ms.topic: get-started-article
ms.localizationpriority: high
ms.openlocfilehash: 9bd2b17296872d4b94de5a7468178fbb2ba39709
ms.sourcegitcommit: f6490192d686f0a1e0c2ebe471f98e30105c0844
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2019
ms.locfileid: "70868398"
---
# <a name="upload-a-windows-server-20082008-r2-specialized-image-to-azure"></a>Отправка специализированного образа Windows Server 2008 или 2008 R2 в Azure 

![Баннер, посвященный разделу об образе WS08](media/WS08-image-banner-large.png)

Теперь вы можете запускать виртуальную машину с Windows Server 2008 или 2008 R2 в облаке с помощью Azure. 

## <a name="prep-the-windows-server-20082008-r2-specialized-image"></a>Подготовка специализированного образа Windows Server 2008 или 2008 R2
Прежде чем можно будет отправить образ, внесите следующие изменения:

- Скачайте и установите Windows Server 2008 с пакетом обновления 2 (SP2), если эта операционная система еще не установлена в вашем образе.

- Настройте параметры удаленного рабочего стола (RDP).
  1. Последовательно выберите пункты **Панель управления** > **Параметры системы**.   
  2. Выберите **Параметры удаленного доступа** в меню слева.

     ![Снимок экрана параметров системы, на котором выделен раздел "Параметры удаленного доступа".](media/1a_remote_settings.png)

  3. Выберите вкладку **Удаленный доступ** в свойствах системы.   

     ![Снимок экрана с вкладкой удаленного доступа в свойствах системы.](media/2c_sysprops.png)

  4. Выберите пункт "Разрешать подключения от компьютеров с любой версией удаленного рабочего стола (опаснее)".   
  5. Нажмите кнопку **Применить**, а затем — **ОК**.
- Настройка параметров брандмауэра Windows.   
   1. В командной строке в режиме администратора введите "**wf.msc**", чтобы открыть брандмауэр Windows и дополнительные параметры безопасности.   
   2. Отсортируйте результаты по **портам** и выберите **порт 3389**.   
     ![Снимок экрана с правилами для входящих подключений в параметрах брандмауэра Windows.](media/3b_inboundrules.png)   
   3. Включите удаленный рабочий стол (TCP-IN) для профилей: **Домен**, **Частный** и **Общедоступный** (как показано выше).

- Сохраните все параметры и завершите работу образа.   
- Если вы используете Hyper-V, убедитесь, что дочерний AVHD объединен с родительским VHD для сохранения изменений.

В настоящий момент известно об ошибке, из-за которой пароль администратора на отправленном образе действует только в течение 24 часов. Выполните следующие действия, чтобы избежать этой проблемы: 

1. Выберите **Пуск** > **Выполнить**.
2. Введите **lusrmgr.msc**.
3. Выберите **Пользователи** в разделе "Локальные пользователи и группы".
4. Щелкните правой кнопкой мыши пункт **Администратор** и выберите **Свойства**.
5. Выберите **срок действия пароля не ограничен** и нажмите кнопку **OK**.
![Снимок экрана со свойствами администратора.](media/6_adminprops.png)

## <a name="uploading-the-image-vhd"></a>Отправка виртуального жесткого диска с образом
Чтобы отправить виртуальный жесткий диск, воспользуйтесь скриптом ниже. Перед выполнением этого действия вам потребуется опубликовать файл параметров для учетной записи Azure. Получите [файл параметров Azure](https://azure.microsoft.com/downloads/).

Воспользуйтесь таким скриптом:

```powershell
Get-AzurePublishSettingsFile 

Login-AzureRmAccount
 
      # Import publishsettings
      Import-AzurePublishSettingsFile -PublishSettingsFile <LocationOfPublishingFile>
      $subscriptionId = 'xxxx-xxxx-xxxx-xxxx-xxxxx'
 
      # Set NodeFlight subscription as default subscription
      Select-AzureRmSubscription -SubscriptionId $subscriptionId
      Set-AzureRmContext -SubscriptionId $subscriptionId
      $rgName = "<resourcegroupname>"
    
      $urlOfUploadedImageVhd = "<BlobUrl>/<NameForVHD>.vhd"
      Add-AzureRmVhd -ResourceGroupName $rgName -Destination $urlOfUploadedImageVhd -LocalFilePath "<FilePath>"  
```
## <a name="deploy-the-image-in-azure"></a>Развертывание образа в Azure
В этом разделе приведены инструкции по развертыванию виртуального жесткого диска с образом в Azure. 

> [!IMPORTANT]
> В Azure не следует использовать предварительно настроенные пользовательские образы.

1.  Создайте новую [группу ресурсов](https://docs.microsoft.com/rest/api/resources/resourcegroups/createorupdate). 
2.  Создайте новое [хранилище больших двоичных объектов](https://docs.microsoft.com/rest/api/storageservices/put-blob) в группе ресурсов.
3.  Создайте [контейнер](https://docs.microsoft.com/rest/api/storageservices/create-container) внутри хранилища больших двоичных объектов.
4.  Скопируйте URL-адрес хранилища больших двоичных объектов из свойств.
5.  Используйте приведенный выше скрипт для отправки образа в новое хранилище больших двоичных объектов.
6.  Создайте [диск](https://docs.microsoft.com/azure/virtual-machines/windows/prepare-for-upload-vhd-image) для вашего виртуального жесткого диска.   
     а) Перейдите в раздел "Диски" и нажмите кнопку **Добавить**.  
     б. Задайте диску имя. Выберите подписку, которую требуется использовать, задайте регион и выберите тип учетной записи.   
     в. В качестве типа источника выберите "Хранилище". Откройте расположение виртуального жесткого диска с большими двоичными объектами, созданного с помощью скрипта.  
     г) Выберите тип ОС Windows и размер (по умолчанию: 1023).   
     д) Нажмите кнопку **Создать**.   

7.  Перейдите в раздел "Созданные диски" и нажмите кнопку **Создать виртуальную машину**.   
     а) Задайте имя виртуальной машине.   
     б. Выберите группу, созданную на шаге 5, в которую был загружен диск.   
     в. Выберите размер и план SKU для своей виртуальной машины.   
     г) Выберите сетевой интерфейс на странице "Параметры". Убедитесь, что в сетевом интерфейсе задано следующее правило:
 
        PORT:3389 Protocol: TCP Action: Allow Priority: 1000 Name: ‘RDP-Rule'.   
     д) Нажмите кнопку **Создать**.




