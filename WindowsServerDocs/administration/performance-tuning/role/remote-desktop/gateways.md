---
title: Настройка удаленного рабочего стола шлюзы производительности
description: Производительность, рекомендаций по настройке для шлюзов удаленного рабочего стола
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: HammadBu; VladmiS
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: 70b27d45acbfb046d52271a50ca7deffb226b8d0
ms.sourcegitcommit: d84dc3d037911ad698f5e3e84348b867c5f46ed8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/28/2019
ms.locfileid: "66266730"
---
# <a name="performance-tuning-remote-desktop-gateways"></a>Настройка удаленного рабочего стола шлюзы производительности

> [!Note]
> В Windows 8 + и Windows Server 2012 R2 + шлюза удаленных рабочих столов (шлюз RD) поддерживает TCP, UDP и устаревших транспорта RPC. Большая часть следующие данные находится о предыдущих версий транспорта RPC. Если не используется устаревший транспорта RPC, этот раздел не применим.

В этом разделе описывает параметры производительности, которые помогают повысить производительность развертывания клиента и tunings, основанные на шаблонах использования сети клиента.

По существу шлюз удаленных рабочих Столов выполняет много пакетов, пересылка операций между экземплярами подключение удаленного рабочего стола и экземпляры сервера узла сеансов удаленных рабочих Столов в сети клиента.

> [!Note]
> Следующие параметры применяются только для транспорта RPC.

Internet Information Services (IIS) и шлюз удаленных рабочих Столов экспортируйте следующие параметры реестра, чтобы повысить производительность системы в шлюзе удаленных рабочих Столов.

**Tunings потока**

-   **MaxIoThreads**

    ``` syntax
    HKLM\Software\Microsoft\Terminal Server Gateway\Maxiothreads (REG_DWORD)
    ```

    Этот пул потоков конкретного приложения указывает количество потоков, которые создаются шлюза удаленных рабочих Столов для обработки входящих запросов. Если этот параметр реестра присутствует, она вступает в силу. Количество потоков равно количеству логические процессы. Если число логических процессоров меньше 5, значение по умолчанию — 5 потоков.

-   **MaxPoolThreads**

    ``` syntax
    HKLM\System\CurrentControlSet\Services\InetInfo\Parameters\MaxPoolThreads (REG_DWORD)
    ```

    Этот параметр задает количество потоков в пуле IIS для одного логического процессора. Потоки в пуле IIS смотрите сети для запросов и обработки всех входящих запросов. **MaxPoolThreads** счетчик не включает потоки, которые использует шлюз удаленных рабочих Столов. Значение по умолчанию — 4.

**Tunings вызов удаленной процедуры для шлюза удаленных рабочих Столов**

Следующие параметры может помочь настроить удаленные вызовы процедур (RPC), которые получены компьютеров подключение удаленного рабочего стола и шлюза удаленных рабочих Столов. Изменение windows позволяет регулировать объем данных проходит через каждого подключения и может повысить производительность для RPC через HTTP версии 2 сценариев.

-   **ServerReceiveWindow**

    ``` syntax
    HKLM\Software\Microsoft\Rpc\ServerReceiveWindow (REG_DWORD)
    ```

    Значение по умолчанию — 64 КБ. Это значение указывает, использует сервер для данных, получаемых от прокси RPC. Минимальное значение присвоено 8 КБ, и максимальное значение составляет 1 ГБ. Если значение не указано, используется значение по умолчанию. При изменении этого значения, чтобы изменения вступили в силу необходимо перезапустить IIS.

-   **ServerReceiveWindow**

    ``` syntax
    HKLM\Software\Microsoft\Rpc\ServerReceiveWindow (REG_DWORD)
    ```

    Значение по умолчанию — 64 КБ. Это значение указывает окно, которое клиент использует данные, полученные от прокси RPC. Минимальное значение — 8 КБ, а максимальное значение — 1 ГБ. Если значение не указано, используется значение по умолчанию.

## <a name="monitoring-and-data-collection"></a>Мониторинг и сбор данных


Следующий список счетчиков производительности, считается базовый набор счетчиков, при мониторинге использования ресурсов на шлюзе удаленных рабочих Столов:

-   \\Шлюз служб терминалов\\\*

-   \\Прокси-сервер RPC/HTTP\\\*

-   \\Прокси-сервер RPC/HTTP на каждый сервер\\\*

-   \\Веб-службы\\\*

-   \\W3SVC\_W3WP\\\*

-   \\IPv4\\\*

-   \\Память\\\*

-   \\Сетевой интерфейс (\*)\\\*

-   \\Процесс (\*)\\\*

-   \\Сведения о процессоре (\*)\\\*

-   \\Синхронизация (\*)\\\*

-   \\Системы\\\*

-   \\TCPv4\\\*

Следующие счетчики производительности, применимы только для прежних версий транспорта RPC:

-   \\Прокси-сервер RPC/HTTP\\ \* RPC

-   \\Прокси-сервер RPC/HTTP на каждый сервер\\ \* RPC

-   \\Веб-службы\\ \* RPC

-   \\W3SVC\_W3WP\\\* RPC

**Примечание**    при необходимости добавьте \\IPv6\\ \* и \\TCPv6\\ \* объектов. ReplaceThisText

 
