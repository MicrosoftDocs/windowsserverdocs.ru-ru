---
title: Производительность процессора Hyper-V
description: Вопросы производительности процессора в настройке производительности Hyper-V
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: Asmahi; SandySp; JoPoulso
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: 2a49fdaba89a01c8daf6483f72dbc88daa91452b
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59843245"
---
# <a name="hyper-v-processor-performance"></a>Производительность процессора Hyper-V


## <a name="virtual-machine-integration-services"></a>Службы интеграции виртуальной машины

Службы интеграции виртуальной машины с включенной поддержкой драйверы для Hyper-V-конкретных операций ввода-вывода устройств, которые значительно уменьшает нагрузку на ЦП по сравнению с эмулированных устройств ввода-вывода. В каждой поддерживаемой виртуальной машине следует установить последнюю версию служб интеграции виртуальной машины. Уменьшение служб, виртуальных машин из состояния простоя ЦП работа гостей в значительной степени использовать гостей, а также улучшает пропускную способность ввода-вывода. Это первый шаг в настройке производительности на сервере с Hyper-V. Список поддерживаемых операционных систем, см. в разделе [Обзор Hyper-V](https://technet.microsoft.com/library/hh831531.aspx).

## <a name="virtual-processors"></a>Виртуальные процессоры

Hyper-V в Windows Server 2016 поддерживает не более 240 виртуальных процессоров на каждую виртуальную машину. Виртуальные машины, которые нагрузкой, которые не являются интенсивное использование ресурсов ЦП должны быть настроены для использования один виртуальный процессор. Это из-за излишних затрат ресурсов, который связан с несколькими виртуальными процессорами, таких как затраты на дополнительной синхронизации в гостевой операционной системы.

Увеличьте число виртуальных процессоров, если для виртуальной машины требуется несколько ЦП обработки при максимальной нагрузке.

## <a name="background-activity"></a>Фоновое действие

Минимизация фоновой деятельности бездействующих виртуальных машин высвобождает циклы ЦП, которые могут использоваться другими виртуальными машинами в другом месте. Гостевые системы Windows обычно используют менее 1% одного ЦП, если они простаивают. Ниже приведены несколько рекомендаций по минимизации фонового использования ЦП виртуальной машины.

-   Установите последнюю версию служб интеграции виртуальной машины.

-   Удалите эмулируемый сетевой адаптер виртуальной машины диалоговом окне параметров (использование Microsoft Hyper-V-конкретный адаптер).

-   Удалите неиспользуемые устройства, такие как компакт-диска и COM-порт или извлеките из них носители.

-   Поддерживать гостевой операционной системы Windows на экране входа в систему, когда он не используется и отключить заставку.

-   Просмотрите запланированные задачи и службы, которые включены по умолчанию.

-   Просмотр поставщиков трассировки событий Windows, которые включены по умолчанию, выполнив **logman.exe запроса - ets**

-   Улучшения серверных приложений, чтобы уменьшить периодических действий (например, таймеры).

-   Закройте диспетчер сервера на узле и гостевой операционных систем.

-   Не оставляйте диспетчера Hyper-V под управлением, так как она постоянно обновляет эскиз виртуальной машины.

Ниже приведены дополнительные рекомендации по настройке *версия клиента* из Windows в виртуальной машине, чтобы сократить общее использование ЦП:

-   Отключите фоновые службы, например SuperFetch и Windows Search.

-   Отключите запланированные задачи, например запланированных дефрагментацию.

## <a name="virtual-numa"></a>Виртуальная топология NUMA

Чтобы виртуализировать рабочие нагрузки вертикального масштабирования, Hyper-V в Windows Server 2016 развернуть пределы масштабирования виртуальных машин. Одной виртуальной машине можно назначить до 240 виртуальных процессоров и 12 ТБ памяти. При создании таких больших виртуальных машин, память из нескольких узлов NUMA основной системы скорее всего будет использоваться. В такой конфигурации виртуальной машины Если виртуальные процессоры и память не выделяются из одного узла NUMA, рабочие нагрузки могут иметь плохой производительности из-за невозможности использовать преимущества оптимизации NUMA.

В Windows Server 2016 Hyper-V включает виртуальную топологию NUMA для виртуальных машин. Виртуальная топология NUMA по умолчанию оптимизируется в соответствии с топологией NUMA основного компьютера. Предоставление топологии NUMA виртуальной машине позволяет гостевой операционной системе и установленным в ней приложениям с поддержкой NUMA использовать связанные с NUMA преимущества оптимизаций производительности точно так же, как если бы они работали на физическом компьютере.

С точки зрения рабочей нагрузки никакой разницы между виртуальной и физической топологией NUMA нет. Когда рабочая нагрузка на виртуальной машине выделяет локальную память для данных и обращается к этим данным на одном и том же узле NUMA, в соответствующей физической системе осуществляется быстрый доступ к локальной памяти. При этом потерь производительности в процессе доступа к удаленной памяти удается избежать. Только для приложений с поддержкой NUMA могут воспользоваться из vNUMA.

Microsoft SQL Server является примером приложения, поддерживающего NUMA. Дополнительные сведения см. в разделе [доступ к неоднородной основные сведения о памяти](https://technet.microsoft.com/library/ms178144.aspx).

Виртуальную архитектуру NUMA и функцию динамической памяти нельзя использовать одновременно. Виртуальная машина, для которой включена динамическая память, имеет только один виртуальный узел NUMA и ей не предоставляется топология NUMA вне зависимости от параметров виртуальной архитектуры NUMA.

Дополнительные сведения о виртуальной архитектуре NUMA см. в разделе [Обзор виртуальной топологии архитектуры NUMA Hyper-V](https://technet.microsoft.com/library/dn282282.aspx).

##<a name="see-also"></a>См. также

-   [Терминологии Hyper-V](terminology.md)

-   [Архитектура Hyper-V](architecture.md)

-   [Конфигурация сервера Hyper-V](configuration.md)

-   [Производительность памяти Hyper-V](memory-performance.md)

-   [Хранилище Hyper-V производительность ввода-вывода](storage-io-performance.md)

-   [Сети Hyper-V производительность ввода-вывода](network-io-performance.md)

-   [Обнаружение узких мест в виртуализованной среде](detecting-virtualized-environment-bottlenecks.md)

-   [Виртуальные машины Linux](linux-virtual-machine-considerations.md)
