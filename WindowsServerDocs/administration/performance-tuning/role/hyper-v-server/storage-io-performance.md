---
title: Производительность операций ввода-вывода хранилища Hyper-V
description: Вопросы производительности операций ввода-вывода хранилища в настройке производительности Hyper-V
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: Asmahi; SandySp; JoPoulso
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: 52eff180f4eb429c8676c301e8acd062505f3ce2
ms.sourcegitcommit: f6490192d686f0a1e0c2ebe471f98e30105c0844
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2019
ms.locfileid: "70866568"
---
# <a name="hyper-v-storage-io-performance"></a>Производительность операций ввода-вывода хранилища Hyper-V

В этом разделе описываются различные параметры и рекомендации по настройке производительности операций ввода-вывода хранилища в виртуальной машине. Путь ввода-вывода хранилища расширяется из стека гостевого хранилища на уровне виртуализации узла, в стек хранилища узлов, а затем на физический диск. Ниже приведены объяснения о возможностях оптимизации на каждом из этих этапов.

## <a name="virtual-controllers"></a>Виртуальные контроллеры

Hyper-V предлагает три типа виртуальных контроллеров: IDE, SCSI и адаптеры шины виртуальных узлов (HBA).

## <a name="ide"></a>IDE

Контроллеры IDE представляют диски IDE на виртуальной машине. Контроллер IDE эмулируется, и это единственный контроллер, доступный для гостевых виртуальных машин под управлением более старой версии Windows без Integration Services виртуальной машины. Дисковые операции ввода-вывода, выполняемые с помощью драйвера фильтра IDE, поставляемого с виртуальной машиной Integration Services, значительно выше, чем производительность операций дискового ввода-вывода, обеспечиваемая эмуляторным контроллером IDE. Рекомендуется использовать диски IDE только для дисков операционной системы, так как они имеют ограничения по производительности из-за максимального размера операций ввода-вывода, которые могут выдаваться этим устройствам.

## <a name="scsi-sas-controller"></a>SCSI (контроллер SAS)

Контроллеры SCSI предоставляют виртуальным машинам диски SCSI, и каждый виртуальный контроллер SCSI может поддерживать до 64 устройств. Для оптимальной производительности рекомендуется подключить несколько дисков к одному виртуальному контроллеру SCSI и создать дополнительные контроллеры, только так как они необходимы для масштабирования количества дисков, подключенных к виртуальной машине. Путь SCSI не эмулируется, что делает его предпочтительным контроллером для всех дисков, кроме диска операционной системы. На виртуальных машинах поколения 2 существует единственный тип контроллера. Этот контроллер, появившийся в Windows Server 2012 R2, сообщается как SAS для поддержки общих VHDX-файлов.

## <a name="virtual-fibre-channel-hbas"></a>Виртуальные Fibre Channel HBA

Виртуальные Fibre Channel HBA можно настроить так, чтобы обеспечить прямой доступ к виртуальным машинам для Fibre Channel и Fibre Channel LUN через Ethernet (Фкое). Виртуальные Fibre Channel диски обходят файловую систему NTFS в корневом разделе, что снижает нагрузку на ЦП при вводе-выводе хранилища.

Большие диски данных и диски, совместно используемые несколькими виртуальными машинами (для сценариев гостевых кластеров), являются основными кандидатами для виртуальных Fibre Channelных дисков.

Виртуальным Fibre Channelным дискам требуется один или несколько Fibre Channel адаптеров шины (HBA), которые должны быть установлены на узле. Каждый HBA узла требуется для использования драйвера HBA, поддерживающего возможности виртуальных Fibre Channel и NPIV Windows Server 2016. Структура SAN должна поддерживать NPIV, а порты HBA, используемые для виртуальной Fibre Channel, должны быть настроены в топологии Fibre Channel, поддерживающей NPIV.

Чтобы максимально увеличить пропускную способность для узлов, установленных с несколькими HBA, рекомендуется настроить несколько виртуальных сетевых адаптеров в виртуальной машине Hyper-V (для каждой виртуальной машины можно настроить до четырех адаптеров шины). Hyper-V автоматически сделает наилучшие усилия по балансировке виртуальных адаптеров шины для размещения HBA, обращающихся к той же виртуальной сети SAN.

## <a name="virtual-disks"></a>Виртуальные диски

Диски могут предоставляться виртуальным машинам через виртуальные контроллеры. Эти диски могут быть виртуальными жесткими дисками, которые представляют собой файловые абстракции диска или транзитный диск на узле.

## <a name="virtual-hard-disks"></a>Виртуальные жесткие диски

Существует два формата виртуальных жестких дисков: VHD и VHDX. Каждый из этих форматов поддерживает три типа файлов виртуального жесткого диска.

## <a name="vhd-format"></a>Формат VHD

Формат VHD был единственным форматом виртуального жесткого диска, поддерживаемым Hyper-V в прошлых выпусках. Формат VHD, появившийся в Windows Server 2012, был изменен, чтобы обеспечить лучшее выравнивание, что приводит к значительному повышению производительности новых дисков больших секторов.

Все новые виртуальные жесткие диски, создаваемые на базе Windows Server 2012 или более поздней версии, имеют оптимальное выравнивание по 4 КБ. Этот согласованный формат полностью совместим с предыдущими операционными системами Windows Server. Однако свойство Alignment будет разорвано для новых выделений из синтаксических анализаторов, которые не поддерживают выравнивание по 4 КБ (например, средство синтаксического анализа виртуальных жестких дисков из предыдущей версии Windows Server или средства синтаксического анализа сторонних разработчиков).

Любой виртуальный жесткий диск, перемещенный из предыдущего выпуска, не преобразуется автоматически в этот новый улучшенный формат VHD.

Чтобы преобразовать в новый формат VHD, выполните следующую команду Windows PowerShell:

``` syntax
Convert-VHD –Path E:\vms\testvhd\test.vhd –DestinationPath E:\vms\testvhd\test-converted.vhd
```

Можно проверить свойство Alignment для всех виртуальных жестких дисков в системе, и оно должно быть преобразовано в оптимальное выравнивание по 4 КБ. Создайте новый виртуальный жесткий диск с данными из исходного виртуального жесткого диска с помощью параметра **CREATE-From-Source** .

Чтобы проверить выравнивание с помощью Windows PowerShell, изучите линию выравнивания, как показано ниже:

``` syntax
Get-VHD –Path E:\vms\testvhd\test.vhd

Path                    : E:\vms\testvhd\test.vhd
VhdFormat               : VHD
VhdType                 : Dynamic
FileSize                : 69245440
Size                    : 10737418240
MinimumSize             : 10735321088
LogicalSectorSize       : 512
PhysicalSectorSize      : 512
BlockSize               : 2097152
ParentPath              :
FragmentationPercentage : 10
Alignment               : 0
Attached                : False
DiskNumber              :
IsDeleted               : False
Number                  :
```

Чтобы проверить выравнивание с помощью Windows PowerShell, изучите линию выравнивания, как показано ниже:

``` syntax
Get-VHD –Path E:\vms\testvhd\test-converted.vhd

Path                    : E:\vms\testvhd\test-converted.vhd
VhdFormat               : VHD
VhdType                 : Dynamic
FileSize                : 69369856
Size                    : 10737418240
MinimumSize             : 10735321088
LogicalSectorSize       : 512
PhysicalSectorSize      : 512
BlockSize               : 2097152
ParentPath              :
FragmentationPercentage : 0
Alignment               : 1
Attached                : False
DiskNumber              :
IsDeleted               : False
Number                  :
```

## <a name="vhdx-format"></a>Формат VHDX

VHDX — это новый формат виртуального жесткого диска, представленный в Windows Server 2012, который позволяет создавать отказоустойчивые высокопроизводительные виртуальные диски размером до 64 терабайт. Ниже перечислены преимущества этого формата.

-   Поддержка емкости хранилища виртуальных жестких дисков до 64 терабайт.

-   Защита от повреждения данных во время сбоев питания за счет журналирования обновлений в структурах метаданных VHDX.

-   Возможность хранения пользовательских метаданных о файле, который может захотеть записать пользователь, например версия операционной системы или исправления.

Формат VHDX также обеспечивает следующие преимущества для повышения производительности.

-   Лучшее выравнивание формата виртуального жесткого диска обеспечивает работу с дисками, имеющими сектора большого размера.

-   Большие размеры блоков для динамических и разностных дисков, что позволяет этим дискам фронте потребности рабочей нагрузки.

-   виртуальный диск объемом в логическом секторе 4 КБ, который обеспечивает повышенную производительность при использовании приложений и рабочих нагрузок, предназначенных для 4 КБ.

-   Эффективность представления данных, что приводит к уменьшению размера файла и позволяет базовому физическому устройству хранения освободить неиспользуемое пространство. (Для обрезки требуются диски с сквозным или дисковым интерфейсом SCSI и совместимое с обрезками оборудование.)

При обновлении до Windows Server 2016 рекомендуется преобразовать все файлы VHD в формат VHDX из-за этих преимуществ. Единственный сценарий, в котором имеет смысл хранить файлы в формате VHD, — когда виртуальная машина может быть перемещена в предыдущий выпуск Hyper-V, который не поддерживает формат VHDX.

## <a name="types-of-virtual-hard-disk-files"></a>Типы файлов виртуального жесткого диска

Существует три типа VHD-файлов. В следующих разделах описываются характеристики производительности и компромиссы между типами.

При выборе типа VHD-файла следует учитывать следующие рекомендации.

-   При использовании формата VHD рекомендуется использовать фиксированный тип, так как он обеспечивает повышенную устойчивость и характеристики производительности по сравнению с другими типами VHD-файлов.

-   При использовании формата VHDX рекомендуется использовать динамический тип, так как он обеспечивает гарантии устойчивости в дополнение к экономии места, связанной с выделением пространства только в том случае, если это необходимо.

-   Фиксированный тип также рекомендуется, независимо от формата, когда хранилище на томе размещения не отслеживается, чтобы гарантировать наличие достаточного дискового пространства при расширении VHD-файла во время выполнения.

-   Моментальные снимки виртуальной машины создают разностный виртуальный жесткий диск для хранения записей на дисках. Наличие нескольких моментальных снимков может повысить уровень использования ЦП дискового ввода-вывода, но может заметно не повлиять на производительность, за исключением больших рабочих нагрузок сервера, интенсивно использующих операции ввода-вывода. Однако наличие большой цепочки моментальных снимков может заметно повлиять на производительность, так как чтение с виртуального жесткого диска может потребовать проверки запрошенных блоков во многих разностных виртуальных жестких дисках. Хранение цепочек моментальных снимков очень важно для поддержания хорошей производительности дискового ввода-вывода.

## <a name="fixed-virtual-hard-disk-type"></a>Фиксированный тип виртуального жесткого диска

Место для виртуального жесткого диска сначала выделяется при создании VHD-файла. Этот тип VHD-файла меньше, скорее всего, фрагментирован, что снижает пропускную способность ввода-вывода, когда один ввод-вывод разделяется на несколько операций ввода-вывода. Это минимальное количество ресурсов ЦП для трех типов VHD-файлов, так как операции чтения и записи не требуют поиска сопоставления блока.

## <a name="dynamic-virtual-hard-disk-type"></a>Тип динамического виртуального жесткого диска

Пространство для виртуального жесткого диска выделяется по требованию. Блоки на диске запускаются как Нераспределенные блоки и не поддерживаются фактическим пространством в файле. При первой запись блока в стек виртуализации должен выделить пространство внутри VHD-файла для блока, а затем обновить метаданные. Это увеличивает количество необходимых дисковых операций ввода-вывода для записи и увеличивает загрузку ЦП. Операции чтения и записи в существующих блоках вызывают доступ к диску и нагрузку на ЦП при поиске сопоставления блоков в метаданных.

## <a name="differencing-virtual-hard-disk-type"></a>Тип разностного виртуального жесткого диска

Виртуальный жесткий диск указывает на родительский VHD-файл. Любые операции записи в блоки, не записанные в результате выделения пространства в файле VHD, как и динамически расширяемый виртуальный жесткий диск. Операции чтения обслуживаются из VHD-файла, если блок был записан в. В противном случае они обслуживаются из родительского VHD-файла. В обоих случаях считываются метаданные для определения сопоставления блока. Операции чтения и записи на этот виртуальный жесткий диск могут потреблять больше ресурсов ЦП, что приводит к большему потреблению операций ввода-вывода по сравнению с фиксированным файлом VHD.

## <a name="block-size-considerations"></a>Рекомендации по размеру блоков

Размер блока может значительно повлиять на производительность. Оптимальный размер блока лучше соответствует шаблонам распределения рабочей нагрузки, использующей диск. Например, если приложение выделяет фрагменты размером 16 МБ, оптимальным является размер блока виртуального жесткого диска, равный 16 МБ. Размер блока, равный &gt;2 МБ, возможен только на виртуальных жестких дисках с форматом VHDX. Наличие большего размера блока, чем шаблон выделения для рабочей нагрузки с произвольным вводом-выводом, значительно увеличивает использование пространства на узле.

## <a name="sector-size-implications"></a>Влияние на размер сектора

Большая часть отрасли программного обеспечения зависела от секторов диска размером 512 байт, но стандарт переходит на секторы диска объемом 4 КБ. Для уменьшения проблем совместимости, которые могут возникать при изменении размера сектора, производители жестких дисков представляют собой переходный размер, называемый 512-дисками эмуляции (512e).

Эти диски эмуляции предлагают некоторые преимущества, предоставляемые дисковыми секторами на базе 4 КБ, например Улучшенная эффективность формата и Улучшенная схема для кодов исправления ошибок (ECC). Они имеют меньше проблем совместимости, которые могут возникнуть при предоставлении размера сектора размером 4 КБ в интерфейсе диска.

## <a name="support-for-512e-disks"></a>Поддержка дисков 512e

Диск 512e может выполнять запись только в терминах физического сектора, т. е. он не может напрямую записывать в него 512byte сектор. Внутренний процесс на диске, который делает эти операции записи, можно выполнить следующим образом.

-   Диск считывает физический сектор 4 КБ во внутренний кэш, содержащий 512-байтовый логический сектор, на который ссылается запись.

-   Данные в буфере размером 4 КБ изменяются так, чтобы содержать обновленные 512-байтные сектора.

-   Диск выполняет запись обновленного буфера размером 4 КБ обратно в физический сектор на диске.

Этот процесс называется чтение и изменение — запись (РМВ). Общее влияние на производительность процесса РМВ зависит от рабочих нагрузок. Процесс РМВ приводит к снижению производительности виртуальных жестких дисков по следующим причинам.

-   Динамические и разностные виртуальные жесткие диски имеют битовую карту из 512 байт перед их полезными данными. Кроме того, нижний колонтитул, заголовок и родительские указатели выводятся в соответствии с 512-байтным сектором. Чаще всего драйвер виртуального жесткого диска выдает команды записи 512-Byte для обновления этих структур, что приводит к процессу РМВ, описанному выше.

-   Обычно приложения выдают операции чтения и записи размером в 4 КБ (размер кластера по умолчанию — NTFS). Так как в начале блока полезных данных для динамических и разностных виртуальных жестких дисков имеется 512-битное битовое изображение, блоки размером 4 КБ не согласовываются с границей физической 4 КБ. На следующем рисунке показан блок VHD размером 4 КБ (выделенный), который не согласуется с границей физической 4 КБ.

![блок VHD 4 КБ](../../media/perftune-guide-vhd-4kb-block.png)

Каждая команда записи 4 КБ, выданная текущим средством синтаксического анализа для обновления полезных данных, приводит к двум операциям чтения для двух блоков на диске, которые затем обновляются и затем записываются обратно в два дисковых блока. Hyper-V в Windows Server 2016 устраняет некоторые эффекты производительности на дисках 512e в стеке VHD, подготавливая ранее упомянутые структуры для выравнивания до 4 КБ в формате VHD. Это позволяет избежать РМВного влияния при доступе к данным в файле виртуального жесткого диска и при обновлении структур метаданных виртуального жесткого диска.

Как упоминалось ранее, виртуальные жесткие диски, скопированные из предыдущих версий Windows Server, не будут автоматически выставляться по 4 КБ. Можно вручную преобразовать их для оптимального согласования с помощью параметра **Копировать с исходного** диска, доступного в интерфейсах VHD.

По умолчанию виртуальные жесткие диски предоставляются с физическим размером сектора в 512 байт. Это делается для того, чтобы не влиять на зависящие от размера физического сектора приложения при перемещении приложения и виртуальных жестких дисков из предыдущей версии Windows Server.

По умолчанию диски с форматом VHDX создаются с размером физического сектора 4 КБ для оптимизации профилей производительности обычных дисков и больших дисков секторов. Чтобы полностью использовать 4 КБ сектора, рекомендуется использовать формат VHDX.

## <a name="support-for-native-4kb-disks"></a>Поддержка собственных дисков размером 4 КБ

Hyper-V в Windows Server 2012 R2 и более поздних версиях поддерживает 4 КБ собственные диски. Но диск виртуального жесткого диска по-прежнему можно хранить на собственном диске размером 4 КБ. Это делается путем реализации алгоритма РМВа программного обеспечения на уровне стека виртуального хранилища, который преобразует 512-байтный доступ и запросы на обновление в соответствующие 4 КБ обращения и обновления.

Так как VHD-файл может предоставлять только себя в виде дисков логического сектора размером 512 байт, очень вероятно, что будут выполняться приложения, которые выдают запросы на операции ввода-вывода 512 байт. В таких случаях слой РМВ будет соответствовать этим запросам и приведет к снижению производительности. Это также справедливо для диска с форматом VHDX, который имеет логический размер сектора 512 байт.

Можно настроить формат VHDX-файла как диск логического сектора размером 4 КБ, и это оптимальная конфигурация для повышения производительности, когда диск размещается на собственном физическом устройстве 4 КБ. Следует соблюдать осторожность, чтобы убедиться, что гостевой компьютер и приложение, использующее виртуальный диск, поддерживаются в логическом секторе размером 4 КБ. Форматирование VHDX будет правильно работать на устройстве с размером логического сектора 4 КБ.

## <a name="pass-through-disks"></a>Транзитные диски

Виртуальный жесткий диск в виртуальной машине можно сопоставить непосредственно с физическим или логическим номером устройства (LUN), а не с VHD-файлом. Преимущество заключается в том, что эта конфигурация обходит файловую систему NTFS в корневом разделе, что снижает нагрузку на ЦП при вводе-выводе на хранение. Риск заключается в том, что физические диски или LUN могут быть труднее перемещаться между компьютерами, чем VHD-файлы.

Сквозные диски следует избегать из-за ограничений, появившихся в сценариях миграции виртуальных машин.

## <a name="advanced-storage-features"></a>Дополнительные возможности хранилища

### <a name="storage-quality-of-service-qos"></a>Качество обслуживания хранилища

Начиная с Windows Server 2012 R2, Hyper-V включает возможность установки определенных параметров качества обслуживания (QoS) для хранилища на виртуальных машинах. Качество обслуживания хранилища обеспечивает его изоляцию в мультитенантной среде и механизмы для уведомления в случае, если производительность ввода-вывода хранилища не соответствует установленному уровню, необходимому для эффективного выполнения рабочей нагрузки на виртуальных машинах.

Качество обслуживания хранилища позволяет указать максимальное количество операций ввода-вывода в секунду (IOPS) для виртуального жесткого диска. Администратор может отрегулировать вводы-выводы хранилища таким образом, чтобы потребление ресурсов хранилища одним клиентом не отражалось на другом.

Можно также задать минимальное значение для операций ввода-вывода в секунду. В этом случае он получит уведомление, если IOPS на указанном виртуальном диске опустится ниже порога, необходимого для оптимальной работы устройства.

При этом также обновляется инфраструктура метрики виртуальной машины и параметры хранилища, что позволяет администратору отслеживать производительность и параметры, связанные с возвратом платежей.

Максимальные и минимальные значения задаются в виде нормализованных операций ввода-вывода, где каждые 8 КБ данных считаются вводом/выводом.

Ниже перечислены некоторые ограничения.

-   Только для виртуальных дисков

-   Разностный диск не может иметь родительский виртуальный диск на другом томе

-   Реплика — качество обслуживания для сайта реплики, настроенного отдельно от первичного сайта

-   Общие VHDX не поддерживаются

Дополнительные сведения о качеству обслуживания хранилища см. в статье [качество обслуживания хранилища для Hyper-V](https://technet.microsoft.com/library/dn282281.aspx).

### <a name="numa-io"></a>ВВОД-ВЫВОД NUMA

Windows Server 2012 и более поздние версии поддерживают крупные виртуальные машины, а конфигурация больших виртуальных машин (например, конфигурация с Microsoft SQL Server, работающая с виртуальными процессорами 64) также потребует масштабируемости с точки зрения пропускной способности ввода-вывода.

Следующие основные усовершенствования, впервые представленные в стеке хранилища Windows Server 2012 и Hyper-V, обеспечивают требования к масштабируемости ввода-вывода для крупных виртуальных машин:

-   Увеличение количества каналов связи, созданных между гостевыми устройствами и стеком хранилища узлов.

-   Более эффективный механизм завершения ввода-вывода, включающий распределение прерываний между виртуальными процессорами, чтобы избежать дорогостоящих прерываний взаимодействия.

В Windows Server 2012 имеется несколько записей реестра, расположенных в разделе HKLM\\System\\CurrentControlSet\\Enum\\VMBUS\\{Device ID}\\{идентификатор экземпляра}\\Сторчаннел, позволяющее регулировать количество каналов. Они также согласовывают виртуальные процессоры, которые обрабатывают завершения ввода-вывода, с виртуальными процессорами, которые назначаются приложением для процессоров ввода-вывода. Параметры реестра настраиваются отдельно для каждого адаптера на аппаратном ключе устройства.

-   **Чаннелкаунт (DWORD)** Общее число используемых каналов, максимум 16. По умолчанию используется значение CEILING, равное количеству виртуальных процессоров/16.

-   **Чаннелмаск (QWORD)** Сходство процессоров для каналов. Если он не задан или имеет значение 0, по умолчанию используется существующий алгоритм распределения каналов, используемый для обычного хранения или для сетевых каналов. Это гарантирует, что каналы хранилища не будут конфликтовать с сетевыми каналами.

### <a name="offloaded-data-transfer-integration"></a>Интеграция с разгрузкой Передача данных

Критически важные задачи обслуживания для виртуальных жестких дисков, такие как слияние, перемещение и сжатие, зависят от копирования больших объемов данных. Текущий метод копирования данных требует, чтобы чтение и запись данных производились в различные местоположения, что может занимать много времени. Он также использует ресурсы ЦП и памяти на узле, который мог бы использоваться для обслуживания виртуальных машин.

Поставщики решений сети хранения данных (SAN) работают над обеспечением почти мгновенных операций копирования больших объемов данных. Это хранилище разработано для того, чтобы система, расположенная выше дисков, указала перемещение определенного набора данных из одного расположения в другое. Эта аппаратная функция называется разгрузкой Передача данных.

Hyper-V в Windows Server 2012 и более поздних версиях поддерживает разгрузку операций Передача данных (ODX), чтобы эти операции можно было передавать из гостевой операционной системы на оборудование узла. Это гарантирует, что Рабочая нагрузка сможет использовать хранилище с поддержкой ODX, как если бы оно выполнялось в невиртуализованной среде. Стек хранилища Hyper-V также выдает ODX операции во время операций обслуживания для виртуальных жестких дисков, таких как слияние дисков и мета-операции миграции хранилища, в которых перемещаются большие объемы данных.

### <a name="unmap-integration"></a>Интеграция сопоставления

Файлы виртуального жесткого диска существуют как файлы на томе хранилища, и они совместно используют доступное пространство с другими файлами. Так как размер этих файлов занимает много памяти, занимаемое ими пространство может быстро расти. Спрос на больший объем физической памяти влияет на бюджет оборудования ИТ. Важно оптимизировать использование физического хранилища, насколько это возможно.

До Windows Server 2012, когда приложения удаляют содержимое на виртуальном жестком диске, что фактически приводит к удалению места для хранения содержимого, стек хранилища Windows в гостевой операционной системе и узел Hyper-V имели ограничения, препятствующие этому сведения, переданные на виртуальный жесткий диск и физическое запоминающее устройство. Это не позволило стеку памяти Hyper-V оптимизировать использование пространства файлами виртуального диска на основе VHD. Кроме того, базовое устройство хранения не может высвободить пространство, которое ранее занималось удаленными данными.

Начиная с Windows Server 2012, Hyper-V поддерживает уведомления об отмене, что позволяет более эффективно использовать VHDX-файлы для представления данных внутри нее. Это приводит к уменьшению размера файлов и позволяет базовому физическому устройству хранения освободить неиспользуемое пространство.

Только контроллеры SCSI, поддержкой IDE и Virtual Fibre Channel для Hyper-V позволяют команде сопоставления гостевых систем достигать стека виртуального хранилища узла. На виртуальных жестких дисках только виртуальные диски в формате VHDX поддерживают команды сопоставления, указанные в гостевой службе.

По этим причинам рекомендуется использовать VHDX-файлы, подключенные к контроллеру SCSI, если они не используют виртуальные Fibre Channel диски.

## <a name="see-also"></a>См. также

-   [Терминология Hyper-V](terminology.md)

-   [Архитектура Hyper-V](architecture.md)

-   [Конфигурация сервера Hyper-V](configuration.md)

-   [Производительность процессоров Hyper-V](processor-performance.md)

-   [Производительность памяти Hyper-V](memory-performance.md)

-   [Производительность ввода-вывода сети Hyper-V](network-io-performance.md)

-   [Обнаружение узких мест в виртуализированной среде](detecting-virtualized-environment-bottlenecks.md)

-   [Виртуальные машины Linux](linux-virtual-machine-considerations.md)
