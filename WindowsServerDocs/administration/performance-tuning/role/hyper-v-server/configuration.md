---
title: Конфигурация Hyper-V
description: Рекомендации по настройке Hyper-V для настройки производительности
ms.prod: windows-server-threshold
ms.technology: performance-tuning-guide
ms.topic: article
ms.author: Asmahi; SandySp; JoPoulso
author: phstee
ms.date: 10/16/2017
ms.openlocfilehash: e5e55ad492439fcb7150469d9a35b639f5ff9a2f
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59830515"
---
# <a name="hyper-v-configuration"></a>Конфигурация Hyper-V

## <a name="hardware-selection"></a>Выбор оборудования

Вопросы оборудования для серверов под управлением Hyper-V, обычно схожи с без виртуализации серверов, но серверы с Hyper-V можно ЦП, используется больше памяти и требуется больше пропускной способности ввода-вывода из-за консолидации серверов.

-   **Процессоры**

    Hyper-V в Windows Server 2016 предоставляет логические процессоры как один или несколько виртуальных процессоров для каждой активной виртуальной машине. Теперь Hyper-V требует процессоров, поддерживающих технологии преобразования адресов второго уровня (SLAT), например Extended Page Tables (EPT) или вложенные страницы таблиц (NPT).

-   **кэш**

    Hyper-V могут использовать преимущества большего размера кэша процессора, особенно для загрузки, которые имеют большой размер рабочего набора в памяти и в конфигурации виртуальных машин, в которых при высоком соотношении виртуальных процессоров для логических процессоров.

-   **Память**

    Физическому серверу требуется достаточно памяти для корневого и дочерних разделов. Корневой раздел требуется память для эффективного выполнения операций ввода-вывода от имени виртуальных машин и операции, такие как моментальный снимок виртуальной машины. Hyper-V обеспечивает достаточный объем памяти доступен на корневом разделе что позволяет оставшуюся память назначаться дочерних разделов. Размер дочерних разделов следует задавать в соответствии потребностями из ожидаемой нагрузки для каждой виртуальной машины.

-   **Хранилище**

    Устройства хранения должны иметь достаточную пропускную способность ввода-вывода и ресурсов для удовлетворения текущих и будущих потребностей виртуальной машины, физического сервера узлов. Учитывайте эти требования, при выборе контроллеров запоминающих устройств и дисков и конфигурации RAID. Размещение виртуальных машин с высокой степенью диска рабочих нагрузок на разных физических дисках, скорее всего, повысит общую производительность. Например если активно использовать четыре виртуальные машины совместно используют один диск, каждая виртуальная машина может дать только 25 процентов пропускной способности диска.

## <a name="power-plan-considerations"></a>Рекомендации по плану Power

Как ключевой технологией виртуализации является мощным средством полезны в повышение плотности рабочих нагрузок сервера, уменьшению числа необходимых физических серверов в центре обработки данных, повышение эксплуатационной эффективности и сокращение расходов на потребление электроэнергии. Управление питанием крайне важно для управления затратами. 

В среде идеальный центра обработки данных энергопотребление управляется консолидации рабочих на компьютерах, пока они в основном интересуют занят и затем отключить простоя машин. Если этот подход нецелесообразно, администраторы могут использовать управления питанием на физических узлах, чтобы убедиться, что они не потребляют больше энергии, чем необходимо. 

Способы управления питанием сервера приходится платить, особенно, когда клиент рабочие нагрузки не являются доверенными для диктовки политики о физической инфраструктуре поставщика услуг размещения. Чтобы определить, как максимально повысить пропускную способность при минимальном энергопотребление остается слой размещения программного обеспечения. В основном режиме простоя машинах это может привести к физической инфраструктурой в завершение, Средняя power draw подходит, приводит к рабочих нагрузок отдельного клиента, работает медленнее, чем они могут, в противном случае.

Windows Server использует виртуализацию в самых разнообразных сценариях. К узлу облака с Hyper-V на сервере IIS, облегченных средней занят сервер SQL, под управлением сотни виртуальных машин на каждом сервере. Каждый из этих сценариев может иметь уникальные требования к производительности оборудования, программного обеспечения и. По умолчанию использует Windows Server и рекомендует **Сбалансированный** управления питанием, что позволяет энергосбережение, увеличив производительность процессора на основе загрузки ЦП.

С помощью **Сбалансированный** схемы управления питанием, наибольший энергопотребления (и минимальной задержки ответа рабочей нагрузки клиентов) применяются только в том случае, когда физического узла относительно занята. Если вы значение ответа детерминированным и малой задержкой для всех рабочими нагрузками клиента, следует рассмотреть возможность переключения по умолчанию **Сбалансированный** схемы управления питанием для **высокопроизводительных** схемы управления питанием. **Высокопроизводительных** схемы управления питанием процессоров на полной скорости все время выполнения, эффективно отключение требованию переключения, а также других средств управления питанием и оптимизировать производительность по экономии энергии.

Для клиентов, которые остались довольны экономия уменьшение числа физических серверов и нужно гарантировать их достижения максимальной производительности их виртуализованных рабочих нагрузок, можно использовать **высокопроизводительных** Схема управления питанием.

Дополнительные рекомендации и полезные сведения об использовании схем управления питанием оптимизации инфраструктуры, чтение [рекомендуется с балансировкой планирование параметров электропитания для быстрого времени отклика](../../hardware/power/recommended-balanced-plan-parameters.md)



## <a name="server-core-installation-option"></a>Установка основных серверных компонентов

Функция Windows Server 2016, вариант установки основных серверных компонентов. Server Core обеспечивает минимальную среду для размещения выбранного набора ролей сервера, включая Hyper-V. Она содержит меньше места на диске для несущей ОС и меньше атаки и обслуживания поверхности. Таким образом мы настоятельно рекомендуем использовать вариант установки основных серверных компонентов виртуализации серверов Hyper-V.

Установки Server Core предлагает окно консоли, только в том случае, если пользователь вошел в систему, но Hyper-V предоставляет функции удаленного управления, в том числе [Windows Powershell](https://technet.microsoft.com/library/hh848559.aspx) , администраторы могут управлять его удаленно.

## <a name="dedicated-server-role"></a>Роли выделенного сервера

Корневой раздел должен быть выделенным для Hyper-V. Выполнение дополнительных ролей сервера на сервере с Hyper-V может отрицательно сказаться на производительности сервера виртуализации, особенно в том случае, если они потребляют значительную пропускную способность ЦП, памяти или операций ввода-вывода. Сводя к минимуму серверные роли в корневом разделе обеспечивает дополнительные преимущества, такие как уменьшение поверхности атаки.

Системные администраторы должны внимательно рассмотреть какое программное обеспечение устанавливается в корневом разделе, так как для некоторых программ может отрицательно сказаться на общую производительность сервера с Hyper-V.

## <a name="guest-operating-systems"></a>Гостевые операционные системы

Hyper-V поддерживает и повысить количество гостевых операционных систем. Количество виртуальных процессоров, которые поддерживаются на гостевую ОС, зависит от гостевой операционной системы. Список поддерживаемых операционных систем, см. в разделе [Обзор Hyper-V](https://technet.microsoft.com/library/hh831531.aspx).

## <a name="cpu-statistics"></a>Статистические данные центрального Процессора

Hyper-V публикует счетчики производительности для оценки поведения сервера виртуализации и сообщить об использовании ресурсов. Стандартный набор средств для просмотра счетчиков производительности в Windows включает системный монитор и Logman.exe, которые могут отображать и вести журнал счетчиков производительности Hyper-V. Имена объектов соответствующих счетчиков имеют префикс **Hyper-V**.

Использование ЦП физической системой всегда следует определять с помощью счетчиков производительности логического процессора низкоуровневой оболочки Hyper-V. Использование ЦП счетчики, диспетчер задач и системного монитора в корневом каталоге и дочерних разделов не отражают фактические физические ЦП. Используйте следующие счетчики производительности для наблюдения за производительностью:

-   **Логического процессора низкоуровневой оболочки Hyper-V (\*)\\% общего времени выполнения** общего времени не простаивающего логических процессоров

-   **Логического процессора низкоуровневой оболочки Hyper-V (\*)\\% время работы гостевой** время, затраченное на выполнение циклов в гостя или в узле

-   **Логического процессора низкоуровневой оболочки Hyper-V (\*)\\% время работы низкоуровневой оболочки** время, затраченное в гипервизор работает

-   **Hyper-V низкоуровневая оболочка корневой виртуальный процессор (\*)\\ \***  измеряет использование ЦП корневой раздел

-   **Виртуальный процессор низкоуровневой оболочки Hyper-V (\*)\\ \***  измеряет использование ЦП гостевые разделы


## <a name="see-also"></a>См. также

-   [Терминологии Hyper-V](terminology.md)

-   [Архитектура Hyper-V](architecture.md)

-   [Производительность процессора Hyper-V](processor-performance.md)

-   [Производительность памяти Hyper-V](memory-performance.md)

-   [Хранилище Hyper-V производительность ввода-вывода](storage-io-performance.md)

-   [Сети Hyper-V производительность ввода-вывода](network-io-performance.md)

-   [Обнаружение узких мест в виртуализованной среде](detecting-virtualized-environment-bottlenecks.md)

-   [Виртуальные машины Linux](linux-virtual-machine-considerations.md)
