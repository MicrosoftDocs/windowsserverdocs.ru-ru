---
title: Рекомендации по планированию производительности серверного оборудования
description: Рекомендации по обеспечению высокой производительности серверного оборудования для Windows Server 2016
ms.topic: landing-page
ms.author: phstee
author: phstee
ms.date: 01/08/2018
ms.openlocfilehash: bac2aa367cc9a8d736fd83f7aeed3e467aeddb54
ms.sourcegitcommit: 53d526bfeddb89d28af44210a23ba417f6ce0ecf
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/06/2020
ms.locfileid: "87896749"
---
# <a name="server-hardware-performance-considerations"></a>Рекомендации по планированию производительности серверного оборудования

В следующем разделе приведены важные аспекты, которые нужно учитывать при выборе серверного оборудования. Соблюдение этих рекомендаций поможет устранить узкие места, которые могут снижать производительность сервера.

## <a name="processor-recommendations"></a>Рекомендации по выбору процессоров

Предпочтение следует отдавать 64-разрядным процессорам. 64-разрядные процессоры предоставляют значительно больше адресуемого пространства, а для Windows Server 2016 являются обязательным требованием. Для этой ОС не будет предоставляться 32-разрядная версия, но сохраняется возможность выполнять в 64-разрядной ОС Windows Server 2016 32-разрядные приложения.

Чтобы увеличить объем вычислительных ресурсов на сервере, вы можете выбрать процессор с более высокой частотой ядер или с большим количеством ядер. Если мощность ЦП является дефицитным ресурсом в системе, увеличение частоты ядер в 2 раза обычно больше повышает производительность, чем удвоение числа ядер с сохранением частоты.

Не следует ожидать линейного прироста производительности при увеличении числа ядер, и этот эффект может дополнительно ослабевать при использовании технологии Hyper-Threading, так как она основана на совместном использовании ресурсов в пределах одного физического ядра.


>[!Important]
> Объем памяти и производительность подсистемы ввода-вывода должны всегда соответствовать производительности ЦП, и наоборот.

Не используйте значения тактовой частоты ЦП для сравнения процессоров разных производителей и (или) разных поколений, так как такая оценка скорости может вводить в заблуждение.

Для работы Hyper-V важно, чтобы процессор поддерживал трансляцию адресов второго уровня (SLAT). Intel реализует эту поддержку в технологии Extended Page Tables (EPT), а AMD — в технологии Nested Page Tables (NPT). Чтобы проверить наличие этой возможности, выполните на сервере служебную программу SystemInfo.exe.

## <a name="cache-recommendations"></a>Рекомендации по выбору кэша

Выбирайте процессоры с большим размером кэша L2 или L3. В новых архитектурах, таких как Haswell и Skylake, используется единая кэш-память последнего уровня (LLC — Last Level Cache) или L4. Кэши большего размера, как правило, обеспечивают более высокую производительность и влияют на нее сильнее, чем частота ЦП.

## <a name="memory-ram-and-paging-storage-recommendations"></a>Рекомендации по выбору памяти (ОЗУ) и хранилища для файла подкачки

>[!Note]
> После установки Windows Server 2016 производительность некоторых систем может быть ниже, чем при использовании Windows Server 2012 R2. Во время разработки Windows Server 2016 было реализовано несколько изменений, повышающих безопасность и надежность платформы. Некоторые из этих изменений, например включение Защитника Windows по умолчанию, могут снизить производительность ввода-вывода для некоторых рабочих нагрузок и шаблонов. Корпорация Майкрософт не рекомендует отключать Защитник Windows, так как он представляет собой важный уровень защиты системы.

Увеличьте объем ОЗУ в соответствии с потребностями в памяти.
Если на компьютере не хватает памяти и возникает потребность немедленно увеличить ее объем, Windows использует файл подкачки, то есть расширяет объем ОЗУ за счет пространства на жестком диске. Чрезмерный объем операций с файлом подкачки снижает общую производительность системы.
Чтобы оптимизировать ее работу, соблюдайте следующие рекомендации при выборе размещения для файла подкачки.
- Разместите файл подкачки на отдельном запоминающем устройстве или, по крайней мере, не используйте запоминающее устройство с другими часто используемыми файлами. Например, файл подкачки и файлы операционной системы следует размещать на разных физических дисках.

- Размещайте файл подкачки на диске без поддержки отказоустойчивости. В случае отказа диска высока вероятность сбоя всей системы. Если вы хотите разместить файл подкачки на отказоустойчивом диске, учитывайте, что отказоустойчивые системы часто отличаются медлительностью операций записи на, так как они сохраняют данные в нескольких расположениях.

- Если нужно увеличить пропускную способность для файла подкачки, используйте несколько дисков или дисковый массив. Не размещайте несколько файлов подкачки в разных разделах одного физического диска.

## <a name="peripheral-bus-recommendations"></a>Рекомендации по выбору периферийной шины
Для Windows Server 2016 в качестве основного интерфейса хранилища и сети следует использовать PCI Express (PCIe), поэтому лучше выбирать сервера с поддержкой шин PCIe. Чтобы скорость шины не ограничивала производительность системы, используйте для адаптеров Ethernet со скоростью 10 Гбит/с и более слоты PCIe x8 и более высокой скорости.

## <a name="disk-recommendations"></a>Рекомендации по выбору диска
Старайтесь выбирать диски с более высокой скоростью вращения, чтобы снизить время выполнения произвольных операций (разница между дисками 7200 и 15 000 об./мин составляет около 2 мс) и увеличить пропускную способность последовательных операций. Но диски с более высокой скоростью вращения увеличивают стоимость, энергопотребление и другие параметры системы.

2,5-дюймовые диски корпоративного класса могут обслуживать значительно большее количество произвольных операций в секунду, чем эквивалентные 3,5-дюймовые диски.

Часто запрашиваемые данные, особенно с последовательным режимом доступа, следует хранить ближе к началу диска, так как такое расположение обычно соответствует самой быстрой внешней дорожке.

Использование небольшого числа дисков высокой емкости вместо множества дисков малого размера может снизить общую производительность хранилища. Меньшее количество шпинделей означает ограничение параллелизма при обслуживании запросов, что потенциально снижает пропускную способность и увеличивает время ответа (в зависимости от интенсивности рабочей нагрузки).

Использование SSD и высокоскоростных флэш-дисков наиболее эффективно для дисков с преобладанием операций чтения и высокой чувствительностью к скорости ввода-вывода или длительности задержек. Хорошим кандидатом на использование SSD и высокоскоростных флэш-дисков будут загрузочные диски, так как в этом сценарии значительно сокращается время загрузки.

Накопители NVMe SSD обеспечивают более высокую производительность, большую глубину очередей команд, более эффективную обработку прерываний и повышение эффективности операций с размером 4 КБ. Это особенно важно в сценариях с большим количеством одновременных операций ввода-вывода.


## <a name="network-and-storage-adapter-recommendations"></a>Рекомендации по выбору адаптера сети и хранилища

В следующем разделе приведены рекомендуемые характеристики адаптеров сети и хранилища для высокопроизводительных серверов. Эти параметры позволят избежать возникновения узких мест в сети или хранилище при высокой нагрузке.

### <a name="certified-adapter-usage"></a>Использование сертифицированных адаптеров
Используйте только те адаптеры, которые прошли набор тестов сертификации оборудования для Windows.

### <a name="64-bit-capability"></a>Поддержка 64-разрядной архитектуры
Адаптеры с поддержкой 64-разрядной архитектуры могут выполнять операции прямого доступа к памяти (DMA) в расположениях с большим объемом физической памяти (более 4 ГБ). Если драйвер не поддерживает DMA для расположений размером больше 4 ГБ, система использует двойную буферизацию ввода-вывода в физическое адресное пространство размером меньше 4 ГБ.

### <a name="copper-and-fiber-adapters"></a>Адаптеры с медным и оптоволоконным подключением
Адаптеры с медным подключением обычно имеют такую же производительность, как и аналоги на основе оптоволокна. Некоторые адаптеры Fibre Channel даже поддерживают обе технологии. Некоторые среды лучше подходят для адаптеров с медным подключением, а некоторые — для адаптеров с оптоволоконным подключением.

### <a name="dual--or-quad-port-adapters"></a>Адаптеры с двумя или четырьмя портами
Многопортовые адаптеры хорошо подходят для серверов с ограниченным числом слотов PCI.

Чтобы обойти ограничения SCSI на количество дисков, подключаемых к шине SCSI, некоторые адаптеры имеют две или четыре шины SCSI на одной плате. Адаптеры Fibre Channel обычно не устанавливают ограничений на количество подключенных дисков, если не подключать их через интерфейс SCSI.

Адаптеры Serial Attached SCSI (SAS) и Serial ATA (SATA) также ограничивают число подключений из-за особенностей последовательных протоколов, но вы можете подключить дополнительные диски с помощью коммутаторов.

Сетевые адаптеры предоставляют эту возможность для сценариев балансировки нагрузки и (или) отработки отказа. При одинаковой рабочей нагрузке два однопортовых сетевых адаптера обычно дают более высокую производительность, чем один двухпортовый сетевой адаптер.

Ограничения шины PCI могут быть важным фактором, негативно влияющим на производительность многопортовых адаптеров. Поэтому старайтесь размещать их в слоты PCIe с высокой производительностью (пропускной способностью).

### <a name="interrupt-moderation"></a>Управление прерываниями
Некоторые адаптеры умеют корректировать частоту прерываний процессоров узла для информирования о выполнении или завершении операций. Управление прерываниями часто позволяет снизить нагрузку на ЦП узла, но при неправильном подходе к управлению экономия ресурсов ЦП может привести к увеличению задержки.

### <a name="receive-side-scaling-rss-support"></a>Поддержка масштабирования на стороне приема (RSS)
Технология RSS позволяет масштабировать операции обработки получаемых пакетов с учетом числа доступных на компьютере процессоров. Это особенно важно для интерфейсов Ethernet со скоростью 10 Гбит/с и более.

### <a name="offload-capability-and-other-advanced-features-such-as-message-signaled-interrupt-msi-x"></a>Возможность разгрузки и другие расширенные функции, например прерывание по сообщениям (MSI)-X
Адаптеры с поддержкой разгрузки снижают нагрузку на ЦП и улучшают производительность.

### <a name="dynamic-interrupt-and-deferred-procedure-call-dpc-redirection"></a>Динамическое перенаправление прерываний и отложенных вызовов процедур (DPC)
В Windows Server 2016 реализована архитектура ввода-вывода Numa, которая позволяет адаптерам хранилища PCIe динамически перенаправлять прерывания и отложенные вызовы процедур. Это повышает производительность любой многопроцессорной системы за счет улучшения секционирования рабочей нагрузки, попаданий в кэш и применения аппаратных соединений для рабочих нагрузок с высокой интенсивностью ввода-вывода.

## <a name="see-also"></a>См. также
- [Рекомендации по питанию серверного оборудования](power.md)
- [Питание и настройка производительности](power/power-performance-tuning.md)
- [Настройка управления питанием процессора](power/processor-power-management-tuning.md)
- [Рекомендуемые параметры сбалансированного режима энергоснабжения](power/recommended-balanced-plan-parameters.md)
