---
title: Руководство пользователя по Server Performance Advisor
description: Руководство пользователя по Server Performance Advisor
ms.assetid: be99a5a9-b9c0-436b-912c-e5c5839a533d
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.topic: article
ms.prod: windows-server
ms.technology: manage
ms.openlocfilehash: 6a6ccedeeb007b9d3ab32c308fae991deb526442
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71383088"
---
# <a name="server-performance-advisor-users-guide"></a>Руководство пользователя по Server Performance Advisor

>Область применения: Windows Server (половина ежегодного канала), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 10, Windows 8

Это руководство пользователя по Microsoft Server Performance Advisor (SPA) содержит рекомендации по использованию SPA для выявления узких мест производительности в системах, развернутых в различных ролях сервера.

SPA может помочь вам в следующих вещах:

* Управляйте производительностью сервера и устраняйте проблемы с производительностью сервера.

* Предоставление отчетов о данных и рекомендаций по распространенным проблемам с конфигурацией и производительностью.

* Предоставьте лучшие пратиценые рекомендации на основе собираемых данных.

> [!NOTE]
> Консоль SPA не вносит никаких изменений в серверы.

Дополнительные сведения о разработке пакетов советника по защищенному пакету см. в статье [Обзор разработки пакета советника по производительности](server-performance-advisor-pack-development-guide.md).

## <a name="server-performance-advisor-overview"></a>Обзор советника по производительности сервера


В этом разделе описывается журнал SPA, описываются его Целевая аудитория и сценарии, а также представлен обзор архитектуры средства.

### <a name="history-of-spa"></a>Журнал SPA

Исходная версия советника по производительности Microsoft Server (SPA) была выпущена в 2005-2006. Он главным образом предназначен для Windows Server 2003, включая основные роли операционной системы и сервера, такие как службы IIS (IIS) и Active Directory. Цель этого средства — помочь вам оценить производительность сервера и устранить проблемы с производительностью сервера.

SPA предоставляет системным администраторам отчеты о данных и рекомендации по распространенным проблемам с конфигурацией и производительностью. SPA собирает связанные с производительностью данные из различных источников на серверах, например счетчики производительности, разделы реестра, запросы WMI, файлы конфигурации и трассировку событий для Windows (ETW). В зависимости от собираемых данных о производительности сервера, SPA может подробно изучить текущую серверную ситуацию с производительностью и получить рекомендации о том, что можно улучшить.

Было более 1 000 000 загрузок исходного средства SPA, и это позволило многим системным администраторам управлять производительностью своих серверов. Это очень успешное средство устранения неполадок с производительностью.

С момента выпуска исходного SPA существует несколько существенных изменений в мире производительности сервера. В первую очередь, выпуск Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2 и Windows Server 2008 с новыми версиями соответствующих ролей сервера, таких как службы IIS (IIS) 8,5. Более новые версии советника по производительности сервера расширяют возможности исходного SPA до последних серверных операционных систем и серверных ролей.

Хотя SPA 3,1 использует те же цели проектирования и парадигму анализа производительности, что и исходный инструмент, она была переписана с использованием новейшей технологии. Он также имеет следующие основные улучшения.

* Может выполнять анализ серверов под Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2 и Windows Server 2008.

* Поддерживает функцию удаленного анализа, которая позволяет SPA 3,1 выполнять накопление и анализ данных из центральной консоли без необходимости устанавливать код на анализируемые серверы.

* Использует Microsoft SQL Server для анализа и хранения данных, что позволяет обрабатывать и хранить большие объемы данных.

* Отделяет инструмент от пакетов Advisor. Логика анализа производительности для каждой роли сервера выпускается в виде пакета Advisor, который может быть выпущен или обновлен отдельно от средства.

* Предоставляет пакеты Advisor, разработанные в скриптах SQL с открытой архитектурой. Сторонние стороны могут разрабатывать пакеты Advisor или расширять существующие пакеты Advisor от корпорации Майкрософт для удовлетворения специальных потребностей.

* Поддерживает новые функции, такие как параллельные отчеты о сравнении, тенденции и исторические диаграммы, помогающие находить ненормальные результаты.

* Предоставляет такие функции, как изменение, импорт и экспорт пороговых значений для точной настройки отчетов и уведомлений и совместное использование этих настроек с другими пользователями SPA.

* Поддерживает несколько проектов, которые можно использовать для группировки целевых серверов.

* Предоставляет повторяющийся сбор данных в консоли SPA.

* Включает пользовательские запросы и создание отчетов с помощью Microsoft SQL Server (для опытных пользователей).

* Настраиваемые командлеты Windows PowerShell можно использовать с SPA

* Обратная совместимость для импорта и просмотра отчетов из базы данных SPA 3,0

### <a name="target-audience"></a>Целевая аудитория

Средство SPA в основном предназначено для системных администраторов, которые управляют менее чем 100 серверами в различных ролях сервера. Он также может использоваться инженерами службы поддержки для сбора данных о производительности и устранения проблем с производительностью клиентов.

SPA предлагает рекомендации, которые помогут решить проблемы с производительностью. Однако он основан на допущениях, которые могут быть неприменимы к конкретной серверной среде. Рекомендации, предлагаемые в SPA, должны рассматриваться как предложения. Мы ожидаем, что пользователи с SPA хорошо понимают конфигурацию системы, варианты использования и влияние настройки системы на общее поведение системы. Системные администраторы должны принять решение о том, следует ли применять рекомендации SPA к их среде.

### <a href="" id="what-s-new-in-spa-3-1-"></a>Что нового в SPA 3,1?

В SPA 3,1 были добавлены следующие функции и улучшения.

* Пакет советника по Active Directory помогает анализировать общую производительность роли сервера доменных служб Active Directory сервера.

* Поддержка разработчиков при добавлении потерянных уведомлений о событиях ETW в пакетах Advisor и о том, что оповещение отображается при создании отчета, а события были потеряны из-за высокой частоты длительного или сильного дискового пространства.

### <a name="target-scenarios"></a>Целевые сценарии

Ниже приведены целевые сценарии для SPA:

* **Серверная среда**

    SPA обеспечивает простоту настройки и обслуживания. Он применяется к серверным средам, в которых используется от 1 до 100 серверов. SPA плохо масштабируется, если вы пытаетесь управлять производительностью более чем 100 серверов. Для более крупных или более сложных сред рекомендуется использовать System Center Operations Manager.

* **Устранение неполадок производительности**

    SPA можно использовать в качестве средства устранения неполадок производительности. Он обеспечивает возможность собираются высокоуровневые данные о производительности, а также выполняет тщательную обработку данных, чтобы лучше понять общее поведение системы и помечает все аномалии. При подозрении проблемы с производительностью клиента можно использовать SPA для накопления и анализа данных о производительности с сервера.

    SPA создает отчет, который можно просмотреть. В отчетах SPA содержится список уведомлений, которые выделяют потенциальные проблемы и раздел данных, включающий различные индексы производительности, конфигурации и параметры сервера. Этот отчет можно использовать для определения конкретной проблемы с производительностью и использования рекомендаций для поиска решений проблемы. Отчеты можно сравнивать с другими отчетами, созданными в другое время или на другом сервере. С помощью этого параллельного сравнения можно определить различия между обычным исходным и нормальным поведением.

    **Примечание** . SPA не предназначен для использования в качестве средства отладки или отслеживания использования. Более того, с точки зрения серверов он может считаться средством, предназначенным только для чтения, и не изменяет конфигурации серверов.

     

* **Мониторинг индекса производительности**

    SPA можно использовать для мониторинга индекса производительности серверов. Вы можете запустить SPA на серверах для получения данных о производительности, а затем запустить диаграмму тенденций или архивную диаграмму, чтобы выявить нормальные выпуски. Вы можете просмотреть отчет для определенного анализа, получить дополнительные сведения о проблемах с производительностью, а затем использовать рекомендации или другие данные отчета для устранения проблемы.

### <a name="spa-architecture"></a>Архитектура SPA

Логика сбора данных SPA основана на протоколе в Windows, который называется журналы и оповещения производительности (PLA). PLA позволяет программам выполнять накопление данных о производительности с локальных или удаленных серверов, таких как счетчики производительности, запросы WMI, трассировки ETW, разделы реестра и файлы конфигурации. Когда SPA запускает анализ производительности на целевом сервере, создается набор сборщиков данных PLA, основанный на определенном выбранном пакете советника (SPA). Пакет Advisor содержит собираемый источник данных и общую папку, в которой будут храниться журналы. При сборе данных SPA хранится только одна учетная запись пользователя. для записи журналов также используется та же учетная запись пользователя, которая используется в PLA.

SPA использует базу данных SQL Server для хранения журналов производительности, собираемых с целевых серверов. SPA импортирует все журналы производительности из общей папки в базу данных, а затем использует логику анализа данных внутри каждого пакета Advisor для обработки данных и создания отчетов. Пакет Advisor анализирует данные о производительности, собранные с целевых серверов, и создает отчеты SPA. Дополнительные сведения о создании пакета Advisor см. в статье рекомендации по [разработке пакета советника по производительности сервера](server-performance-advisor-pack-development-guide.md).

Пользовательские интерфейсы и взаимодействия консоли SPA создаются в составе Спаконсоле. exe. Консоль можно использовать для создания базы данных, добавления или удаления пакетов Advisor, управления целевыми серверами, выполнения анализа производительности и просмотра отчетов о производительности.

Консоль SPA может работать в следующих операционных системах:

* Windows 8.1

* Windows 8

* Windows 7

* Windows Server 2012 R2

* Windows Server 2012

* Windows Server 2008 R2

* Windows Server 2008

В типичном бизнес-приложении существует три уровня: уровень представления, уровень бизнес-логики и уровень хранилища. SPA разработана как два уровня, консоль и база данных. Консоль выступает в качестве уровня представления с определенной логикой, связанной с процессом, а база данных выступает в качестве уровня хранилища и уровня бизнес-логики. Консоль захватывает введенные пользователем данные и управляет действиями по сбору данных, обработке данных и созданию отчетов. SPA не зависит от системных служб Windows.

На следующей схеме показана высокоуровневая архитектура системы SPA. Процесс:

1.  В консоли SPA выполняется анализ производительности на указанных серверах.

2.  При сборе данных о производительности PLA на целевых серверах записывает журналы обратно в общую папку, указанную в группе сборщиков данных.

3.  После завершения сбора данных на целевом компьютере консоль SPA импортирует журналы в базу данных SQL Server.

4.  Консоль вызывает логику обработки данных конкретного пакета Advisor.

5.  Пакет Advisor обрабатывает данные и вызывает API-интерфейсы SPA для вставки записей в системные таблицы отчетов, определенные платформой SPA.

6.  Для просмотра созданных отчетов можно использовать средство просмотра отчетов в консоли. Для облегчения устранения проблем с производительностью SPA предоставляет три типа отчетов: отдельные отчеты, параллельные отчеты, тенденции или исторические диаграммы. Дополнительные сведения об отчетах см. в разделе [Просмотр отчетов](#bkmk-viewingreports).

![Архитектура Spa](../media/server-performance-advisor/spa-user-manual-architecture.png)

## <a name="getting-started-with-spa"></a>Начало работы с SPA


### <a name="requirements"></a>Требования

Консоль SPA можно установить на Windows 8.1, Windows 8, Windows 7, Windows Server 2012 R2, Windows Server 2012, Windows Server 2008 R2 и Windows Server 2008. Запуск SPA в более ранних версиях операционной системы Windows Server не поддерживается. SPA работает на платформе x86 или x64, но не поддерживает архитектуры IA64 и ARM.

SPA основан на Windows Presentation Foundation (WPF) 2,0, который входит в состав Microsoft .NET Framework 4, поэтому требуется .NET Framework 4.

Также необходимо установить SQL Server 2008 R2 Express на том же компьютере, где установлена SPA. SQL Server 2008 R2 Express — это бесплатное ядро СУБД, выпущенное корпорацией Майкрософт. Загрузить Microsoft SQL Server 2008 R2 Express можно в центре загрузки Майкрософт. Хотя мы рекомендуем использовать SQL Server 2008 R2 Express, новые версии SQL Server также могут быть совместимы с SPA.

**Примечание** . SPA не включает SQL Server или .NET Framework как часть пакета установки SPA. После установки Microsoft SQL Server 2008 R2 и .NET Framework 4,0 рекомендуется запустить Центр обновления Windows перед установкой SPA.

 

Поскольку пользователи могут создавать базы данных и управлять ими с помощью SPA, учетная запись пользователя, используемая для запуска SPA, должна иметь те же права администратора, что и SQL Server.

### <a href="" id="bkmk-setupspa"></a>Настройка SPA

SPA упаковывается в CAB-файл, содержащий все двоичные файлы для платформы SPA, командлеты Windows PowerShell, которые используются в расширенных сценариях, и следующие пакеты Advisor: ядро ОС, Hyper-V, Active Directory и IIS. После извлечения CAB-файла в папку не требуется дополнительная установка. Однако для запуска SPA необходимо включить сбор данных с целевых серверов следующим образом:

* Для запуска сбора данных PLA учетная запись пользователя, используемая для запуска консоли SPA, должна входить в группу безопасности "Администраторы" на целевом сервере. Если целевой сервер и консоль находятся в одном домене, учетная запись пользователя домена должна входить в группу безопасности "Администраторы" на целевом сервере. Если целевой сервер и консоль находятся не в одном домене, создайте учетную запись администратора на целевом сервере с тем же именем пользователя и паролем, что и у учетной записи пользователя, используемой для запуска консоли SPA.

* Создайте общую папку для результатов на сервере.

* Убедитесь, что учетная запись пользователя, используемая для запуска консоли SPA, имеет разрешения на чтение и запись для общей папки. PLA использует эту учетную запись для записи журналов в папку.
Консоль SPA использует одну и ту же учетную запись для чтения журналов и их импорта в базу данных.

    **Примечание** . ETW реализует круглый буфер для хранения трассировки и перемещает их в общую папку, когда это возможно. Если сервер занят или операция записи выполняется слишком долго, ETW удаляет трассировки при заполнении буфера. ВАЖНО, чтобы общая папка находилась на сервере с быстрым доступом к операциям ввода-вывода. Рекомендуется, чтобы у каждого целевого сервера была общая папка для снижения потери данных, вызванной медленным вводом-выводом файлов.

     

* Чтобы PLA запускал доступ к целевым серверам, установите брандмауэр Windows, чтобы разрешить удаленный журналы и оповещения производительности доступ на целевых серверах. PLA использует TCP-порт 139.

* Убедитесь, что служба " **журналы производительности &** " запущена.

* Если консоль и целевой сервер находятся в разных подсетях, то необходимо также задать поле Remote IP Address (адрес удаленного назначения) в правилах брандмауэра для входящих подключений в параметрах **области** на странице **журналы и оповещения производительности** , как показано ниже.

    ![свойства PLA](../media/server-performance-advisor/spa-user-manual-pla-firewall.png)

* Включите обнаружение сети в консоли и на каждом из целевых серверов.

* Если целевой сервер не присоединен к домену, включите следующий параметр реестра: **HKLM\\SOFTWARE\\Microsoft\\Windows\\Currentversion\\политики\\системный\\LocalAccountTokenFilterPolicy**.

**Примечание** . По умолчанию SPA записывает журналы диагностики в папку, где находится Спаконсоле. exe. Если SPA устанавливается в папке Program Files, SPA может записывать только тот журнал, когда Спаконсоле. exe запускается от имени администратора.

Если требуется выполнить анализ данных на компьютере консоли, необходимо запустить SPA в качестве администратора. PLA проходит по другому пути кода при работе с локальным компьютером, для которого требуются права администратора.

Если требуется запустить пакет советника по IIS SPA для серверов, необходимо включить запрос WMI и трассировку ETW для сервера IIS. Это можно сделать, включив **трассировку** в службе роли **работоспособности и диагностики** , а также **скрипты и средства управления IIS** в разделе **средства управления** роли сервера **веб-сервера (IIS)** .

 

### <a name="creating-your-first-project"></a>Создание первого проекта

Когда все будет настроено, вы сможете создать первый проект SPA. Как описано в предыдущем разделе, SPA хранит все, что связано с анализом данных производительности в базе данных. Каждый проект SPA соответствует одной базе данных. При **первом использовании мастера мастер** поможет выполнить следующие действия.

**Создание проекта SPA**

1.  Запустите Спаконсоле. exe. Консоль переходит в отключенный режим, в котором SPA не подключена ни к одной базе данных, а главное окно — пустым.

2.  Чтобы создать новый проект, в меню **файл**выберите команду **создать проект**. При первом использовании мастера запускается мастер. На первой странице показаны действия, которые необходимо выполнить при использовании мастера.

    * Создание базы данных

    * Подготавливать пакеты Advisor

    * Добавление серверов в список целевых серверов

3.  Нажмите кнопку **Далее**. На странице **Создание базы данных проекта** предлагается указать имя экземпляра Microsoft SQL Server, в котором нужно создать базу данных. Например, если он находится на том же компьютере, что и консоль, можно использовать **\\localhost &lt;имя SQL server&gt;** .

    **Примечание** . Имя экземпляра по умолчанию для установки SQL Server 2008 R2 Express — SQLExpress. Для экземпляра SQL Server 2008 R2 Express, установленного на локальном компьютере, обычно по умолчанию используется база данных **localhost\\SQLExpress**. Однако он мог быть изменен во время установки SQL Server, поэтому необходимо убедиться в том, что используется правильное имя экземпляра SQL Server.

     

4.  Укажите имя базы данных. В качестве допустимых символов для имени базы данных допускаются только буквы, цифры и символы подчеркивания (\_). Разумным предложением для имени базы данных SPA будет **Spa**. Если ввести недопустимое имя, появится красный значок ошибки. Связанная подсказка выдает причину ошибки проверки.

    **Примечание** . Важно запомнить имя базы данных и имя экземпляра сервера, поскольку это единственные идентификаторы для проекта. Эти сведения необходимо указать, если необходимо переключиться на эту базу данных.

     

5.  После того как имя экземпляра сервера и имя базы данных введены, при первом использовании мастер создает расположение для файла базы данных.

6.  На странице **Создание базы данных проекта** нажмите кнопку **Далее**. При первом использовании мастера создается база данных и создается вся связанная с SPA схема базы данных, функции и хранимые процедуры в базе данных. Этот шаг может занять несколько секунд в зависимости от скорости работы оборудования и сети.

    **Обратите внимание** , что в случае сбоя этого шага появляется сообщение об ошибке. Некоторые из распространенных проблем: консоль не может подключиться к экземпляру SQL Server, недостаточно прав для создания базы данных, или имя базы данных уже существует.

     

7.  Когда предыдущий шаг будет выполнен, вы увидите страницу **пакета помощника по подготовке** . В нем перечислены все пакеты Advisor, доступные на компьютере. SPA автоматически проверяет папку с именем **APS** в корневом каталоге Spa. В нем указаны полное имя, версия и автор каждого пакета Advisor.

    **Примечание** . Дополнительные сведения о том, как полное имя и версия используются в SPA, см. в разделе [Управление пакетами Advisor](#bkmk-manageadvisorpacks) .

     

8.  Выберите пакеты Advisor, которые требуется подготавливать в базе данных проекта, а затем нажмите кнопку **Далее**. Можно также нажать кнопку **пропустить** , чтобы перейти к следующему шагу без подготовки пакетов Advisor.

    **Примечание** . Вы можете подготавливать пакеты Advisor каждый раз при использовании этого средства. Дополнительные сведения см. в разделе [Управление пакетами Advisor](#bkmk-manageadvisorpacks).

     

9.  На странице **Добавление серверов** для каждого сервера, добавляемого в список целевой сервер, необходимо заполнить два обязательных поля: **имя сервера** и **расположение общей папки**.

    **Примечание** . Существует также поле **комментария** , которое в основном используется для классификации или поиска сервера. В экземплярах, где имеется много серверов, можно импортировать файл значений с разделителями-запятыми (CSV), содержащий имя сервера, папку результатов и необязательное поле комментария. Поле " **Замечание** " используется для описания сервера, а термин может использоваться для фильтрации серверов для сбора данных. При инициализации серверов с помощью CSV-файла ошибка синтаксического анализа в файле не загружает серверы.

     

10. Необходимо настроить несколько конфигураций для включения сбора данных PLA, как описано в разделе [Настройка SPA](#bkmk-setupspa). Страница **Добавление сервера** предоставляет возможность настройки теста, помогающую устранять неполадки конфигурации. Установите флажок, связанный с компьютером, и нажмите кнопку **проверить подключение**. SPA пытается создать группу сборщиков данных на целевых серверах и пытается импортировать результаты обратно в базу данных. Если все правильно, отобразится **состояние** **пройдено**. В случае сбоя появится подсказка, описывающая причину сбоя.

11. Каждый из серверов автоматически добавляется в базу данных, даже если он не прошел проверку конфигурации. Чтобы удалить серверы из списка, выберите имя сервера и нажмите кнопку **Удалить**.

12. Когда все будет завершено, нажмите кнопку **Готово** , чтобы закрыть мастер при первом использовании. Если закрыть мастер в первый раз, прежде чем завершать его, все предыдущие шаги будут сохранены, и ни один из них не будет автоматически восстановлен. Необходимо внести изменения вручную.

## <a name="running-analysis"></a>Выполнение анализа


После настройки базы данных можно запустить анализ производительности на серверах.

При каждом запуске консоли SPA последний проект, который использовался текущим пользователем, открывается автоматически. Главное окно содержит список серверов. У каждого сервера есть четыре свойства: имя сервера, результат анализа, текущее состояние и замечание.

* **Имя сервера** Имя сервера, которое является идентификатором для сервера. Дублирующиеся имена не допускаются.

* **Результат анализа** По умолчанию он показывает результат последнего выполнения анализа производительности на сервере. Если с сервером не выполнялся анализ производительности, то **отчет не**отображается. При возникновении предупреждения, выданного отчетом, отображается **предупреждение** и метка времени, когда был создан последний отчет. Если во время последнего анализа на сервере проблемы не обнаружены, то отображается значение **ОК** и метка времени.

    **Примечание** . Если вы недавно изменили системный параметр, рекомендуется выполнить анализ еще раз, чтобы оценить влияние изменений и получить обновленный отчет о состоянии системы. SPA не следит за изменениями конфигурации тестируемой системы.

     

* **Текущее состояние** Показывает состояние задач анализа производительности, выполняемых в данный момент на сервере. Чтобы отменить выполняемую задачу, щелкните значок **отмены** , обозначенный красным крестиком.

* **Замечание** Описывает текущий целевой сервер. Например, можно описать сервер с помощью роли сервера (например, SQL Server) или расположения (например, Кент). SPA использует **имя сервера** и **Замечание** для поиска и поиска соответствующего сервера. В текстовом поле Поиск можно ввести. Если **имя сервера** или столбцы с **комментариями** содержат точную строку, введенную в поле поиска, сервер отображается в списке серверов.

На консоли также доступны следующие элементы управления:

* **Повторить** Флажок, описывающий возможность регулярного повторения коллекции в зависимости от интервала времени. Для большинства установок сервера необходимо повторить сбор данных о SPA, чтобы иметь достаточный журнал для анализа. Если вы хотите, чтобы коллекция выполнялась только один раз, не следует выбирать флажок **повторить** .

* **Удалить повторение** Кнопка, позволяющая отменить текущее задание повтора коллекции. Он отменяет повторную сбор, но не текущую коллекцию (если она есть). Этот параметр позволяет сбросить новый интервал повтора коллекции или запустить коллекцию вручную.

Прежде чем начать анализ производительности, выберите длительность сбора данных. Несмотря на то, что сбор дополнительных данных помогает обеспечить более точную производительность сервера, он также создает большее количество журналов, что может привести к появлению более возможного влияния на сервер. Выберите правильную продолжительность сбора данных в зависимости от конкретной потребности. Каждый пакет Advisor определяет минимальную допустимую длительность. Выбранная длительность сбора данных должна быть больше минимальной длительности выбранных пакетов Advisor.

Чтобы запустить анализ производительности на целевых серверах, выберите серверы, для которых требуется выполнить анализ производительности, и нажмите кнопку **запустить анализ** . Откроется диалоговое окно с запросом на выбор пакетов Advisor для запуска на серверах. Выбранные пакеты Advisor выполняются одновременно. Создаваемые отчеты основываются на данных о производительности, собираемых за тот же период времени.

**Примечание** . Если выбрать сервер, на котором выполняется повторяющийся анализ производительности, кнопка **Удалить повторение** позволяет отменить сбор повторяющихся данных. SPA не разрешает одновременно несколько сеансов сбора данных на одном компьютере.

 

## <a href="" id="bkmk-viewingreports"></a>Просмотр отчетов


В SPA существует три типа отчета об анализе производительности: один отчет, параллельный отчет, тренд и исторические диаграммы.

После выполнения анализа производительности создается отчет для каждого пакета Advisor, запущенного на целевом компьютере. Из списка серверов в главном окне можно развернуть **результаты анализа** , чтобы просмотреть все пакеты Advisor, которые были запущены на определенном сервере. Можно щелкнуть имя отчета, чтобы просмотреть один отчет.

Рядом с именем пакета Advisor есть три значка, которые показывают состояние последнего выполнения анализа на сервере:

* На **последнем** значке отображается отчет, созданный последним анализом производительности на этом сервере для пакета Advisor.

* Значок **найти** отображает список отчетов анализа производительности, позволяющий выбрать правильный отчет. Поля " **пакет Advisor** " и " **целевой сервер** " заполняются текущим пакетом Advisor и сведениями о целевом сервере. По умолчанию для диапазона времени задана одна неделя, а для параметра Дата окончания — значение сегодня. Если нажать кнопку **Поиск** в правом верхнем углу, можно получить список всех отчетов об анализе производительности для выбранного сервера и пакета Advisor в пределах диапазона времени.

* Значок « **Просмотр диаграмм** » открывает представление тенденция и историческая диаграмма.

На следующем рисунке показаны значки " **последние**", " **Поиск**" и " **Просмотр диаграмм** " после каждого пакета Advisor:

![значки отчета](../media/server-performance-advisor/spa-user-manual-report-icons.png)

### <a name="searching-for-and-within-reports"></a>Поиск и в отчетах

Поиск отчетов выполняется с помощью **обозревателя отчетов**. Это позволяет выполнять поиск отчетов по диапазону дат, имени сервера и пакету Advisor. Это рекомендуемый способ поиска отчета, отличного от последнего отчета о выполнении. Отчет о последнем запуске доступен через **представление отчет** для этого сервера.

При просмотре определенного отчета можно легко перейти к следующему и предыдущему отчету по времени или просмотреть связанный отчет, например другой AP, выполняющийся одновременно. Эти параметры доступны в разделе **действия**.

Возможен также поиск в отчете. У нескольких отчетов есть поле **поиска строки,** доступное для быстрого поиска в текстовой строке в отчете. Чтобы удалить текстовое поле, его можно закрыть. Чтобы активировать поле поиска (в Windows с текстовым поиском), можно использовать сочетание клавиш Control + F. Поле **найти** позволяет пользователю указать регистр с учетом регистра в соответствии с параметром **учитывать регистр** .

На следующем рисунке показано поле поиска **Поиск** с заданной **строкой** на вкладке **отчета** .

![поле поиска поиска](../media/server-performance-advisor/spa-user-manual-find-search-box.png)

### <a name="single-report"></a>Один отчет

В одном отчете отображаются результаты анализа производительности, полученные в результате одного запуска пакета Advisor на одном компьютере. В отчете отображается имя пакета Advisor, имя целевого сервера, время создания отчета и продолжительность сбора данных.

Один отчет содержит раздел уведомлений и разделы данных.

### <a name="notification-section"></a>Раздел уведомлений

Раздел уведомлений состоит из набора правил анализа производительности. Каждое уведомление содержит некоторый источник данных, некоторые пороговые значения и определенную бизнес-логику. При выполнении анализа производительности бизнес-логика оценивает источники данных на соответствие пороговым значениям, чтобы определить, прошло ли правило. В противном случае появится предупреждение о возможной ошибке производительности. Здесь также приводятся рекомендации по устранению проблемы. Раздел уведомлений всегда является первой вкладкой в представлении одного отчета.

Раздел уведомления состоит из двух частей: **предупреждения** и **другие уведомления**.

Если источник данных правила удовлетворяет определенным условиям на основе параметров логики и порога, в области **предупреждения** появляется предупреждение. Предупреждение включает следующие компоненты:

* Значок предупреждения указывает на наличие потенциальной проблемы.

* Имя правила. Например, **Сетевые приемы пакетов** — это ссылка, указывающая на страницу сведений о правиле, как описано в разделе [Управление пакетами Advisor](#bkmk-manageadvisorpacks).

* Простое описание потенциальных проблем.

* Рекомендации по возможному решению потенциальной проблемы с производительностью.

Различные серверы могут сильно различать конфигурацию и использование, и невозможно установить пороговые значения и правила, применимые ко всем серверам при всех условиях. SPA предоставляет возможность изменять пороговые значения. Можно также отключить правило, если оно не применяется к вашему сценарию. По умолчанию все правила включены. Отключенное правило не отображается в области уведомлений. Дополнительные сведения см. в разделе [Управление пакетами Advisor](#bkmk-manageadvisorpacks).

В области **другие уведомления** содержатся все остальные правила, в которых не выдается предупреждение или правило неприменимо. Он содержит похожие части, найденные в области **предупреждений** . Наибольшее отличие заключается в том, что если предупреждение не возникает или правило неприменимо, обычно рекомендации не предоставляются.

### <a name="data-sections"></a>Разделы данных

Разделы данных содержат данные о производительности, формируемые пакетом Advisor на основе необработанных данных, собранных с целевых серверов. Разделы данных включают набор разделов верхнего уровня и несколько уровней подразделов. Разделы верхнего уровня представляются в виде вкладок. Все подразделы в разделах верхнего уровня представлены в расширяемых областях. Можно свернуть или развернуть каждый из разделов, чтобы сосредоточиться на области интересов, как показано на следующем рисунке.

![разделы данных](../media/server-performance-advisor/spa-user-manual-data-sections.png)

Основной пакет советника по работе с ОС и пакет Advisor для IIS содержат раздел **Обзор системы** . В этом разделе содержатся сведения верхнего уровня об использовании ресурсов и конфигурации. Другие разделы верхнего уровня представляют области данных о производительности. SPA представляет данные отчета следующими способами.

* **Одно значение** Пара "ключ-значение". Ключ — это строка, представляющая значение значения. Значением может быть строка, числовое значение или логическое значение. Это часто используется для отображения статических сведений, например конфигурации, архитектуры ЦП, общего объема памяти и версии BIOS, которые не меняются со временем.

* **значение списка** Иногда это пара "ключ-значение", но значение списка может содержать несколько полей. Например, атрибут ЦП может быть показан в таблице с несколькими столбцами и несколькими строками. Каждая строка представляет один ЦП, а каждый столбец представляет атрибут ЦП.

* **Статистика** Может рассматриваться как особый тип одиночного значения. Он может содержать только числовые данные. Во время сбора данных многие из числовых точек данных меняются, а не остаются постоянными. Например, загрузка ЦП изменяется каждый раз, когда PLA собирает счетчик производительности. Отображение только одного значения не может точно отражать ситуацию с производительностью. Вместо отображения только одного значения, для таких динамических числовых точек данных используются значения СРЗНАЧ, максимум, минимум и 90%. Значение 90% представляет действие на уровне 90 или выше для всех событий этого счетчика в заданном интервале коллекции.

* **Верхний список** Обычно содержит Топ потребителей определенного ресурса или верхних сущностей, которые испытывают определенные события. Например, **первые 10 процессов с точки зрения среднего уровня использования ЦП** включают в себя десять процессов с наибольшим средним временем загрузки ЦП во время сбора данных. Поскольку загрузка ЦП также представляет собой динамическую числовую точку данных, в список также включаются другие статистические данные, такие как максимальное, минимальное и 90%, чтобы предоставить пользователю более полную картину использования ЦП.

Как упоминалось в предыдущих разделах, SPA использует PLA для накопления трассировки ETW, запросов WMI, счетчиков производительности, разделов реестра и файлов конфигурации для создания отчета. Важно понимать источник данных, лежащий в основе каждой точки данных в отчете. SPA предоставляет такие сведения с помощью всплывающих подсказок. Можно навести указатель мыши на ключевые столбцы или строки, чтобы просмотреть подсказку источника данных. Например, **WMI: Win32\_undrive: Caption** означает, что источником данных является WMI-запрос, имя класса WMI — Win32\_дискдриве, а свойство — **заголовок**.

### <a href="" id="side-by-side-report-"></a>Параллельный отчет

Отдельные отчеты предоставляют уведомления и раздел данных, которые помогают пользователю находить потенциальные проблемы с производительностью, но часто бывает трудно определить потенциальную неполадку с производительностью, непосредственно изучив один отчет. Один отчет может содержать слишком много точек данных, что затрудняет поиск потенциальных проблем.

Для решения этой проблемы SPA предоставляет возможность сравнения двух отчетов. Можно сравнить отчет с потенциальной проблемой с базовым отчетом, чтобы помочь найти различия.

Параллельные отчеты можно запускать из средства просмотра с одним отчетом. Пользователи могут щелкнуть **действия**, а затем **Сравнить отчеты** , чтобы выбрать отчеты. Он имеет смысл только для сравнения отчетов из одного и того же пакета Advisor. Можно выбрать сравнение отчета с предыдущим отчетом по времени, следующий отчет во времени или произвольный отчет, выбранный с помощью возможностей поиска. Например, чтобы изолировать аномальное поведение, можно сравнить отчет по базовому серверу с отчетом, созданным в другое время на том же компьютере, или отчет, созданный на другом компьютере с аналогичной ролью сервера и загрузкой.

Параллельный отчет выглядит примерно так же, как и один отчет. Он содержит раздел уведомлений и разделы данных. Оно содержит то же количество уведомлений и разделов данных, что и единое средство просмотра отчетов. Единственное отличие состоит в том, что отчеты отображаются параллельно. Каждый раздел содержит данные из исходного отчета (отчет 1) и целевой отчет (отчет 2). В параллельном отчете отображается имя пакета Advisor, имя целевого сервера (отчет 1 слева и отчет 2 справа), время создания отчета и продолжительность сбора данных для каждого отчета в отчете о его создании.

Если закрыть диалоговое окно **найти** , можно повторно активировать его, введя Control + F. Это диалоговое окно находит и выделяет текстовые строки в текущем разделе.

В разделе уведомления, если какой-либо из результатов из двух сравниваемых отчетов является предупреждением, он отображается в области **предупреждения** . В противном случае результаты будут перечислены в области **другие уведомления** . Поскольку ключ для параллельного отчета заключается в выявлении различий между отчетами, подробные сведения о правиле не отображаются. Пользователи могут щелкнуть имя правила, чтобы открыть форму сведений о правиле для получения дополнительных сведений о правиле.

В разделах данных данные представлены параллельно с данными из отчета 1 слева и данными из отчета 2 в правой части. SPA показывает одиночные значения в одной и той же таблице, но вместо метки **значений**столбцов они называются **Report 1** и **Report 2** соответственно. В параллельном отчете отображаются все другие формы данных в параллельных таблицах.

Параллельное средство просмотра отчетов также предоставляет подсказки о источнике данных.

### <a name="historical-and-trend-charts"></a>Исторические и трендические диаграммы

Имеет смысл показывать только тенденции и исторические диаграммы для определенного сервера и конкретного пакета Advisor. Необходимо выбрать диапазон времени (по умолчанию за последнюю неделю), а затем нажать кнопку **ОК** , чтобы вывести на экран тенденцию и средство просмотра исторических диаграмм.

В средстве просмотра тенденций и исторических диаграмм есть три вкладки: историческая диаграмма, 24-часовой график тренда и диаграмма тенденций за 7 дней.

### <a name="historical-chart"></a>Статистическая диаграмма

На исторических диаграммах показан ряд значений для числовой точки данных за заданный промежуток времени. Например, **Средняя задержка запроса** для IIS на одном сервере за последние 15 дней. Каждая точка данных в архивной диаграмме представляет значение определенного источника данных, сделанного в одном сеансе анализа производительности.

Существует несколько способов использования исторических диаграмм.

1.  Чтобы упростить поиск аварийных сведений в определенное время для точки данных, например, в 2:00 AM каждый день, **Средняя задержка запросов** в IIS переходит от 200 мс к 500 мс.

2.  Для обеспечения корреляции нескольких точек данных. Например, показывает **среднюю задержку запросов** и **Среднее количество запросов** за последние 15 дней. В отчете может появиться сообщение о том, что задержка запроса и число запросов увеличиваются в то же время, что может означать, что увеличение задержки запроса вызвано увеличением числа запросов.

В архивной диаграмме пользователи могут выполнять следующие действия:

* Отображение нескольких рядов данных в области диаграммы. Каждый ряд данных отображается как график в средстве просмотра отчетов. Каждый график автоматически масштабируется по размеру в средстве просмотра отчетов.

* Добавьте или удалите ряды данных из списка рядов данных в нижней части средства просмотра исторических диаграмм.

* Отображение или скрытие ряда данных в списке рядов данных. Пользователи могут щелкнуть конкретный ряд данных в списке, чтобы выделить соответствующий график в области диаграммы.

* Увеличить на определенный период времени, выбрав период времени в области диаграммы. Чтобы уменьшить масштаб, нажмите кнопку, расположенную в левом нижнем углу диаграммы.

* Исследование одного отчета путем двойного щелчка по определенной точке данных.

* Скопируйте данные и сделайте их доступными для других программ, таких как Microsoft Excel. Это позволяет использовать возможности диаграмм Microsoft Excel, если это уместно.

### <a name="trend-charts"></a>Диаграммы трендов

Многие повторяющиеся проблемы с производительностью вызваны периодическими задачами, выполняемыми на целевых серверах или на них. Например, веб-сайт, ориентированный на развлекательные развлечения, может получить больше обращений в выходные дни, или задача резервного копирования дисков может привести к снижению производительности сервера каждый день в 2:00 AM.

Диаграмма тенденций призвана помочь в обнаружении таких проблем с производительностью. Проблемы с производительностью могут повторяться в различных шаблонах. Наиболее распространенные шаблоны — это ежедневные шаблоны и еженедельные шаблоны, в которых проблемы производительности происходят в течение одного часа дня или одного дня недели. Таким образом, SPA предоставляет 24-часовой график тренда и диаграмму тенденций за семь дней.

Диаграмма анализа тенденций обеспечивает более глубокий анализ набора данных и выполняет поиск тенденций на основе времени суток. Для оси X задается 24-часовой период, начиная с 0:00 (полночь) и заканчивая на 23:59. SPA не отображает тенденции для нескольких рядов данных одновременно. Чтобы выбрать ряды данных для просмотра, щелкните **Выбор рядов данных** .

Для обработки данных SPA проверяет все моментальные снимки, созданные между 0:00 и 0:59, за каждый час. SPA определяет минимальное, максимальное, среднее и Сигма для набора моментальных снимков, создаваемых в течение этого часа, и показывает их как японские свечи диаграммы. SPA повторяет процесс создания моментальных снимков между 1:00 и 1:59, затем 2:00 до 2:59 и т. д. Если в течение заданного часа моментальных снимков не существует, SPA оставляет этот час пустым на графе и переходит к следующему часу.

Диаграмма тенденций за семь дней очень похожа на 24-часовой тренд. Единственное отличие заключается в том, что он группирует ряды данных на основе дня недели, а не часа дня.

Ряды данных, выбираемые на диаграммах трендов и исторические, сохраняются в качестве предпочтений пользователя. В следующий раз, когда средство просмотра тенденций и исторических диаграмм открыто для одного и того же пакета Advisor, в качестве значения по умолчанию будет указан один и тот же набор рядов данных.

## <a name="managing-reports"></a>Управление отчетами


### <a name="deleting-reports"></a>Удаление отчетов

Отчеты можно удалить, чтобы максимально ограничить количество отчетов, которыми необходимо управлять с помощью SPA. В зависимости от частоты отчетов и количества серверов рекомендуется удалить ненужные отчеты. Хотя SPA не имеет ограничения на отчеты, которыми может управлять, базовая база данных может иметь ограничение размера.

**Примечание** . удаленные отчеты не могут быть удалены.

 

### <a name="exporting-and-importing-reports"></a>Экспорт и импорт отчетов

Отчеты можно экспортировать в XML-файл для передачи в другую консоль SPA или по электронной почте другому пользователю. При экспорте отчета отчет не удаляется. Чтобы экспортировать отчет, просматриваемый в данный момент, в **средстве просмотра отчетов**щелкните **действия**, а затем выберите **Экспорт**. Чтобы экспортировать несколько отчетов, в **обозревателе отчетов**щелкните **включить множественный выбор**, выберите несколько отчетов в поле выбора, а затем нажмите кнопку **Экспорт**. Отчеты в формате XML экспортируются в выбранный каталог назначения.

Экспортированный отчет можно просмотреть в SPA. импортированные отчеты не добавляются в базу данных SPA. Они в основном предназначены для использования в качестве приложения средства просмотра XML для экспортированного отчета. На сервере для импортированного отчета не обязательно устанавливать те же пакеты Advisor, что и исходная экспортированная консоль отчета SPA.

## <a href="" id="bkmk-manageadvisorpacks"></a>Управление пакетами Advisor


SPA включает пакеты Advisor для основной операционной системы, Hyper-V, Active Directory и IIS. SPA предоставляет открытую архитектуру для разработки пакетов Advisor с помощью SQL, поэтому разработчикам, разработанным не корпорацией Майкрософт, можно создавать версии пакетов Advisor. Существует четыре варианта управления пакетом Advisor: подготавливать, настраивать, сбрасывать или удалять.

### <a name="provision-new-advisor-packs"></a>Подготавливает новые пакеты Advisor

Новые пакеты Advisor могут выпускаться корпорацией Майкрософт или разработчиками сторонних разработчиков. Пакет Advisor включает в себя Провисионметадата. XML и набор скриптов SQL, описывающих логику.

**Предоставление нового пакета Advisor**

1.  Скопируйте все содержимое пакета Advisor в каталоге *% спарут%* \\APS.

2.  В главном окне щелкните **Конфигурация**, а затем — **Настройка пакетов Advisor**. Откроется диалоговое окно **Настройка пакетов Advisor** .

    **Примечание** . Это диалоговое окно похоже на страницу **пакета помощника по подготовке** при первом использовании мастера. В нем отображается список пакетов Advisor, доступных для управления. Каждый пакет Advisor в списке имеет такие свойства, как имя, установленная версия, версия и автор. Name — это полное имя пакета Advisor, а установленная версия — это версия этого пакета Advisor, которая уже была подготовлена в проекте. Если пакет Advisor не подготовлен в текущей базе данных, в текстовом поле установленная версия отобразится значение **не установлено**. В поле версия указывается версия этого пакета Advisor, которая хранится в папке пакеты Advisor.

     

3.  Выберите пакет Advisor из списка. Если пакет Advisor не был подготовлен или имеется более новая версия в папке пакетов Advisor, чем та, которая находится в базе данных, кнопка **Подготовка** включена. Нажмите кнопку **подготавливать** .

4.  После завершения подготовки в поле **установленная версия** выбранного пакета Advisor будет представлена новая информация о версии.

### <a name="customize-advisor-packs"></a>Настройка пакетов Advisor

SPA определяет открытую архитектуру, позволяющую пользователям изменять пакеты Advisor. Пользователи могут изменять файлы пакета Advisor, изменяя пороговые значения, совместно использовать пороговые значения, а также включать или отключать правила.

Дополнительные сведения об изменении и сборке пакетов Advisor см. в разделе [руководство по разработке пакета советника по производительности сервера](server-performance-advisor-pack-development-guide.md).

### <a name="changing-thresholds"></a>Изменение пороговых значений

Пороговые значения используются в SPA, чтобы определить, выполнено ли условие триггера правила. Фактические пороговые значения для реальных сценариев клиентов могут сильно различаться из-за рабочей нагрузки, аппаратной среды и потребностей бизнеса. Пороговые значения по умолчанию могут быть неправильными для текущего случая пользователя, поэтому SPA предоставляет возможность изменить существующее пороговое значение.

Пороговые значения можно изменить, щелкнув имя правила в одном или параллельном отчете. Или, чтобы управлять всеми правилами конкретного пакета Advisor, можно изменить пороговые значения в меню **Конфигурация** .

**Изменение порогового значения**

1.  В меню **Конфигурация** выберите пункт **Настройка пакетов помощников**, щелкните имя пакета Advisor, который нужно изменить, а затем нажмите кнопку **настроить**.

    **Примечание** . Отобразится список всех правил, которые включены в пакет Advisor. Флажок слева от имени пакета Advisor указывает, включено ли правило. Если правило отключено, оно скрыто от всех отчетов.

     

2.  Щелкните конкретное правило, которое необходимо изменить. Откроется форма **сведений о правиле** для выбранного правила.

В форме сведения о правиле содержатся подробные сведения о конкретном правиле. Он включает имя, описание, состояние, возможные результаты и пороговые значения. SPA поддерживает два типа результатов правил: **предупреждение** и **ОК**. Для каждого типа имеется текст рекомендаций и рекомендация.

Для некоторых правил не заданы пороговые значения. Например, правило проверки **активности HTTP** проверяет логический параметр для IIS. Поэтому список пороговых значений может быть пустым. В противном случае будут перечислены все пороговые значения, используемые текущим правилом. Подробное описание того, как пороговое значение используется в правиле, включается в описание.

Если форма **сведений о правиле** запускается из меню **Конфигурация** , список пороговых значений содержит три столбца: имя, исходный параметр и изменить параметр. Если он запускается из одного или параллельного отчета, пороговое значение, используемое отчетом, также включаются. Пользователи могут изменять текущие пороговые значения, изменяя значение в столбце **изменить параметр** , а затем нажав кнопку **сохранить** , чтобы сохранить изменения в базе данных.

Все изменения, внесенные в пороговые значения, применяются только к отчетам, созданным после внесения изменений. Эти изменения не затрагивают существующие отчеты.

### <a name="sharing-thresholds"></a>Общие пороговые значения

Если вы управляете серверами в аналогичных ситуациях, можно использовать один и тот же набор порогов. Вы можете экспортировать и импортировать пороговые значения для конкретного пакета Advisor с помощью меню **Конфигурация** . Можно выбрать конкретный пакет Advisor, а затем нажать кнопку **настроить**. Экспортируемый пороговый файл имеет формат XML.

При импорте порогового значения SPA проверяет формат XML-файла и проверяет, соответствует ли файл выбранному пакету Advisor. В случае успеха SPA импортирует все значения из файла порогового значения в текущую базу данных проекта. Как и в предыдущем сценарии изменения порогов, все изменения пороговых значений вступают в силу только для отчетов, создаваемых в будущем. Существующие отчеты не затрагиваются.

### <a name="enable-or-disable-rules"></a>Включение и отключение правил

Правило можно включить или отключить в форме **сведений о правиле** . Для сохранения внесенных изменений необходимо нажать кнопку **сохранить** . Если правило отключено, оно не должно отображаться ни в одном из отчетов. Но базовая бизнес-логика активируется при создании отчета, поэтому при повторном включении правила оно снова отображается в отчетах.

### <a name="reset-advisor-packs-to-original-state"></a>сбросить пакеты Advisor в исходное состояние

Вы можете изменить подготовленный пакет Advisor в базе данных. Кроме изменения пороговых значений, можно также изменить скрипты SQL. SPA не поддерживает изменение метаданных отчета, а также добавление или удаление правил для подготовленного пакета Advisor. Изменение этих областей вручную может привести к непредвиденному поведению.

Дополнительные сведения об изменении подготовленного пакета Advisor см. в разделе руководств по [разработке пакета советника по производительности сервера](server-performance-advisor-pack-development-guide.md).

Если вы хотите выполнить откат изменений, внесенных в подготовленный пакет Advisor, можно выбрать сброс пакета Advisor. Это перезаписывает все скрипты SQL, связанные с пакетом Advisor, и сбрасывает все пороговые значения по умолчанию. При этом сохраняются все существующие отчеты.

сброс пакета Advisor можно выполнить с помощью формы **Настройка пакетов Advisor** . Необходимо выбрать пакет Advisor для сброса, а затем нажать кнопку **сбросить**.

### <a name="remove-advisor-packs"></a>Удаление пакетов Advisor

Если пакет Advisor больше не нужен, пользователи могут удалить его из базы данных. Удаление пакета Advisor удаляет все сведения о пакете Advisor из базы данных, включая правила и пороговые значения, все скрипты SQL и все отчеты. Откат ни для одного из действий не может быть отменен.

Удаление пакета Advisor можно выполнить с помощью формы **Настройка пакетов Advisor** . Необходимо выбрать пакет Advisor, который нужно удалить, и нажать кнопку **отменить**подготовку.

### <a name="update-existing-advisor-packs"></a>Обновление существующих пакетов Advisor

Обновление существующих пакетов Advisor очень похоже на сброс пакета Advisor в исходное состояние. Чтобы обновить пакет Advisor до более новой версии, скопируйте новый пакет Advisor в папку пакета Advisor. Пакет Advisor считается обновлением существующего пакета Advisor только при отсутствии изменений метаданных отчета. Идентификаторы отчета и правил должны быть одинаковыми. В противном случае они должны рассматриваться как два разных пакета Advisor.

Если есть только изменения бизнес-логики и нет изменений метаданных отчета для пакета Advisor, ему следует предоставить новый номер версии, например от 1,0 до 2,0. При изменении метаданных отчета пакету Advisor следует присвоить другое полное имя. Например, Microsoft. Серверперформанцеадвисор. IIS. v1 можно изменить на Microsoft. Серверперформанцеадвисор. IIS. v2.

Если существует более новая версия пакета Advisor, список в форме " **Настройка пакетов Advisor** " автоматически заполняет столбец **версии** последней версией пакета Advisor. Можно выбрать пакет Advisor, а затем нажать кнопку **Сброс**. Пакет Advisor обновляет новую бизнес-логику и пороговые значения. Все отчеты для этого пакета Advisor сохраняются.

## <a name="managing-servers"></a>Управление серверами


SPA предоставляет базовые возможности для управления целевыми серверами. Можно добавить новые серверы в список целевых серверов, удалить серверы из списка или изменить примечания для серверов.

**Добавление или удаление серверов или изменение сведений о сервере**

1.  В меню **Конфигурация** выберите пункт **Настройка серверов**.

2.  В списке серверов, которые в настоящее время существуют в базе данных проекта, последняя строка пуста. Щелкните строку и заполните поля. Поля **имя сервера** и **расположение общей** папки являются обязательными, а имя сервера должно быть уникальным.

3.  Введите другие сведения о сервере в столбце **замечаний** для каждого сервера.

    **Примечание** . В этом поле используется формат свободного текста, поэтому его можно использовать в качестве поля описания. Или используйте это поле, чтобы пометить серверы, чтобы их можно было легко найти в главном окне или сгруппировать серверы, например по расположению или роли сервера.

     

4.  Если вы хотите использовать SPA с большим количеством серверов, SPA поддерживает для импорта формат значений с разделителями-запятыми (CSV). Файл должен содержать по крайней мере два поля: расположение **сервера** и **общей папки**. Третье поле, **Примечание** является необязательным, но рекомендуется упорядочить серверы. Вы также можете экспортировать список серверов в CSV-файл, чтобы определить соответствующий формат или создать резервную копию конфигурации сервера.

### <a name="searching-and-filtering"></a>Поиск и фильтрация

Если вы управляете более чем несколькими серверами, SPA обеспечивает базовую поддержку быстрого поиска серверов в главном окне. Можно щелкнуть заголовок столбца, чтобы отсортировать его по имени сервера, результатам анализа, состоянию текущей задачи или примечаниям. Можно также использовать функцию поиска. В правом верхнем углу главного окна можно ввести строку для поиска. Список **целевых серверов** в главном окне использует строку для фильтрации серверов и для вывода только серверов с полями имени или комментария, содержащими строку поиска.

На следующем рисунке показано, как строка **Dell** соответствует серверам со строкой **Dell** или серверами с полем **комментариев** , содержащим **Dell**.

![Пример поиска и фильтрации](../media/server-performance-advisor/spa-user-manual-find-search-example.png)

## <a name="advanced-functionality"></a>Расширенная функциональность


### <a name="working-with-spa-windows-powershell-cmdlets"></a>Работа с защищенными командлетами Windows PowerShell

Консоль SPA поддерживает через пользовательский интерфейс для повторяющегося сбора данных. Если эта функциональная возможность недостаточна для вашей среды, существуют командлеты Windows PowerShell, которые опытный администратор может использовать для настройки сбора данных. Эти командлеты Windows PowerShell позволяют системным администраторам автоматически выполнять анализ производительности на целевых серверах и использовать SPA для удаленной поддержки клиентов. Например, системные администраторы могут создавать сценарии для вызова командлетов SPA в течение определенного интервала времени для периодической выборки состояния производительности целевых серверов.

Перед использованием этих командлетов рекомендуется закрыть приложение Спаконсоле. exe.

Перед запуском командлетов Windows PowerShell необходимо зарегистрировать командлеты на компьютере консоли.

**Регистрация командлетов Windows PowerShell**

1.  В командной строке Windows PowerShell с повышенными привилегиями введите **регистерспакмдлетс. cmd**. Появится сообщение **успешное указание командлетов Register Spa** .

2.  Запустите **спа-повершелл. cmd**. Если передать путь в файл сценария Windows PowerShell, он автоматически выполняет скрипты. В противном случае откроется Командная строка Windows PowerShell, которая готова к запуску защищенных командлетов Windows PowerShell.

В следующей таблице описаны командлеты Windows PowerShell для SPA.

| Имя командлета | Параметры | Описание |
| ------ | ------- | ------ |
| Start-Спааналисис | **-ServerName** Имя целевого сервера.<br>**-Адвисорпаккнаме** Полное имя пакета Advisor, добавляемого в очередь на сервере. Если запланировано одновременное выполнение нескольких пакетов, значение параметра должно быть отформатировано как AP1name, AP2name.<br>**— Длительность** Длительность сбора данных.<br>**Учетные данные** Учетные данные пользователя для учетной записи, выполняющей сбор данных на целевом сервере.<br>**-SqlInstanceName** Имя экземпляра SQL Server.<br>**-Склдатабасенаме** Имя базы данных проекта SPA. | Запускает сеанс сбора данных SPA на указанном сервере. |
| Спааналисис | **-SqlInstanceName** Имя экземпляра SQL Server.<br>**-Склдатабасенаме** Имя базы данных проекта SPA.<br>**-ServerName** Имя целевого сервера. | Пытается прерывать выполнение сеанса SPA. Если сеанс уже завершен, он возвращается без выполнения каких-либо действий. |
| Get-Спасервер | **-SqlInstanceName** Имя экземпляра SQL Server.<br>**-Склдатабасенаме** Имя базы данных проекта SPA. | Возвращает список серверов в базе данных. Он возвращает список объектов, включая следующие свойства: Name, Status, Общая папка и замечание. |
| Get-Спаадвисорпаккс | **-SqlInstanceName** Имя экземпляра SQL Server<br>**-Склдатабасенаме** Имя базы данных проекта SPA | Возвращает список пакетов Advisor в базе данных. Он возвращает список объектов, включая следующие свойства: Name, DisplayName, Author и Version. |

Windows PowerShell предоставляет возможность передавать учетные данные через зашифрованные файлы для включения сценариев автоматизации. Дополнительные сведения об использовании зашифрованных файлов для передачи учетных данных командлету см. в разделе [Создание сценариев Windows PowerShell, которые принимают учетные данные](https://technet.microsoft.com/magazine/ff714574.aspx).

### <a name="automating-spa-report-collection-by-using-windows-powershell"></a>Автоматизация сбора отчетов SPA с помощью Windows PowerShell

Следующие процедуры представляют пример автоматизации сбора отчетов SPA с помощью командлетов Windows PowerShell SPA.

Учетные данные пользователя могут быть зашифрованы и кэшированы с помощью Windows PowerShell. Эти учетные данные используются для входа на удаленные серверы. В следующем примере показана эта методика, хотя это не относится к SPA.

``` syntax
$fileName = 'D:\temp\operator.txt'
$userName = 'domainname\operator'
 
# save credential to file
$(Get-Credential).Password | convertFrom-SecureString | Set-Content $fileName
 
# load credential from file
$credential = New-Object System.Management.Automation.PsCredential $userName, $(Get-Content $fileName | convertTo-SecureString)
 
# run command
.\start-SpaAnalysis  ServerName: Server1  Credential: $credential  AdvisorPackName:Microsoft.ServerPerformanceAdvisor.CoreOS.V1 10  Duration:10  SqlInstanceName: .\SQLExpress  SqlDatabaseName:SPA8294
```

Перед запуском этого файла необходимо выполнить команду **Set-ExecutionPolicy remoteSigned**

Его можно запустить из пакетного файла с помощью следующей команды:

``` syntax
PowerShell -command "& '.\RunSpa.ps1' "
```

### <a name="use-t-sql-to-generate-reports"></a>Использование T-SQL для создания отчетов

Данные отчета SPA можно извлечь с помощью SQL для создания пользовательских отчетов, которые не предоставляются в Спаконсоле. exe.

Например, следующая команда T-SQL предоставляет 10 самых основных серверов по ЦП для временных рамок, охватывающих последние три дня:

``` syntax
select TOP 10
   MachineName,
   AverageCpu
FROM (
   select
      __MachineName MachineName,
      AVG(AverageValue) AverageCpu
   FROM [SPA].[Microsoft.ServerPerformanceAdvisor.CoreOS.V1].vwCpuPerformance
   WHERE __Creationtime > dateadd(DAY, -3, GETUTcdate())
      AND Name = N'% Processor time' AND CpuId = N'_Total'
   GROUP BY __MachineName
) t
OrdER BY t.AverageCpu DESC 
```

### <a name="working-with-multiple-projects"></a>Работа с несколькими проектами

В некоторых случаях может потребоваться секционировать SQL Serverные базы данных, используемые SPA. Это может помочь уменьшить размер данных SQL Server базы данных или логически секционировать серверы. В таких случаях консоль SPA поддерживает несколько проектов. Можно создать новую базу данных проекта, щелкнув **файл**, а затем выбрав **создать проект**. При первом запуске мастера откроется новая база данных проекта.

После создания проектов можно нажать кнопку **файл**, а затем выбрать команду **Открыть проект** для переключения между проектами. Консоль SPA не разрешает переключение баз данных при выполнении необработанного анализа производительности в текущем открытом проекте. Это позволяет защитить целостность данных о производительности.

Если вы решили создать новую базу данных проекта или открыть другую базу данных проекта, текущий проект будет закрыт. Все открытые отчеты закрываются при закрытии текущего проекта.

**Примечание** . SQL Server 2008 R2 Express имеет ограничение в 10 ГБ базы данных. Используя несколько проектов, можно использовать одну или несколько баз данных SQL Server и остаться в пределах 10 ГБ SQL Server 2008 R2 Express.

 

### <a name="logging-and-debugging"></a>Ведение журнала и отладка

SPA предоставляет базовые функции ведения журнала. Он позволяет записывать только журналы в файл журнала, который находится в той же папке, что и Спаконсоле. exe. Учетная запись пользователя, которая запускает консоль SPA, должна иметь разрешение на запись в папку, в которой была установлена SPA, чтобы гарантировать возможность записи журналов в файл журнала.

SPA содержит следующие допустимые уровни журнала:

* **Информационные** сообщения Выводит журналы для каждого действия, которое принимает консоль SPA, и в основном предназначено для целей отладки.

* **Предупреждение об ошибке** Записывает в журнал все ошибки и исключения, происходящие в консоли SPA. Некоторые сбои представляют собой ошибки проверки, которые могут быть обработаны консолью SPA.

* **Критическая задача** Записывает в журнал только ошибки и исключения, которые не могут быть обработаны консолью SPA. Эти сбои приводят к сбою консоли SPA. В журналах содержатся сведения о контексте для таких сбоев.

По умолчанию уровень ведения журнала — предупреждение. Это означает, что SPA регистрирует только ошибки и исключения, происходящие в SPA. Уровень журнала можно изменить, отредактировав файл **спаконсоле. exe. config** в той же папке, где находится спаконсоле. exe. Все журналы записываются в файл log. txt в той же папке.

SPA также предоставляет некоторые основные возможности для отладки. Чтобы включить отладку для SPA, пользователям необходимо вручную изменить базу данных проекта SPA. Параметр хранится в таблице конфигураций. Чтобы изменить проект SPA на режим отладки, пользователь должен запустить следующий скрипт SQL:

``` syntax
UPdate [Configurations] SET Value = N'true' WHERE Name = N'Debugmode'.
```

В режиме отладки платформа SPA сохраняет все временные данные, формируемые во время анализа производительности, чтобы можно было устранять неполадки в пакетах Advisor. Этот сценарий в основном предназначен для использования разработчиками пакета Advisor.

Дополнительные сведения о возможностях отладки в SPA см. в статье [рекомендации по разработке пакета советника по производительности сервера](server-performance-advisor-pack-development-guide.md).

### <a name="managing-the-database"></a>Управление базой данных

### <a name="backup-and-restore-the-database"></a>Резервное копирование и восстановление базы данных

Консоль SPA не предоставляет функции для резервного копирования и восстановления базы данных SPA. Для резервного копирования и восстановления баз данных следует использовать стандартные средства и скрипты Microsoft SQL Server.

### <a name="clean-up-the-database"></a>Очистка базы данных

Размер баз данных проекта SPA может увеличиваться по мере выполнения анализа производительности. По умолчанию SPA хранит все отчеты. Для повышения производительности может потребоваться удалить старые отчеты. Отчеты можно удалять с помощью интерфейса **обозревателя отчетов** .

## <a name="privacy-and-security"></a>Конфиденциальность и безопасность


SPA поддерживает только сбор данных с целевых серверов в консоль SPA. Она не предназначена для отправки каких-либо сведений разработчикам Майкрософт и сторонних разработчиков. Дополнительные сведения о конфиденциальности SPA см. в разделе условия лицензионного соглашения на использование программного обеспечения корпорации Майкрософт для советника по производительности сервера.

Все данные, собираемые SPA, хранятся в базах данных проекта. Из-за особенностей некоторых трассировок ETW SPA может сосуществовать конфиденциальные данные, которые могут иметь высокую важность. Вы должны знать о потенциальном риске, связанном с предоставлением общего доступа к базам данных проекта SPA. Временные файлы журналов сохраняются в общих папках, указанных на каждом целевом компьютере. Несмотря на то, что SPA пытается удалить эти временные файлы журналов после завершения импорта данных, нет никакой гарантии, что эти файлы журналов всегда будут удалены. Следует убедиться, что общие папки находятся в безопасном расположении.

Пакеты Advisor для SPA содержат скрипты SQL для анализа и анализа журналов производительности для создания отчетов о производительности. SPA пытается ограничить привилегию, с которой выполняются эти сценарии. Однако по-прежнему существует вероятность, что скрипты могут сосчитать конфиденциальную информацию через SPA от целевых серверов, а также получить или изменить конфиденциальную информацию, хранящуюся в той же базе данных проекта SPA. Необходимо убедиться, что все пакеты Advisor, подготовленные к базе данных проекта SPA, относятся к надежным источникам.

## <a name="errors-and-troubleshooting"></a>Ошибки и устранение неполадок


### <a name="spaconsoleexe-does-not-start-or-write-log-file"></a>Спаконсоле. exe не запускает или не записывает файл журнала

При первой попытке запустить Спаконсоле. exe, если .NET Framework не установлен, приложение не запустится или не запишет файл журнала. Перед запуском SPA убедитесь, что платформа compatible.NET установлена и работает правильно.

### <a name="locating-log-information"></a>Поиск сведений о журнале

SPA хранит сведения об ошибках в файле Log. txt в папке SPA. подробные сообщения об ошибках и стек вызовов записываются в эту папку. Если возникают ошибки, требующие более подробной интерпретации информации, можно открыть файл log. txt, чтобы просмотреть сведения об ошибке.

### <a name="database-size-limitations-for-sql-server-express"></a>Ограничения размера базы данных для SQL Server Express

Размер SQL Server Express ограничен 10 ГБ для пользовательской базы данных. Эта база данных размера имеет емкость для хранения отчетов 20000 – 30000. Чтобы снизить вероятность достижения этого предела базы данных, рекомендуется регулярно удалять отчеты и (или) использовать другую версию SQL Server, не имеющую ограничений на базу данных пользователей размером 10 ГБ.

### <a name="sql-server-express-log-size-and-disk-capacity"></a>SQL Server Express размер журнала и емкость диска

Если используется SQL Server Express, то размер базы данных пользователя ограничен 10 ГБ, но соответствующий файл журнала может превышать 70 ГБ. По этим причинам рекомендуется 100 ГБ или больше свободного места на диске для SQL Server Express. Это место на диске должно быть достаточным для хранения приблизительно 20 000 до 30 000 отчетов. Этот файл журнала называется СПАДБ\_log. ldf и находится в **% Program Files%\\Microsoft SQL Server\\MSSQL10. SQLEXPRESS\\MSSQL\\данных**.

### <a name="failure-to-connect-to-target-server"></a>Не удалось подключиться к целевому серверу

При выполнении анализа производительности на целевых серверах учетная запись пользователя, которая запускает консоль SPA, должна иметь определенные привилегии для установки сборщиком данных в очередь на целевых серверах. Параметры брандмауэра Windows также необходимо изменить, чтобы разрешить передачу данных с помощью PLA. Подробные инструкции по настройке см. в разделе [Настройка SPA](#bkmk-setupspa).

### <a name="failure-to-create-pla-data-collection-set-on-the-target-server"></a>Не удалось создать набор сбора данных PLA на целевом сервере

При получении сообщения о невозможности создания набора сбора данных PLA на целевом сервере выполните следующие действия.

* Убедитесь, что служба " **журналы производительности &** " запущена.

* Параметр безопасности **сетевой доступ: запретить хранение паролей и учетных данных для проверки подлинности сети** . Параметр безопасности должен быть отключен, так как SPA должен использовать учетные данные пользователя для создания набора сбора данных на целевом сервере.

### <a href="" id="running-spa-against-the-console-"></a>Запуск SPA для консоли

PLA проходит через другой канал, если целевой сервер совпадает с консолью SPA. Даже если учетная запись пользователя запускает консоль SPA с правами администратора, PLA завершается ошибкой. Если консоль SPA установлена на целевом сервере, пользователям необходимо запустить SPA с правами администратора, чтобы убедиться, что задача анализа производительности может запускаться в консоли.

### <a name="running-multiple-consoles-at-the-same-time"></a>Одновременное выполнение нескольких консолей

SPA не поддерживает несколько консолей, работающих одновременно с одной базой данных проекта SPA. SPA также не предоставляет механизм блокировки и синхронизации, чтобы предотвратить его возникновение. Если одновременно выполняются две консоли SPA, консоль будет работать непоследовательно в зависимости от последовательности времени, в которой работают эти консоли SPA. Чтобы избежать этого, все сеансы анализа производительности в очереди должны быть удалены из списка перед обработкой консолью, запускающей анализ.

SPA защищает целостность каждого отчета, успешно сформированного с помощью SPA. в то же время SPA не гарантирует, что все задачи анализа, поставленные в очередь, завершаются. Если вы видите непротиворечивые изменения состояния для сеансов анализа производительности или ошибок, которые привели к тому, что системе не удается найти журналы производительности, созданные группой сборщиков данных, скорее всего, это вызвано несколькими экземплярами консоли SPA, работающих с одним и тем же База данных проекта SPA.

На выполнение защищенных командлетов Windows PowerShell также может повлиять консоль SPA, работающая с той же базой данных SPA. Рекомендуется закрыть консоль SPA перед запуском командлетов Windows PowerShell SPA.

### <a name="spaconsoleexe-recurring-collection-is-disrupted"></a>Повторяющаяся коллекция Спаконсоле. exe прервана

При запуске Спаконсоле. exe и использовании повторяющегося сбора данных (например, в почасовой коллекции) сервер, на котором работает Спаконсоле. exe, не должен находиться в режиме энергосбережения, чтобы его можно было приостановить. SPA не проверяет политику энергосбережения. Это приостановленное действие может привести к нарушению регулярного сбора повторяющихся данных.

### <a name="lost-etw-events"></a>Потерянные события ETW

Чтобы создать минимальное воздействие на производительность целевых серверов, в процессе сбора сведений о производительности PLA разрабатывается с низким приоритетом. Если целевой сервер занят, PLA может удалить некоторые задачи сбора данных, чтобы обеспечить выполнение задач с высоким приоритетом, которые выполняются на целевых серверах. Следует подумать о настройке общей папки, в которой события записываются на диск, который не конфликтует с рабочей нагрузкой, или с более быстрым диском, например SSD. Когда события отбрасываются, они выводятся в представлении отчета, так как потерянные события могут повлиять на надежность созданных метрик производительности.

Некоторые проблемы с разрешениями также могут привести к пропуску запросов реестра или инструментария WMI. Однако это гораздо менее вероятно, чем потери событий ETW. В результате группа сборщиков данных иногда не содержит все запрошенные значения. Необходимо убедиться, что ситуация обрабатывается скриптами T-SQL для всех пакетов Advisor. Если данные не существуют в результате сбора данных, они помечаются как не имеющие данных в отчетах.

Так как события трассировки событий Windows являются общими для PLA, точки данных, созданные на основе трассировки ETW, могут не соответствовать точкам данных, созданным на основе, например счетчиков производительности. Например, можно увидеть, что общее использование ЦП службами IIS составляет 80% (то есть счетчики производительности), а верхние URL-адреса используют только 10% всего времени ЦП (то есть точки данных, поступающих из трассировки ETW). Обычно источник данных для одной точки данных можно просмотреть с помощью всплывающей подсказки точки данных. Следует помнить о влиянии такой потери данных.

Чтобы избежать потери данных событий, необходимо закрыть папку результатов на целевом сервере.

Если результаты сборщика данных содержат неполные данные, отличные от потерь трассировки ETW, а разработчик пакета Advisor добавил поддержку уведомления о потере событий ETW, информационная панель отображается поверх одного отчета, чтобы уведомить пользователя о потенциальном непоследовательный отчет, вызванный потерей данных. подробные сведения о потери данных можно найти в файле Log. txt.

## <a name="glossary"></a>Словарь терминов


Ниже приведены некоторые термины, используемые в SPA:

* **Пакет Advisor** Коллекция метаданных и скриптов T-SQL, которые обрабатывают журналы производительности, собранные с целевого сервера. Затем пакет Advisor создает отчеты на основе данных журнала производительности. Метаданные в пакете Advisor определяют данные, которые должны быть собраны с целевого сервера для измерения производительности. Метаданные также определяют набор правил, пороговые значения и формат отчета. Чаще всего пакет Advisor написан специально для одной роли сервера, например службы IIS (IIS).

* **Консоль Spa** Спаконсоле. exe — Центральная часть SPA. SPA не требуется запускать на тестируемом целевом сервере. Консоль SPA содержит все пользовательские интерфейсы для SPA, от настройки проекта до выполнения анализа и просмотра отчетов. По разработке, SPA является двусторонним приложением. Консоль SPA содержит слой пользовательского интерфейса и часть уровня бизнес-логики. Консоль SPA планирует и обрабатывает запросы на анализ производительности.

* **Платформа Spa** Предоставляет все пользовательские интерфейсы, обработку журналов производительности, конфигурацию, обработку ошибок, API-интерфейсы базы данных и процедуры управления.

* **Проект Spa** База данных, содержащая все сведения о целевых серверах, пакетах Advisor и отчетах анализа производительности, которые создаются на целевых серверах для пакетов Advisor. Вы можете сравнивать и просматривать журналы и тенденции в рамках одного проекта SPA. Можно создать более одного проекта. Проекты SPA независимы друг от друга и не имеют общих данных для проектов.

* **Целевой сервер** Физический компьютер или виртуальная машина под управлением Windows Server с определенными ролями сервера, такими как IIS.

* **Сеанс анализа данных** Анализ производительности на указанном целевом сервере. Сеанс анализа данных может включать несколько пакетов Advisor. Наборы сборщиков данных из этих пакетов Advisor объединяются в единый набор сборщиков данных. Все журналы производительности для одного сеанса анализа данных собираются в один и тот же период времени. Анализ отчетов, созданных пакетами Advisor, выполняющимися в одном сеансе анализа данных, может помочь пользователям понять общую ситуацию с производительностью и определить основные причины проблем с производительностью.

* **Трассировка событий для Windows** Высокопроизводительная, экономичная и масштабируемая система трассировки, предоставляемая в Windows. Он предоставляет возможности профилирования и отладки, которые можно использовать для устранения неполадок в различных сценариях. SPA использует события ETW в качестве источника данных для создания отчетов о производительности. Общие сведения о ETW см. [в статье улучшение отладки и настройка производительности с помощью ETW](https://msdn.microsoft.com/magazine/cc163437.aspx).

* **Инструментарий управления Windows (WMI) (WMI)** Инфраструктура для данных управления и операций в Windows. Можно создавать сценарии или приложения WMI для автоматизации задач администрирования на удаленных компьютерах. Инструментарий WMI также предоставляет данные управления другим частям операционной системы и продуктам. SPA использует сведения о классе WMI и точки данных в качестве источников для создания отчетов о производительности.

* **Счетчики производительности** Используется для предоставления сведений о том, насколько хорошо выполняется операционная система или приложение, служба или драйвер. Данные счетчиков производительности позволяют определить узкие места системы и настроить производительность системы и приложений. Операционная система, сеть и устройства предоставляют данные счетчиков, которые приложение может использовать для предоставления пользователям графического представления о том, насколько хорошо работает система. SPA использует сведения о счетчиках производительности и точки данных в качестве источников для создания отчетов о производительности.

* **Журналы и оповещения производительности (PLA)** Собирает журналы и трассировки производительности и создает предупреждения о производительности при выполнении определенных триггеров. PLA можно использовать для получения счетчиков производительности, трассировки событий Windows (ETW), запросов WMI, разделов реестра и файлов конфигурации. PLA также поддерживает удаленный сбор данных с помощью удаленных вызовов процедур (RPC). Пользователь определяет группу сборщиков данных, которая содержит сведения о собираемых данных, частоте сбора данных, продолжительности сбора данных, фильтрах и расположении для сохранения файлов результатов. SPA использует PLA для получения всех данных о производительности целевых серверов.

* **Один отчет** Отчет SPA, созданный на основе одного сеанса анализа данных для одного пакета Advisor на одном целевом сервере. Он может содержать уведомления и различные разделы данных.

* **Параллельный отчет** Отчет SPA, сравнивающий два отдельных отчета для одного и того же пакета Advisor. Эти два отчета могут формироваться с разных целевых серверов или из отдельных запусков анализа производительности на одном целевом сервере. Параллельный отчет создает возможность сравнить два отчета, чтобы помочь пользователям определить аномальное поведение или параметры в одном из отчетов. Параллельный отчет содержит уведомления и различные разделы данных. В каждом разделе данные из обоих отчетов отображаются рядом друг с другом.

* **Диаграмма тенденций** Отчет SPA, который используется для исследования повторяющихся закономерностей проблем с производительностью. Многие повторяющиеся проблемы с производительностью вызваны тем, что запланированные серверные изменения загружаются с сервера или с клиентских компьютеров, что может происходить ежедневно или еженедельно. SPA обеспечивает 24-часовой график тренда и диаграмму тенденций за семь дней для выявления этих проблем.

    Пользователь может выбрать один или несколько рядов данных за раз, то есть числовое значение в рамках одного отчета, например **среднее общее использование ЦП**. точнее говоря, числовое значение — это скалярное значение от одного сервера, созданного одним ТД в определенный экземпляр времени. SPA группирует эти значения в 24 группы, по одному на каждый час дня (семь для отчета в течение 7 дней, по одному на каждый день недели). SPA вычисляет средние, минимальные, максимальные и стандартные отклонения для каждой группы.

* **Историческая диаграмма** Отчет SPA, который используется для отображения изменений определенных числовых значений в отдельных отчетах для заданной пары "сервер-пакет" с течением времени. Пользователь может выбрать несколько рядов данных и отобразить их вместе на исторических диаграммах, чтобы понять корреляцию между разными рядами данных.

* **Ряд данных** Числовые данные, собираемые из одного источника данных за определенный период времени. Один и тот же источник означает, что данные должны поступать с одного целевого сервера, например средней длины очереди запросов для служб IIS на одном сервере.

* **Правила** Сочетания логики, пороговых значений и описаний. Они представляют потенциальную угрозу производительности. Каждый пакет Advisor содержит несколько правил. Каждое правило запускается процессом создания отчета. Правило применяет логику и пороговые значения к данным в отдельном отчете. Если условия соблюдены, выдается предупреждающее уведомление. В противном случае для уведомления задается состояние **ОК** . Если правило не применяется, уведомление устанавливается в состояние Неприменимо (**НД**).

* **Уведомления** Сведения, которые отображаются в правиле пользователям. Он включает в себя состояние правила (**ОК**, **НД**или **предупреждение**), имя правила и возможные рекомендации для устранения проблем с производительностью.
