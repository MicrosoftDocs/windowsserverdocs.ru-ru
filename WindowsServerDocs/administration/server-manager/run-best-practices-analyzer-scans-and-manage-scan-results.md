---
title: Запуска наиболее проверок анализатором соответствия рекомендациям и управление ими Results_1 сканирования
description: Диспетчер серверов
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-server-manager
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 232f1c80-88ef-4a39-8014-14be788c2766
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 58fdf35e1d06fe7176b122155b2768094f2b01b4
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59838225"
---
# <a name="run-best-practices-analyzer-scans-and-manage-scan-results"></a>Запуск проверок анализатором соответствия рекомендациям и управление результатами проверок

>Область применения. Windows Server 2016

В управлении Windows *рекомендации* — это инструкции по настройке сервера, которые эксперты считают наилучшими в обычных условиях. Например, для большинства серверных технологий считается оптимальным сохранять открытыми только порты, необходимые для обмена данными с другими компьютерами сети, и блокировать неиспользуемые порты. Хотя нарушение рекомендаций, даже очень важных, необязательно представляет собой проблему, они указывают конфигурации сервера, которые могут привести к снижению производительности и надежности, непредвиденным конфликтам, повышению рисков для безопасности и другим потенциальным неполадкам.

Лучшие анализатора соответствия рекомендациям (BPA) — это средство управления сервером, который доступен в Windows Server 2012 R2, Windows Server 2012 и Windows Server 2008 R2. BPA помогает администраторам уменьшить число нарушений рекомендаций, выполняя проверку ролей, установленных на управляемых серверах, работающих под управлением Windows Server 2012 или Windows Server 2008 R2 и сообщая о нарушении рекомендаций для администратора.

Запуском проверок рекомендации анализатора соответствия рекомендациям (BPA) либо из диспетчера сервера с помощью графического пользовательского интерфейса Анализатора, или с помощью командлетов Windows PowerShell. начиная с Windows Server 2012, вы можете отсканировать одну или несколько ролей одновременно на нескольких серверах ли вы использовать плитки анализатора соответствия рекомендациям в консоли диспетчера серверов или командлетах Windows PowerShell для выполнения проверок. Также в анализаторе соответствия рекомендациям можно задать исключение или игнорирование результатов проверки, которые не нужно отображать.

Эта статья содержит следующие разделы.

-   [Местонахождение анализатора соответствия Рекомендациям](#BKMK_find)

-   [Как работает анализатор соответствия Рекомендациям](#BKMK_how)

-   [Проверка ролей анализатором соответствия рекомендациям](#BKMK_BPAscan)

-   [Управление результатами проверок](#BKMK_manage)

## <a name="BKMK_find"></a>Местонахождение анализатора соответствия Рекомендациям
На плитке анализатора соответствия рекомендациям можно найти на роль и страницы группы сервера диспетчера серверов в Windows Server 2012 R2 и Windows Server 2012. также можно открыть сеанс Windows PowerShell с повышенными правами, чтобы выполнить командлеты анализатора соответствия рекомендациям.

## <a name="BKMK_how"></a>Как работает анализатор соответствия Рекомендациям
Анализатор соответствия рекомендациям путем измерения для роли соответствия рекомендациям по восьми категориям эффективности, достоверности и надежности. Результатом такого измерения является один из трех уровней серьезности, которые описаны в следующей таблице.

|Уровень серьезности|Описание|
|---------|--------|
|Ошибка|Результат "Ошибка" возвращается в том случае, если роль не удовлетворяет условиям некоторого правила рекомендаций, в результате чего можно ожидать проблем с работоспособностью.|
|Информация|Результат "Информация" возвращается в том случае, если роль удовлетворяет условиям правила.|
|Предупреждение|Результат "Предупреждение" возвращается в том случае, если несоответствие может привести к проблемам, если не будут сделаны изменения. В настоящий момент роль может соответствовать условиям правила, но может утратить это соответствие, если не внести изменения в ее конфигурацию или параметры политики. Например, проверка служб удаленных рабочих столов может выдать результат "Предупреждение", если сервер лицензирования недоступен для роли, поскольку, даже если во время проверки нет активных удаленных подключений, отсутствие сервера лицензирования не позволяет новым удаленным подключениям получить действующие лицензии на клиентский доступ.|

### <a name="rule-categories"></a>Категории правил
В следующей таблице описаны категории правил рекомендаций для роли, которые оцениваются во время анализатор соответствия рекомендациям для сканирования.

|Название категории|Описание|
|---------|--------|
|Безопасность|Правила безопасности применяются для оценки роли относительного риска угроз, таких как неавторизованный или злонамеренный пользователь, потеря или кража конфиденциальных и личных данных.|
|Производительность|Правила производительности применяются для оценки способности роли обрабатывать запросы и выполнять свои обязанности на предприятии в ожидаемые сроки, исходя из рабочей нагрузки роли.|
|Конфигурация|Правила конфигурации применяются для определения параметров роли, изменение которых может потребоваться для оптимального функционирования роли. Правила конфигурации помогают предотвратить конфликты параметров, которые могут привести к появлению сообщений об ошибках или помешать роли выполнять назначенные функции на предприятии.|
|Политика|Правила политики применяются для определения параметров реестра групповой политики или Windows, которые могут потребовать изменений для оптимальной и безопасной работы роли.|
|Операция|Правила использования применяются для выявления возможных сбоев при выполнении назначенных задач роли на предприятии.|
|Перед развертыванием|Правила перед развертыванием применяются до того, как установленная роль будет развернута на предприятии. Они позволяют администраторам оценивать, соблюдены ли рекомендации, до использования роли на производстве.|
|После развертывания|Правила после развертывания применяются после того, как все необходимые для роли службы будут запущены, и роль начнет выполняться на предприятии.|
|Предварительные требования|Правила необходимых условий поясняют, какие параметры конфигурации, параметры политик и компоненты необходимы для роли, прежде чем анализатор будет применять конкретные правила из прочих категорий. Необходимое условие в результатах проверки указывает на неверный параметр, отсутствующую программу, неправильно включенную или отключенную политику, параметр раздела реестра или другие особенности конфигурации, из-за которых анализатору соответствия рекомендациям не удается применить одно или несколько правил во время проверки. Необходимое условие в результатах не означает соответствия или несоответствия. Оно говорит лишь о том, что правило нельзя применить, и поэтому не входит в результаты проверки.|

## <a name="BKMK_BPAscan"></a>Проверка ролей анализатором соответствия рекомендациям
Выполнением проверок анализатором соответствия рекомендациям для ролей либо при помощи графического пользовательского интерфейса Анализатора в диспетчере серверов или с помощью командлетов Windows PowerShell.

В Windows Server 2012 R2 и Windows Server 2012 некоторые роли предлагается задать дополнительные параметры, такие как имена конкретных серверов или общих ресурсов, которые работают части роли, или идентификаторы подмоделей, перед началом проверки анализатором соответствия Рекомендациям. В случае проверки анализатором соответствия рекомендациям моделей, требующих задавать дополнительные параметры, используйте командлеты BPA; пользовательский интерфейс анализатора соответствия рекомендациям не поддерживает дополнительные параметры, такие как идентификаторы подмоделей. Например, идентификатор подмодели **FSRM** представляет подмодель файловых служб BPA для диспетчера ресурсов файлового сервера — службу роли файловых служб и служб хранилища. Чтобы выполнить проверку только на службу роли диспетчера ресурсов файлового сервера необходимо выполнить проверку анализатором соответствия Рекомендациям с помощью командлетов Windows PowerShell и добавьте параметр `SubmodelId` командлета.

Несмотря на то, что нельзя задать дополнительные параметры для проверки, запускаемой из графического пользовательского интерфейса Анализатора, на плитке Анализатора в диспетчере серверов отображаются результаты последней проверки анализатором соответствия Рекомендациям, независимо от того, как она была запущена.

-   [Проверка ролей при помощи графического интерфейса пользователя анализатора соответствия Рекомендациям](#BKMK_GUIscan)

-   [Проверка ролей при помощи командлетов Windows PowerShell](#BKMK_PSscan)

### <a name="BKMK_GUIscan"></a>Проверка ролей при помощи графического интерфейса пользователя анализатора соответствия Рекомендациям
Для проверки одной роли в графическом интерфейсе пользователя анализатора соответствия рекомендациям выполните следующие действия.

##### <a name="to-scan-roles-by-using-the-bpa-gui"></a>Проверка роли при помощи графического интерфейса пользователя анализатора соответствия рекомендациям

1.  Выполните одно из следующих действий, чтобы открыть диспетчер сервера, если он еще не открыт.

    -   На панели задач Windows нажмите кнопку диспетчера сервера.

    -   На **запустить** щелкните плитку Диспетчер серверов.

2.  В области переходов откройте страницу роли или группы.

    При проверке анализатором соответствия рекомендациям, которая выполняется со страницы роли или группы, проверяются все роли, установленные на серверах этой группы.

3.  На **задачи** меню **анализатор соответствия рекомендациям** плитку, щелкните **начать проверку BPA**.

4.  В зависимости от количества правил, соответствие которым оценивается для выбранной роли или группы, проверка может занять несколько минут.

### <a name="BKMK_PSscan"></a>Проверка ролей при помощи командлетов Windows PowerShell
Используйте следующие процедуры для проверки одной или нескольких ролей при помощи командлетов Windows PowerShell.

> [!NOTE]
> В процедурах данного раздела показаны не все командлеты и параметры анализатора соответствия рекомендациям. Дополнительные сведения о работе с анализатором соответствия Рекомендациям в Windows PowerShell, в сеансе Windows PowerShell, введите **Get-help***BPACmdlet***-полный**, где *BPACmdlet* может принимать одно из следующих значений. Можно также найти разделы справки по командлетам BPA на [техническом центре Windows Server](https://go.microsoft.com/fwlink/p/?LinkId=240177).

-   **Get-BPAmodel**

-   **Invoke-BPAmodel**

-   **Get-BPAResult**

-   **Set-BPAResult**

#### <a name="BKMK_singlerole"></a>Для проверки одной роли с помощью командлетов Windows PowerShell

1.  Выполните одно из следующих действий, чтобы запустить Windows PowerShell с повышенными правами пользователя.

    -   Запуск Windows PowerShell от имени администратора **запустить** щелкните правой кнопкой мыши **Windows PowerShell** плитку в **приложений** результатов, а затем на панели приложения щелкните **Запуск от имени администратора**.

    -   Чтобы запустить Windows PowerShell с правами администратора с рабочего стола, щелкните правой кнопкой мыши **Windows PowerShell** ярлык в панели задач, а затем нажмите кнопку **Запуск от имени администратора**.

2.  начиная с Windows PowerShell 3.0, модули командлетов автоматически импортируются в сеанс Windows PowerShell при первом использовании командлета из модуля. Импортировать или загружать модуль командлетов анализатора соответствия рекомендациям не требуется.

3.  найти идентификаторы моделей для всех ролей анализатором соответствия рекомендациям можно выполнить проверку, введя **Get-Bpamodel** командлет, как показано в следующем примере.

    `Get-Bpamodel`

4.  В результатах выполнения шага 3 найдите идентификаторы моделей ролей, которые нужно проверить анализатором соответствия рекомендациям.

5.  Чтобы запустить проверку конкретной роли анализатором соответствия рекомендациям, введите любую из следующих команд: В случае нескольких ролей разделяйте идентификаторы моделей запятыми.

    `Invoke-BPAmodel -modelId <modelID_from_Step3>`

    `Invoke-BPAmodel <modelID_from_Step3>`

    **Пример:**`Invoke-BPAmodel -modelId Microsoft/Windows/DNSServer,Microsoft/Windows/FileServices`

    > [!NOTE]
    > Идентификатор модели содержит весь путь, который отображается в столбце **Id** — например **Microsoft/Windows/Hyper-V**.

    Можно также запустить проверку конкретной роли из результатов шага 3, направив результаты выполнения командлета `Get-BPAmodel` по конвейеру в командлет `Invoke-BPAmodel` , как показано в следующем примере.

    `Get-BPAmodel <model_ID> | Invoke-BPAmodel`

    Запустить этот командлет без указания идентификатора модели передает все модели, возвращаемые `Get-BPAmodel` командлета в `Invoke-BPAmodel` командлета, запуском проверки всех моделей, доступных на серверах, которые были добавлены в пул серверов диспетчера серверов.

#### <a name="BKMK_allroles"></a>Проверка всех ролей с помощью командлетов Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя, если он еще не открыт. Инструкции см. в описании предыдущей процедуры.

2.  Для запуска проверок BPA передайте в командлет `Invoke-BPAmodel` по конвейеру все роли, для которых можно выполнить проверку анализатором соответствия рекомендациям.

    `Get-BPAmodel | Invoke-BPAmodel`

3.  Когда сканирование будет закончено, Windows PowerShell возвратит результаты, аналогичные приведенному ниже, для каждой роли, которое было просмотрено.

    ```
    modelId                 :  Microsoft/Windows/FileServices
    SubmodelId              :
    Success                 :  True
    Scantime                :  1/01/2012  12:18:40 PM
    ScantimeUtcOffset       :  -08:00:00
    detail                  :  {server_name1, server_name2}

    ```

## <a name="BKMK_manage"></a>Управление результатами проверок
После выполнения проверки в графическом интерфейсе анализатора соответствия рекомендациям можно просмотреть результаты проверки на плитке анализатора. Когда пользователь выбирает какой-либо результат на плитке, в области просмотра на этой плитке отображаются свойства результата, в том числе сведения о том, удовлетворяет ли роль соответствующей рекомендации. Если результат не соответствует требованиям, и вы хотите знать, как устранить проблемы, описанные в свойствах результата, по гиперссылкам в ошибки и предупреждение свойства результата открываются подробные разделы справки технического центра Windows Server.

> [!NOTE]
> Результаты проверки анализатором соответствия рекомендациям не сохраняются и не архивируются автоматически. При запуске новой проверки модели или подмодели результаты предыдущей проверки теряются. О том, как сохранить результаты проверки анализатором соответствия рекомендациям для архивации, печати или пересылки другим пользователям, см. статью [Просмотр результатов BPA из сеансов Windows PowerShell в различных форматах](#BKMK_formats) в этом разделе.

### <a name="exclude-and-include-bpa-results"></a>Исключение и включение результатов BPA
Если необходимо просмотреть некоторые результаты BPA, например результаты, которые часто встречаются в проверке, но требуют решения нет, можно исключить эти результаты, с помощью графического пользовательского интерфейса Анализатора или командлеты анализатора соответствия Рекомендациям в Windows PowerShell. В любое время эти результаты можно будет включить снова.

> [!NOTE]
> Исключенные результаты также скрываются от просмотра на управляемых серверах. Другие администраторы не могут видеть исключенные результаты на управляемых серверах. Чтобы исключить результаты из представления только локальной консоли диспетчера сервера, создайте пользовательский запрос, вместо использования **исключить результат** команды.

#### <a name="BKMK_exclude"></a>Исключить результаты проверки
Параметр **Исключить** действует постоянно: исключенные результаты остаются таковыми при дальнейших проверках той же модели на том же компьютере, пока не будут снова включены.

Исключить результаты проверки можно с помощью командлета `Set-BPAResult` с параметром `Exclude` . Как и в плитке, анализатор соответствия рекомендациям в диспетчере сервера можно исключить отдельные объекты результатов, или можно также исключить набор результатов, поля которых (категория, заголовок и серьезность, например) равны или содержат определенные значения. Например, можно исключить все результаты **Производительность** из набора результатов проверки роли.

> [!NOTE]
> Чтобы использовать процедуры, описанные в этом разделе, необходимо выполнить хотя бы одну проверку модели анализатором соответствия рекомендациям.

###### <a name="to-exclude-scan-results-by-using-the-gui"></a>Исключение результатов проверки при помощи графического интерфейса анализатора соответствия рекомендациям

1.  Откройте страницу групп ролей или серверов в диспетчере сервера.

2.  На плитке анализатора соответствия рекомендациям для роли или группы серверов, щелкните правой кнопкой мыши результат в списке и нажмите кнопку **исключить результат**.

    Этот результат не будет отображаться в списке результатов.

3.  Чтобы просмотреть исключенные результаты в графическом интерфейсе пользователя, запустите встроенный запрос **Исключенные результаты** . Щелкните **Сохраненные условия поиска**, а затем **Исключенные результаты**.

    После выполнения запроса **Исключенные результаты** обратите внимание, что текст подзаголовка плитки с описанием отображаемых в списке результатов поменялся на **Исключенные результаты**. В этом списке фигурируют только исключенные результаты.

###### <a name="to-exclude-scan-results-by-using-windows-powershell-cmdlets"></a>Исключение результатов проверки при помощи командлетов Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя.

2.  Исключите конкретные результаты из проверки модели путем запуска следующей команды.

    `Get-BPAResult -modelId <model ID> | Where { $_.<Field Name> -eq "Value"} | Set-BPAResult -Exclude $true`

    Предыдущая команда извлекает элементы результатов проверки анализатором соответствия Рекомендациям для идентификатора модели, представленного *модели идентификатор*.

    Второй сегмент команды фильтрует результаты командлета `Get-BPAResult` , отбирая из них только те результаты проверки, для которых значение поля, представленного заполнителем *Имя поля*, совпадает с текстом в кавычках.

    Заключительная часть команды, стоящий после второго знака вертикальной черты, исключает результаты, отобранные предыдущим сегментом командлет.

    **Пример:**`Get-BPAResult -Microsoft/Windows/FileServices | Where { $_.Severity -eq "Information"} | Set-BPAResult -Exclude $true`

#### <a name="include-scan-results"></a>Включение результатов проверки
Если требуется, чтобы ранее исключенные результаты проверки снова отображались, можно их включить. Параметр **Включить** действует постоянно: включенные результаты остаются таковыми при дальнейших проверках той же модели на том же компьютере.

##### <a name="BKMK_gui"></a>Включение результатов проверки с помощью графического пользовательского интерфейса

1.  Откройте страницу групп ролей или серверов в диспетчере сервера.

2.  На плитке анализатора соответствия рекомендациям для роли или группы серверов, щелкните правой кнопкой мыши исключенный результат в **исключенные результаты** списке запроса, а затем нажмите кнопку **включить результат**.

    Этот результат более не будет отображаться в списке исключенных результатов. Очистите запрос, щелкнув **Очистить все** , чтобы увидеть включенный результат в списке всех включенных результатов.

##### <a name="BKMK_cmdlets"></a>Включение результатов проверки с помощью командлетов Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя.

2.  Включите конкретные результаты проверки модели, введя следующую команду и нажав клавишу **ВВОД**:

    `Get-BPAResult -modelId <model Id> | Where { $_.<Field Name> -eq "Value" } | Set-BPAResult -Exclude $false`

    Предыдущая команда извлекает элементы результатов проверки анализатором соответствия Рекомендациям для модели, представленной *модели идентификатор*.

    Вторая часть команды, после первого знака вертикальной черты ( **|** ) фильтрует результаты **Get-BPAResult** командлета, отбирая только те результаты проверки, для которого значение результата поля, представленного *имя поля*, совпадает с текстом в кавычках.

    После второго знака вертикальной черты последний сегмент команды включает результаты, отобранные вторым сегментом. Для этого в качестве значения параметра **-Exclude** устанавливается **false**.

    **Пример:**`Get-BPAResult -Microsoft/Windows/FileServices | Where { $_.Severity -eq "Information"} | Set-BPAResult -Exclude $false`

### <a name="view-and-export-bpa-scan-results-in-windows-powershell"></a>Просмотр и экспорт результатов проверки анализатором соответствия рекомендациям в Windows PowerShell
Чтобы просмотреть и управлении результатами проверки с помощью командлетов Windows PowerShell, см. ниже. Чтобы использовать процедуры, приведенные в этом разделе, необходимо выполнить хотя бы одну проверку модели или подмодели анализатором соответствия рекомендациям.

#### <a name="BKMK_recentPS"></a>Чтобы просмотреть результаты последней проверки роли с помощью Windows PowerShell

1.  Откройте сеанс Windows PowerShell с повышенными правами пользователя.

2.  Получите результаты последней проверки для заданного идентификатора модели. Введите следующую строку, в котором модель представлена *модели идентификатор*, а затем нажмите клавишу **ввод**. Можно получить результаты для нескольких моделей, разделив идентификаторы моделей запятыми.

    `Get-BPAResult <model ID>`

    **Пример:** `Get-BPAResult Microsoft/Windows/DNSServer,Microsoft/Windows/FileServices`

    Если подмодели модели, такие как служба роли, получите результаты только для данной подмодели, включая идентификатор подмодели в командлете.

    **Пример:** `Get-BPAResult Microsoft/Windows/FileServices -SubmodelID FSRM`

#### <a name="BKMK_formats"></a>Просмотр или сохранение результатов BPA из сеансов Windows PowerShell в различных форматах

-   В Windows PowerShell каждый результат BPA имеет следующий вид.

    ```
    ResultNumber     :  14
    ResultId         :  1557706192
    modelId          :  Microsoft/Windows/FileServices
    SubmodelId       :  FSRM
    RuleId           :  16
    computerName     :  server_name1, server_name2
    Context          :  FileServices
    Source           :  server_name1
    Severity         :  Information
    Category         :  Configuration
    Title            :  Access Denied remediation requires remote management be enabled on this server
    Problem          :
    Impact           :
    Resolution       :
    compliance       :  The File Server Best Practices Analyzer scan has determined that you are in compliance with this best practice.
    help             :
    Excluded         :  False

    ```

    Выполните одно из указанных ниже действий.

    -   Чтобы представить результаты BPA в табличном виде, запустите следующий командлет, добавив интересующие вас свойства результата из предыдущего примера.

        `Get-BPAResult model ID | format-Table -Property <property1,property2,property3...>`

        **Пример:**`Get-BPAResult Microsoft/Windows/FileServices | format-Table -Property modelId,SubmodelId,computerName,Source,Severity,Category,Title,Problem,Impact,Resolution,compliance,help`

    -   Чтобы отобразить результаты BPA в сетке графического интерфейса с фильтром по текстовой строке и заголовками столбцов, которые можно щелкать для сортировки, запустите следующий командлет.

        `Get-BPAResult <model ID> | OGV`

    -   Чтобы экспортировать результаты BPA в HTML-файле, который можно архивировать или отправить по электронной почте, запустите следующий командлет, где *путь* представляет путь к файлу и имя, к которому вы хотите сохранить результаты.

        `Get-BPAResult <model ID> | convertTo-Html | Set-Content <path>`

        **Пример:**`Get-BPAResult Microsoft/Windows/FileServices | convertTo-Html | Set-Content C:\BPAResults\FileServices.htm`

    -   Чтобы экспортировать результаты BPA в текстовый файл значений с разделителями запятыми (CSV), выполните следующий командлет, где *путь* представляет путь и имя файла, к которому вы хотите сохранить результаты в формате CSV. Результаты в формате CSV можно импортировать в Microsoft Excel или другие программы, которые отображают данные в таблицах и сеток.

        `Get-BPAResult <model ID> | Export-CSV <path>`

        **Пример:**`Get-BPAResult Microsoft/Windows/FileServices | Export-CSV C:\BPAResults\FileServices.txt`

## <a name="see-also"></a>См. также
[Анализатор соответствия рекомендациям для разрешения материалы по Windows Server TechCenter](https://go.microsoft.com/fwlink/p/?LinkId=241597)
[фильтрация, сортировка и запрос данных в плитках диспетчера серверов](filter-sort-and-query-data-in-server-manager-tiles.md)
[Manage Multiple, remote Servers с помощью диспетчера серверов](manage-multiple-remote-servers-with-server-manager.md)
