---
title: Установка и удаление ролей, служб ролей и компонентов
description: Диспетчер серверов
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-server-manager
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 04f16d84-45c2-4771-84c1-1cc973d0ee02
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 32d356b3ae70b7b15f23a40247e73b4b8f61c3db
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59822375"
---
# <a name="install-or-uninstall-roles-role-services-or-features"></a>Установка и удаление ролей, служб ролей и компонентов

>Область применения. Windows Server (полугодовой канал), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В Windows Server консоли Server Manager и командлеты Windows PowerShell для диспетчера сервера поддерживают установку ролей и компонентов на локальном или удаленном сервере, или автономные виртуальные жесткие диски (VHD). Можно установить несколько ролей и компонентов на одном удаленном сервере или автономный виртуальный жесткий ДИСК в одном добавьте мастера ролей и компонентов или сеанса Windows PowerShell.  
  
> [!IMPORTANT]  
> Диспетчер серверов нельзя использовать для управления более новыми выпусками операционной системы Windows Server. Диспетчер серверов, работающих под управлением Windows Server 2012 R2 или Windows 8.1 не может использоваться для установки ролей, служб ролей и компонентов на серверах, работающих под управлением Windows Server 2016.  
  
Вы должны войти на сервер с правами администратора для установки или удаления ролей, служб ролей и компонентов. Если вы вошли на локальный компьютер с учетной записью, не имеющей прав администратора на целевом сервере, щелкните правой кнопкой мыши целевой сервер на плитке **Серверы**, выберите **Управлять как** и укажите учетную запись с правами администратора. Сервер, на котором требуется подключить автономный виртуальный жесткий диск, должен быть добавлен в диспетчер серверов. На таком сервере нужны права администратора.  
  
Дополнительные сведения о ролей, служб ролей и компонентов, см. в разделе [ролей, служб ролей и компонентов](https://go.microsoft.com/fwlink/p/?LinkId=239558).  
  
Эта статья содержит следующие разделы.  
  
-   [Установка ролей, служб ролей и компонентов с помощью Добавить роли и функции мастера](#BKMK_installarfw)  
  
-   [Установка ролей, служб ролей и компонентов при помощи командлетов Windows PowerShell](#BKMK_installwps)  
  
-   [Удаление ролей, служб ролей и компонентов с помощью remove мастера ролей и компонентов](#BKMK_removerrfw)  
  
-   [Удаление ролей, служб ролей и компонентов при помощи командлетов Windows PowerShell](#BKMK_removewps)  
  
-   [Установка ролей и компонентов на нескольких серверах при помощи сценария Windows PowerShell](#BKMK_batch)  
  
-   [Установка .NET Framework 3.5 и других компонентов по требованию](#BKMK_FoD)  
  
## <a name="BKMK_installarfw"></a>Установка ролей, служб ролей и компонентов с помощью Добавить роли и функции мастера  
В одном сеансе мастера компонентов и добавить роли можно установить ролей, служб ролей и компонентов на локальном сервере, удаленном сервере, которая была добавлена в диспетчер серверов или автономный виртуальный жесткий ДИСК. Дополнительные сведения о том, как добавить сервер в диспетчер серверов для управления см. в разделе [Добавление серверов в диспетчер серверов](add-servers-to-server-manager.md).  
  
> [!NOTE]  
> При использовании диспетчера серверов в Windows Server 2016 или Windows 10, можно использовать Добавить роли и функции мастера для установки роли и компоненты только на серверах и автономных виртуальных жестких дисков, работающих под управлением Windows Server 2016.  
  
#### <a name="to-install-roles-and-features-by-using-the-add-roles-and-features-wizard"></a>Установка ролей и компонентов с помощью Добавить роли и функции мастера  
  
1.  Если диспетчер серверов уже открыт, переходите к следующему шагу. Если диспетчер серверов еще не открыт, откройте его одним из следующих способов.  
  
    -   На рабочем столе Windows запустите диспетчер серверов, щелкнув **Диспетчер серверов** на панели задач Windows.  
  
    -   В Windows **запустить** щелкните **диспетчера серверов** плитку.  
  
2.  На **управление** меню, щелкните **Добавить роли и компоненты**.  
  
3.  На странице **Приступая к работе** убедитесь, что конечный сервер и сетевое окружение подготовлены к установке нужной вам роли или компонента. Нажмите кнопку **Далее**.  
  
4.  На странице **Выбор типа установки** выберите **Установка ролей или компонентов** , чтобы установить все элементы ролей или компонентов на одном сервере, или **Установка служб удаленных рабочих столов** , чтобы установить инфраструктуру рабочих столов на основе виртуальных машин или сеансов для служб удаленных рабочих столов. В случае варианта **Установка служб удаленных рабочих столов** логические части роли служб удаленных рабочих столов нужным образом распределяются администраторами между разными серверами. Нажмите кнопку **Далее**.  
  
5.  На странице **Выбор целевого сервера** выберите сервер из пула серверов или автономный виртуальный жесткий диск. Чтобы выбрать автономный виртуальный жесткий диск в качестве конечного сервера, сначала выберите сервер, на котором будет подключен виртуальный жесткий диск, а затем выберите VHD-файл. Сведения о способах добавления серверов в пул серверов см. в разделе [добавить серверы в диспетчер серверов](add-servers-to-server-manager.md). Выбрав конечный сервер, нажмите кнопку **Далее**.  
  
    > [!NOTE]  
    > Для установки ролей и компонентов на автономных виртуальных жестких дисках целевые виртуальные жесткие диски должны отвечать следующим требованиям.  
    >   
    > -   Виртуальные жесткие диски должна быть запущена версия Windows Server, которая соответствует версии диспетчера сервера выполняется. См. Примечание в начале [Установка ролей, служб ролей и компонентов с помощью Добавить роли и функции мастера](#BKMK_installarfw).  
    > -   Виртуальные жесткие диски не должны содержать больше одного системного тома или раздела.  
    > -   Общая сетевая папка, в которой хранится VHD-файл, должна предоставлять учетной записи компьютера (или локальной системы) для сервера, где будет подключен виртуальный жесткий диск, следующие права доступа. Одной лишь учетной записи пользователя недостаточно. На общем ресурсе можно предоставить разрешения **Чтение** и **Запись** группе **Все**, чтобы разрешить доступ к виртуальному жесткому диску, но из соображений безопасности делать это не рекомендуется.  
    >   
    >     -   Права на **Чтение и запись** в диалоговом окне **Общий доступ к файлам.**  
    >     -   **Полный доступ** доступ на **безопасности** tab, файл или папку **свойства** диалоговое окно.  
  
6.  Выберите роли, если необходимо, выберите службы ролей и нажмите кнопку **Далее** , чтобы выбрать компоненты.  
  
    Во время выполнения, добавить роли и функции мастера автоматически информирует о возникших конфликтах на конечном сервере, которые могут помешать выбранных ролей или компонентов из установке или нормальной работе. Также появляется запрос на добавление ролей, служб ролей и компонентов, необходимых для выбранных ролей или компонентов.  
  
    Кроме того, если планируется удаленное управление ролями либо с другого сервера, либо с компьютера на базе клиента Windows с установленными средствами администрирования удаленного сервера, можно не устанавливать средства управления и оснастки для ролей на конечном сервере. По умолчанию, добавить роли и мастер компонентов для установки выбраны средства управления.  
  
7.  На странице **Подтверждение выбранных элементов для установки** проверьте выбранные вами роли, компоненты и серверы. Если все готово к установке, нажмите кнопку **Установить**.  
  
    Можно также экспортировать выбранные параметры в файл конфигурации на основе XML, который можно использовать для автоматической установки с помощью Windows PowerShell. Чтобы экспортировать конфигурацию, заданную в этом Добавление ролей и сеансов мастер компонентов, нажмите кнопку **экспорт параметров конфигурации**и сохраните XML-файл в удобном месте.  
  
    Команда **Указать альтернативный исходный путь** на странице **Подтверждение выбранных элементов для установки** позволяет указать альтернативный исходный путь для файлов, необходимых для установки ролей и компонентов на выбранном сервере. В Windows Server 2012 и более поздних выпусках Windows Server [компоненты по требованию](https://go.microsoft.com/fwlink/p/?LinkID=241573) позволяет уменьшить объем дискового пространства, используемого операционной системой, путем удаления файлов ролей и компонентов с серверов, которые управляются удаленно. Удалив файлы ролей и компонентов с сервера при помощи командлета `Uninstall-WindowsFeature -remove`, в дальнейшем можно установить роли и компоненты на сервер, указав альтернативный исходный путь или общий ресурс, на котором хранятся необходимые файлы ролей и компонентов. Источника пути или файловом ресурсе должны быть предоставлены **чтения** разрешения либо **все** (не рекомендуется по соображениям безопасности), группы или учетной записи компьютера (*домена* \\ *SERverNAME*$) конечного сервера; предоставления доступа учетной записи пользователя недостаточно. Дополнительные сведения о функции "Компоненты по запросу" см. в разделе [Варианты установки Windows Server](https://go.microsoft.com/fwlink/p/?LinkId=241573).  
  
    Можно указать файл WIM в качестве альтернативного источника файлов компонентов при установке ролей, служб ролей и компонентов на работающем физическом сервере. Исходный путь для WIM-файл должен быть в следующем формате, с помощью **WIM** как префикс и индекс, в котором находятся файлы компонентов суффикс: **WIM:e:\sources\install.wim:4**. Тем не менее нельзя использовать WIM-файл непосредственно в качестве источника для установки ролей, служб ролей и компонентов на автономный виртуальный жесткий ДИСК; необходимо либо подключить автономный виртуальный жесткий ДИСК и укажите его путь подключения для исходных файлов, или должен указывать на папку, содержащую копию содержимого WIM-файла.  
  
8.  После того как вы щелкнете **установить**, **ход выполнения установки** странице отображается ход выполнения установки, результаты и сообщения, такие как предупреждения, сбои или действия по настройке после установки, требуется для ролей или компонентов, которые вы установили. В Windows Server 2012 и более поздних выпусках Windows Server, можно закрыть Добавить роли и функции мастера во время установки по-прежнему выполняется и просмотреть результаты установки или другие сообщения в **уведомления** наверху консоли диспетчера сервера. Нажмите кнопку **уведомления** значок флага для получения дополнительных сведений об установке или других задачах, выполняемых в диспетчере сервера.  
  
## <a name="BKMK_installwps"></a>Установка ролей, служб ролей и компонентов с помощью командлетов Windows PowerShell  
Командлеты развертывания диспетчера серверов для функции Windows PowerShell к Графическим пользовательским интерфейсом, аналогичным образом добавлять мастера ролей и компонентов и удалять мастера ролей и компонентов, с одним важным отличием. В Windows PowerShell в отличие от в add мастера ролей и компонентов, средства управления и оснастки для роли не включены по умолчанию. Чтобы установить средства управления вместе с ролью, добавьте в командлет параметр `IncludeManagementTools`. При установке ролей и компонентов на сервере, на котором выполняется вариант установки основных серверных компонентов Windows Server 2012 или более поздних версий, можно добавить средства управления для роли в установку, но нельзя установить средства управления на основе графического интерфейса пользователя и оснастки на серверах, работающих под управлением с вариантом установки основных серверных компонентов Windows Server. Единственный параметр командной строки и средств управления Windows PowerShell можно установить в варианте установки основных серверных компонентов.  
  
#### <a name="to-install-roles-and-features-by-using-the-install-windowsfeature-cmdlet"></a>Установка ролей и компонентов при помощи командлета Install-WindowsFeature  
  
1.  Выполните одно из следующих действий, чтобы открыть сеанс Windows PowerShell с повышенными правами.  
  
    > [!NOTE]  
    > При установке ролей и компонентов на удаленном сервере, запустите Windows PowerShell с повышенными правами пользователя не нужно.  
  
    -   На рабочем столе Windows щелкните правой кнопкой мыши **Windows PowerShell** на панели задач и выберите команду **Запустить от имени администратора**.  
  
    -   В Windows **запустить** экрана, щелкните правой кнопкой мыши плитку для Windows PowerShell и затем на панели приложения щелкните **Запуск от имени администратора**.  
  
2.  Введите **Get-WindowsFeature** и нажмите клавишу **ВВОД** , чтобы просмотреть список доступных и установленных ролей и компонентов на локальном сервере. Если локальный компьютер не является сервером, или если вам нужны сведения об удаленном сервере, запустите **Get-WindowsFeature - computerName <***имя_компьютера***>**, в котором  *имя_компьютера* представляет имя удаленного компьютера, на котором работает Windows Server 2016. Результаты командлета содержат имена команд ролей и компонентов, добавленных в командлет на шаге 4.  
  
    > [!NOTE]  
    > В Windows PowerShell 3.0 и более поздних версиях Windows PowerShell нет необходимости импортировать модуль командлета диспетчера серверов в сеанс Windows PowerShell перед запуском командлетов, которые являются частью модуля. Модуль автоматически импортируется при первом выполнении командлета, входящего в модуль. Кроме того ни командлеты Windows PowerShell, ни имена компонентов, используемых с командлетами учитывается регистр.  
  
3.  Тип **Get-help Install-WindowsFeature**, а затем нажмите клавишу **ввод** для просмотра синтаксиса и допустимых параметров `Install-WindowsFeature` командлета.  
  
4.  Введите следующую команду и нажмите клавишу **ввод**, где *имя_компонента* представляет имя команды, роли или компонента, который вы хотите установить (получены в шаге 2), и *имя_компьютера* представляет имя удаленного компьютера, на котором вы хотите установить роли и компоненты. Несколько значений параметра *имя_компонента* разделяйте запятыми. Параметр `Restart` автоматически перезапускает конечный сервер, если это требуется для установки роли или компонента.  
  
    ```  
    Install-WindowsFeature -Name <feature_name> -computerName <computer_name> -Restart  
    ```  
  
    Чтобы установить роли и компоненты на автономном виртуальном жестком диске, добавьте оба параметра — `computerName` и `VHD` . Если не добавить параметр `computerName`, то командлет решит, что доступ к виртуальному жесткому диску должен получить локальный компьютер. Параметр `computerName` содержит имя сервера, на котором следует подключить виртуальный жесткий диск, а параметр `VHD` — путь к VHD-файлу на указанном сервере.  
  
    > [!NOTE]  
    > Необходимо добавить `computerName` параметра, если вы запускаете командлет с компьютера, под управлением клиентской операционной системе Windows.  
    >   
    > Для установки ролей и компонентов на автономных виртуальных жестких дисках целевые виртуальные жесткие диски должны отвечать следующим требованиям.  
    >   
    > -   Виртуальные жесткие диски должна быть запущена версия Windows Server, которая соответствует версии диспетчера сервера выполняется. См. Примечание в начале [Установка ролей, служб ролей и компонентов с помощью Добавить роли и функции мастера](#BKMK_installarfw).  
    > -   Виртуальные жесткие диски не должны содержать больше одного системного тома или раздела.  
    > -   Общая сетевая папка, в которой хранится VHD-файл, должна предоставлять учетной записи компьютера (или локальной системы) для сервера, где будет подключен виртуальный жесткий диск, следующие права доступа. Одной лишь учетной записи пользователя недостаточно. На общем ресурсе можно предоставить разрешения **Чтение** и **Запись** группе **Все**, чтобы разрешить доступ к виртуальному жесткому диску, но из соображений безопасности делать это не рекомендуется.  
    >   
    >     -   Права на **Чтение и запись** в диалоговом окне **Общий доступ к файлам.**  
    >     -   **Полный доступ** доступ на **безопасности** tab, файл или папку **свойства** диалоговое окно.  
  
    ```  
    Install-WindowsFeature -Name <feature_name> -VHD <path> -computerName <computer_name> -Restart  
    ```  
  
    **Пример:** Следующий командлет устанавливает роль доменных служб active directory и компонент управления групповыми политиками на удаленном сервере ContosoDC1. Средства управления и оснастки добавляются с использованием параметра `IncludeManagementTools`, и конечный сервер будет перезапущен автоматически, если этого требует установка.  
  
    ```  
    Install-WindowsFeature -Name AD-Domain-Services,GPMC -computerName ContosoDC1 -IncludeManagementTools -Restart  
    ```  
  
5.  После завершения установки для проверки установки, открыв **все серверы** страницу в диспетчере серверов выберите сервер, на котором установлены роли и компоненты и просмотрите **ролей и компонентов** плитки на странице для выбранного сервера. Можно также запустить `Get-WindowsFeature` командлет, нацеленный на выбранный сервер (Get-WindowsFeature - computerName <*имя_компьютера*>) для просмотра списка ролей и компонентов, установленных на сервере.  
  
## <a name="BKMK_removerrfw"></a>Удаление ролей, служб ролей и компонентов с помощью remove мастера ролей и компонентов  
Вы должны войти в систему на сервер с правами администратора для удаления ролей, служб ролей и компонентов. Если вы вошли на локальный компьютер с учетной записью, не имеющей прав администратора на целевом сервере удаления, щелкните правой кнопкой мыши целевой сервер на плитке **Серверы** , выберите **Управлять как** и укажите учетную запись с правами администратора. Сервер, на котором требуется подключить автономный виртуальный жесткий диск, должен быть добавлен в диспетчер серверов. На таком сервере нужны права администратора.  
  
#### <a name="to-remove-roles-and-features-by-using-the-remove-roles-and-features-wizard"></a>Чтобы удалить роли и компоненты с помощью remove мастера ролей и компонентов  
  
1.  Если диспетчер серверов уже открыт, переходите к следующему шагу. Если диспетчер серверов еще не открыт, откройте его одним из следующих способов.  
  
    -   На рабочем столе Windows запустите диспетчер серверов, щелкнув **Диспетчер серверов** на панели задач Windows.  
  
    -   На **начальном экране** Windows выберите плитку **Диспетчер сервера** .  
  
2.  В меню **Управление** выберите команду **Удалить роли и функции**.  
  
3.  На странице **Приступая к работе** проверьте, все ли готово к удалению ролей и компонентов с сервера. Нажмите кнопку **Далее**.  
  
4.  На **Выбор целевого сервера** странице, выберите сервер из пула серверов или выберите автономный виртуальный жесткий ДИСК. Чтобы выбрать автономный виртуальный жесткий диск, сначала выберите сервер, на котором будет подключен виртуальный жесткий диск, а затем выберите VHD-файл.  
  
    > [!NOTE]  
    > Общая сетевая папка, в которой хранится VHD-файл, должна предоставлять учетной записи компьютера (или локальной системы) для сервера, где будет подключен виртуальный жесткий диск, следующие права доступа. Одной лишь учетной записи пользователя недостаточно. На общем ресурсе можно предоставить разрешения **Чтение** и **Запись** группе **Все**, чтобы разрешить доступ к виртуальному жесткому диску, но из соображений безопасности делать это не рекомендуется.  
    >   
    > -   Права на **Чтение и запись** в диалоговом окне **Общий доступ к файлам.**  
    > -   **Полный доступ** на вкладке **Безопасность** в диалоговом окне **Свойства** файла или папки.  
  
    Сведения о способах добавления серверов в пул серверов см. в разделе [добавить серверы в диспетчер серверов](add-servers-to-server-manager.md). Выбрав конечный сервер, нажмите кнопку **Далее**.  
  
    > [!NOTE]  
    > Удаление ролей можно использовать и мастер компонентов для удаления ролей и компонентов с серверов, работающих под управлением того же выпуска Windows Server, которые поддерживает версию диспетчера сервера, который используется. Невозможно удалить ролей, служб ролей и компонентов с серверов, работающих под управлением Windows Server 2016, при использовании диспетчера серверов в Windows Server 2012 R2, Windows Server 2012 или Windows 8. Нельзя использовать remove мастера ролей и компонентов для удаления ролей и компонентов с серверов, работающих под управлением Windows Server 2008 или Windows Server 2008 R2.  
  
5.  Выберите роли, если необходимо, выберите службы ролей и нажмите кнопку **Далее** , чтобы выбрать компоненты.  
  
    И продолжить удаление ролей и функций автоматически появится приглашение на удаление ролей, служб ролей и компонентов, которые нельзя использовать без удаляемых ролей и компонентов при удалении.  
  
    Кроме того вы можете удалить средства управления и оснастки для ролей на конечном сервере. По умолчанию, в удалить роли и мастер компонентов средства управления выбранные для удаления. Средства управления и оснастки можно оставить, если выбранный сервер планируется использовать для управления ролью на других удаленных серверах.  
  
6.  На странице **Подтверждение выбора компонентов для удаления** проверьте выбранные вами роли, компоненты и серверы. Если вы готовы к удалению ролей и компонентов, нажмите кнопку **удалить**.  
  
7.  После того как вы щелкнете **удалить**, **ход удаления** странице отображается ход удаления, результаты и сообщения, такие как предупреждения, сбои или после удаления действия по настройке, такие как перезапуск конечного сервера. В Windows Server 2012 и более поздних выпусках Windows Server, вы можете закрыть remove мастера ролей и компонентов во время удаления находится в ход выполнения и просматривать результаты удаления или другие сообщения в **уведомления** область в верхней части Консоль диспетчера сервера. Нажмите кнопку **уведомления** флаг для получения дополнительных сведений об удалении или других задачах, выполняемых в диспетчере сервера.  
  
## <a name="BKMK_removewps"></a>Удаление ролей, служб ролей и компонентов при помощи командлетов Windows PowerShell  
Командлеты развертывания диспетчера серверов для функции Windows PowerShell к Графическим пользовательским интерфейсом, аналогичным образом удалить мастера ролей и компонентов, с одним важным отличием. В Windows PowerShell в отличие от в удалить роли и мастер компонентов, средства управления и оснастки для роли не удаляются по умолчанию. Чтобы удалить средства управления вместе с ролью, добавьте в командлет параметр `IncludeManagementTools`. Если вы удаляете роли и компоненты с сервера, на котором выполняется вариант установки Server Core Windows Server 2012 или более поздней версии, Windows Server, этот параметр служит для удаления командной строки и средств управления Windows PowerShell для указанного роли и компоненты.  
  
#### <a name="to-remove-roles-and-features-by-using-the-uninstall-windowsfeature-cmdlet"></a>Удаление ролей и компонентов при помощи командлета Uninstall-WindowsFeature  
  
1.  Выполните одно из следующих действий, чтобы открыть сеанс Windows PowerShell с повышенными правами.  
  
    > [!NOTE]  
    > Если вы удаляете роли и компоненты с удаленного сервера, запустите Windows PowerShell с повышенными правами пользователя не нужно.  
  
    -   На рабочем столе Windows щелкните правой кнопкой мыши **Windows PowerShell** на панели задач и выберите команду **Запустить от имени администратора**.  
  
    -   В Windows **запустить** экрана, щелкните правой кнопкой мыши плитку Windows PowerShell и затем на панели приложения щелкните **Запуск от имени администратора**.  
  
2.  Введите **Get-WindowsFeature** и нажмите клавишу **ВВОД** , чтобы просмотреть список доступных и установленных ролей и компонентов на локальном сервере. Если локальный компьютер не является сервером, или если вам нужны сведения об удаленном сервере, запустите **Get-WindowsFeature - computerName <***имя_компьютера***>**, в котором  *имя_компьютера* представляет имя удаленного компьютера, на котором работает Windows Server 2016. Результаты командлета содержат имена команд ролей и компонентов, добавленных в командлет на шаге 4.  
  
    > [!NOTE]  
    > В Windows PowerShell 3.0 и более поздних версиях Windows PowerShell нет необходимости импортировать модуль командлета диспетчера серверов в сеанс Windows PowerShell перед запуском командлетов, которые являются частью модуля. Модуль автоматически импортируется при первом выполнении командлета, входящего в модуль. Кроме того ни командлеты Windows PowerShell, ни имена компонентов, используемых с командлетами учитывается регистр.  
  
3.  Тип **Get-help Uninstall-WindowsFeature**, а затем нажмите клавишу **ввод** для просмотра синтаксиса и допустимых параметров `Uninstall-WindowsFeature` командлета.  
  
4.  Введите следующий командлет и нажмите клавишу **ВВОД**, где *имя_компонента* — командное имя роли или компонента, которые нужно удалить (получены в шаге 2), а *имя_компьютера* — удаленный компьютер, с которого будут удалены роли и компоненты. Несколько значений параметра *имя_компонента* разделяйте запятыми. Параметр `Restart` автоматически перезапускает конечные серверы, если это требуется для удаления роли или компонента.  
  
    ```  
    Uninstall-WindowsFeature -Name <feature_name> -computerName <computer_name> -Restart  
    ```  
  
    Чтобы удалить роли и компоненты с автономного виртуального жесткого диска, добавьте оба параметра — `computerName` и `VHD`. Если не добавить параметр `computerName`, то командлет решит, что доступ к виртуальному жесткому диску должен получить локальный компьютер. Параметр `computerName` содержит имя сервера, на котором следует подключить виртуальный жесткий диск, а параметр `VHD` — путь к VHD-файлу на указанном сервере.  
  
    > [!NOTE]  
    > Необходимо добавить `computerName` параметра, если вы запускаете командлет с компьютера, под управлением клиентской операционной системе Windows.  
    >   
    > Общая сетевая папка, в которой хранится VHD-файл, должна предоставлять учетной записи компьютера (или локальной системы) для сервера, где будет подключен виртуальный жесткий диск, следующие права доступа. Одной лишь учетной записи пользователя недостаточно. На общем ресурсе можно предоставить разрешения **Чтение** и **Запись** группе **Все**, чтобы разрешить доступ к виртуальному жесткому диску, но из соображений безопасности делать это не рекомендуется.  
    >   
    > -   Права на **Чтение и запись** в диалоговом окне **Общий доступ к файлам.**  
    > -   **Полный доступ** доступ на **безопасности** tab, файл или папку **свойства** диалоговое окно.  
  
    ```  
    Uninstall-WindowsFeature -Name <feature_name> -VHD <path> -computerName <computer_name> -Restart  
    ```  
  
    **Пример:** Следующий командлет Удаляет роль доменных служб active directory и компонент управления групповой политикой с удаленного сервера ContosoDC1. Средства управления и оснастки также удаляются, и конечный сервер будет перезапущен автоматически, если это требуется для удаления.  
  
    ```  
    Uninstall-WindowsFeature -Name AD-Domain-Services,GPMC -computerName ContosoDC1 -IncludeManagementTools -Restart  
    ```  
  
5.  После завершения удаления убедитесь, что роли и компоненты удалены, открыв **все серверы** страницу в диспетчере серверов выберите сервер, из которого удалены роли и компоненты и просмотрите **ролей и Функции** на странице для выбранного сервера. Можно также запустить `Get-WindowsFeature` командлет, нацеленный на выбранный сервер (Get-WindowsFeature - computerName <*имя_компьютера*>) для просмотра списка ролей и компонентов, установленных на сервере.  
  
## <a name="BKMK_batch"></a>Установка ролей и компонентов на нескольких серверах, запустив сценарий Windows PowerShell  
Несмотря на то, что нельзя использовать добавление мастера ролей и компонентов для установки ролей, служб ролей и компонентов на более чем один целевой сервер в одном сеансе мастера, можно использовать сценарий Windows PowerShell для установки ролей, служб ролей и компонентов на нескольких целевых серверы, которыми вы управляете с помощью диспетчера сервера. Этот сценарий, используемый для пакетного развертывания, так называется данный процесс, указывает на XML-файл конфигурации, который можно легко создать с помощью Добавить роли и компоненты мастера и щелкнув **экспорт параметров конфигурации** после выполнения инструкций мастера до **подтверждение выбранных параметров установки** странице Добавить роли и функции мастера.  
  
> [!IMPORTANT]  
> Все целевые серверы, которые указаны в скрипте должна быть запущена версия Windows Server, которая соответствует версии диспетчера сервера выполняется на локальном компьютере. Например если вы используете Диспетчер серверов в Windows 10, можно установить ролей, служб ролей и компонентов на серверах, работающих под управлением Windows Server 2016. Если в установку добавлены средства управления на основе графического пользовательского интерфейса, процесс установки автоматически преобразует целевые серверы, которые работают с вариантом установки основных серверных компонентов Windows Server (сервер с полным графическим пользовательским Интерфейсом, также известный вариант полной установки как работающей графической оболочки сервера).  
>   
> Сценарий, приведенный в этом разделе приведен пример как пакетное развертывание можно выполнять с помощью `Install-WindowsFeature` командлета и сценария Windows PowerShell. Есть и другие сценарии и методы пакетного развертывания на нескольких серверах. Другие сценарии для развертывания ролей и компонентов можно найти в [репозитории центра сценариев](https://gallery.technet.microsoft.com/ScriptCenter).  
  
#### <a name="to-install-roles-and-features-on-multiple-servers"></a>Установка ролей и компонентов на нескольких серверах  
  
1.  Если вы еще не сделано, создайте XML-файл конфигурации, который содержит роли, службы ролей и компонентов, которые должны быть установлены на нескольких серверах. Этот файл конфигурации можно создать, добавить роли и функции мастера, выбрав ролей, служб ролей и компонентов, которые должны и щелкнув **экспорт параметров конфигурации** после выполнения инструкций мастера до **Подтверждение выбранных параметров установки** страницы. Сохраните файл конфигурации в удобном месте. Не нужно нажимать кнопку **Установить** или выполнять мастер до конца, если вы используете его только для создания файла конфигурации.  
  
2.  Выполните одно из следующих действий, чтобы открыть сеанс Windows PowerShell с повышенными правами.  
  
    -   На рабочем столе Windows щелкните правой кнопкой мыши **Windows PowerShell** на панели задач и выберите команду **Запустить от имени администратора**.  
  
    -   В Windows **запустить** экрана, щелкните правой кнопкой мыши плитку Windows PowerShell и затем на панели приложения щелкните **Запуск от имени администратора**.  
  
3.  Скопируйте и вставьте следующий скрипт в сеансе Windows PowerShell.  
  
    ```  
    function Invoke-WindowsFeatureBatchDeployment {  
        param (  
            [parameter(mandatory)]  
            [string[]] $computerNames,  
            [parameter(mandatory)]  
            [string] $ConfigurationFilepath  
        )  
  
        # Deploy the features on multiple computers simultaneously.  
        $jobs = @()  
        foreach($computerName in $computerNames) {  
            $jobs += start-Job -Command {  
                Install-WindowsFeature -ConfigurationFilepath $using:ConfigurationFilepath -computerName $using:computerName -Restart  
            }   
        }  
  
        Receive-Job -Job $jobs -Wait | select-Object Success, RestartNeeded, exitCode, FeatureResult  
    }  
    ```  
  
    Целевые серверы будут автоматически перезапущены, если этого требуют выбранные роли и компоненты.  
  
4.  Запустите функцию следующим образом.  
  
    1.  Создайте переменную, где будут храниться имена конечных компьютеров, разделенные запятыми. В следующем примере в переменной `$ServerNames` хранятся имена целевых серверов *Contoso_01* и *Contoso_02*. Нажмите клавишу **ВВОД**.  
  
        ```  
        # Sample Invocation  
        $ServerNames = 'Contoso_01','Contoso_02'  
        Invoke-WindowsFeatureBatchDeployment -computerNames $ServerNames -ConfigurationFilepath C:\Users\sampleuser\Desktop\DeploymentConfigTemplate.xml  
        ```  
  
    2.  Чтобы запустить функцию, введите следующую команду и нажмите клавишу **ВВОД**, где `$ServerNames` — пример переменной, созданной в предыдущем шаге, а *C:\Users\Sampleuser\Desktop\DeploymentConfigTemplate.xml* — пример пути к файлу конфигурации, созданному на шаге 1.  
  
        **Вызвать WindowsFeatureBatchDeployment - computerNames $ServerNames параметр - ConfigurationFilepath C:\Users\Sampleuser\Desktop\DeploymentConfigTemplate.xml**  
  
5.  После завершения установки для проверки установки, открыв **все серверы** страницу в диспетчере серверов выберите сервер, на котором установлены роли и компоненты и просмотрите **ролей и компонентов** плитки на странице для выбранного сервера. Можно также запустить `Get-WindowsFeature` командлет, нацеленный на определенный сервер (`Get-WindowsFeature -computerName` <*имя_компьютера*>) для просмотра списка ролей и компонентов, установленных на сервере.  
  
## <a name="BKMK_FoD"></a>Установка .NET Framework 3.5 и других компонентов по требованию  
начиная с Windows Server 2012 и Windows 8, файлы компонентов для .NET Framework 3.5 (которая включает .NET Framework 2.0 и .NET Framework 3.0) не доступны на локальном компьютере по умолчанию. Данные файлы удалены. Файлы компонентов, удаленных в конфигурации функции "Компоненты по требованию", вместе с файлами компонентов для .NET Framework 3.5 доступны в Центре обновления Windows. По умолчанию если файлы компонентов недоступны на конечном сервере под управлением Windows Server 2012 или более поздних версий, процесс установки поиск недостающих файлов путем подключения к центру обновления Windows. Можно переопределить поведение по умолчанию, настроив параметры групповой политики или указав альтернативный исходный путь во время установки, вида установки: с помощью Добавить роли и компоненты графического интерфейса мастера или командной строки.  
  
Компонент .NET Framework 3.5 можно установить, выполнив одно из описанных ниже действий.  
  
-   Воспользуйтесь разделом [Порядок установки .NET Framework 3.5 с помощью командлета Install-WindowsFeature](#BKMK_dotnetcmdlet), чтобы добавить параметр `Source`, и укажите источник файлов компонентов .NET Framework 3.5. Без добавления параметра `Source` в процессе установки сначала определяется, указан ли путь к файлам компонентов в параметрах групповой политики, и если такой путь не найден, поиск недостающих файлов компонентов осуществляется с помощью Центра обновления Windows.  
  
-   Используйте [установка .NET Framework 3.5 с помощью Добавить роли и функции мастера](#BKMK_arfw) для указания альтернативного расположения исходных файлов на **Подтверждение параметров установки** странице Добавить роли и функции мастера.  
  
-   Воспользуйтесь [Установка .NET Framework 3.5 с помощью DISM](#BKMK_dism) , чтобы получить файлы из Центра обновления Windows (по умолчанию), или укажите исходный путь к установочному носителю.  
  
[Настройка альтернативных источников файлов компонентов в групповой политике](#BKMK_configgp) для .NET Framework 3.5 или другие компоненты, если файлы компонентов не обнаружены на локальном компьютере.  
  
> [!IMPORTANT]  
> При установке файлов компонентов из удаленного источника права на **Чтение** в исходном пути или файловом ресурсе общего доступа необходимо присвоить группе **Все** (не рекомендуется по соображениям безопасности) или учетной записи компьютера (локальная система) конечного сервера; предоставления доступа учетной записи пользователя недостаточно.  
>   
> Серверы в рабочих группах не могут получить доступ к внешним файловым ресурсам, даже если учетная запись компьютера для сервера рабочей группы имеет права на **Чтение** внешнего общего ресурса. Другие исходные расположения, действующие для серверов рабочих групп, включают установочные носители, Центр обновления Windows и VHD- или WIM-файлы, хранящиеся на локальном сервере рабочей группы.  
>   
> Можно указать файл WIM в качестве альтернативного источника файлов компонентов при установке ролей, служб ролей и компонентов на работающем физическом сервере. Исходный путь для WIM-файл должен быть в следующем формате, с помощью **WIM** как префикс и индекс, в котором находятся файлы компонентов суффикс: **WIM:e:\sources\install.wim:4**. Тем не менее нельзя использовать WIM-файл непосредственно в качестве источника для установки ролей, служб ролей и компонентов на автономный виртуальный жесткий ДИСК; необходимо либо подключить автономный виртуальный жесткий ДИСК и укажите его путь подключения для исходных файлов, или должен указывать на папку, содержащую копию содержимого WIM-файла.  
  
### <a name="BKMK_dotnetcmdlet"></a>Чтобы установить .NET Framework 3.5 с помощью командлета Install-WindowsFeature  
  
1.  Выполните одно из следующих действий, чтобы открыть сеанс Windows PowerShell с повышенными правами.  
  
    > [!NOTE]  
    > При установке роли и компоненты с удаленного сервера, запустите Windows PowerShell с повышенными правами пользователя не нужно.  
  
    -   На рабочем столе Windows щелкните правой кнопкой мыши **Windows PowerShell** на панели задач и выберите команду **Запустить от имени администратора**.  
  
    -   В Windows **запустить** экрана, щелкните правой кнопкой мыши плитку Windows PowerShell и затем на панели приложения щелкните **Запуск от имени администратора**.  
  
    -   На сервер под управлением варианта установки основных серверных компонентов Windows Server 2012 R2 или Windows Server 2012, введите **PowerShell** в командной строке, а затем нажмите клавишу **ввод**.  
  
2.  Введите следующую команду и нажмите клавишу **ввод**. В примере ниже исходные файлы находятся в хранилище параллельных компонентов (также называется **SxS**) на установочном носителе на диске D.  
  
    ```  
    Install-WindowsFeature NET-Framework-Core -Source D:\Sources\SxS  
    ```  
  
    Если нужно, чтобы в качестве источника недостающих файлов компонентов использовался Центр обновления Windows, или источник по умолчанию уже настроен с помощью групповой политики, параметр `Source` следует добавлять только для указания альтернативного источника.  
  
### <a name="BKMK_arfw"></a>Установка .NET Framework 3.5 с помощью Добавить роли и функции мастера  
  
1.  На **управление** меню в диспетчере серверов щелкните **Добавить роли и компоненты**.  
  
2.  Выбор целевого сервера, на котором работает Windows Server 2016.  
  
3.  На **Выбор компонентов** странице Добавить роли и функции мастера выберите **.NET Framework 3.5**.  
  
4.  Если локальному компьютеру разрешено это делать настройками групповой политики, процесс установки пытается получить недостающие файлы компонентов с помощью Центра обновления Windows. Нажмите кнопку **Установить**; переходить к следующему шагу не нужно.  
  
    Если этого делать не разрешают параметры групповой политики, или вы хотите воспользоваться другим источником файлов компонентов .NET Framework 3.5, на **подтверждение выбранных параметров установки** страницы мастера, нажмите кнопку **указать альтернативный исходный путь** .  
  
5.  Предоставьте путь к хранилищу соседствующих (side-by-side) компонентов (также называется **SxS**) в установочном носителе или к WIM-файлу. В примере ниже установочный носитель находится на диске D.  
  
    **D:\Sources\SxS\\**  
  
    Чтобы указать WIM-файл, добавьте префикс **WIM:** и индекс образа для использования в WIM-файле в качестве суффикса, как показано в примере ниже.  
  
    **WIM:\\\\***имя_сервера***\share\install.wim:3**  
  
6.  Нажмите кнопку **ОК**, а затем кнопку **Установить**.  
  
### <a name="BKMK_dism"></a>Чтобы установить .NET Framework 3.5 с помощью DISM  
  
1.  Выполните одно из следующих действий, чтобы открыть сеанс Windows PowerShell с повышенными правами.  
  
    > [!NOTE]  
    > При установке роли и компоненты с удаленного сервера, запустите Windows PowerShell с повышенными правами пользователя не нужно.  
  
    -   На рабочем столе Windows щелкните правой кнопкой мыши **Windows PowerShell** на панели задач и выберите команду **Запустить от имени администратора**.  
  
    -   В Windows **запустить** экрана, щелкните правой кнопкой мыши плитку Windows PowerShell и затем на панели приложения щелкните **Запуск от имени администратора**.  
  
    -   На сервере, на котором выполняется вариант установки основных серверных компонентов, введите **PowerShell** в командной строке, а затем нажмите клавишу **ввод**.  
  
2.  Используйте одну из указанных ниже команд DISM.  
  
    -   Если компьютер имеет доступ к центру обновления Windows, или расположение исходного файла по умолчанию уже настроен в групповой политике, выполните следующую команду.  
  
        ```  
        DISM /online /Enable-Feature /Featurename:NetFx3 /All  
        ```  
  
    -   Если компьютер имеет доступ к установочному носителю, выполните команду, аналогичную следующей. В примере ниже установочный носитель операционной системы находится на диске D. Параметр `LimitAccess` не позволяет команде связаться с Центром обновления Windows или сервером, на котором выполняются службы WSUS.  
  
        ```  
        DISM /online /Enable-Feature /Featurename:NetFx3 /All /LimitAccess /Source:d:\sources\sxs  
        ```  
  
    > [!NOTE]  
    > В команде DISM учитывается регистр.  
  
### <a name="BKMK_configgp"></a>Настройка альтернативных источников файлов компонентов в групповой политике  
Параметр групповой политики, описанный в этом разделе, указывает расположение авторизованного источника файлов .NET Framework 3.5 и файлов других компонентов, которые удалены как часть конфигурации "Компоненты по требованию". Параметр политики **укажите параметры для установки дополнительных компонентов и восстановления компонентов** находится в **компьютера Конфигурация компьютера\Административные шаблоны\Система** папки в групповой политике Редактор локальной групповой политики или консоли управления.  
  
> [!NOTE]  
> Для изменения параметров групповой политики на локальном компьютере требуется быть членом группы "Администраторы". Если параметры групповой политики нужного компьютера управляются на уровне домена, для их изменения необходимо быть членом группы "Администраторы домена".  
  
##### <a name="to-configure-a-default-alternate-source-path-in-group-policy"></a>Порядок настройки пути по умолчанию к альтернативному источнику в групповой политике  
  
1.  В редакторе локальных групповых политик или консоли управления групповыми политиками откройте следующий параметр политики.  
  
    **компьютер Конфигурация компьютера\Административные шаблоны\система\указать параметры установки дополнительных компонентов и восстановления компонентов**  
  
2. Sselect **включено** включить данный параметр политики, если он еще не включен.  
  
3.  В текстовом поле **Альтернативный путь к исходным файлам** в области **Параметры** укажите полный путь к общей папке или WIM-файлу. Чтобы указать WIM-файл в качестве альтернативного расположения исходных файлов, добавьте префикс **WIM:** к пути и индекс образа для использования в WIM-файле как суффикс. Ниже приводятся примеры возможных значений.  
  
    -   путь к общей папке: **\\\\***имя_сервера***\share\\*** имя_папки*  
  
    -   путь к WIM-файлу, в котором **3** представляет индекс образа, в которой находятся файлы компонентов:  **WIM:\\\\***имя_сервера***\share\install.wim:3**  
  
4.  Если не хотите, чтобы компьютеры, управляемые этим параметром искали недостающие файлы компонентов в центре обновления Windows, выберите политики **никогда не пытаться загружать полезные данные из центра обновления Windows**.  
  
5.  Если компьютеры, которые управляются данным параметром политики обычно получают обновления с помощью служб WSUS, но вы предпочитаете использовать для поиска недостающих файлов компонентов Центр обновления Windows, а не WSUS, выберите **Напрямую обращаться в Центр обновления Windows, чтобы загрузить контент для восстановления вместо использования служб WSUS**.  
  
6.  После завершения изменения данного параметра политики нажмите кнопку **ОК**, а затем закройте редактор групповых политик.  
  
## <a name="see-also"></a>См. также  
[Варианты установки Windows Server](https://go.microsoft.com/fwlink/p/?LinkId=241573)  
[Рекомендации по развертыванию Microsoft .NET Framework 3.5](https://go.microsoft.com/fwlink/p/?LinkId=248869)  
[Включение и отключение компонентов Windows](https://go.microsoft.com/fwlink/p/?LinkId=246552)  
  


