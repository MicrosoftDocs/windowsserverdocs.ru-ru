---
title: Запуск пктмон
description: Справочная статья по команде пктмон Start.
ms.topic: reference
author: khdownie
ms.author: v-kedow
ms.date: 1/14/2021
ms.openlocfilehash: 92e8048958dbba1e4d8b71addbc010f5ba8bc31c
ms.sourcegitcommit: 5dd48d0da9400d7e8a6ae40b4c977d1703c4e669
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2021
ms.locfileid: "98241173"
---
# <a name="pktmon-start"></a>Запуск пктмон

> Область применения: Windows Server (половина ежегодного канала), Windows Server 2019, Windows 10, Azure Stack ХЦИ, центр Azure Stack, Azure

Запускает мониторинг пакетов.

## <a name="syntax"></a>Синтаксис

```
pktmon start [-c { all | nics | [ids...] }] [-d] [--etw [-p size] [-k keywords]]
             [-f] [-s] [--log-mode {circular | multi-file | real-time | memory}]
```

### <a name="parameters"></a>Параметры

| **Параметр** | **Описание** |
| ------------- | --------------- |
| **-c,--компоненты** | Выберите компоненты для мониторинга. Могут быть все компоненты, только сетевые карты или список идентификаторов компонентов. Значение по умолчанию — ALL. |
| **-d,--только Drop** | Сообщать только о пропущенных пакетах. По умолчанию также сообщается об успешном распространении пакетов. |
| **--ETW** | Запускает сеанс ведения журнала для записи пакетов. |
| **-p,--Packet-Size** | Число байтов, записываемых в журнал из каждого пакета. Чтобы всегда заносить в журнал весь пакет, задайте для него значение 0. Значение по умолчанию — 128 байт. |
| **-k,--ключевые слова** | Шестнадцатеричная битовая маска (сумма следующих флагов), которая определяет, какие события регистрируются в журнале. Значение по умолчанию — 0x012. См. раздел Флаги ключевых слов ниже. |
| **-f,--имя файла** | ETL-файл журнала. Значение по умолчанию — Пктмон. ETL |
| **-s,--file-size** | Максимальный размер файла журнала в мегабайтах. Значение по умолчанию — 512 МБ. |
| **-l,--режим ведения журнала** | Выберите режим ведения журнала. Значение по умолчанию — циклический. См. раздел режимы ведения журнала ниже. |

### <a name="keyword-flags"></a>Флаги ключевого слова

Следующие флаги применяются к параметру **-k** или **--keywords** (см. выше).

| **Пометить** | **Описание** |
| --------- | ----------- |
| **0x001** | Ошибки монитора внутренних пакетов.
| **0x002** | Сведения о компонентах, счетчиках и фильтрах. Эти сведения добавляются в конец файла журнала.
| **0x004** | Сведения об источнике и назначении для первого пакета в NET_BUFFER_LIST группе.
| **0x008** | Выберите метаданные пакета из перечисления NDIS_NET_BUFFER_LIST_INFO.
| **0x010** | Необработанный пакет, усеченный до размера, указанного в параметре [--packet-size].

### <a name="logging-modes"></a>Режимы ведения журнала

Режим ведения журнала задается с помощью параметра **-l** или **--Log-Mode** (см. выше).

| **Режим** | **Описание** |
| -------- | --------------- |
| **тригонометри** | Новые события перезапишут самые старые при достижении максимального размера файла. |
| **несколько файлов** | При достижении максимального размера файла создается новый файл журнала. Файлы журнала нумеруются последовательно: PktMon1. ETL, PktMon2. ETL и т. д. |
| **в режиме реального времени** | Отображение событий и пакетов на экране в реальном времени. Файл журнала не создается. Нажмите клавиши **CTRL + C** , чтобы прерывать наблюдение. |
| **свободной** | События записываются в буфер кольцевой памяти. Размер буфера задается в параметре [--file-size]. Содержимое буфера записывается в файл журнала во время операции приостанавливается. |

## <a name="examples"></a>Примеры

Следующая команда запускает запись и включает ведение журнала пакетов.

```PowerShell
C:\Test> pktmon start --etw
```

Следующая команда запускает запись, включает ведение журнала пакетов и выбирает режим ведения журнала в режиме реального времени:

```PowerShell
C:\Test> pktmon start --etw -l real-time
```

Следующая команда будет записывать счетчики пакетов для всех сетевых адаптеров без ведения журнала пакетов:

```PowerShell
C:\Test> pktmon start -c nics
```

Следующая команда захватывает только удаленные пакеты, которые проходят через компоненты 4 и 5, и записывает их в журнал:

```PowerShell
C:\Test> pktmon start --etw -c 4,5 -d
```

## <a name="additional-references"></a>Дополнительные ссылки

- [пктмон](pktmon.md)
- [Пктмонная Comp](pktmon-comp.md)
- [Счетчики пктмон](pktmon-counters.md)
- [Фильтр пктмон](pktmon-filter.md)
- [Добавление фильтра пктмон](pktmon-filter-add.md)
- [Формат пктмон](pktmon-format.md)
- [Список пктмон](pktmon-list.md)
- [Пктмон пкапнг](pktmon-pcapng.md)
- [Сброс пктмон](pktmon-reset.md)
- [Выгрузка пктмон](pktmon-unload.md)
- [Общие сведения о мониторе пакетов](/windows-server/networking/technologies/pktmon/pktmon)
