---
title: DiskRAID
description: Справочный раздел для программы командной строки DiskRAID, которая позволяет настраивать избыточные массивы независимых дисков (или недорогих) и управлять ими.
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 20aef1e5-7641-47cf-b4eb-cda117f65b6e
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: ffceb9347921536a1bee59f46a4d5ab4800c1e70
ms.sourcegitcommit: aed942d11f1a361fc1d17553a4cf190a864d1268
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2020
ms.locfileid: "83235208"
---
# <a name="diskraid"></a>DiskRAID

**DiskRAID** — это программа командной строки, которая позволяет настраивать избыточные массивы (или недорогие) дисковых ПОДСИСТЕМ (RAID) и управлять ими.

RAID обычно используется на серверах для стандартизации и классификации отказоустойчивых дисковых систем. Уровни RAID предоставляют различные наборы производительности, надежности и затрат. Некоторые серверы предоставляют три уровня RAID: уровень 0 (чередование), уровень 1 (зеркальное отображение) и уровень 5 (чередование с четностью).

Аппаратная подсистема RAID позволяет отличать физически используемые единицы хранения друг от друга с помощью логического номера устройства (LUN). Объект LUN должен иметь по крайней мере один Плекс и может иметь любое количество дополнительных плексов. Каждый плекс содержит копию данных в объекте LUN. Плекса можно добавлять в объект LUN и удалять из него.

Большинство команд DiskRAID работают с конкретным портом адаптера шины (HBA), адаптером инициатора, порталом инициатора, поставщиком, подсистемой, контроллером, портом, устройством, LUN, целевым порталом, целевым объектом или группой целевых порталов. Для выбора объекта используется команда **SELECT** . Говорят, что выбранный объект имеет фокус. Основное внимание уделяется упрощению общих задач настройки, таких как создание нескольких LUN в одной подсистеме.

> [!NOTE]
> Программа командной строки DiskRAID работает только с подсистемами хранения, поддерживающими службу виртуальных дисков (VDS).

## <a name="diskraid-commands"></a>Команды DiskRAID

В средстве DiskRAID доступны следующие команды.

### <a name="add"></a>add

Добавляет существующий LUN к выбранному в текущий момент LUN или добавляет портал цели iSCSI в выбранную группу портала целевого объекта iSCSI.

#### <a name="syntax"></a>Синтаксис

```
add plex lun=n [noerr]
add tpgroup tportal=n [noerr]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| Плекс LUN =`<n>` | Указывает номер LUN, добавляемый в текущий выбранный LUN в качестве плекса. ВНИМАНИЕ! все данные в LUN, добавляемые в качестве плекса, будут удалены. |
| тпграуп тпортал =`<n>` | Указывает номер портала цели iSCSI для добавления в выбранную группу портала целевого объекта iSCSI. |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="associate"></a>связана

Устанавливает указанный список портов контроллера как активный для текущего выбранного LUN (другие порты контроллера становятся неактивными) или добавляет указанные порты контроллера в список существующих активных портов контроллера для выбранного LUN или связывает указанный целевой объект iSCSI с выбранным в данный момент LUN.

#### <a name="syntax"></a>Синтаксис

```
associate controllers [add] <n>[,<n> [,…]]
associate ports [add] <n-m>[,<n-m>[,…]]
associate targets [add] <n>[,<n> [,…]]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| controller | Добавляет или заменяет список контроллеров, связанных с текущим выбранным LUN. Используйте только с поставщиками VDS 1,0. |
| ports; | Добавляет или заменяет список портов контроллера, связанных с текущим выбранным LUN. Используйте только с поставщиками VDS 1,1. |
| целевые объекты | Добавляет или заменяет список целевых объектов iSCSI, связанных с текущим выбранным LUN. Используйте только с поставщиками VDS 1,1. |
| add | **При использовании поставщиков VDS 1,0:** Добавляет указанные контроллеры к существующему списку контроллеров, связанных с LUN. Если этот параметр не указан, список контроллеров заменяет существующий список контроллеров, связанных с этим LUN.<p>**При использовании поставщиков VDS 1,1:** Добавляет указанные порты контроллера в существующий список портов контроллера, связанных с LUN. Если этот параметр не указан, список портов контроллера заменяет существующий список портов контроллера, связанных с этим LUN. |
| `<n>[,<n> [, ...]]` | Используйте с параметром **Controllers** или **Targets** . Указывает число контроллеров или целевых объектов iSCSI, которые должны быть установлены в активное или связываемое. |
| `<n-m>[,<n-m>[,…]]` | Используйте с параметром **ports** . Указывает порты контроллера, которые должны быть заданы активными с помощью пары номер контроллера (*n*) и номера порта (*m*). |

#### <a name="example"></a>Пример

Чтобы связать и добавить порты в LUN, использующий поставщик VDS 1,1, выполните следующие действия.

```
DISKRAID> SEL LUN 5
LUN 5 is now the selected LUN.

DISKRAID> ASSOCIATE PORTS 0-0,0-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1)

DISKRAID> ASSOCIATE PORTS ADD 1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1, Ctlr 1 Port 1)
```

### <a name="automagic"></a>Автоматическое магическое

Устанавливает или снимает флаги, предоставляющие указания поставщикам о настройке LUN. Используется без параметров. в операции **автоволшебки** отображается список флагов.

#### <a name="syntax"></a>Синтаксис

```
automagic {set | clear | apply} all <flag=value> [<flag=value> [...]]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| set | Задает указанные значения для указанных флагов. |
| clear | Удаляет указанные флаги. Ключевое слово **ALL** очищает все флаги автоволшебия. |
| apply | Применяет текущие флаги к выбранному LUN. |
| `<flag>` | Флаги определяются акронимами из трех букв, включая:<ul><li>**ФКР** — требуется быстрое восстановление после сбоя</li><li>**ФТЛ** — отказоустойчивость</li><li>**MSR** — в основном операции чтения</li><li>**МКСД** — максимальное число дисков</li><li>**МКСС** — ожидался максимальный размер</li><li>**Ora** — оптимальное выравнивание для чтения</li><li>**Or** — оптимальный размер для чтения</li><li>**OSR** — оптимизация для последовательных операций чтения</li><li>**ОСВ** — оптимизация для последовательных операций записи</li><li> **OWA** — оптимальное выравнивание записи</li><li>**OWS** -оптимальный размер записи</li><li>**РБП** — приоритет перестроения</li><li>**РБВ** — Проверка возврата для чтения включена</li><li>**РМП** — сопоставление включено</li><li>**STS** — размер чередования</li><li>**ВТК** — кэширование сквозной записи включено</li><li>**Инк** — съемный</li></ul> |

### <a name="break"></a>break

Удаляет Плекс из выбранного в данный момент LUN. Плекс и содержащиеся в нем данные не сохраняются, а области диска могут быть освобождены.

> [!CAUTION]
> Перед использованием этой команды необходимо сначала выбрать зеркальный LUN. Все данные на плекс будут удалены. Все данные, содержащиеся в исходном LUN, не обязательно должны быть одинаковыми.

#### <a name="syntax"></a>Синтаксис

```
break plex=<plex_number> [noerr]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| плексов | Указывает номер удаляемого плекса. Плекс и содержащиеся в нем данные не будут сохранены, а ресурсы, используемые этим плексом, будут освобождены. Данные, содержащиеся в LUN, не гарантированно согласуются. Если вы хотите хранить этот плекс, используйте служба теневого копирования томов (VSS). |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="chap"></a>протокола

Задает общий секрет протокола проверки пароля (CHAP), чтобы инициаторы iSCSI и целевые объекты iSCSI могли обмениваться данными друг с другом.

#### <a name="syntax"></a>Синтаксис

```
chap initiator set secret=[<secret>] [target=<target>]
chap initiator remember secret=[<secret>] target=<target>
chap target set secret=[<secret>] [initiator=<initiatorname>]
chap target remember secret=[<secret>] initiator=<initiatorname>
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| набор инициаторов | Задает общий секрет в локальной службе инициатора iSCSI, используемой для взаимной проверки подлинности CHAP, когда инициатор выполняет проверку подлинности целевого объекта. |
| запоминание инициатора | Передает секрет CHAP целевого объекта iSCSI в локальную службу инициатора iSCSI, чтобы служба инициатора могла использовать секрет для проверки подлинности в целевом объекте во время проверки подлинности CHAP. |
| набор целей | Задает общий секрет в текущей выбранной цели iSCSI, используемой для проверки подлинности CHAP, когда целевой объект проверяет подлинность инициатора. |
| конечное, запомнить | Передает секрет CHAP инициатора iSCSI к текущему целевому объекту iSCSI в фокусе, чтобы целевой объект мог использовать секрет для проверки подлинности в инициаторе во время взаимной проверки подлинности CHAP. |
| secret | Указывает секрет для использования. Если этот параметр пуст, секрет будет очищен. |
| target | Указывает целевой объект в текущей выбранной подсистеме, связываемый с секретом. Это необязательно при задании секрета на инициаторе и при его выходе означает, что секрет будет использоваться для всех целевых объектов, у которых еще нет соответствующего секрета. |
| initiatorname | Указывает имя инициатора iSCSI, связываемое с секретом. Это необязательно при задании секрета на целевом объекте и выходе из него означает, что секрет будет использоваться для всех инициаторов, у которых еще нет соответствующего секрета. |

### <a name="create"></a>create

Создает новый LUN или целевой объект iSCSI в выбранной подсистеме или создает группу целевых порталов на выбранном целевом объекте. Вы можете просмотреть фактическую привязку с помощью команды **DiskRAID List** .

#### <a name="syntax"></a>Синтаксис

```
create lun simple [size=<n>] [drives=<n>] [noerr]
create lun stripe [size=<n>] [drives=<n, n> [,...]]  [stripesize=<n>] [noerr]
create lun raid [size=<n>] [drives=<n, n> [,...]] [stripesize=<n>] [noerr]
create lun mirror [size=<n>] [drives=<n, n> [,...]] [stripesize=<n>] [noerr]
create lun automagic size=<n> [noerr]
create target name=<name> [iscsiname=<iscsiname>] [noerr]
create tpgroup [noerr]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| простой | Создает простой LUN. |
| полоса | Создает чередующийся LUN. |
| тома | Создает чередующийся LUN с четностью. |
| mirror | Создает зеркальный LUN. |
| Автоматическое магическое | Создает LUN, используя подсказки *automagic* , действующие в настоящее время. Дополнительные сведения см. в подразделе подкоманда **automagic** этой статьи. |
| Размер = | Указывает общий размер LUN в мегабайтах. Необходимо указать либо параметр **size**=, либо **Drives**=. Их также можно использовать вместе. Если параметр **size =** не указан, то созданный LUN будет максимально допустимым размером, допускаемым всеми указанными дисками.<p>Поставщик обычно создает LUN по крайней мере до требуемого размера, но в некоторых случаях поставщику может потребоваться округлить до следующего самого крупного размера. Например, если размер указан как. 99 ГБ, а поставщик может выделить только ГБ дисковых пространства, то результирующий LUN будет равен 1 ГБ. Чтобы указать размер с помощью других единиц, используйте один из следующих распознаваемых суффиксов сразу после размера:<ul><li>**B** -байт</li><li>**КБ** – КБ</li><li>**МБ** — мегабайт</li><li>**ГБ** -гигабайт</li><li>**ТБ** – терабайт</li><li>**Pb** -петабайтного уровня.</li></ul> |
| диски = | Указывает *drive_number* дисков, используемых для создания LUN. Необходимо указать либо параметр **size**=, либо **Drives**=. Их также можно использовать вместе. Если параметр **size =** не указан, то созданный LUN — это максимальный возможный размер, допустимый для всех указанных дисков. Если указан параметр **size =** , поставщики будут выбирать диски из указанного списка дисков для создания LUN. Поставщики будут пытаться использовать диски в порядке, указанном по возможности. |
| стрипесизе = | Указывает размер в мегабайтах для *чередующегося* или *RAID-массива* . Стрипесизе невозможно изменить после создания LUN. Чтобы указать размер с помощью других единиц, используйте один из следующих распознаваемых суффиксов сразу после размера:<ul><li>**B** -байт</li><li>**КБ** – КБ</li><li>**МБ** — мегабайт</li><li>**ГБ** -гигабайт</li><li>**ТБ** – терабайт</li><li>**Pb** -петабайтного уровня.</li></ul> |
| target | Создает новую цель iSCSI в выбранной подсистеме. |
| name | Предоставляет понятное имя для целевого объекта. |
| исксинаме | Предоставляет имя iSCSI для целевого объекта и может быть опущено, чтобы поставщик создавал имя. |
| тпграуп | Создает новую группу порталов цели iSCSI на выбранном целевом объекте. |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="delete"></a>удалить

Удаляет выбранный в данный момент LUN, целевой объект iSCSI (при условии, что отсутствуют LUN, связанные с целевым объектом iSCSI) или группой целевых порталов iSCSI.

#### <a name="syntax"></a>Синтаксис

```
delete lun [uninstall] [noerr]
delete target [noerr]
delete tpgroup [noerr]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| номеров | Удаляет выбранный в данный момент LUN и все данные на нем. |
| uninstall | Указывает, что диск локальной системы, связанный с LUN, будет очищен перед удалением LUN. |
| target | Удаляет выбранную цель iSCSI, если ни один LUN не связан с целевым объектом. |
| тпграуп | Удаляет текущую выбранную группу порталов цели iSCSI. |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="detail"></a>Описание

Отображает подробные сведения о выбранном в данный момент объекте указанного типа.

#### <a name="syntax"></a>Синтаксис

```
detail {hbaport | iadapter | iportal | provider | subsystem | controller | port | drive | lun | tportal | target | tpgroup} [verbose]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| хбапорт | Выводит подробные сведения о выбранном в данный момент порту адаптера шины узла (HBA). |
| иадаптер | Выводит подробные сведения о выбранном в данный момент адаптере инициатора iSCSI. |
| ипортал | Выводит подробные сведения о выбранном в данный момент портале инициатора iSCSI. |
| поставщик | Выводит подробные сведения о текущем выбранном поставщике. |
| подсистема | Выводит подробные сведения о текущей выбранной подсистеме. |
| controller | Выводит подробные сведения о текущем выбранном контроллере. |
| порт | Выводит подробные сведения о текущем выбранном порте контроллера. |
| устройство | Выводит подробные сведения о выбранном в данный момент диске, включая занимающие LUN. |
| номеров | Выводит подробные сведения о текущем выбранном LUN, включая участвующие диски. Выходные данные немного отличаются в зависимости от того, является ли LUN частью Fibre Channel или подсистемы iSCSI. Если список узлов с немаскированными узлами содержит только звездочку, это означает, что LUN размаскируется на все узлы. |
| тпортал | Выводит подробные сведения о текущем выбранном портале цели iSCSI. |
| target | Выводит подробные сведения о текущей выбранной цели iSCSI. |
| тпграуп | Выводит подробные сведения о выбранной группе портал целевого объекта iSCSI. |
| verbose | Для использования только с параметром LUN. Содержит дополнительные сведения, включая его плексов. |

### <a name="dissociate"></a>отменить связь

Устанавливает указанный список портов контроллера как неактивный для текущего выбранного LUN (другие порты контроллера не затрагиваются) или отменяет указанный список целевых объектов iSCSI для выбранного в данный момент LUN.

#### <a name="syntax"></a>Синтаксис

```
dissociate controllers <n> [,<n> [,...]]
dissociate ports <n-m>[,<n-m>[,…]]
dissociate targets <n> [,<n> [,…]]
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| controllers | Удаляет контроллеры из списка контроллеров, связанных с выбранным в данный момент LUN. Используйте только с поставщиками VDS 1,0. |
| ports; | Удаляет порты контроллера из списка портов контроллера, связанных с текущим выбранным LUN. Используйте только с поставщиками VDS 1,1. |
| целевые объекты | Удаляет целевые объекты из списка целевых объектов iSCSI, связанных с текущим выбранным LUN. Используйте только с поставщиками VDS 1,1. |
| `<n> [,<n> [,…]]` | Для использования с параметром **Controllers** или **Targets** . Указывает число контроллеров или целевых объектов iSCSI, которые должны быть заданы как неактивные или не являющиеся несвязанными. |
| `<n-m>[,<n-m>[,…]]` | Для использования с параметром **ports** . Указывает порты контроллера, которые нужно задать как неактивные с помощью пары номер контроллера (*n*) и номер порта (*m*). |

#### <a name="example"></a>Пример

```
DISKRAID> SEL LUN 5
LUN 5 is now the selected LUN.

DISKRAID> ASSOCIATE PORTS 0-0,0-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1)

DISKRAID> ASSOCIATE PORTS ADD 1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1, Ctlr 1 Port 1)

DISKRAID> DISSOCIATE PORTS 0-0,1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 1)
```

### <a name="exit"></a>exit

Завершает работу DiskRAID.

#### <a name="syntax"></a>Синтаксис

```
exit
```

### <a name="extend"></a>extend

Расширяет выбранный в данный момент LUN, добавляя секторы в конец LUN. Не все поставщики поддерживают расширение LUN. Не расширяет никакие тома и файловые системы, содержащиеся в LUN. После расширения LUN необходимо расширить связанные структуры на диске с помощью команды **DiskPart Extend** .

#### <a name="syntax"></a>Синтаксис

```
extend lun [size=<LUN_size>] [drives=<drive_number>, [<drive_number>, ...]] [noerr]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| размер; | Указывает размер в мегабайтах для расширения LUN. Необходимо указать либо *Размер* , либо `<drive>` параметр. Их также можно использовать вместе. Если параметр **size =** не указан, то номер LUN расширяется на максимально возможный размер, допустимый для всех указанных дисков. Если указан параметр **size =** , поставщики выбирают диски из списка, указанного параметром **Drives =** , для создания LUN. Чтобы указать размер с помощью других единиц, используйте один из следующих распознаваемых суффиксов сразу после размера:<ul><li>**B** -байт</li><li>**КБ** – КБ</li><li>**МБ** — мегабайт</li><li>**ГБ** -гигабайт</li><li>**ТБ** – терабайт</li><li>**Pb** -петабайтного уровня.</li></ul> |
| диски = | Указывает, какие `<drive_number>` диски следует использовать при создании LUN. Необходимо указать либо *Размер* , либо `<drive>` параметр. Их также можно использовать вместе. Если параметр **size =** не указан, то созданный LUN — это максимальный возможный размер, допустимый для всех указанных дисков. Поставщики используют диски в порядке, указанном по возможности. |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="flushcache"></a>флушкаче

Очищает кэш текущего выбранного контроллера.

#### <a name="syntax"></a>Синтаксис

```
flushcache controller
```

### <a name="help"></a>help

Отображает список всех команд DiskRAID.

#### <a name="syntax"></a>Синтаксис

```
help
```

### <a name="importtarget"></a>импорттаржет

Возвращает или задает текущий целевой объект импорта служба теневого копирования томов (VSS), заданный для выбранной в данный момент подсистемы.

#### <a name="syntax"></a>Синтаксис

```
importtarget subsystem [set target]
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| задать целевой объект | Задает выбранный целевой объект в качестве целевого объекта импорта VSS для выбранной в данный момент подсистемы. Если этот параметр не указан, команда извлекает текущий целевой объект импорта VSS, заданный для выбранной в данный момент подсистемы. |

### <a name="initiator"></a>initiator

Извлекает сведения о локальном инициаторе iSCSI.

#### <a name="syntax"></a>Синтаксис

```
initiator
```

### <a name="invalidatecache"></a>инвалидатекаче

Делает кэш недействительным на выбранном контроллере.

#### <a name="syntax"></a>Синтаксис

```
invalidatecache controller
```

### <a name="lbpolicy"></a>лбполици

Задает политику балансировки нагрузки для выбранного в данный момент LUN.

#### <a name="syntax"></a>Синтаксис

```
lbpolicy set lun type=<type> [paths=<path>-{primary | <weight>}[,<path>-{primary | <weight>}[,…]]]
lbpolicy set lun paths=<path>-{primary | <weight>}[,<path>-{primary | <weight>}[,…]]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| type | Указывает политику балансировки нагрузки. Если тип не указан, необходимо указать параметр **path** . Параметр Type может иметь одно из следующих значений:<ul><li>**Отработка отказа** — использует один первичный путь с другими путями для резервного копирования.</li><li>**Циклический перебор** — использует все пути циклическим перебором, который последовательно пытается использовать каждый путь.</li><li>**Субсетраундробин** — использует все первичные пути циклическим перебором; пути резервного копирования используются только в случае сбоя всех основных путей.</li><li>**Динлкд** — использует путь с наименьшим количеством активных запросов.<li><li>**Взвешенный** — использует путь с наименьшим весом (каждому пути должен быть назначен вес).</li><li>**Леастблоккс** — использует путь с наименьшими блоками.</li><li>**ВендорспеЦифик** — использует политику конкретного поставщика.</li></ul> |
| path | Указывает, является ли путь **первичным** или имеет определенный тип `<weight>` . Все пути, которые не указаны, неявно устанавливаются в качестве резервной копии. Все указанные пути должны быть одним из путей выбранного в данный момент LUN. |

### <a name="list"></a>list

Отображает список объектов указанного типа.

#### <a name="syntax"></a>Синтаксис

```
list {hbaports | iadapters | iportals | providers | subsystems | controllers | ports | drives | LUNs | tportals | targets | tpgroups}
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| хбапортс | Содержит сводную информацию обо всех портах HBA, известных службе VDS. Выбранный порт HBA помечается звездочкой (*). |
| иадаптерс | Содержит сводную информацию обо всех адаптерах инициатора iSCSI, известных службе VDS. Выбранный в данный момент адаптер инициатора отмечен звездочкой (*). |
| ипорталс | Содержит сводную информацию обо всех порталах инициатора iSCSI в выбранном в данный момент адаптере инициатора. Выбранный в данный момент портал инициатора отмечен звездочкой (*). |
| providers | Содержит сводную информацию о каждом поставщике, известном службе VDS. Выбранный в данный момент поставщик помечен звездочкой (*). |
| подсистемы | Содержит сводную информацию о каждой подсистеме в системе. Выбранная в данный момент подсистема помечена звездочкой (*). |
| controllers | Содержит сводную информацию о каждом контроллере в выбранной подсистеме. Выбранный контроллер отмечен звездочкой (*). |
| ports; | Содержит сводную информацию о каждом порте контроллера в выбранном контроллере. Текущий выбранный порт отмечен звездочкой (*). |
| диски | Содержит сводную информацию о каждом диске в выбранной подсистеме. Выбранный в данный момент диск отмечен звездочкой (*). |
| номеров | Содержит сводную информацию о каждом LUN в выбранной подсистеме. Выбранный в данный момент LUN помечен звездочкой (*). |
| тпорталс | Содержит сводную информацию обо всех порталах цели iSCSI в выбранной подсистеме. Выбранный на данный момент целевой портал помечен звездочкой (*). |
| целевые объекты | Содержит сводную информацию обо всех целевых объектах iSCSI в выбранной подсистеме. Выбранный в данный момент целевой объект помечен звездочкой (*). |
| тпграупс | Содержит сводную информацию обо всех группах порталов цели iSCSI в выбранном целевом объекте. Выбранная в данный момент группа портала помечается звездочкой (*). |

### <a name="login"></a>login

Записывает указанный адаптер инициатора iSCSI в текущую выбранную цель iSCSI.

#### <a name="syntax"></a>Синтаксис

```
login target iadapter=<iadapter> [type={manual | persistent | boot}] [chap={none | oneway | mutual}] [iportal=<iportal>] [tportal=<tportal>] [<flag> [<flag> […]]]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| type | Указывает тип выполняемого входа: **вручную** или **Постоянный**. Если не указано, будет выполнено ручное имя входа. |
| manual | Вход вручную. Существует также вариант **загрузки** , предназначенный для будущей разработки и не используемый в настоящее время. |
| надежно | Автоматически использовать одно и то же имя входа при перезапуске компьютера. |
| протокола | Указывает тип проверки подлинности CHAP: **None**, **OneWay** CHAP или **взаимный** CHAP; Если не указано, то проверка подлинности не используется. |
| тпортал | Указывает необязательный целевой портал в выбранной подсистеме, используемой для входа в систему. |
| ипортал | Указывает необязательный портал инициатора в указанном адаптере инициатора для использования при входе. |
| `<flag>` | Идентифицируется акронимами из трех букв:<ul><li>**IP-адреса** — требовать IPSec</li><li>**EMP** — Включение многопутевого ввода-вывода</li><li>**Ехд** -включить дайджест заголовка</li><li>**EDD** — включить дайджест данных</li></ul> |

### <a name="logout"></a>logout

Записывает указанный адаптер инициатора iSCSI из текущего выбранного целевого объекта iSCSI.

#### <a name="syntax"></a>Синтаксис

```
logout target iadapter= <iadapter>
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| иадаптер | Указывает адаптер инициатора с сеансом входа, из которого будет выполнен выход. |

### <a name="maintenance"></a>обслуживание;

Выполняет операции обслуживания для текущего выбранного объекта указанного типа.

#### <a name="syntax"></a>Синтаксис

```
maintenance <object operation> [count=<iteration>]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| `<object>` | Указывает тип объекта, для которого выполняется операция. Тип *объекта* может быть **подсистемой**, **контроллером**, **портом, диском** или **LUN**. |
| `<operation>` | Указывает операцию обслуживания для выполнения. Тип *операции* может быть **спинуп**, **спиндовн**, **мигающим**, **гудок** или **ping**. Необходимо указать *операцию* . |
| количество = | Указывает количество повторов *операции*. Обычно это используется с **мигающими**, **звуком**или **командой ping**. |

### <a name="name"></a>name

Устанавливает понятное имя выбранной подсистемы, LUN или целевого объекта iSCSI с указанным именем.

#### <a name="syntax"></a>Синтаксис

```
name {subsystem | lun | target} [<name>]
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| `<name>` | Указывает имя для подсистемы, LUN или целевого объекта. Длина имени должна быть меньше 64 символов. Если имя не указано, удаляется существующее имя. |

### <a name="offline"></a>автономно

Устанавливает состояние текущего выбранного объекта указанного типа в значение " **вне сети**".

#### <a name="syntax"></a>Синтаксис

```
offline <object>
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| `<object>` | Указывает тип объекта, для которого должна быть выполнена эта операция. Тип может быть: **подсистемой**, **контроллером**, **диском**, **LUN**или **тпортал**. |

### <a name="online"></a>в сети

Устанавливает состояние выбранного объекта указанного типа в значение "в **сети**". Если объект — **хбапорт**, изменяет состояние путей на выбранный в данный момент порт HBA на "в **сети**".

#### <a name="syntax"></a>Синтаксис

```
online <object>
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| `<object>` | Указывает тип объекта, для которого должна быть выполнена эта операция. Тип может быть: **хбапорт**, **подсистема**, **контроллер**, **диск**, **LUN**или **тпортал**. |

### <a name="recover"></a>recover

Выполняет необходимые операции, такие как повторная синхронизация или горячее резервирование, для восстановления выбранного в данный момент отказоустойчивого LUN. Например, восстановление может привести к привязке горячего резервирования к набору RAID, который имеет неисправный диск или другое перераспределение экстента диска.

#### <a name="syntax"></a>Синтаксис

```
recover <lun>
```

### <a name="reenumerate"></a>перечислить

Перечисление объектов указанного типа. При использовании команды Extend LUN необходимо использовать команду Refresh для обновления размера диска перед использованием команды reenumerat.

#### <a name="syntax"></a>Синтаксис

```
reenumerate {subsystems | drives}
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| подсистемы | Запрашивает у поставщика обнаружение новых подсистем, которые были добавлены в текущий выбранный поставщик. |
| диски | Запрашивает внутренние шины ввода-вывода для обнаружения новых дисков, добавленных в выбранной подсистеме. |

### <a name="refresh"></a>refresh

Обновляет внутренние данные для выбранного в данный момент поставщика.

#### <a name="syntax"></a>Синтаксис

```
refresh provider
```

### <a name="rem"></a>rem

Используется для комментирования скриптов.

#### <a name="syntax"></a>Синтаксис

```
Rem <comment>
```

### <a name="remove"></a>remove

Удаляет указанный портал цели iSCSI из выбранной целевой группы портала.

#### <a name="syntax"></a>Синтаксис

```
remove tpgroup tportal=<tportal> [noerr]
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| тпграуп тпортал =`<tportal>` | Указывает конечный портал iSCSI для удаления. |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="replace"></a>replace

Заменяет указанный диск на выбранный в данный момент диск. Возможно, указанный диск не является выбранным в данный момент.

#### <a name="syntax"></a>Синтаксис

```
replace drive=<drive_number>
```

##### <a name="parameter"></a>Параметр

| Параметр | Описание |
| --------- | ----------- |
| диск = | Указывает `<drive_number>` диск для замены. |

### <a name="reset"></a>сброс

Сброс текущего выбранного контроллера или порта.

#### <a name="syntax"></a>Синтаксис

```
reset {controller | port}
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| controller | Сбрасывает контроллер. |
| порт | Сбрасывает порт. |

### <a name="select"></a>select

Отображает или изменяет текущий выбранный объект.

#### <a name="syntax"></a>Синтаксис

```
select {hbaport | iadapter | iportal | provider | subsystem | controller | port | drive | lun | tportal | target | tpgroup } [<n>]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| object | Указывает тип объекта для выбора, включая **поставщик**, **подсистему**, **контроллер**, **диск**или **LUN**. |
| хбапорт`[<n>]` | Устанавливает фокус на указанный локальный порт HBA. Если порт HBA не указан, команда отображает текущий выбранный порт HBA (если он есть). Указание недопустимого индекса порта HBA приведет к отсутствию порта HBA в фокусе. При выборе порта HBA отменяются выбранные адаптеры инициатора и порталы инициатора. |
| иадаптер`[<n>]` | Устанавливает фокус на указанный локальный адаптер инициатора iSCSI. Если адаптер инициатора не указан, команда отображает выбранный в данный момент адаптер инициатора (если он есть). Если указать недопустимый индекс адаптера инициатора, то он не поместится в адаптер инициатора. Выбор адаптера инициатора отменяет выбор всех выбранных портов HBA и порталов инициатора. |
| ипортал`[<n>]` | Устанавливает фокус на указанный локальный портал инициатора iSCSI в выбранном адаптере инициатора iSCSI. Если портал инициатора не указан, команда отображает текущий выбранный портал инициатора (если он есть). Задание недействительного индекса портала инициатора приведет к отсутствию выбранного портала инициатора. |
| поставщики`[<n>]` | Устанавливает фокус на указанного поставщика. Если поставщик не указан, команда отображает текущий выбранный поставщик (если он есть). Если указать недопустимый индекс поставщика, то поставщик не имеет фокуса. |
| подсистемы`[<n>]` | Устанавливает фокус на указанную подсистему. Если подсистема не указана, команда отображает подсистему с фокусом (при наличии). Если указать недопустимый индекс подсистемы, подсистема в фокусе не создается. Выбор подсистемы неявно выбирает соответствующий поставщик. |
| контроллера`[<n>]` | Устанавливает фокус на указанный контроллер в текущей выбранной подсистеме. Если контроллер не указан, команда отображает текущий выбранный контроллер (если он есть). Если указать недопустимый индекс контроллера, то контроллер не находится в фокусе. При выборе контроллера отменяется выбор выбранных портов контроллера, дисков, LUN, целевых порталов, целевых объектов и групп целевых порталов. |
| порту`[<n>]` | Устанавливает фокус на указанный порт контроллера в текущем выбранном контроллере. Если порт не указан, команда отображает текущий выбранный порт (если он есть). Если указать недопустимый индекс порта, то выбранный порт не выдается. |
| диск`[<n>]` | Задает фокус на указанном диске или физическом шпинделе в текущей выбранной подсистеме. Если диск не указан, команда отображает выбранный в данный момент диск (если он есть). Если указать недопустимый индекс диска, то диск не находится в фокусе. Выбор диска отменяет выбор выбранных контроллеров, портов контроллера, LUN, целевых порталов, целевых объектов и групп целевых порталов. |
| номеров`[<n>]` | Устанавливает фокус на указанный LUN в текущей выбранной подсистеме. Если LUN не указан, команда отображает текущий выбранный LUN (если он есть). При указании недопустимых значений индекса LUN не выбран LUN. При выборе LUN отменяется выбор выбранных контроллеров, портов контроллера, дисков, целевых порталов, целевых объектов и групп целевых порталов. |
| тпортал`[<n>]` | Устанавливает фокус на указанный портал цели iSCSI в выбранной подсистеме. Если целевой портал не указан, команда отображает выбранный на данный момент целевой портал (если он есть). Указание недопустимого индекса целевого портала. результаты не выбраны на целевом портале. Выбор целевого портала отменяет выбор всех контроллеров, портов контроллера, дисков, LUN, целевых объектов и групп целевых порталов. |
| мишень`[<n>]` | Устанавливает фокус на указанную цель iSCSI в текущей выбранной подсистеме. Если целевой объект не указан, команда отображает выбранный в данный момент целевой объект (если он есть). При указании недопустимого целевого индекса результаты не выбраны. Выбор целевого объекта отменяет выбор всех контроллеров, портов контроллера, дисков, LUN, целевых порталов и групп целевых порталов. |
| тпграуп`[<n>]` | Устанавливает фокус на указанную группу порталов цели iSCSI в текущей выбранной цели iSCSI. Если группа конечных порталов не указана, команда отображает выбранную группу целевых порталов (если она есть). Если указать недопустимый индекс группы конечного портала, то группа целевых порталов не находится в фокусе. |
|`[<n>]` | Задает `<object number>` для выбора. Если `<object number>` указанный объект является недопустимым, все существующие элементы указанного типа будут удалены. Если `<object number>` значение не указано, отображается текущий объект.

### <a name="setflag"></a>setflag

Задает выбранный в данный момент диск в качестве устройства горячего резервирования. Горячий резерв не может использоваться для обычных операций привязки LUN. Они зарезервированы только для обработки ошибок. Сейчас диск не должен быть привязан к какому бы то ни было существующему LUN.

#### <a name="syntax"></a>Синтаксис

```
setflag drive hotspare={true | false}
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| true | Выбирает выбранный в данный момент диск в качестве устройства горячего резервирования. |
| false | Отменяет выбор выбранного диска в качестве устройства горячего резервирования. |

### <a name="shrink"></a>shrink

Уменьшает размер выбранного LUN.

#### <a name="syntax"></a>Синтаксис

```
shrink lun size=<n> [noerr]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| размер; | Указывает требуемый объем пространства в мегабайтах (МБ) для уменьшения размера LUN. Чтобы указать размер с помощью других единиц, используйте один из следующих распознаваемых суффиксов сразу после размера:<ul><li>**B** -байт</li><li>**КБ** – КБ</li><li>**МБ** — мегабайт</li><li>**ГБ** -гигабайт</li><li>**ТБ** – терабайт</li><li>**Pb** -петабайтного уровня. |
| Noerr | Только для сценариев. При возникновении ошибки DiskRAID продолжит обрабатывать команды, как если бы ошибка не возникала. |

### <a name="standby"></a>резервные

Изменяет состояние путей на выбранный в данный момент порт адаптера шины узла (HBA) на STANDBY.

#### <a name="syntax"></a>Синтаксис

```
standby hbaport
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| хбапорт | Изменяет состояние путей на выбранный в данный момент порт адаптера шины узла (HBA) на STANDBY. |

### <a name="unmask"></a>unmask

Делает текущие выбранные LUN доступными из указанных узлов.

#### <a name="syntax"></a>Синтаксис

```
unmask lun {all | none | [add] wwn=<hexadecimal_number> [;<hexadecimal_number> [;…]] | [add] initiator=<initiator>[;<initiator>[;…]]} [uninstall]
```

##### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- | ----------- |
| all | Указывает, что LUN должен быть доступен со всех узлов. Однако вы не можете снять маску LUN для всех целевых объектов в подсистеме iSCSI.<P>Перед выполнением команды необходимо выйти из целевого объекта `unmask lun all` . |
| нет | Указывает, что LUN не должен быть доступен ни для одного узла.<P>Перед выполнением команды необходимо выйти из целевого объекта `unmask lun none` . |
| add | Указывает, что указанные узлы должны быть добавлены к существующему списку узлов, из которого доступен этот LUN. Если этот параметр не указан, список узлов заменяет существующий список узлов, с которого доступен этот LUN. |
| WWN = | Задает список шестнадцатеричных чисел, представляющих WWN-имена, из которых должны быть доступны LUN или узлы. Чтобы замаскировать или снять маску для определенного набора узлов в подсистеме Fibre Channel, можно ввести разделенный точками с запятой список WWN для портов на интересующих компьютерах. |
| Инициатор = | Указывает список инициаторов iSCSI, к которым должен быть предоставлен доступ к выбранному в данный момент LUN. Чтобы замаскировать или снять маску для определенного набора узлов в подсистеме iSCSI, можно ввести разделенный точками с запятой список имен инициаторов iSCSI для инициаторов на интересующих компьютерах. |
| uninstall | Если этот параметр указан, удаляется диск, связанный с LUN, в локальной системе до маскирования LUN. |

## <a name="scripting-diskraid"></a>Создание скриптов для DiskRAID

DiskRAID можно включить в скрипт на любом компьютере под управлением поддерживаемой версии Windows Server с соответствующим поставщиком оборудования VDS. Чтобы вызвать сценарий DiskRAID, в командной строке введите:

```
diskraid /s <script.txt>
```

По умолчанию DiskRAID останавливает обработку команд и возвращает код ошибки, если в скрипте возникла проблема. Чтобы продолжить выполнение скрипта и игнорировать ошибки, включите в команду параметр **noerr** . Это позволяет использовать такие полезные методики, как использование одного сценария для удаления всех LUN в подсистеме независимо от общего числа LUN. Не все команды поддерживают параметр **noerr** . Ошибки всегда возвращаются при ошибках синтаксиса команд, независимо от того, включен ли параметр **noerr** .

## <a name="diskraid-error-codes"></a>Коды ошибок DiskRAID

| Код ошибки | Описание ошибки |
| ---------- | ----------------- |
| 0 | Без ошибок. Весь сценарий выполнялся без ошибок. |
| 1 | Возникло неустранимое исключение. |
| 2 | В командной строке DiskRAID указаны неправильные аргументы. |
| 3 | DiskRAID не смог открыть указанный скрипт или выходной файл. |
| 4 | Одна из служб, используемых DiskRAID, вернула ошибку. |
| 5 | Произошла ошибка синтаксиса команды. Произошел сбой скрипта, так как объект был неправильно выбран или недопустим для использования с этой командой. |

## <a name="example"></a>Пример

Чтобы просмотреть состояние подсистемы 0 на компьютере, введите:

```
diskraid
```

Нажмите клавиши ВВОД и вывод, как показано ниже:

```
Microsoft Diskraid version 5.2.xxxx
Copyright (©) 2003 Microsoft Corporation
On computer: COMPUTER_NAME
```

Чтобы выбрать подсистему 0, введите следующую команду в командной строке DiskRAID:

```
select subsystem 0
```

Нажмите клавиши ВВОД и вывод, как показано ниже:

```
Subsystem 0 is now the selected subsystem.

DISKRAID> list drives

  Drive ###  Status      Health          Size      Free    Bus  Slot  Flags
  ---------  ----------  ------------  --------  --------  ---  ----  -----
  Drive 0    Online      Healthy         107 GB    107 GB    0     1
  Drive 1    Offline     Healthy          29 GB     29 GB    1     0
  Drive 2    Online      Healthy         107 GB    107 GB    0     2
  Drive 3    Not Ready   Healthy          19 GB     19 GB    1     1
```

Чтобы выйти из программы DiskRAID, введите следующую команду в командной строке DiskRAID:

```
exit
```

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)