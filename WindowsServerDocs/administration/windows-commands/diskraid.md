---
title: diskraid
description: 'Раздел Windows команды для ***- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 20aef1e5-7641-47cf-b4eb-cda117f65b6e
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 7ebd65fb56114bff9e6ae4b6a76376561c686dfa
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66439564"
---
# <a name="diskraid"></a>diskraid



DiskRAID является средством командной строки, которая позволяет настраивать и управлять избыточного массива независимых (или недорогих) дисков (RAID) подсистем хранения.

RAID — это метод, используемый для стандартизации и классификации отказоустойчивые дисковые системы. Уровни RAID с различными сочетаниями производительности, надежности и стоимости. RAID-МАССИВА обычно используется на серверах. Некоторые серверы поддерживают три уровня RAID: Уровень 0 (чередование), уровень 1 (зеркальное отображение) и уровень 5 (распределение с контролем четности).

Аппаратный RAID подсистемы отличает единиц хранилища физически адресацией друг у друга с помощью логического номера устройства (LUN). Объект LUN должен иметь по крайней мере один команд, как и может иметь любое количество дополнительных плексов. Каждый жных содержит копию данных в объекте LUN. Плексов можно добавить и удалена из объекта LUN.

Большинство команд DiskRAID оперируют порта адаптера шины конкретного узла, инициатора адаптера, портал инициатора, поставщика, подсистемы, контроллера, порт, диск, LUN, целевой портал, целевой объект или группа конечного портала. Используйте команды SELECT для выбора объекта. Считается, что выбранный объект имеет фокус. Фокус упрощает общие задачи настройки, таких как создание нескольких LUN в одну подсистему.

> [!NOTE]
> Средство командной строки DiskRAID работает только с подсистемами хранения, которые поддерживают службы виртуальных дисков (VDS).

## <a name="diskraid-commands"></a>Команды DiskRAID

Чтобы просмотреть синтаксис команды, щелкните команду:
-   [add](#BKMK_1)
-   [связать](#BKMK_2)
-   [автоматического](#BKMK_3)
-   [break](#BKMK_4)
-   [CHAP](#BKMK_5)
-   [Создание](#BKMK_6)
-   [delete](#BKMK_7)
-   [Подробности](#BKMK_8)
-   [Отменить связь](#BKMK_9)
-   [exit](#BKMK_10)
-   [Расширить](#BKMK_11)
-   [flushcache](#BKMK_12)
-   [help](#BKMK_13)
-   [importtarget](#BKMK_14)
-   [Инициатор](#BKMK_15)
-   [invalidatecache](#BKMK_16)
-   [lbpolicy](#BKMK_18)
-   [Список](#BKMK_19)
-   [Имя входа](#BKMK_20)
-   [Выход из системы](#BKMK_21)
-   [Обслуживание](#BKMK_22)
-   [name](#BKMK_23)
-   [Автономный режим](#BKMK_24)
-   [Онлайн](#BKMK_25)
-   [recover](#BKMK_26)
-   [reenumerate](#BKMK_27)
-   [обновления](#BKMK_28)
-   [rem](#BKMK_29)
-   [удалить](#BKMK_30)
-   [replace](#BKMK_31)
-   [Сброс](#BKMK_32)
-   [Выберите](#BKMK_33)
-   [setflag](#BKMK_34)
-   [Сжатие](#BKMK_shrink)
-   [ждущий режим](#BKMK_35)
-   [снять маску](#BKMK_36)

### <a name="BKMK_1"></a>Добавить

Добавляет существующего LUN для выбранного LUN или портала цели iSCSI в выбранном iSCSI целевую портала группу.

#### <a name="syntax"></a>Синтаксис

```
add plex lun=n [noerr]
add tpgroup tportal=n [noerr]
```

#### <a name="parameters"></a>Параметры

**lun жных**=*n*

Указывает номер LUN, добавляемый в качестве команд, как что LUN.

> [!CAUTION]
> Все данные на логическом диске, добавляется в качестве команд, как будут удалены.

**портала TPGROUP =** <em>n</em>

Номер iSCSI целевого портала добавляемый группа выбранных iSCSI конечного портала.

**успешного**

Указывает, что все ошибки, возникающие при выполнении этой операции будет игнорироваться. Это полезно в режиме сценария.

### <a name="BKMK_2"></a>связать

Задает указанный список контроллера порты как активные для выбранного LUN (порты являются сделана неактивной другому контроллеру), добавляет указанный контроллер порты в список имеющихся портов активного контроллера для текущего выбранного LUN или связывает целевой объект iSCSI, указанный для текущего выбранного LUN.

#### <a name="syntax"></a>Синтаксис

```
associate controllers [add] <n>[,<n> [,…]]
associate ports [add] <n-m>[,<n-m>[,…]]
associate targets [add] <n>[,<n> [,…]]
```

#### <a name="parameters"></a>Параметры

**Контроллеры**

Для использования только поставщики VDS 1.0. Добавляет или заменяет список контроллеров, которые связаны с выбранного LUN.

**Порты**

Для использования только поставщики VDS 1.1. Добавляет или заменяет списка портов контроллера, которые связаны с выбранного LUN.

**Целевые объекты**

Для использования только поставщики VDS 1.1. Добавляет или заменяет список целевых объектов iSCSI, которые связаны с выбранного LUN.

**add**

Для поставщиков VDS 1.0 добавляет указанный контроллеров в существующий список контроллеров, связанной с LUN. Если этот параметр не указан, список контроллеров заменяет существующий список контроллеров, связанных с данным LUN.

Для поставщиков VDS 1.1 добавляет указанный контроллер портов в существующий список портов контроллера, связанных с LUN. Если этот параметр не указан, список портов контроллера заменяет существующий список портов контроллера, связанных с данным LUN.
```
<n>[,<n> [, ...]]
```
Для использования с **контроллеров** или **целевых объектов** параметра. Указывает количество контроллеров или целей iSCSI, чтобы задать значение "active" или "связывание.
```
<n-m>[,<n-m>[,…]]
```
Для использования с **порты** параметра. Указывает контроллер порты, которые нужно установить в качестве активного, с помощью нескольких контроллера (*n*) и номер порта (*m*) пары.

#### <a name="example"></a>Пример

В следующем примере показано, как связать и добавьте порты на LUN, который использует поставщик VDS 1.1:
```
DISKRAID> SEL LUN 5
LUN 5 is now the selected LUN.

DISKRAID> ASSOCIATE PORTS 0-0,0-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1)

DISKRAID> ASSOCIATE PORTS ADD 1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1, Ctlr 1 Port 1)
```

### <a name="BKMK_3"></a>автоматического

Задает или удаляет значение флагов, давать подсказки к поставщикам о том, как настроить LUN. При использовании без параметров **автоматического** операция отображает список флагов.

#### <a name="syntax"></a>Синтаксис

```
automagic {set | clear | apply} all <flag=value> [<flag=value> [...]]
```

#### <a name="parameters"></a>Параметры

**set**

Задает указанные флаги, указанные значения.

**Очистить**

Удаляет указанные флаги. **Все** ключевое слово очищает все флаги автоматического.

**применить**

Применяет флагов текущего выбранного логическому устройству.

\<флаг >

Флаги определяются двухбуквенные сокращения.

|Flag|Описание|
|----|-----------|
|FCR|Быстрое восстановление после сбоя требуется|
|FTL|Отказоустойчивость|
|MSR|В основном чтение|
|MXD|Более жестких дисков|
|MXS|Требуется задать максимальный размер|
|ORA|Выравнивание оптимальной чтения|
|СХЕМУ ИЛИ|Размер оптимальной чтения|
|OSR|Оптимизировать для|
|OSW|Оптимизация для последовательных операций записи|
|ВЕБ-КЛИЕНТА OUTLOOK|Выравнивание оптимальной записи|
|OWS|Размер оптимальной записи|
|RBP|Перестроить приоритет|
|RBV|Проверьте чтения обратно включена|
|ОБ|Преобразования включены|
|СЛУЖБА МАРКЕРОВ БЕЗОПАСНОСТИ|Размер блока чередования|
|WTC|Сквозной записи включено кэширование|
|YNK|Съемные|

### <a name="BKMK_4"></a>break

Удаляет жных из выбранного LUN. Команд, как и данные, содержащиеся в ней не сохраняются, и могут быть исправлены области диска.

#### <a name="syntax"></a>Синтаксис

```
break plex=<plex_number> [noerr]
```

#### <a name="parameters"></a>Параметры

**команд, как**

Указывает количество команд, как для удаления. Команд, как и данные, содержащиеся в ней не будут сохранены, и ресурсы, используемые им будет освобождено. Данные, содержащиеся в LUN не гарантируется согласованность. Если вы хотите сохранить этот жных, используйте службы для теневого копирования томов (VSS).

**успешного**

Указывает, что все ошибки, возникающие при выполнении этой операции будет игнорироваться. Это полезно в режиме сценария.

#### <a name="remarks"></a>Примечания

> [!NOTE]
> Перед использованием необходимо сначала выбрать отраженные LUN **break** команды.

> [!CAUTION]
> Все данные на команд, как будут удалены.

> [!CAUTION]
> Все данные, содержащиеся в исходном LUN не гарантируется согласованность.

### <a name="BKMK_5"></a>CHAP

Задает проверки пароля протокола (CHAP) общего секрета, инициаторы iSCSI и целей iSCSI мог обмениваться данными друг с другом.

#### <a name="syntax"></a>Синтаксис

```
chap initiator set secret=[<secret>] [target=<target>]
chap initiator remember secret=[<secret>] target=<target>
chap target set secret=[<secret>] [initiator=<initiatorname>]
chap target remember secret=[<secret>] initiator=<initiatorname>
```

#### <a name="parameters"></a>Параметры

**набор инициатора**

Задает общий секрет в службу инициатора iSCSI локальный, использующееся для взаимной проверки подлинности CHAP для инициатора подлинность целевого устройства.

**Помните, инициатора**

Взаимодействует секрет CHAP цели iSCSI в службу инициатора iSCSI на локальном, вызывающая служба может использовать секрет для прохождения проверки подлинности к целевому объекту во время проверки подлинности CHAP.

**набор целей**

Задает общий секрет в целевой объект текущего выбранного iSCSI, используемый для проверки подлинности CHAP, когда целевое устройство проверяет подлинность инициатора.

**Помните, целевой объект**

Взаимодействует секрет CHAP инициатора iSCSI для текущего целевого объекта iSCSI с фокусом, таким образом, чтобы целевой объект можно использовать секрет для прохождения проверки подлинности в инициаторе во время взаимной проверки подлинности CHAP.

**Секрет**

Секретный код для использования. Если не указано, будет удалено секрет.

**target**

Указывает целевой объект в выбранной подсистеме, связываемый с секретным кодом. Это необязательно, при задании секрет инициатора и не отобразит его указывает, что секретный код будет использоваться для всех целевых объектов, у вас нет связанных секрет.

**initiatorname**

Указывает имя инициатора iSCSI, связываемый с секретным кодом. Это необязательно, при задании секрет целевого объекта и не отобразит его указывает, что секретный код будет использоваться для всех инициаторов, которые у вас нет связанных секрет.

### <a name="BKMK_6"></a>Создание

Создает новый LUN или цель iSCSI на выбранной подсистеме или создает группу конечных порталов для выбранного объекта. Можно просмотреть Фактическая привязка с использованием **списка DiskRAID** команды.

#### <a name="syntax"></a>Синтаксис

```
create lun simple [size=<n>] [drives=<n>] [noerr]
create lun stripe [size=<n>] [drives=<n, n> [,...]]  [stripesize=<n>] [noerr]
create lun raid [size=<n>] [drives=<n, n> [,...]] [stripesize=<n>] [noerr]
create lun mirror [size=<n>] [drives=<n, n> [,...]] [stripesize=<n>] [noerr]
create lun automagic size=<n> [noerr]
create target name=<name> [iscsiname=<iscsiname>] [noerr]
create tpgroup [noerr]
```

#### <a name="parameter"></a>Параметр

**Простой**

Создает простой LUN.

**Stripe**

Создает чередующийся LUN.

**RAID**

Создает чередующиеся LUN с контролем четности.

**зеркальный**

Создает отраженные LUN.

**автоматического**

Создает LUN с помощью *автоматического* подсказки в данный момент. См. в разделе **автоматического** вложенные команды, Дополнительные сведения.

**Размер**=

Определяет общий размер LUN в мегабайтах. Если **размер =** параметр не указан, создать LUN будет наибольшего возможного размера, допускаемых все указанные диски.

Поставщик обычно создает LUN по крайней мере столь значительной, как запрошенный размер, но может потребоваться округление вверх до следующего наибольшего размера в некоторых случаях поставщик. Например если размер задан как.99 ГБ и поставщик может помещать только ГБ областей диска, полученный LUN будет 1 ГБ.

Чтобы указать размер, используя другие единицы измерения, используйте один из следующих суффиксов распознанных сразу после размера.
-   **B** для байтов.
-   **КБ** для килобайт.
-   **МБ** для мегабайт.
-   **ГБ** за гигабайт.
-   **ТБ** для терабайта.
-   **PB** для до нескольких петабайт.

**диски**=

Указывает *drive_number* для дисков, используемых для создания LUN. Если **размер =** параметра не указано, создать LUN наибольшего возможного размера, допускаемых все указанные диски. Если **размер =** параметр указан, поставщики будет выбирать диски из списка указанный диск, чтобы создать LUN. Поставщики будет пытаться использовать диски в порядке, указанном по возможности.

**stripesize**=

Указывает размер в мегабайтах для *stripe* или *RAID* LUN. Stripesize нельзя изменить после создания LUN.

Чтобы указать размер, используя другие единицы измерения, используйте один из следующих суффиксов распознанных сразу после размера.
-   **B** для байтов.
-   **КБ** для килобайт.
-   **МБ** для мегабайт.
-   **ГБ** за гигабайт.
-   **ТБ** для терабайта.
-   **PB** для до нескольких петабайт.

**target**

Создает новую цель iSCSI на выбранной подсистеме.

**name**

Содержит понятное имя для целевого объекта.

**iscsiname**

Блоки iSCSI имя для целевого объекта и может быть опущен для поставщика создания имени.

**TPGROUP**

Создает новую группу портала целевой объект iSCSI на данный момент выбранного целевого объекта.

**успешного**

Указывает, что все ошибки, возникающие при выполнении этой операции будет игнорироваться. Это полезно в режиме сценария.

#### <a name="remarks"></a>Примечания

-   Либо **размер**= или **дисков**= параметр должен быть указан. Они могут также использоваться совместно.
-   После создания невозможно изменить размер блока чередования для LUN.

### <a name="BKMK_7"></a>Удаление

Удаление выбранного LUN, цели iSCSI (если есть не все LUN, связанный с целевым объектом iSCSI) или iSCSI целевого портала группы.

#### <a name="syntax"></a>Синтаксис

```
delete lun [uninstall] [noerr]
delete target [noerr]
delete tpgroup [noerr]
```

#### <a name="parameters"></a>Параметры

**LUN**

Удаление выбранного LUN и все данные на нем.

**Удаление**

Указывает, что диск в локальной системе, связанной с LUN будет удален перед удалением LUN.

**target**

Удаляет целевой объект текущего выбранного iSCSI, если ни один LUN связаны с целевым объектом.

**TPGROUP**

Удаляет группу портала текущего выбранного iSCSI target.

**успешного**

Указывает, что все ошибки, возникающие при выполнении этой операции будет игнорироваться. Это полезно в режиме сценария.

### <a name="BKMK_8"></a>Подробности

Отображает подробные сведения о текущий выбранный объект указанного типа.

#### <a name="syntax"></a>Синтаксис

```
Detail {hbaport | iadapter | iportal | provider | subsystem | controller | port | drive | lun | tportal | target | tpgroup} [verbose]
```

#### <a name="parameters"></a>Параметры

**HBAPORT**

Содержит подробные сведения о порте адаптера шины текущего выбранного узла.

**IADAPTER**

Содержит подробные сведения об адаптере инициатора iSCSI на текущий выбранный.

**IPORTAL**

Содержит подробные сведения о портале инициатора iSCSI на текущий выбранный.

**Поставщик**

Содержит подробные сведения о выбранном поставщике.

**подсистемы**

Содержит подробные сведения о выбранной подсистеме.

**Контроллер**

Содержит подробные сведения о выбранном контроллере.

**Порт**

Содержит подробные сведения о порте текущего выбранного контроллера.

**Диск**

Содержит подробные сведения о выбранном диске, включая занятую LUN.

**LUN**

Списки подробные сведения о выбранном LUN, включая и сопутствующие дисков. Выходных данных зависит от того, является ли LUN частью подсистемы Fibre Channel или iSCSI. Если в список немаскированные узлов содержит только символ звездочки, это означает, что LUN раскрыт для всех узлов.

**портала**

Содержит подробные сведения о портала цели iSCSI текущего выбранного.

**target**

Содержит подробные сведения о целевой объект текущего выбранного iSCSI.

**TPGROUP**

Содержит подробные сведения о группе целевого портала iSCSI текущего выбранного.

**Verbose**

Для использования только с параметром LUN. Список дополнительных данных, включая его плексов.

### <a name="BKMK_9"></a>Отменить связь

Наборы указанный список портов контроллера как неактивные для выбранного LUN (другой контроллер порты не затрагиваются), или отменяет связь указанного списка целевых объектов iSCSI для текущего выбранного LUN.

#### <a name="syntax"></a>Синтаксис

```
dissociate controllers <n> [,<n> [,...]]
dissociate ports <n-m>[,<n-m>[,…]]
dissociate targets <n> [,<n> [,…]]
```

#### <a name="parameter"></a>Параметр

**Контроллеры**

Для использования только поставщики VDS 1.0. Удаляет контроллеров из списка контроллеров, которые связаны с выбранного LUN.

**Порты**

Для использования только поставщики VDS 1.1. Удаляет контроллера порты из списка портов контроллера, которые связаны с выбранного LUN.

**Целевые объекты**

Для использования только поставщики VDS 1.1. Удаление целевых объектов из списка целей iSCSI, которые связаны с выбранного LUN.
```
<n> [,<n> [,…]]
```
Для использования с **контроллеров** или **целевых объектов** параметра. Указывает количество контроллеров или целей iSCSI, чтобы установить как неактивную или удалить связь.
```
<n-m>[,<n-m>[,…]]
```
Для использования с **порты** параметра. Указывает контроллер порты, которые нужно задать как неактивные, с помощью номера контроллера (*n*) и номер порта (*m*) пары.

#### <a name="example"></a>Пример

```
DISKRAID> SEL LUN 5
LUN 5 is now the selected LUN.

DISKRAID> ASSOCIATE PORTS 0-0,0-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1)

DISKRAID> ASSOCIATE PORTS ADD 1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 0, Ctlr 0 Port 1, Ctlr 1 Port 1)

DISKRAID> DISSOCIATE PORTS 0-0,1-1
Controller port associations changed.
(Controller ports active after this command: Ctlr 0 Port 1)
```

### <a name="BKMK_10"></a>exit

Выполняет выход из DiskRAID.

#### <a name="syntax"></a>Синтаксис

```
exit
```

### <a name="BKMK_11"></a>Расширить

Расширяет что LUN, добавляя секторов в конец LUN. Не все поставщики поддерживают расширение LUN. Не расширяет все тома или файловые системы, содержащихся на логическом диске. После расширения LUN, следует использовать расширения связанных структур на диске, с помощью **расширить DiskPart** команды.

#### <a name="syntax"></a>Синтаксис

```
extend lun [size=<LUN_size>] [drives=<drive_number>, [<drive_number>, ...]] [noerr]
```

#### <a name="parameters"></a>Параметры

**размер =**

Указывает размер в мегабайтах для расширения LUN. Если **размер =** параметр не указан, LUN расширяется за счет наибольшего возможного размера, допускаемых все указанные диски. Если **размер =** параметр указан, поставщики выберите диски из списка, указанного параметром **дисков =** параметр, чтобы создать LUN.

Чтобы указать размер, используя другие единицы измерения, используйте один из следующих суффиксов распознанных сразу после размера.
-   **B** для байтов.
-   **КБ** для килобайт.
-   **МБ** для мегабайт.
-   **ГБ** за гигабайт.
-   **ТБ** для терабайта
-   **PB** для до нескольких петабайт

**диски =**

Указывает \<drive_number > для дисков, используемых при создании LUN. Если **размер =** параметра не указано, создать LUN наибольшего возможного размера, допускаемых все указанные диски. Поставщики используют диски в порядке, указанном по возможности.

**успешного**

Указывает, что следует игнорировать все ошибки, возникающие при выполнении этой операции. Это полезно в режиме сценария.

#### <a name="remarks"></a>Примечания

Либо *размер* или \<диска > необходимо указать параметр. Они могут также использоваться совместно.

### <a name="BKMK_12"></a>flushcache

Очищает кэш на выбранном контроллере.

#### <a name="syntax"></a>Синтаксис

```
flushcache controller
```

### <a name="BKMK_13"></a>Справка

Отображает список всех команд DiskRAID.

#### <a name="syntax"></a>Синтаксис

```
help
```

### <a name="BKMK_14"></a>importtarget

Возвращает или задает текущий целевой объект импорта службы теневого копирования томов (VSS), настроенный для текущего выбранного подсистемы.

#### <a name="syntax"></a>Синтаксис

```
importtarget subsystem [set target]
```

#### <a name="parameter"></a>Параметр

**целевой набор**

Задает текущий выбранный целевой объект в целевой объект импорта VSS для выбранной подсистеме. Если не указан, команда извлекает текущий целевой объект импорта VSS, установленную для выбранной подсистеме.

### <a name="BKMK_15"></a>Инициатор

Извлекает сведения о локальном инициаторе iSCSI.

#### <a name="syntax"></a>Синтаксис

```
initiator
```

### <a name="BKMK_16"></a>invalidatecache

Делает недействительным кэш на выбранном контроллере.

#### <a name="syntax"></a>Синтаксис

```
invalidatecache controller
```

### <a name="BKMK_18"></a>lbpolicy

Задает политики балансировки нагрузки на выбранном логическом диске.

#### <a name="syntax"></a>Синтаксис

```
lbpolicy set lun type=<type> [paths=<path>-{primary | <weight>}[,<path>-{primary | <weight>}[,…]]]
lbpolicy set lun paths=<path>-{primary | <weight>}[,<path>-{primary | <weight>}[,…]]
```

#### <a name="parameters"></a>Параметры

**type**

Задает политики балансировки нагрузки. Если тип не указан, то **путь** параметр должен быть указан. Тип может принимать одно из следующих:

**ОТРАБОТКА ОТКАЗА**: Использует один основной путь с другими путями, путей создания резервной копии.

**ЦИКЛИЧЕСКИЙ ПЕРЕБОР**: Использует все пути циклического перебора, который последовательно пытается каждого пути.

**SUBSETROUNDROBIN**: Использует всех основных путей в циклического перебора; путей создания резервной копии используются только в том случае, при отказе всех основных путей.

**DYNLQD**: Использует путь с наименьшим числом активных запросов.

**ВЗВЕШЕННОЕ**: Использует путь с наименьшим весом (каждого пути должны быть назначены вес).

**LEASTBLOCKS**: Использует путь с Наименьшие блоки.

**VENDORSPECIFIC**: Использует политику поставщика.

**Пути**

Указывает, является ли путь **основной** или имеет определенный \<вес >. Все пути, не указанные неявно задаются как резервное копирование. Все пути в списке должен быть одним из путей к выбранному LUN.

### <a name="BKMK_19"></a>Список

Отображает список объектов указанного типа.

#### <a name="syntax"></a>Синтаксис

```
List {hbaports | iadapters | iportals | providers | subsystems | controllers | ports | drives | LUNs | tportals | targets | tpgroups}
```

#### <a name="parameters"></a>Параметры

**hbaports**

Приведены сводные сведения о всех портов адаптера ШИНЫ, известные для службы виртуальных ДИСКОВ. Выбранный порт адаптера ШИНЫ помечается звездочкой (*).

**iadapters**

Приведены сводные сведения о всех адаптерах инициатора iSCSI, известно, VDS. Текущий выбранный инициатора адаптера помечается звездочкой (*).

**iportals**

Приведены сводные сведения о всех порталах инициатора iSCSI в выбранном инициатора адаптера. На портале текущий выбранный инициатора помечается звездочкой (*).

**Поставщики**

Приведены сводные сведения о каждого поставщика, известные для службы виртуальных ДИСКОВ. В настоящее время выбранного поставщика помечается звездочкой (*).

**Подсистемы**

Приведены сводные сведения о каждой подсистемы в системе. Выбранной подсистеме помечается звездочкой (*).

**Контроллеры**

Приведены сводные сведения о каждом контроллере в выбранной подсистеме. В настоящее время выбранного контроллера помечается звездочкой (*).

**Порты**

Приведены сводные сведения о порте каждого контроллера в данный момент выбранного контроллера. Выбранный порт отмечен звездочкой (*).

**диски**

Приведены сводные сведения о каждого диска в выбранной подсистеме. В настоящее время выбранный диск помечается звездочкой (*).

**номера LUN**

Приведены сводные сведения о LUN в выбранной подсистеме. Что LUN помечается звездочкой (*).

**tportals**

Приведены сводные сведения о все целевые порталы iSCSI в выбранной подсистеме. Текущий выбранный целевой портал помечается звездочкой (*).

**Целевые объекты**

Приведены сводные сведения о всех целевых объектов iSCSI в выбранной подсистеме. В настоящее время выбранного целевого объекта помечается звездочкой (*).

**tpgroups**

Приведены сводные сведения о iSCSI целевого портала групп в настоящее время выбранного целевого объекта. Текущей выбранной группы портала помечается звездочкой (*).

### <a name="BKMK_20"></a>Имя входа

Регистрирует адаптер инициатора iSCSI на указанный в целевой объект текущего выбранного iSCSI.

#### <a name="syntax"></a>Синтаксис

```
login target iadapter=<iadapter> [type={manual | persistent | boot}] [chap={none | oneway | mutual}] [iportal=<iportal>] [tportal=<tportal>] [<flag> [<flag> […]]]
```

#### <a name="parameters"></a>Параметры

**type**

Указывает тип имени входа для выполнения: **вручную**, **постоянных**, или **загрузки**. Если не указано, будет выполняться вручную имени входа.

**вручную** -входа вручную.

**постоянные** — автоматически использовать то же имя входа, при перезапуске компьютера.

**загрузки** -(этот параметр предназначен для дальнейшей разработки и в настоящий момент не используется<em>.</em>)

**CHAP**

Указывает тип проверки подлинности CHAP: **none**, **oneway** CHAP, или **взаимной** CHAP; Если не указано, будет использоваться без проверки подлинности.

**портала**

Указывает дополнительный портал инициатора в подсистеме, выбранных для входа.

**IPORTAL**

Указывает портал необязательно инициатора в адаптер указанного инициатора, следует использовать для входа.

\<флаг >

Определить по три буквы акронимов.

**IP-АДРЕСА**: Требует IPsec

**EMP**: Включить режим multipath

**EHD**: Включить дайджест заголовка

**EDD**: Включить дайджест данных

### <a name="BKMK_21"></a>Выход из системы

Регистрирует адаптер инициатора указанного iSCSI от целевой объект текущего выбранного iSCSI.

#### <a name="syntax"></a>Синтаксис

```
logout target iadapter= <iadapter>
```

#### <a name="parameters"></a>Параметры

**IADAPTER**

Указывает адаптер инициатора с сеансом входа, выхода из.

### <a name="BKMK_22"></a>Обслуживание

Выполняет операции обслуживания с текущего выбранного объекта указанного типа.

#### <a name="syntax"></a>Синтаксис

```
maintenance <object operation> [count=<iteration>]
```

#### <a name="parameters"></a>Параметры

\<Объект >

Указывает тип объекта, на котором для выполнения операции. *Объект* тип может быть **подсистемы**, **контроллера**, **порта, диск** или **LUN**.

\<операции >

Указывает операцию для выполнения обслуживания. *Операции* тип может быть **spinup**, **spindown**, **blink**, **звукового сигнала** или **ping** . *Операции* должен быть указан.

**Count =**

Указывает число повторений *операции*. Обычно используется с **blink**, **звукового сигнала**, или **ping**.

### <a name="BKMK_23"></a>Имя

Задает понятное имя подсистемы, LUN или iSCSI текущего выбранного целевого объекта для указанного имени.

#### <a name="syntax"></a>Синтаксис

```
name {subsystem | lun | target} [<name>]
```

#### <a name="parameter"></a>Параметр

\<Имя >

Указывает имя подсистемы, LUN или целевой объект. Имя должно быть короче 64 символов. Если имя не указано, существующее имя, если таковые имеются, удаляется.

### <a name="BKMK_24"></a>Автономный режим

Задает состояние текущего выбранного объекта указанного типа для **автономной**.

#### <a name="syntax"></a>Синтаксис

```
offline <object>
```

#### <a name="parameter"></a>Параметр

\<Объект >

Указывает тип объекта, на котором для выполнения этой операции. \<Объекта >

Тип может быть **подсистемы**, **контроллера**, **диск**, **LUN**, или **портала**.

### <a name="BKMK_25"></a>Онлайн

Задает состояние указанного типа для выбранного объекта **online**. Если объект является **hbaport**, изменяет состояние путей на текущий выбранный порт адаптера ШИНЫ **online**.

#### <a name="syntax"></a>Синтаксис

```
online <object> 
```

#### <a name="parameter"></a>Параметр

\<Объект >

Указывает тип объекта, на котором для выполнения этой операции. \<Объекта >

Тип может быть **hbaport**, **подсистемы**, **контроллера**, **диск**, **LUN**, или  **портала**.

### <a name="BKMK_26"></a>Восстановление

Выполняет операции, необходимые, таких как повторная синхронизация или горячего резервирования, восстановления что отказоустойчивые LUN. Например, ВОССТАНОВЛЕНИЕ может привести к горячий резерв для привязки к набору RAID с отказавшего диска или других перераспределения экстент диска.

#### <a name="syntax"></a>Синтаксис

```
recover <lun>
```

### <a name="BKMK_27"></a>reenumerate

Reenumerates объектов указанного типа. Если вы используете расширение команды LUN, обновить размер диска перед использованием команды reenumerate необходимо использовать команду refresh.

#### <a name="syntax"></a>Синтаксис

```
reenumerate {subsystems | drives}
```

#### <a name="parameters"></a>Параметры

**Подсистемы**

Запросы к поставщику для обнаружения любой новой подсистемы, которые были добавлены в данный момент выбранного поставщика.

**диски**

Запросы внутренних шин ввода-вывода для обнаружения новых разделов, которые были добавлены в выбранной подсистеме.

### <a name="BKMK_28"></a>обновления

Обновляет внутренние данные для выбранного поставщика.

#### <a name="syntax"></a>Синтаксис

```
refresh provider
```

### <a name="BKMK_29"></a>REM

Используется для вставки комментариев в сценарии.

#### <a name="syntax"></a>Синтаксис

```
Rem <comment>
```

### <a name="BKMK_30"></a>удалить

Удаляет указанный целевой портал iSCSI из портала текущий выбранный целевой группы.

#### <a name="syntax"></a>Синтаксис

```
remove tpgroup tportal=<tportal> [noerr]
```

#### <a name="parameter"></a>Параметр

**портала TPGROUP =** \<портала >

Указывает портала цели iSCSI для удаления.

**успешного**

Указывает, что следует игнорировать все ошибки, возникающие при выполнении этой операции. Это полезно в режиме сценария.

### <a name="BKMK_31"></a>Замените

Заменяет указанный диск в настоящее время выбранный диск.

#### <a name="syntax"></a>Синтаксис

```
replace drive=<drive_number>
```

#### <a name="parameter"></a>Параметр

**диск =**

Указывает \<drive_number > для замены диска.

#### <a name="remarks"></a>Примечания

-   Указанный диск не может быть сейчас выбранный диск.

### <a name="BKMK_32"></a>Сброс

Выполняет сброс текущего выбранного контроллера или порт.

#### <a name="syntax"></a>Синтаксис

```
Reset {controller | port}
```

#### <a name="parameters"></a>Параметры

**Контроллер**

Сбрасывает контроллер.

**Порт**

Сбрасывает порт.

### <a name="BKMK_33"></a>Выберите

Отображает или изменяет текущий выбранный объект.

#### <a name="syntax"></a>Синтаксис

```
Select {hbaport | iadapter | iportal | provider | subsystem | controller | port | drive | lun | tportal | target | tpgroup } [<n>]
```

#### <a name="parameters"></a>Параметры

**объект**

Указывает тип объекта для выбора. \<Объекта > тип может быть **поставщика**, **подсистемы**, **контроллера**, **диск**, или **LUN**.

**hbaport** [\<n>]

Устанавливает фокус на указанный локальный порт адаптера ШИНЫ. Если порт адаптера ШИНЫ, не указан, команда отображает текущий выбранный порт адаптера ШИНЫ (если таковые имеются). Указывает недопустимый индекс порта адаптера ШИНЫ приводит от порт адаптера ШИНЫ не в фокусе. Выбор порта адаптера ШИНЫ отменяет выбор любого выбранного инициатора адаптеры и порталы инициатора.

**IADAPTER** [\<n >]

Устанавливает фокус на адаптер инициатора iSCSI указанный локальный. Если адаптер инициатора не указан, команда отображает текущий выбранный инициатора адаптера (если таковые имеются). Указания индекса адаптера недопустимый инициатор приводит ни одного адаптера инициатора с фокусом. Выбрав адаптер инициатора отменяет выбор любого выбранного порты адаптера ШИНЫ и порталы инициатора.

**IPORTAL** [\<n >]

Устанавливает фокус на указанный локальный инициатор портал iSCSI в адаптер инициатора iSCSI выбранного. Если портал инициатора не указан, команда отображает портал текущего выбранного инициатора (если таковые имеются). Указания индекса портала недопустимый инициатор приводит портал не выбранного инициатора.

**Поставщик** [\<n >]

Задает фокус для указанного поставщика. Если поставщик не задан, команда отображает текущий выбранный поставщик (если таковые имеются). Указания индекса Недопустимый поставщик приводит поставщик не в фокусе.

**Подсистема** [\<n >]

Устанавливает фокус на указанной подсистемы. Если подсистема не указан, команда отображает подсистема с фокусом (если таковые имеются). Указания индекса недопустимая подсистема приводит подсистема не в фокусе. При выборе подсистеме неявно выбираются его соответствующий поставщик.

**контроллер** [\<n >]

Устанавливает фокус на указанный контроллер в пределах выбранной подсистеме. Если контроллер не указан, команда отображает текущий выбранный контроллер (если таковые имеются). Указания индекса недопустимый контроллера приводит контроллер не в фокусе. Отменяет выбор выборе контроллера, все порты выбранного контроллера, дисков, LUN, целевые порталы, целевые объекты и группы конечных порталов.

**порт** [\<n >]

Устанавливает фокус на порт указанный контроллер в выбранном контроллере. Если порт не указан, команда отображает текущий выбранный порт (если таковые имеются). Указания индекса недопустимый порт приводит нет выбранного порта.

**диск** [\<n >]

Устанавливает фокус на указанном диске, то есть физические жесткие диски, в пределах выбранной подсистеме. Если диск не указан, команда отображает текущий выбранный диск (если таковые имеются). Указания индекса недопустимый диск приводит диск не в фокусе. Отменяет выделение выбора на диск, любой выбранных контроллеров, порты контроллера, LUN, порталы, целевые объекты и группы конечных порталов.

**LUN** [\<n >]

Устанавливает фокус на указанный LUN в пределах выбранной подсистеме. Если не указан ни один LUN, она выводит что LUN (если таковые имеются). Указывает недопустимый индекс LUN приводит от нет выбранного LUN. Отменяет выделение выбора LUN, любой выбранных контроллеров, порты контроллера, диски, порталы, целевые объекты и группы конечных порталов.

**портала** [\<n >]

Устанавливает фокус на указанный целевой портал iSCSI в пределах выбранной подсистеме. Если нет целевой портал не указан, команда отображает текущий выбранный целевой портал (если таковые имеются). Указания индекса портала недопустимый целевой приводит портал не выбранного целевого объекта. Отменяет выделение выбора целевого портала, все контроллеры, порты контроллера, дисков, LUN, целевые объекты и группы конечных порталов.

**целевой объект** [\<n >]

Устанавливает фокус на целевой объект iSCSI, указанного в выбранной подсистеме. Если цель не указана, команда отображает текущий выбранный целевой объект (если таковые имеются). Указания индекса недопустимый целевой объект приводит к выбранной целевой объект. Отменяет выделение выбора целевого объекта, все контроллеры, порты контроллера, диски, LUN, целевые порталы и группы конечных порталов.

**tpgroup** [\<n>]

Задает фокус для указанного iSCSI целевого портала группы в целевой объект текущего выбранного iSCSI. Если целевой портала группа не указана, команда отображает текущий выбранный целевой портала группы (если таковые имеются). Указания индекса недопустимый целевой портала группы приводит к портала группа не в фокусе.

[\<n >]

Указывает \<объекта номер > для выбора. Если <object number> указан недопустимый, будут удалены существующие параметры для объектов указанного типа. Если нет <object number> указан, отображается текущий объект.

### <a name="BKMK_34"></a>setflag

Задает текущий выбранный диск в качестве горячего резерва.

#### <a name="syntax"></a>Синтаксис

```
setflag drive hotspare={true | false}
```

#### <a name="parameters"></a>Параметры

**true**

Выбирает текущий выбранный диск в качестве горячего резерва.

**false**

Снимает выделение сейчас выбранный диск в качестве горячего резерва.

#### <a name="remarks"></a>Примечания

Горячий резерв не может использоваться для обычных операций привязки LUN. Они зарезервированы для только обработка ошибок. Диск не должен быть привязан в настоящее время для любого существующего LUN.

### <a name="BKMK_shrink"></a>Сжатие

Уменьшение размера выбранного LUN.

#### <a name="syntax"></a>Синтаксис

```
shrink lun size=<n> [noerr]
```

#### <a name="parameters"></a>Параметры

**размер =**

Задает нужный объем свободного места в мегабайтах (МБ), чтобы уменьшить размер LUN. Чтобы указать размер, используя другие единицы измерения, используйте один из распознанных суффиксов (B, КБ, МБ, ГБ, ТБ и PB) сразу после размера.

**успешного**

Указывает, что все ошибки, возникающие при выполнении этой операции будет игнорироваться. Это полезно в режиме сценария.

### <a name="BKMK_35"></a>ждущий режим

Изменяет состояние путей к порту адаптера шины текущего выбранного узла в режим ОЖИДАНИЯ.

#### <a name="syntax"></a>Синтаксис

```
standby hbaport
```

#### <a name="parameters"></a>Параметры

**HBAPORT**

Изменяет состояние путей к порту адаптера шины текущего выбранного узла в режим ОЖИДАНИЯ.

### <a name="BKMK_36"></a>снять маску

Делает текущий выбранный LUN доступным из указанных узлов.

#### <a name="syntax"></a>Синтаксис

```
unmask LUN {all | none | [add] wwn=<hexadecimal_number> [;<hexadecimal_number> [;…]] | [add] initiator=<initiator>[;<initiator>[;…]]} [uninstall]
```

#### <a name="parameters"></a>Параметры

**Все**

Указывает, что LUN следует сделать доступными из всех узлов. Тем не менее не может снять маску LUN всем целевым объектам в подсистеме iSCSI.

> [!IMPORTANT]
> Необходимо выхода целевого объекта перед запуском команды снять МАСКУ все.

**Нет**

Указывает, что LUN не должны быть доступны на любом узле.

> [!IMPORTANT]
> Необходимо выхода целевого объекта перед запуском команды снять МАСКУ LUN NONE.

**add**

Указывает, что указанные узлы должны быть добавлены в существующий список узлов, входящих в этот LUN, доступен из. Если этот параметр не указан, список узлов, предоставленные заменяет существующий список узлов, входящих в этот LUN, доступен из.

**WWN-ИМЕН =**

Задает список шестнадцатеричных чисел, представляющих имена во всем мире, из которых LUN или узлов следует сделать доступными. Чтобы маска/снять маску к определенному набору узлов в подсистеме Fibre Channel, можно ввести разделенный точками с запятой список WWN-ИМЕН для портов на хост-компьютеры интерес.

**Инициатор =**

Указывает список инициаторов iSCSI, к которым что LUN следует сделать доступными. Чтобы маска/снять маску к определенному набору узлов в подсистеме iSCSI, можно ввести разделенный точками с запятой список имен инициатора iSCSI инициаторов на главных компьютерах интерес.

**Удаление**

Если указан, удаляет диск, связанный с LUN в локальной системе, прежде чем маскировки LUN.

## <a name="scripting-diskraid"></a>Создание сценариев DiskRAID

DiskRAID можно включить в скрипт на любом компьютере под управлением Windows Server 2008 или Windows Server 2003 с помощью связанного поставщика оборудования службы виртуальных ДИСКОВ. Для выполнения скрипта DiskRAID, в командной строке введите:
```
diskraid /s <script.txt>
```
По умолчанию DiskRAID прекращает обработку команды и возвращает код ошибки, если имеется проблема в скрипте. Чтобы продолжить выполнение сценария и пропускать ошибки, необходимо включить параметр УСПЕШНОГО команды. Это позволяет такие полезные рекомендации, как с помощью одного сценария, чтобы удалить все LUN в подсистеме независимо от того, общее количество номеров LUN. Параметр УСПЕШНОГО поддерживается не всеми командами. Ошибки всегда возвращаются в случае ошибок синтаксиса команды, независимо от того, включены ли параметр УСПЕШНОГО

### <a name="diskraid-error-codes"></a>Коды ошибок DiskRAID

|Код ошибки|Описание ошибки|
|----------|-----------------|
|0|Ошибки не обнаружены. Сценарий выполнен без ошибок.|
|1|Неустранимая ошибка.|
|2|Аргументы, заданные в командной строке DiskRAID неверны.|
|3|DiskRAID не удалось открыть указанный сценарий или выходной файл.|
|4|Произошел сбой в одной из служб, используемых DiskRAID.|
|5|Произошла синтаксическая ошибка команды. Сценарий не выполнен, поскольку объект выбран неправильно или недопустима для использования с этой командой.|

## <a name="example-interactively-view-status-of-subsystem"></a>Пример. Интерактивный просмотр состояния подсистемы

Если вы хотите просмотреть состояние подсистемы 0 на компьютере, введите следующее в командной строке:
```
diskraid
```
Нажмите клавишу ВВОД. Отображается следующая информация:
```
Microsoft Diskraid version 5.2.xxxx
Copyright (©) 2003 Microsoft Corporation
On computer: COMPUTER_NAME
```
Чтобы выбрать подсистемы 0, введите следующее в командной строке DiskRAID:
```
select subsystem 0
```
Нажмите клавишу ВВОД. Отображается результат, аналогичный приведенному ниже:
```
Subsystem 0 is now the selected subsystem.

DISKRAID> list drives

  Drive ###  Status      Health          Size      Free    Bus  Slot  Flags
  ---------  ----------  ------------  --------  --------  ---  ----  -----
  Drive 0    Online      Healthy         107 GB    107 GB    0     1
  Drive 1    Offline     Healthy          29 GB     29 GB    1     0
  Drive 2    Online      Healthy         107 GB    107 GB    0     2
  Drive 3    Not Ready   Healthy          19 GB     19 GB    1     1
```
Чтобы выйти из DiskRAID, введите следующее в командной строке DiskRAID:
```
exit
```