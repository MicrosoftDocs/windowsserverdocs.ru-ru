---
title: msiexec
description: Справочная статья по команде msiexec, которая предоставляет средства для установки, изменения и выполнения операций с установщик Windows из командной строки.
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 122eb0ce-ecbc-4909-a52a-15c3413619af
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: b1224d4dfeefd850dcc29e523972351b8cdd9778
ms.sourcegitcommit: d5e27c1f2f168a71ae272bebf8f50e1b3ccbcca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "86956876"
---
# <a name="msiexec"></a>msiexec

Предоставляет средства для установки, изменения и выполнения операций с установщик Windows из командной строки.

## <a name="install-options"></a>Параметры установки

Задайте тип установки для запуска пакета установки.

### <a name="syntax"></a>Синтаксис

```
msiexec.exe [/i][/a][/j{u|m|/g|/t}][/x] <path_to_package>
```

#### <a name="parameters"></a>Параметры

| Параметр | Описание |
| ------- | -------- |
| /i | Задает нормальную установку. |
| /a | Задает административную установку. |
| /жу | Объявите продукт для текущего пользователя. |
| /жм | Объявите продукт для всех пользователей. |
| /ж/г | Указывает идентификатор языка, используемый объявленным пакетом. |
| /ж/т | Применяет преобразование к объявленному пакету. |
| /x | Удаляет пакет. |
| `<path_to_package>` | Указывает расположение и имя файла пакета установки. |

#### <a name="examples"></a>Примеры

Чтобы установить пакет с именем *example.msi* с диска C: с помощью обычного процесса установки, введите:

```
msiexec.exe /i "C:\example.msi"
```

## <a name="display-options"></a>Параметры отображения

Вы можете настроить то, что видит пользователь в процессе установки, в зависимости от целевой среды. Например, если пакет распространяется на все клиенты для установки вручную, должен быть полный пользовательский интерфейс. Однако при развертывании пакета с помощью групповая политика, для которого не требуется вмешательство пользователя, не нужно участвовать в пользовательском интерфейсе.

### <a name="syntax"></a>Синтаксис

```
msiexec.exe /i <path_to_package> [/quiet][/passive][/q{n|b|r|f}]
```

#### <a name="parameters"></a>Параметры

| Параметр | Описание |
| ------- | -------- |
| `<path_to_package>` | Указывает расположение и имя файла пакета установки. |
| /quiet | Указывает тихий режим, что означает, что взаимодействие с пользователем не требуется. |
| /passive | Указывает автоматический режим, означающее, что установка показывает только индикатор выполнения. |
| /Qn | Указывает, что в процессе установки пользовательский интерфейс отсутствует. |
| /Qn + | Указывает, что во время установки нет пользовательского интерфейса, за исключением последнего диалогового окна в конце. |
| /qb | Указывает, что в процессе установки имеется основной пользовательский интерфейс. |
| /QB + | Указывает, что в процессе установки имеется основной пользовательский интерфейс, включая Последнее диалоговое окно в конце. |
| /кр | Указывает сокращенный интерфейс пользователя во время процесса установки. |
| /кф | Указывает полный интерфейс интерфейса пользователя во время установки. |

##### <a name="remarks"></a>Комментарии

- Модальное окно не отображается, если установка отменена пользователем. Вы можете использовать **QB +!** или **QB! +** , чтобы скрыть кнопку **Отмена** .

#### <a name="examples"></a>Примеры

Чтобы установить пакетную *C:\example.msi*с обычным процессом установки без пользовательского интерфейса, введите:

```
msiexec.exe /i "C:\example.msi" /qn
```

## <a name="restart-options"></a>Параметры перезагрузки

Если установочный пакет перезаписывает файлы или пытается изменить файлы, которые используются, может потребоваться перезагрузка до завершения установки.

### <a name="syntax"></a>Синтаксис

```
msiexec.exe /i <path_to_package> [/norestart][/promptrestart][/forcerestart]
```

#### <a name="parameters"></a>Параметры

| Параметр | Описание |
| ------- | -------- |
| `<path_to_package>` | Указывает расположение и имя файла пакета установки. |
| /norestart | Останавливает перезагрузку устройства после завершения установки. |
| /promptrestart | Запрашивает пользователя, если требуется перезагрузка. |
| /forcerestart | Перезапускает устройство после завершения установки. |

#### <a name="examples"></a>Примеры

Чтобы установить пакет *C:\example.msi*, используя нормальный процесс установки без перезагрузки в конце, введите:

```
msiexec.exe /i "C:\example.msi" /norestart
```

## <a name="logging-options"></a>Параметры ведения журнала

Если необходимо выполнить отладку пакета установки, можно задать параметры, чтобы создать файл журнала с конкретными сведениями.

### <a name="syntax"></a>Синтаксис

```
msiexec.exe [/i][/x] <path_to_package> [/L{i|w|e|a|r|u|c|m|o|p|v|x+|!|*}] <path_to_log>
```

#### <a name="parameters"></a>Параметры

| Параметр | Описание |
| ------- | -------- |
| /i | Задает нормальную установку. |
| /x | Удаляет пакет. |
| `<path_to_package>` | Указывает расположение и имя файла пакета установки. |
| /Li | Включает ведение журнала и включает сообщения о состоянии в выходной файл журнала. |
| /лв | Включает ведение журнала и включает в выходной файл журнала некритические предупреждения. |
| /ле | Включает ведение журнала и включает все сообщения об ошибках в выходной файл журнала. |
| /ла | Включает ведение журнала и включает сведения о том, когда действие запускается в выходном файле журнала. |
| /лр | Включает ведение журнала и включает записи, относящиеся к конкретному действию, в выходной файл журнала. |
| /лу | Включает ведение журнала и включает сведения о запросе пользователя в выходной файл журнала. |
| /лк | Включает ведение журнала и включает исходные параметры пользовательского интерфейса в выходной файл журнала. |
| /LM | Включает ведение журнала и включает в выходной файл журнала сведения о нехватке памяти или аварийном завершении. |
| /ло | Включает ведение журнала и включает в выходной файл журнала сообщения о нехватке места на диске. |
| /лп | Включает ведение журнала и включает свойства терминала в выходной файл журнала. |
| /лп | Включает ведение журнала и включает свойства терминала в выходной файл журнала. |
| /лв | Включает ведение журнала и включает подробный вывод в выходной файл журнала. |
| /лп | Включает ведение журнала и включает свойства терминала в выходной файл журнала. |
| /лкс | Включает ведение журнала и включает дополнительные отладочные данные в выходной файл журнала. |
| /l + | Включает ведение журнала и добавляет данные в существующий файл журнала. |
| /l! | Включает ведение журнала и сбрасывает каждую строку в файл журнала. |
| /l | Включает ведение журнала и регистрирует все данные, за исключением Verbose (**/лв**) или дополнительной отладочной информации (**/ЛКС**). |
| `<path_to_logfile>` | Указывает расположение и имя выходного файла журнала. |

#### <a name="examples"></a>Примеры

Чтобы установить пакетную *C:\example.msi*, в обычном процессе установки со всеми предоставленными сведениями о ведении журнала, включая подробные выходные данные, и сохранения выходного файла журнала по адресу *к:\паккаже.лог*, введите:

```
msiexec.exe /i "C:\example.msi" /L*V "C:\package.log"
```

## <a name="update-options"></a>Варианты обновления

Обновления можно применять и удалять с помощью пакета установки.

### <a name="syntax"></a>Синтаксис

```
msiexec.exe [/p][/update][/uninstall[/package<product_code_of_package>]] <path_to_package>
```

#### <a name="parameters"></a>Параметры

| Параметр | Описание |
| ------- | -------- |
| /p | Устанавливает исправление. При установке в автоматическом режиме необходимо также присвоить свойству REINSTALLMODE значение *екмус* и переустановить для *всех*компонентов. В противном случае исправление обновляет только MSI, кэшированный на целевом устройстве. |
| /update | Параметр установки исправлений. Если вы применяете несколько обновлений, их необходимо разделять точкой с запятой (;). |
| /Package | Устанавливает или настраивает продукт. |

#### <a name="examples"></a>Примеры

```
msiexec.exe /p "C:\MyPatch.msp"
msiexec.exe /p "C:\MyPatch.msp" /qb REINSTALLMODE="ecmus" REINSTALL="ALL"
msiexec.exe /update "C:\MyPatch.msp"
```

```
msiexec.exe /uninstall {1BCBF52C-CD1B-454D-AEF7-852F73967318} /package {AAD3D77A-7476-469F-ADF4-04424124E91D}
```

Первый GUID — это идентификатор GUID исправления, второй — код продукта MSI, к которому применено исправление.

## <a name="repair-options"></a>Параметры восстановления

С помощью этой команды можно восстановить установленный пакет.

### <a name="syntax"></a>Синтаксис

```
msiexec.exe [/f{p|o|e|d|c|a|u|m|s|v}] <product_code>
```

#### <a name="parameters"></a>Параметры

| Параметр | Описание |
| ------- | -------- |
| /fp | Восстанавливает пакет, если файл отсутствует. |
| /fo | Восстанавливает пакет, если файл отсутствует или если установлена более старая версия. |
| /Fe | Восстанавливает пакет, если файл отсутствует или установлена идентичная или более старая версия. |
| /FD | Восстанавливает пакет, если файл отсутствует или если установлена другая версия. |
| /fc | Восстанавливает пакет, если файл отсутствует, или если контрольная сумма не совпадает с вычисленным значением. |
| /FA | Принудительно переустанавливает все файлы. |
| /Fu | Восстанавливает все необходимые записи реестра для конкретных пользователей. |
| /FM | Восстанавливает все необходимые записи реестра, относящиеся к компьютеру. |
| /FS | Восстанавливает все существующие ярлыки. |
| /fc | Запускается из источника и повторно кэширует локальный пакет. |

#### <a name="examples"></a>Примеры

Чтобы принудительно выполнить повторную установку всех файлов на основе кода продукта MSI, *{AAD3D77A-7476-469F-ADF4-04424124E91D}*, введите:

```
msiexec.exe /fa {AAD3D77A-7476-469F-ADF4-04424124E91D}
```

## <a name="set-public-properties"></a>Задать открытые свойства

С помощью этой команды можно задать открытые свойства. Сведения о доступных свойствах и их настройке см. в разделе [Общие свойства](/windows/win32/msi/public-properties).

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)

- [Параметры командной строкиMsiexec.exe](/windows/win32/msi/command-line-options)

- [Стандартные параметры командной строки установщика](/windows/win32/msi/standard-installer-command-line-options)
