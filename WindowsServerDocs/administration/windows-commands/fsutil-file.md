---
ms.assetid: 9f3dc104-dd69-4b03-b824-a29896780164
title: Файл fsutil
ms.prod: windows-server
manager: dmoss
ms.author: toklima
author: toklima
ms.technology: storage
audience: IT Pro
ms.topic: article
ms.date: 10/16/2017
ms.openlocfilehash: 236f951286e2ed2e16a329a04e912b812d020aa6
ms.sourcegitcommit: ab64dc83fca28039416c26226815502d0193500c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/01/2020
ms.locfileid: "82725517"
---
# <a name="fsutil-file"></a>Файл fsutil
> Область применения: Windows Server (половина ежегодного канала), Windows Server 2019, Windows Server 2016, Windows 10, Windows Server 2012 R2, Windows 8.1, Windows Server 2012, Windows 8, Windows Server 2008 R2, Windows 7

Находит файл по имени пользователя (если включены квоты диска), запрашивает выделенные диапазоны для файла, задает короткое имя файла, задает допустимую длину данных файла, задает нулевые данные для файла или создает новый файл.



## <a name="syntax"></a>Синтаксис

```
fsutil file [createnew] <filename> <length>
fsutil file [findbysid] <username> <directory>
fsutil file [optimizemetadata] [/A] <filename>
fsutil file [queryallocranges] offset=<offset> length=<length> <filename>
fsutil file [queryextents] [/R] <filename> [<startingvcn> [<numvcns>]]
fsutil file [queryfileid] <filename>
fsutil file [queryfilenamebyid] <volume> <fileid>
fsutil file [queryoptimizemetadata] <filename>
fsutil file [queryvaliddata] [/R] [/D] <filename>
fsutil file [seteof] <filename> <length>
fsutil file [setshortname] <filename> <shortname>
fsutil file [setvaliddata] <filename> <datalength>
fsutil file [setzerodata] offset=<offset> length=<length> <filename>

```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|-------------|---------------|
|CreateNew|Создает файл с указанным именем и размером с содержимым, состоящим из нулей.|
|\<имя файла>|Указывает полный путь к файлу, включая имя файла и расширение, например К:\документс\филенаме.ткст.|
|\<Длина>|Указывает допустимую длину данных файла.|
|финдбисид|Поиск файлов, принадлежащих указанному пользователю на томах NTFS с включенными квотами на диск.|
|\<имя пользователя>|Указывает имя пользователя или имя для входа.|
|\<> каталога|Указывает полный путь к каталогу, например папку c:\Users.|
|оптимиземетадата|Это делает немедленную операцию сжатия метаданных для заданного файла.|
|/A|Анализ метаданных файла до и после оптимизации.|
|куеряллокранжес|Запрашивает выделенные диапазоны для файла на томе NTFS. Полезно для определения того, имеет ли файл разреженные регионы.|
|смещение =\<смещение>|Задает начало диапазона, для которого необходимо задать нули.|
|Длина =\<длина>|Задает длину диапазона (в байтах).|
|куерекстентс|Запрашивает экстенты для файла.|
|/R|Если <filename> является точкой повторного анализа, откройте ее, а не цель.|
|\<стартингвкн>|Указывает первый VCN для запроса. Если не указано, начните с VCN 0.|
|\<нумвкнс>|Число Вкнс для запроса. Если параметр опущен или равен 0, то запрос будет выполняться до EOF.|
|куерифилеид|Запрашивает идентификатор файла на томе NTFS.<p>Этот параметр применяется к: Windows Server 2008 R2 и Windows 7.|
|\<> тома|Указывает том как имя диска, за которым следует двоеточие.|
|куерифиленамебид|Отображает произвольное имя ссылки для указанного идентификатора файла на томе NTFS. Так как файл может иметь несколько имен ссылок, указывающих на этот файл, не гарантируется, какая ссылка на файл будет предоставлена в результате запроса на имя файла.<p>Этот параметр применяется к: Windows Server 2008 R2 и Windows 7.|
|\<ИД>|Указывает идентификатор файла на томе NTFS.|
|куерйоптимиземетадата|Запрашивает состояние метаданных файла.|
|куеривалиддата|Запрашивает допустимую длину данных для файла.|
|/D|Отображение подробных сведений о допустимых данных.|
|сетеоф|Задает конец заданного файла.|
|сетшортнаме|Задает короткое имя (8,3 символов в имени файла) для файла на томе NTFS.|
|\<ShortName>|Указывает короткое имя файла.|
|сетвалиддата|Задает допустимую длину данных для файла на томе NTFS.|
|\<Длина>|Указывает длину файла в байтах.|
|сетзеродата|Задает диапазон (заданный по *смещению* и *длине*) файла, равный нулю, что очищает файл. Если файл является разреженным, базовые единицы распределения будут отделены.|

## <a name="remarks"></a>Примечания

-   В файловой системе NTFS существует два важных понятия длины файла: маркер конца файла (EOF) и допустимая длина данных (ВДЛ). Значение EOF указывает фактическую длину файла. ВДЛ определяет длину допустимых данных на диске. Все операции чтения между ВДЛ и EOF автоматически возвращают значение 0, чтобы сохранить требование повторного использования объекта C2.

-   Параметр **сетвалиддата** доступен только для администраторов, так как ему требуется привилегия на выполнение задач по обслуживанию томов (семанажеволумепривилеже). Эта функция необходима только для расширенных сценариев мультимедиа и системных сетей. Параметр **сетвалиддата** должен быть положительным значением, превышающим текущий ВДЛ, но меньшим, чем текущий размер файла.

    Программа может установить ВДЛ в следующих случаях:

    -   Запись необработанных кластеров непосредственно на диск с помощью аппаратного канала. Это позволяет программе информировать файловую систему о том, что этот диапазон содержит допустимые данные, которые могут быть возвращены пользователю.

    -   Создание больших файлов при возникновении проблем с производительностью. Это позволяет избежать времени, затрачиваемого на заполнение файла нулями при создании или расширении файла.

## <a name="examples"></a><a name="BKMK_examples"></a>Примеры
Чтобы найти файлы, принадлежащие скоттб на диске C, введите:

```
fsutil file findbysid scottb c:\users  
```

Чтобы запросить выделенные диапазоны для файла на томе NTFS, введите:

```
fsutil file queryallocranges offset=1024 length=64 c:\temp\sample.txt  
```

Чтобы оптимизировать метаданные для файла, введите:

```
fsutil file optimizemetadata C:\largefragmentedfile.txt
```

Чтобы запросить экстенты для файла, введите:

```
fsutil file queryextents C:\Temp\sample.txt
```

Чтобы задать EOF для файла, введите:

```
fsutil file seteof C:\testfile.txt 1000
```

Чтобы задать короткое имя для файла Лонгфиленаме. txt на диске C в Лонгфиле. txt, введите:

```
fsutil file setshortname c:\longfilename.txt longfile.txt  
```

Чтобы задать допустимую длину данных в 4096 байт для файла с именем TestFile. txt на томе NTFS, введите:

```
fsutil file setvaliddata c:\testfile.txt 4096  
```

Чтобы задать для диапазона файла на томе NTFS нулевые значения, введите:

```
fsutil file setzerodata offset=100 length=150 c:\temp\sample.txt  
```

## <a name="additional-references"></a>Дополнительные ссылки
- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)

[Fsutil](Fsutil.md)


