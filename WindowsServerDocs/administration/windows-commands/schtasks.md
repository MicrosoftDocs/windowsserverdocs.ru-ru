---
title: schtasks
description: Справочный раздел по * * * *-
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 2e713203-3dd8-491b-b9e1-9423618dc7e8
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: a723025846a0e1725c72d5880d1ecc97579e1a69
ms.sourcegitcommit: ab64dc83fca28039416c26226815502d0193500c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/01/2020
ms.locfileid: "82722170"
---
# <a name="schtasks"></a>schtasks



Планирует выполнение команд и программ периодически или в определенное время. Добавляет и удаляет задачи из расписания, запускает и останавливает задачи по требованию, а также отображает и изменяет запланированные задачи.

Чтобы просмотреть синтаксис команды, щелкните одну из следующих команд:
-   [команда Schtasks CREATE](#BKMK_create)
-   [команда Schtasks Change](#BKMK_change)
-   [команда Schtasks Run](#BKMK_run)
-   [команда Schtasks End](#BKMK_end)
-   [команда Schtasks Delete](#BKMK_delete)
-   [запрос SchTasks](#BKMK_query)

## <a name="remarks"></a>Примечания

- **Команда Schtasks. exe** выполняет те же операции, что и **запланированные задания** на **панели управления**. Эти инструменты можно использовать совместно и взаимозаменяемы.
- **Команда Schtasks** заменяет **файл exe**, средство, входящее в предыдущие версии Windows. Хотя программа **at. exe** по-прежнему включена в семейство Windows Server 2003, в качестве рекомендуемого средства планирования задач командной строки используется **schtasks** .
- Параметры в команде **schtasks** могут отображаться в любом порядке. При вводе команды **schtasks** без параметров выполняется запрос.
- Разрешения для **schtasks**  
  -   Необходимо иметь разрешение на выполнение команды. Любой пользователь может запланировать задание на локальном компьютере, а также просматривать и изменять запланированные задачи. Члены группы «Администраторы» могут планировать, просматривать и изменять все задачи на локальном компьютере.
  -   Чтобы запланировать, просмотреть или изменить задачу на удаленном компьютере, необходимо быть членом группы администраторов на удаленном компьютере или использовать параметр **/u** для предоставления учетных данных администратора удаленного компьютера.
  -   Параметр **/u** в операции **/CREATE** или **/Change** можно использовать только в том случае, если локальный и удаленный компьютеры находятся в одном домене или если локальный компьютер находится в домене, которому доверяет домен удаленного компьютера. В противном случае удаленный компьютер не может проверить подлинность указанной учетной записи пользователя и не сможет проверить, является ли эта учетная запись членом группы "Администраторы".
  -   Задача должна иметь разрешение на запуск. Необходимые разрешения зависят от задачи. По умолчанию задачи выполняются с разрешениями текущего пользователя локального компьютера или с разрешениями пользователя, заданного параметром **/u** , если он включен. Чтобы выполнить задачу с разрешениями другой учетной записи пользователя или с системными разрешениями, используйте параметр **/ru** .
- Чтобы проверить выполнение запланированной задачи или выяснить, почему запланированное задание не выполнялось, см. журнал транзакций службы планировщик задач, *СистемныйКорневойКаталог*\счедлгу.ткст. В этом журнале записываются попытки запуска, инициированные всеми инструментами, которые используют службу, включая **запланированные задачи** и **SchTasks. exe**.
- В редких случаях файлы задач повреждаются. Поврежденные задачи не выполняются. При попытке выполнить операцию с поврежденными задачами программа **SchTasks. exe** выводит следующее сообщение об ошибке:  
  ```
  ERROR: The data is invalid.
  ```  
  Восстановить поврежденные задачи невозможно. Чтобы восстановить функции планирования задач системы, используйте **SchTasks. exe** или **запланированные задачи** для удаления задач из системы и их повторного планирования.

## <a name="schtasks-create"></a><a name=BKMK_create></a>команда Schtasks CREATE

Планирует задачу.

**Команда Schtasks** использует разные сочетания параметров для каждого типа расписания. Чтобы просмотреть Объединенный синтаксис для создания задач или просмотреть синтаксис для создания задачи с определенным типом расписания, выберите один из следующих вариантов.
-   [Объединенный синтаксис и описания параметров](#BKMK_syntax)
-   [Планирование задачи, выполняемой каждые N минут](#BKMK_minutes)
-   [Планирование задачи, выполняемой каждые N часов](#BKMK_hours)
-   [Планирование задачи, выполняемой каждые N дней](#BKMK_days)
-   [Планирование задачи, выполняемой каждые N недель](#BKMK_weeks)
-   [Планирование задачи, выполняемой каждые N месяцев](#BKMK_months)
-   [Планирование задачи, выполняемой в конкретный день недели](#BKMK_spec_day)
-   [Планирование задачи, выполняемой в течение определенной недели месяца](#BKMK_spec_week)
-   [Планирование задачи, которая выполняется с определенной датой, каждый месяц](#BKMK_spec_date)
-   [Планирование задачи, выполняемой в последний день месяца](#BKMK_last_day)
-   [Планирование задачи, которая выполняется один раз](#BKMK_once)
-   [Планирование задачи, выполняемой при каждом запуске системы](#BKMK_startup)
-   [Планирование задачи, выполняемой при входе пользователя в систему](#BKMK_logon)
-   [Планирование задачи, выполняемой при простое системы](#BKMK_idle)
-   [Планирование задачи, которая выполняется сейчас](#BKMK_now)
-   [Планирование задачи, выполняемой с разными разрешениями](#BKMK_diff_perms)
-   [Планирование задачи, выполняемой с разрешениями системы](#BKMK_sys_perms)
-   [Планирование задачи, запускающей более одной программы](#BKMK_multi_progs)
-   [Планирование задачи, выполняемой на удаленном компьютере](#BKMK_remote)

### <a name="combined-syntax-and-parameter-descriptions"></a><a name=BKMK_syntax></a>Объединенный синтаксис и описания параметров

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /sc <ScheduleType> /tn <TaskName> /tr <TaskRun> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]] [/ru {[<Domain>\]<User> | System}] [/rp <Password>] [/mo <Modifier>] [/d <Day>[,<Day>...] | *] [/m <Month>[,<Month>...]] [/i <IdleTime>] [/st <StartTime>] [/ri <Interval>] [{/et <EndTime> | /du <Duration>} [/k]] [/sd <StartDate>] [/ed <EndDate>] [/it] [/z] [/f]
```

##### <a name="parameters"></a>Параметры

##### <a name="sc-scheduletype"></a>/SC \<ScheduleType>

Указывает тип расписания. Допустимые значения: минуты, ЕЖЕЧАСно, ежедневно, ЕЖЕНЕДЕЛЬно, ЕЖЕМЕСЯЧно, один раз, OnStart, OnStart, Idle.

|Тип расписания|Описание|
|-------------|-----------|
|MINUTE, ЕЖЕЧАСНО, ЕЖЕДНЕВНО, ЕЖЕНЕДЕЛЬНО, ЕЖЕМЕСЯЧНО|Задает единицу измерения времени для расписания.|
|После|Задача выполняется один раз в указанные дату и время.|
|ONSTART|Задача выполняется при каждом запуске системы. Можно указать дату начала или выполнить задачу при следующем запуске системы.|
|Вход в систему|Задача выполняется при каждом входе пользователя (любого пользователя) в систему. Можно указать дату или выполнить задачу при следующем входе пользователя в систему.|
|ОБРАБОТЧИК|Задача выполняется каждый раз, когда система бездействует в течение указанного периода времени. Можно указать дату или выполнить задачу в следующий раз, когда система бездействует.|

##### <a name="tn-taskname"></a>/TN \<имя_задания>

Задает имя для задачи. Каждая задача в системе должна иметь уникальное имя. Имя должно соответствовать правилам для имен файлов и не должно превышать 238 символов. Заключите имена, содержащие пробелы, с помощью кавычек.

##### <a name="tr-taskrun"></a>/TR \<>

Указывает программу или команду, выполняемую задачей. Введите полный путь и имя файла исполняемого файла, файла скрипта или пакетного файла. Длина имени пути не должна превышать 262 символов. Если опустить путь, программа **schtasks** предполагает, что файл находится в каталоге *systemroot*выполнять.

##### <a name="s-computer"></a>/s \<> компьютера

Планирует задачу на указанном удаленном компьютере. Введите имя или IP-адрес удаленного компьютера (с символами обратной косой черты или без них). По умолчанию используется локальный компьютер. Параметры **/u** и **/p** допустимы только при использовании параметра **/s**.

##### <a name="u-domainuser"></a>/u [\<домен>\]<User>

Выполняет эту команду с разрешениями указанной учетной записи пользователя. По умолчанию заданы разрешения текущего пользователя локального компьютера. Параметры **/u** и **/p** допустимы только для планирования задачи на удаленном компьютере (**/s**).

Разрешения указанной учетной записи используются для планирования задачи и выполнения задачи. Чтобы выполнить задачу с разрешениями другого пользователя, используйте параметр **/ru** .

Учетная запись пользователя должна быть членом группы администраторов на удаленном компьютере. Кроме того, локальный компьютер должен находиться в том же домене, что и удаленный компьютер, или в домене, который является доверенным для домена удаленного компьютера.

##### <a name="p-password"></a>/p \<пароль>

Предоставляет пароль для учетной записи пользователя, указанной в параметре **/u** . Если используется параметр **/u** , но пропущен параметр **/p** или аргумент password, **команда Schtasks** запрашивает пароль и скрывает введенный текст.

Параметры **/u** и **/p** допустимы только для планирования задачи на удаленном компьютере (**/s**).

##### <a name="ru-domainuser--system"></a>/ru {[\<домен>\] <User> | Системой

Выполняет задачу с разрешениями указанной учетной записи пользователя. По умолчанию задача выполняется с разрешениями текущего пользователя локального компьютера или с разрешением пользователя, указанного параметром **/u** , если он включен. Параметр **/ru** допустим при планировании задач на локальных или удаленных компьютерах.


|       Значение        |                                                    Описание                                                    |
|--------------------|-------------------------------------------------------------------------------------------------------------------|
| [\<Домен>\]<User> |                                       Указывает альтернативную учетную запись пользователя.                                        |
|    Система или     | Указывает учетную запись локальной системы — учетную запись с высоким уровнем привилегий, используемую операционной системой и системными службами. |

##### <a name="rp-password"></a>/RP \<пароль>

Предоставляет пароль для учетной записи пользователя, указанной в параметре **/ru** . Если опустить этот параметр при указании учетной записи пользователя, программа **SchTasks. exe** запрашивает пароль и скрывает введенный текст.

Не используйте параметр **/RP** для задач, запускаемых с учетными данными системной учетной записи (**система/ru**). Учетная запись System не имеет пароля, и **SchTasks. exe** не запрашивает его.

##### <a name="mo-modifier"></a>/Mo \<модификатор>

Указывает, как часто задача выполняется в рамках своего типа расписания. Этот параметр является допустимым, но необязательным, в течение минуты, ЕЖЕЧАСного, ЕЖЕДНЕВНОго, ЕЖЕНЕДЕЛЬного и ЕЖЕМЕСЯЧного расписания. Значение по умолчанию — 1.

|Тип расписания|Значения модификатора|Описание|
|-------------|---------------|-----------|
|MINUTE|1 - 1439|Задача выполняется каждые \<N> минут.|
|Каждый час|1 - 23|Задача выполняется каждые \<N> часов.|
|ЕЖЕДНЕВНО|1 - 365|Задача выполняется каждые \<N> дней.|
|Запуск|1 - 52|Задача выполняется каждые \<N> недель.|
|После|Нет модификаторов.|Задача выполняется один раз.|
|ONSTART|Нет модификаторов.|Задача выполняется при запуске.|
|Вход в систему|Нет модификаторов.|Задача выполняется, когда пользователь, заданный параметром **/u** , входит в систему.|
|ОБРАБОТЧИК|Нет модификаторов.|Задача выполняется после бездействия системы в течение числа минут, заданного параметром **/i** , который необходим для использования с OnIdle.|
|Семейный|1 - 12|Задача выполняется каждые \<N> месяцев.|
|Семейный|ластдай|Задача выполняется в последний день месяца.|
|Семейный|ПЕРВЫЙ, ВТОРОЙ, ТРЕТИЙ, ЧЕТВЕРТЫЙ, ПОСЛЕДНИЙ|Используется с параметром **/d**\<Day> для выполнения задачи в определенной неделе и дне. Например, в третью среду месяца.|

##### <a name="d-dayday--"></a>/d день [, день...] | *

Указывает день (или дни) недели или дня (или дней) месяца. Действует только при ЕЖЕНЕДЕЛЬном или ЕЖЕМЕСЯЧном расписании.


| Тип расписания |              Модификатор              |     Значения дня (/d)      |                                                                                                 Описание                                                                                                 |
|---------------|------------------------------------|--------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    Запуск     |               1 - 52               | ПН – SUN [, ПН, SUN...] |                                                                                                     \*                                                                                                      |
|    Семейный    | ПЕРВЫЙ, ВТОРОЙ, ТРЕТИЙ, ЧЕТВЕРТЫЙ, ПОСЛЕДНИЙ |        ПОНЕДЕЛЬНИК — SUN         |                                                                                   Требуется для расписания конкретной недели.                                                                                    |
|    Семейный    |          Нет или {1-12}          |          1 - 31          | Необязательный параметр и допустимый только без модификатора (**/mo**) (конкретный график даты) или, если параметру **/mo** присвоено значение 1-12 (для каждого \<расписания N> месяцев). Значение по умолчанию — день 1 (первый день месяца). |

##### <a name="m-monthmonth"></a>/m месяц [, месяц...]

Указывает месяц или месяцы года, в течение которых должно выполняться запланированное задание. Допустимые значения: JAN-дек и * (каждый месяц). Параметр **/m** допустим только для ежемесячного расписания. Он необходим, если используется модификатор ЛАСТДАЙ. В противном случае это необязательно, а значение по умолчанию — * (каждый месяц).

##### <a name="i-idletime"></a>/i \<идлетиме>

Указывает, сколько минут компьютер находится в режиме простоя перед запуском задачи. Допустимое значение — целое число от 1 до 999. Этот параметр действителен только с расписанием ONIDLE, а затем является обязательным.

##### <a name="st-starttime"></a>/ST \<> StartTime

Указывает время запуска задачи (при каждом запуске) в \<часовом формате чч: мм> 24-часовой формат. Значение по умолчанию — текущее время на локальном компьютере. Параметр **/St** действителен с почасовой, ежечасной, ежедневной, еженедельно, ежемесячно и раз в расписаниях. Оно требуется для ОДНОКРАТНОго расписания.

##### <a name="ri-interval"></a>/RI \<интервал>

Указывает интервал повторения в минутах. Это неприменимо для типов расписания: минуты, ЕЖЕЧАСно, OnStart, OnStart и OnStart. Допустимый диапазон — от 1 до 599940 минут (599940 минут = 9999 часов). Если указан параметр/ET или/DU, интервал повтора по умолчанию равен 10 минутам.

##### <a name="et-endtime"></a>> \</et EndTime

Указывает время суток, в течение которого расписание почасового или ежечасного задания \<заканчивается в формате чч: мм> 24-часового формата. После указанного времени окончания программа **schtasks** не запускает задачу повторно, пока не будет повторяться время запуска. По умолчанию расписания задач не имеют времени окончания. Этот параметр является необязательным и действителен только с поминутным или ЕЖЕЧАСным расписанием.

Пример см. в следующих статьях:
-   Чтобы запланировать задание, которое выполняется каждые 100 минут в нерабочее время в, **чтобы запланировать задание, которое выполняется каждые** \<N> **минут** .

##### <a name="du-duration"></a>/Du \<длительность>

Задает максимальный интервал времени в минутах или ежечасном расписании в \<HHHH: mm> 24-часовом формате. По истечении указанного времени **команда Schtasks** не запускает задачу повторно, пока не будет повторяться время запуска. По умолчанию расписания задач не имеют максимальной длительности. Этот параметр является необязательным и действителен только с поминутным или ЕЖЕЧАСным расписанием.

Пример см. в следующих статьях:
-   Чтобы запланировать выполнение задачи, выполняемой каждые 3 часа, в течение 10 часов в разделе, **чтобы запланировать задание, которое выполняется каждые** \<N> **часов** .

##### <a name="k"></a>/k

Останавливает программу, выполняемую задачей в момент, заданный параметром **/et** или **/du**. Без **/k**программа **schtasks** не запускает программу снова после того, как она достигнет времени, заданного параметром **/et** или **/du**, но не останавливает программу, если она все еще выполняется. Этот параметр является необязательным и действителен только с поминутным или ЕЖЕЧАСным расписанием.

Пример см. в следующих статьях:
-   Чтобы запланировать задание, которое выполняется каждые 100 минут в нерабочее время в, **чтобы запланировать задание, которое выполняется каждые** \<N> **минут** .

##### <a name="sd-startdate"></a>/SD \<> StartDate

Указывает дату запуска расписания задачи. Значение по умолчанию — текущая дата на локальном компьютере. Параметр **/SD** является допустимым и необязательным для всех типов расписания.

Формат *StartDate* зависит от языкового стандарта, выбранного для параметра локальный компьютер в окне **язык и региональные стандарты** **панели управления**. Для каждого языкового стандарта допустимы только один формат.

В следующей таблице перечислены допустимые форматы даты. Используйте формат, наиболее похожий на формат, выбранный для параметра **Краткая дата** в окне **язык и региональные стандарты** **панели управления** на локальном компьютере.


|       Значение       |                                        Описание                                         |
|-------------------|--------------------------------------------------------------------------------------------|
| \<MM>/<DD>/<YYYY> | Используйте для форматов с первого месяца, например для **английского (США)** и **испанского (Панама)**. |
| \<ДД>/<MM>/<YYYY> |       Используйте в качестве формата для первых дней, например **болгарского** и **нидерландского (Нидерланды)**.        |
| \<ГГГГ>/<MM>/<DD> |          Используйте для форматов с первым годом, например **шведского** и **французского (Канада)**.          |

/ED \<> EndDate

Указывает дату окончания срока действия расписания. Это необязательный параметр. Оно недопустимо в расписании ОДНОКРАТНОго входа, запуска, OnStart или OnStart. По умолчанию расписания не имеют даты окончания.

Формат *EndDate* зависит от языкового стандарта, выбранного для параметра локальный компьютер в окне **язык и региональные стандарты** **панели управления**. Для каждого языкового стандарта допустимы только один формат.

В следующей таблице перечислены допустимые форматы даты. Используйте формат, наиболее похожий на формат, выбранный для параметра **Краткая дата** в окне **язык и региональные стандарты** **панели управления** на локальном компьютере.


|       Значение       |                                        Описание                                         |
|-------------------|--------------------------------------------------------------------------------------------|
| \<MM>/<DD>/<YYYY> | Используйте для форматов с первого месяца, например для **английского (США)** и **испанского (Панама)**. |
| \<ДД>/<MM>/<YYYY> |       Используйте в качестве формата для первых дней, например **болгарского** и **нидерландского (Нидерланды)**.        |
| \<ГГГГ>/<MM>/<DD> |          Используйте для форматов с первым годом, например **шведского** и **французского (Канада)**.          |

##### <a name="it"></a>разрешает

Задает выполнение задачи только в том случае, если пользователь с правами запуска от имени (учетная запись пользователя, под которой выполняется задача) вошел в систему на компьютере. Этот параметр не влияет на задачи, выполняемые с разрешениями системы.

По умолчанию пользователь, выполняющий команду от имени, является текущим пользователем локального компьютера, когда задача запланирована, или учетной записью, указанной параметром **/u** , если она используется. Однако если команда включает параметр **/ru** , то пользователь, выполняющий команду, является учетной записью, указанной параметром **/ru** .

Примеры см. в следующих статьях:
-   Чтобы запланировать задание, которое выполняется каждые 70 дней, если я вошел в систему, в раздел **чтобы запланировать задачу, которая выполняется каждые** *N* **дней** .
-   Выполнение задачи только при входе определенного пользователя в систему **для планирования задачи, выполняемой с другим** разделом разрешений.

##### <a name="z"></a>/z

Указывает, что задача должна быть удалена после завершения ее расписания.

##### <a name="f"></a>/f

Указывает, что необходимо создать задачу и отключить предупреждения, если указанная задача уже существует.

##### <a name=""></a>/?

Отображение справки в командной строке.

### <a name="to-schedule-a-task-that-runs-every-n-minutes"></a><a name=BKMK_minutes></a>Планирование задачи, выполняемой каждые N минут

#### <a name="minute-schedule-syntax"></a>Синтаксис расписания в минутах

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc minute [/mo {1 - 1439}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [{/et <HH:MM> | /du <HHHH:MM>} [/k]] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В расписании минут требуется параметр **/SC Minute** . Параметр **/mo** (модификатор) является необязательным и указывает количество минут между выполнением задачи. Значение по умолчанию для параметра **/mo** равно 1 (каждую минуту). Параметры **/et** (время окончания) и **/du** (продолжительность) являются необязательными и могут использоваться с параметром **/k** (End Task) или без него.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-every-20-minutes"></a>Планирование задачи, выполняемой каждые 20 минут

Следующая команда планирует выполнение сценария безопасности sec. vbs каждые 20 минут. Команда использует параметр **/SC** , чтобы задать расписание по минутам, а параметру **/mo** задать интервал в 20 минут.

Поскольку команда не включает дату и время запуска, задача запускается через 20 минут после завершения команды и запускается каждые 20 минут при каждом запуске системы. Обратите внимание, что исходный файл сценария безопасности находится на удаленном компьютере, но задача запланирована и выполняется на локальном компьютере.
```
schtasks /create /sc minute /mo 20 /tn Security Script /tr \\central\data\scripts\sec.vbs
```

#### <a name="to-schedule-a-task-that-runs-every-100-minutes-during-non-business-hours"></a>Планирование задачи, которая выполняется каждые 100 минут в нерабочее время

Следующая команда планирует выполнение сценария безопасности sec. vbs на локальном компьютере каждые 100 минут между 5:00 вечера. и 7:59 утра Каждый день. В команде параметр **/SC** используется для задания расписания минут, а параметр **/mo** — для указания интервала в 100 минут. Параметры **/St** и **/et** используются для указания времени начала и окончания расписания каждого дня. Он также использует параметр **/k** для завершения скрипта, если он еще выполняется в 7:59 утра. Если не **/k**, **команда Schtasks** не запустит сценарий после 7:59 утра, но если экземпляр запущен в 6:20 утра все еще запущено, оно не будет останавливаться.
```
schtasks /create /tn Security Script /tr sec.vbs /sc minute /mo 100 /st 17:00 /et 08:00 /k
```

### <a name="to-schedule-a-task-that-runs-every-n-hours"></a><a name=BKMK_hours></a>Планирование задачи, выполняемой каждые N часов

#### <a name="hourly-schedule-syntax"></a>Синтаксис ежечасного расписания

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc hourly [/mo {1 - 23}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [{/et <HH:MM> | /du <HHHH:MM>} [/k]] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В почасовом расписании требуется параметр **/SC Hour** . Параметр **/mo** (модификатор) является необязательным и указывает количество часов между выполнением задачи. Значение по умолчанию для параметра **/mo** равно 1 (каждый час). Параметр **/k** (End Task) является необязательным и может использоваться с параметром **/et** (окончание в указанное время) или **/du** (заканчивается после указанного интервала).

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-every-five-hours"></a>Планирование задачи, выполняемой каждые пять часов

Следующая команда планирует запуск программы MyApp каждые пять часов, начиная с первого дня марта 2002. Параметр **/mo** используется для указания интервала, а параметр **/SD** — для указания даты начала. Так как команда не задает время начала, в качестве времени начала используется текущее время.

Так как локальный компьютер настроен на использование **английского языка (Зимбабве)** в **языковых и региональных параметрах** **панели управления**, формат начальной даты — MM/ДД/ГГГГ (03/01/2002).
```
schtasks /create /sc hourly /mo 5 /sd 03/01/2002 /tn My App /tr c:\apps\myapp.exe
```

#### <a name="to-schedule-a-task-that-runs-every-hour-at-five-minutes-past-the-hour"></a>Планирование задачи, выполняемой каждый час за пять минут после часа

Следующая команда назначает запуск программы MyApp ежечасно, начиная с пяти минут после полуночи. Поскольку параметр **/mo** опущен, команда использует значение по умолчанию для ежечасного расписания, которое каждые (1) час. Если эта команда выполняется после 12:05 утра, программа не будет выполняться до следующего дня.
```
schtasks /create /sc hourly /st 00:05 /tn My App /tr c:\apps\myapp.exe
```

#### <a name="to-schedule-a-task-that-runs-every-3-hours-for-10-hours"></a>Планирование задачи, которая выполняется каждые 3 часа в течение 10 часов

Следующая команда планирует запуск программы MyApp каждые 3 часа в течение 10 часов.

Команда использует параметр **/SC** для задания ежечасного расписания, а параметр **/mo** — 3 часа. Параметр **/St** используется для запуска расписания в полночь, а параметр **/du** — для завершения повторений через 10 часов. Так как программа выполняется всего несколько минут, параметр **/k** , который останавливает программу, если она все еще выполняется по истечении срока действия, не требуется.
```
schtasks /create /tn My App /tr myapp.exe /sc hourly /mo 3 /st 00:00 /du 0010:00
```
В этом примере задача выполняется в 12:00 утра, 3:00 утра, 6:00 утра и 9:00 утра. Так как длительность составляет 10 часов, задача не запускается снова в 12:00 часов. Вместо этого он запускается снова в 12:00 утра. следующий день.

### <a name="to-schedule-a-task-that-runs-every-n-days"></a><a name=BKMK_days></a>Планирование задачи, выполняемой каждые N дней

#### <a name="daily-schedule-syntax"></a>Синтаксис ежедневного расписания

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc daily [/mo {1 - 365}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В ежедневном расписании требуется параметр **/SC Daily** . Параметр **/mo** (модификатор) является необязательным и указывает количество дней между выполнением задачи. Значение по умолчанию для параметра **/mo** равно 1 (каждый день).

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-every-day"></a>Планирование задачи, выполняемой каждый день

Чтобы запланировать выполнение программы MyApp раз в день, каждый день, в 8:00 утра. до 31 декабря 2002 г. Поскольку параметр **/mo** опущен, для выполнения команды каждый день используется интервал по умолчанию, равный 1.

В этом примере, так как для локальной системы компьютера выбран параметр **Английский (Великобритания)** в области **язык и региональные стандарты** на **панели управления**, формат конечной даты — дд/мм/гггг (31/12/2002).
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc daily /st 08:00 /ed 31/12/2002
```

#### <a name="to-schedule-a-task-that-runs-every-12-days"></a>Планирование задачи, выполняемой каждые 12 дней

Чтобы запланировать выполнение программы MyApp каждые 12 дней в 1:00 вечера. (13:00) начиная с 31 декабря 2002 г. Команда использует параметр **/mo** для задания интервала в два (2) дня, а параметры **/SD** и **/St** — для указания даты и времени.

В этом примере, так как для параметра « **Английский (Зимбабве)** » в окне «Язык **и региональные стандарты** **» на панели управления**установлена система, формат конечной даты — мм/дд/гггг (12/31/2002).
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc daily /mo 12 /sd 12/31/2002 /st 13:00
```

#### <a name="to-schedule-a-task-that-runs-every-70-days-if-i-am-logged-on"></a>Планирование задачи, выполняемой каждые 70 дней, если вход выполнен

Следующая команда планирует выполнение сценария безопасности sec. vbs каждые 70 дней. Команда использует параметр **/mo** для указания интервала в 70 дней. Он также использует параметр **/IT** , чтобы указать, что задача выполняется только в том случае, если пользователь, от имени которого выполняется задача, вошел в систему на компьютере. Так как задача будет выполняться с разрешениями учетной записи пользователя, задача будет запущена только после входа в систему.
```
schtasks /create /tn Security Script /tr sec.vbs /sc daily /mo 70 /it
```

> [!NOTE]
> Чтобы указать задачи с помощью интерактивного свойства (**/IT**), используйте подробный запрос **(/query/v**). В подробном запросе на отображение задачи с параметром **/IT**поле **режим входа** имеет значение **только Interactive**.

### <a name="to-schedule-a-task-that-runs-every-n-weeks"></a><a name=BKMK_weeks></a>Планирование задачи, выполняемой каждые N недель

#### <a name="weekly-schedule-syntax"></a>Синтаксис еженедельного расписания

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc weekly [/mo {1 - 52}] [/d {<MON - SUN>[,MON - SUN...] | *}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В еженедельном расписании требуется параметр **/SC Weekly** . Параметр **/mo** (модификатор) является необязательным и указывает количество недель между выполнением задачи. Значение по умолчанию для параметра **/mo** равно 1 (каждую неделю).

Еженедельные расписания также имеют необязательный параметр **/d** , чтобы запланировать выполнение задачи в указанные дни недели или на все дни (*). Значение по умолчанию — Пн (понедельник). Параметр "каждый день (*)" эквивалентен планированию ежедневной задачи.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-every-six-weeks"></a>Планирование задачи, выполняемой каждые шесть недель

Следующая команда назначает запуск программы MyApp на удаленном компьютере каждые шесть недель. Команда использует параметр **/mo** для указания интервала. Так как команда пропускает параметр **/d** , задача выполняется в понедельниках.

Эта команда также использует параметр **/s** для указания удаленного компьютера, а параметр **/u** — для выполнения команды с разрешениями учетной записи администратора пользователя. Поскольку параметр **/p** опущен, программа **SchTasks. exe** запрашивает у пользователя пароль учетной записи администратора.

Кроме того, поскольку команда выполняется удаленно, все пути в команде, включая путь к MyApp. exe, ссылаются на пути на удаленном компьютере.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc weekly /mo 6 /s Server16 /u Admin01
```

#### <a name="to-schedule-a-task-that-runs-every-other-week-on-friday"></a>Планирование задачи, выполняемой каждую неделю в пятницу

Следующая команда планирует выполнение задачи каждую пятницу. Он использует параметр **/mo** для указания интервала в две недели, а параметр **/d** — для указания дня недели. Чтобы запланировать задание, выполняемое каждую пятницу, опустите параметр **/mo** или задайте для него значение 1.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc weekly /mo 2 /d FRI
```

### <a name="to-schedule-a-task-that-runs-every-n-months"></a><a name=BKMK_months></a>Планирование задачи, выполняемой каждые N месяцев

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly [/mo {1 - 12}] [/d {1 - 31}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В этом типе расписания требуется параметр **/SC Monthly** . Параметр **/mo** (модификатор), указывающий количество месяцев между выполнением задачи, является необязательным, а значение по умолчанию — 1 (каждый месяц). Этот тип расписания также имеет необязательный параметр **/d** , чтобы запланировать выполнение задачи в указанную дату месяца. Значение по умолчанию — 1 (первый день месяца).

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-on-the-first-day-of-every-month"></a>Планирование задачи, выполняемой в первый день каждого месяца

Следующая команда назначает запуск программы MyApp в первый день каждого месяца. Поскольку значение 1 является значением по умолчанию для параметра **/mo** (модификатор) и параметра **/d** (Day), эти параметры пропускаются из команды.
```
schtasks /create /tn My App /tr myapp.exe /sc monthly
```

#### <a name="to-schedule-a-task-that-runs-every-three-months"></a>Планирование задачи, выполняемой каждые три месяца

Следующая команда планирует запуск программы MyApp каждые три месяца. Для указания интервала используется параметр **/mo** .
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /mo 3
```

#### <a name="to-schedule-a-task-that-runs-at-midnight-on-the-21st-day-of-every-other-month"></a>Планирование задачи, которая выполняется в полночь на 21-й день каждого месяца

Следующая команда планирует выполнение программы MyApp каждый второй месяц в 21 день месяца в полночь. Команда указывает, что эта задача должна выполняться в течение одного года, с 2 июля 2002 до 30 июня 2003.

Команда использует параметр **/mo** для указания ежемесячного интервала (каждые два месяца), параметра **/d** для указания даты, а параметр **/St** — для указания времени. Он также использует параметры **/SD** и **/ED** , чтобы указать дату начала и дату окончания соответственно. Так как для локального компьютера выбран параметр **Английский (Южная Африка)** в области **язык и региональные стандарты** на **панели управления**, даты указываются в локальном формате, гггг/мм/дд.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /mo 2 /d 21 /st 00:00 /sd 2002/07/01 /ed 2003/06/30 
```

### <a name="to-schedule-a-task-that-runs-on-a-specific-day-of-the-week"></a><a name=BKMK_spec_day></a>Планирование задачи, выполняемой в конкретный день недели

#### <a name="weekly-schedule-syntax"></a>Синтаксис еженедельного расписания

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc weekly [/d {<MON - SUN>[,MON - SUN...] | *}] [/mo {1 - 52}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

День расписания недели является разновидностью еженедельного расписания. В еженедельном расписании требуется параметр **/SC Weekly** . Параметр **/mo** (модификатор) является необязательным и указывает количество недель между выполнением задачи. Значение по умолчанию для параметра **/mo** равно 1 (каждую неделю). Параметр **/d** , который является необязательным, планирует выполнение задачи в указанные дни недели или на все дни (\*). Значение по умолчанию — Пн (понедельник). Параметр "каждый день"**( \*/d **) эквивалентен планированию ежедневной задачи.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-every-wednesday"></a>Планирование задачи, выполняемой каждую среду

Следующая команда планирует запуск программы MyApp каждую неделю в среду. Команда использует параметр **/d** для указания дня недели. Так как команда не пропускает параметр **/mo** , задача выполняется каждую неделю.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc weekly /d WED
```

#### <a name="to-schedule-a-task-that-runs-every-eight-weeks-on-monday-and-friday"></a>Планирование задачи, выполняемой каждые восемь недель в понедельник и пятницу

Следующая команда планирует выполнение задачи в понедельник и пятницу каждой восьмой недели. Параметр **/d** используется для указания дней, а параметр **/mo** — для указания восьми-недельного интервала.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc weekly /mo 8 /d MON,FRI
```

### <a name="to-schedule-a-task-that-runs-on-a-specific-week-of-the-month"></a><a name=BKMK_spec_week></a>Планирование задачи, выполняемой в течение определенной недели месяца

#### <a name="specific-week-syntax"></a>Синтаксис конкретной недели

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly /mo {FIRST | SECOND | THIRD | FOURTH | LAST} /d MON - SUN [/m {JAN - DEC[,JAN - DEC...] | *}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В этом типе расписания требуется параметр **/SC Monthly** , параметр **/mo** (модификатор) и параметр **/d** (день). Параметр **/mo** (модификатор) указывает неделю, в которой выполняется задача. Параметр **/d** указывает день недели. (Для этого типа расписания можно указать только один день недели.) Это расписание также имеет необязательный параметр **/m** (month), который позволяет запланировать выполнение задачи в определенные месяцы или\*каждый месяц (). Значение по умолчанию для параметра **/m** — каждый месяц\*().

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-for-the-second-sunday-of-every-month"></a>Планирование задачи на второе воскресенье каждого месяца

Следующая команда назначает запуск программы MyApp на второе воскресенье каждого месяца. Параметр **/mo** используется для указания второй недели месяца, а параметр **/d** — для указания дня.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /mo SECOND /d SUN
```

#### <a name="to-schedule-a-task-for-the-first-monday-in-march-and-september"></a>Планирование задачи на первый понедельник в марте и Сентябрь

Следующая команда назначает запуск программы MyApp на первый понедельник в марте и сентябрь. Параметр **/mo** используется для указания первой недели месяца, а параметр **/d** — для указания дня. Он использует параметр **/m** для указания месяца, разделяя аргументы месяца запятой.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /mo FIRST /d MON /m MAR,SEP
```

### <a name="to-schedule-a-task-that-runs-on-a-specific-date-each-month"></a><a name=BKMK_spec_date></a>Планирование задачи, которая выполняется с определенной датой, каждый месяц

#### <a name="specific-date-syntax"></a>Специальный синтаксис даты

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly /d {1 - 31} [/m {JAN - DEC[,JAN - DEC...] | *}] [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

Для конкретного типа расписания даты требуются параметр **/SC Monthly** и параметр **/d** (день). Параметр **/d** задает дату месяца (1-31), а не день недели. В расписании можно указать только один день. Параметр **/mo** (модификатор) не является допустимым для этого типа расписания.

Параметр **/m** (month) является необязательным для этого типа расписания, а значение по умолчанию — каждый месяц (<em>). **schtasks</em> * не позволяет запланировать задачу на дату, которая не происходит в месяц, заданный параметром **/m** . Однако если опустить параметр **/m** и запланировать задачу для даты, которая не отображается каждый месяц, например 31-й день, задача не будет выполняться в течение более короткого месяца. Чтобы запланировать задачу за последний день месяца, используйте тип расписания последний день.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-for-the-first-day-of-every-month"></a>Планирование задачи в первый день каждого месяца

Следующая команда назначает запуск программы MyApp в первый день каждого месяца. Поскольку модификатором по умолчанию является None (без модификатора), день по умолчанию — день 1, а месяц по умолчанию — каждый месяц, команда не требует дополнительных параметров.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly
```

#### <a name="to-schedule-a-task-for-the-15th-days-of-may-and-june"></a>Планирование задачи в течение 15 дней мая и июнь

Следующая команда назначает запуск программы MyApp на 15 мая и 15 июня в 3:00 вечера. (15:00). Параметр **/m** используется для указания даты, а параметр **/m** — для указания месяцев. Он также использует параметр **/St** для указания времени начала.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /d 15 /m MAY,JUN /st 15:00
```

### <a name="to-schedule-a-task-that-runs-on-the-last-day-of-a-month"></a><a name=BKMK_last_day></a>Планирование задачи, выполняемой в последний день месяца

#### <a name="last-day-syntax"></a>Синтаксис последнего дня

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc monthly /mo LASTDAY /m {JAN - DEC[,JAN - DEC...] | *} [/st <HH:MM>] [/sd <StartDate>] [/ed <EndDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В расписании за последний день параметр **/SC Monthly** , параметр **/mo ластдай** (модификатор) и параметр **/m** (month) являются обязательными. Недопустимый параметр **/d** (день).

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-for-the-last-day-of-every-month"></a>Планирование задачи за последний день каждого месяца

Следующая команда назначает запуск программы MyApp в последний день каждого месяца. Он использует параметр **/mo** , чтобы указать последний день, а параметр **/m** — символ-шаблон (*), чтобы указать, что программа выполняется каждый месяц.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /mo lastday /m *
```

#### <a name="to-schedule-a-task-at-600-pm-on-the-last-days-of-february-and-march"></a>Планирование задачи в 6:00 часов за последние дни февраля и март

Следующая команда назначает запуск программы MyApp в последний день февраля и последний день марта в 6:00 вечера. Он использует параметр **/mo** для указания последнего дня, параметр **/m** для указания месяцев, а параметр **/St** — для указания времени начала.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /mo lastday /m FEB,MAR /st 18:00
```

### <a name="to-schedule-a-task-that-runs-once"></a><a name=BKMK_once></a>Планирование задачи, которая выполняется один раз

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc once /st <HH:MM> [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

В расписании однократного выполнения параметр **/SC Once** является обязательным. Параметр **/St** , указывающий время запуска задачи, является обязательным. Параметр **/SD** , указывающий дату запуска задачи, является необязательным. Параметры **/mo** (модификатор) и **/ED** (Дата окончания) недопустимы для этого типа расписания.

**Команда Schtasks** не позволяет запланировать выполнение задачи, если указанная дата и время находятся в прошлом, в зависимости от времени локального компьютера. Чтобы запланировать задание, которое выполняется один раз на удаленном компьютере в другом часовом поясе, необходимо запланировать его до наступления этой даты и времени на локальном компьютере.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-one-time"></a>Планирование задачи, которая выполняется один раз

Следующая команда назначает запуск программы MyApp в полночь 1 января 2003. Он использует параметр **/SC** для указания типа расписания, а параметр **/SD** и **St** — для указания даты и времени.

Поскольку локальный компьютер использует **Английский (США)** в окне « **язык и региональные стандарты** » на **панели управления**, формат начальной даты — мм/дд/гггг.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc once /sd 01/01/2003 /st 00:00
```

### <a name="to-schedule-a-task-that-runs-every-time-the-system-starts"></a><a name=BKMK_startup></a>Планирование задачи, выполняемой при каждом запуске системы

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc onstart [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

Для типа расписания "по запуску" требуется параметр **/SC OnStart** . Параметр **/SD** (Дата начала) является необязательным, и по умолчанию используется текущая дата.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-when-the-system-starts"></a>Планирование задачи, выполняемой при запуске системы

Следующая команда назначает запуск программы MyApp при каждом запуске системы, начиная с 15 марта 2001:

Так как на локальном компьютере используется **Английский (США)** в окне « **язык и региональные стандарты** **» на панели управления**, формат начальной даты — мм/дд/гггг.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc onstart /sd 03/15/2001
```

### <a name="to-schedule-a-task-that-runs-when-a-user-logs-on"></a><a name=BKMK_logon></a>Планирование задачи, выполняемой при входе пользователя в систему

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc onlogon [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

Тип расписания входа в систему планирует задание, которое выполняется при каждом входе пользователя на компьютер. В поле Расписание входа в систему введите параметр **/sc onlogon** . Параметр **/SD** (Дата начала) является необязательным, и по умолчанию используется текущая дата.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-when-a-user-logs-on-to-a-remote-computer"></a>Планирование задачи, выполняемой при входе пользователя на удаленный компьютер

Следующая команда планирует выполнение пакетного файла при каждом входе пользователя на удаленный компьютер (любого пользователя). Для указания удаленного компьютера используется параметр **/s** . Так как команда является удаленной, все пути в команде, включая путь к пакетному файлу, указывают на путь на удаленном компьютере.
```
schtasks /create /tn Start Web Site /tr c:\myiis\webstart.bat /sc onlogon /s Server23
```

### <a name="to-schedule-a-task-that-runs-when-the-system-is-idle"></a><a name=BKMK_idle></a>Планирование задачи, выполняемой при простое системы

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc onidle /i {1 - 999} [/sd <StartDate>] [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="remarks"></a>Примечания

Тип расписания бездействия (on Idle) планирует задачу, которая выполняется при отсутствии активности пользователя в течение времени, указанного параметром **/i** . В расписании неактивных заданий по типу требуется параметр **/SC OnIdle** и параметр **/i** . Параметр **/SD** (Дата начала) является необязательным, и по умолчанию используется текущая дата.

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-whenever-the-computer-is-idle"></a>Планирование задачи, которая выполняется при простое компьютера

Следующая команда назначает запуск программы MyApp при простое компьютера. Он использует обязательный параметр **/i** , чтобы указать, что компьютер должен оставаться бездействующим в течение десяти минут до запуска задачи.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc onidle /i 10
```

### <a name="to-schedule-a-task-that-runs-now"></a><a name=BKMK_now></a>Планирование задачи, которая выполняется сейчас

**Команда Schtasks** не имеет параметра "запустить сейчас", но ее можно смоделировать, создав задачу, которая выполняется один раз и начнется через несколько минут.

#### <a name="syntax"></a>Синтаксис

```
schtasks /create /tn <TaskName> /tr <TaskRun> /sc once [/st <HH:MM>] /sd <MM/DD/YYYY> [/it] [/ru {[<Domain>\]<User> [/rp <Password>] | System}] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="examples"></a>Примеры

#### <a name="to-schedule-a-task-that-runs-a-few-minutes-from-now"></a>Чтобы запланировать задание, которое выполняется через несколько минут, с этого момента.

Следующая команда планирует выполнение задачи с 13 ноября 2002 по 2:18 вечера. отправляется wake-up пакет.

Так как на локальном компьютере используется **Английский (США)** в окне « **язык и региональные стандарты** **» на панели управления**, формат начальной даты — мм/дд/гггг.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc once /st 14:18 /sd 11/13/2002
```

### <a name="to-schedule-a-task-that-runs-with-different-permissions"></a><a name=BKMK_diff_perms></a>Планирование задачи, выполняемой с разными разрешениями

Можно запланировать выполнение задач всех типов с разрешениями альтернативной учетной записи как на локальном, так и на удаленном компьютере. В дополнение к параметрам, необходимым для конкретного типа расписания, параметр **/ru** является обязательным, а параметр **/RP** является необязательным.

#### <a name="examples"></a>Примеры

#### <a name="to-run-a-task-with-administrator-permissions-on-the-local-computer"></a>Выполнение задачи с разрешениями администратора на локальном компьютере

Следующая команда планирует запуск программы MyApp на локальном компьютере. Он использует параметр **/ru** , чтобы указать, что задача должна выполняться с разрешениями учетной записи администратора пользователя (Admin06). В этом примере запланировано выполнение задачи каждый вторник, но можно использовать любой тип расписания для выполнения задачи с другими разрешениями.
```
schtasks /create /tn My App /tr myapp.exe /sc weekly /d TUE /ru Admin06
```
В ответе программа **SchTasks. exe** запрашивает пароль запуска от имени для учетной записи Admin06, а затем выводит сообщение об успешном выполнении.
```
Please enter the run as password for Admin06: ********
SUCCESS: The scheduled task My App has successfully been created.
```

#### <a name="to-run-a-task-with-alternate-permissions-on-a-remote-computer"></a>Выполнение задачи с альтернативными разрешениями на удаленном компьютере

Следующая команда назначает запуск программы MyApp на компьютере Marketing каждые четыре дня.

Команда использует параметр **/SC** для задания ежедневного расписания и параметр **/mo** для указания интервала в четыре дня.

В команде параметр **/s** используется для указания имени удаленного компьютера и параметра **/u** , чтобы указать учетную запись с разрешением на выполнение задачи на удаленном компьютере (Admin01 на компьютере Marketing). Он также использует параметр **/ru** , чтобы указать, что задача должна выполняться с разрешениями учетной записи пользователя, не имеющей прав администратора (User01 в домене рескитс). Без параметра **/ru** задача будет выполняться с разрешениями учетной записи, указанной параметром **/u**.
```
schtasks /create /tn My App /tr myapp.exe /sc daily /mo 4 /s Marketing /u Marketing\Admin01 /ru Reskits\User01
```
Сначала **команда Schtasks** запрашивает пароль пользователя с именем, указанным параметром **/u** (для выполнения команды), а затем запрашивает пароль пользователя с именем, указанным параметром **/ru** (для запуска задачи). После проверки подлинности паролей **команда Schtasks** выводит сообщение о том, что задача запланирована.
```
Type the password for Marketing\Admin01:********

Please enter the run as password for Reskits\User01: ********

SUCCESS: The scheduled task My App has successfully been created.
```

#### <a name="to-run-a-task-only-when-a-particular-user-is-logged-on"></a>Выполнение задачи только при входе определенного пользователя в систему

Следующая команда планирует выполнение программы Админчекк. exe на общедоступном компьютере каждую пятницу в 4:00 утра, но только в том случае, если администратор компьютера вошел в систему.

Команда использует параметр **/SC** для задания еженедельного расписания, параметр **/d** для указания дня, а параметр **/St** — для указания времени начала.

Команда использует параметр **/s** для указания имени удаленного компьютера и параметр **/u** , чтобы указать учетную запись с разрешением на выполнение задачи на удаленном компьютере. Он также использует параметр **/ru** , чтобы настроить выполнение задачи с разрешениями администратора общедоступного компьютера (Public\Admin01) и параметра **/IT** , чтобы указать, что задача выполняется только при входе в систему учетной записи Public\Admin01.
```
schtasks /create /tn Check Admin /tr AdminCheck.exe /sc weekly /d FRI /st 04:00 /s Public /u Domain3\Admin06 /ru Public\Admin01 /it
```
**Примечание**
-   Чтобы указать задачи с помощью интерактивного свойства (**/IT**), используйте подробный запрос **(/query/v**). В подробном запросе на отображение задачи с параметром **/IT**поле **режим входа** имеет значение **только Interactive**.

### <a name="to-schedule-a-task-that-runs-with-system-permissions"></a><a name=BKMK_sys_perms></a>Планирование задачи, выполняемой с разрешениями системы

Задачи всех типов могут выполняться с разрешениями системной учетной записи как на локальном, так и на удаленном компьютере. Помимо параметров, необходимых для конкретного типа расписания, требуется параметр **системы/ru** (или * */ru * *), а параметр **/RP** является недопустимым.

**Важно.**
-   Системная учетная запись не имеет прав интерактивного входа. Пользователи не могут видеть программы или задачи, выполняемые с системными разрешениями, и взаимодействовать с ними.
-   Параметр **/ru** определяет разрешения, с которыми запускается задача, а не разрешения, используемые для планирования задачи. Только администраторы могут планировать задачи, независимо от значения параметра **/ru** .

**Примечание**

Чтобы найти задачи, выполняемые с разрешениями системы, используйте подробный запрос (**/Query** **/v**). В подробном запросе, отображающем задачу системного выполнения, поле « **Запуск от имени пользователя** » имеет значение **NT AUTHORITY\SYSTEM** , а поле « **режим входа** » имеет значение « **только фон**».

#### <a name="examples"></a>Примеры

#### <a name="to-run-a-task-with-system-permissions"></a>Выполнение задачи с разрешениями системы

Следующая команда планирует запуск программы MyApp на локальном компьютере с разрешениями системной учетной записи. В этом примере задача запланирована на пятнадцатый день каждого месяца, но для выполнения задачи с разрешениями системы можно использовать любой тип расписания.

В команде используется **системный параметр/ru** для указания контекста безопасности системы. Так как системные задачи не используют пароль, параметр **/RP** опускается.
```
schtasks /create /tn My App /tr c:\apps\myapp.exe /sc monthly /d 15 /ru System
```
В ответе программа **SchTasks. exe** отображает информационное сообщение и сообщение об успешном выполнении. Он не запрашивает пароль.
```
INFO: The task will be created under user name (NT AUTHORITY\SYSTEM).
SUCCESS: The Scheduled task My App has successfully been created.
```

#### <a name="to-run-a-task-with-system-permissions-on-a-remote-computer"></a>Выполнение задачи с разрешениями системы на удаленном компьютере

Следующая команда планирует запуск программы MyApp на компьютере Finance01 каждый утро в 4:00 утра. с разрешениями системы.

Команда использует параметр **/TN** для задания имени задачи, а параметр **/tr** — для указания удаленной копии программы MyApp. Параметр **/SC** используется для задания ежедневного расписания, но параметр **/mo** опущен, поскольку по умолчанию используется значение 1 (каждый день). Параметр **/St** используется для указания времени начала, а также времени запуска задачи каждый день.

Команда использует параметр **/s** для указания имени удаленного компьютера и параметр **/u** , чтобы указать учетную запись с разрешением на выполнение задачи на удаленном компьютере. Он также использует параметр **/ru** , чтобы указать, что задача должна выполняться под системной учетной записью. Без параметра **/ru** задача будет выполняться с разрешениями учетной записи, указанной параметром **/u**.
```
schtasks /create /tn My App /tr myapp.exe /sc daily /st 04:00 /s Finance01 /u Admin01 /ru System
```
**Команда Schtasks** запрашивает пароль пользователя с именем, заданным параметром **/u** , и после проверки подлинности пароля выводит сообщение о том, что задача создана и выполняется с разрешениями системной учетной записи.
```
Type the password for Admin01:**********

INFO: The Schedule Task My App will be created under user name (NT AUTHORITY\
SYSTEM).
SUCCESS: The scheduled task My App has successfully been created.
```

### <a name="to-schedule-a-task-that-runs-more-than-one-program"></a><a name=BKMK_multi_progs></a>Планирование задачи, запускающей более одной программы

Каждая задача запускает только одну программу. Тем не менее можно создать пакетный файл, запускающий несколько программ, а затем запланировать задачу запуска пакетного файла. Этот метод показан в следующей процедуре.
1. Создайте пакетный файл, запускающий программы, которые требуется запустить.

   В этом примере создается пакетный файл, запускающий Просмотр событий (eventvwr. exe) и системный монитор (Perfmon. exe).  
   - Откройте текстовый редактор, например Блокнот.
   - Введите имя и полный путь к исполняемому файлу для каждой программы. В этом случае файл содержит следующие инструкции.  
     ```
     C:\Windows\System32\Eventvwr.exe 
     C:\Windows\System32\Perfmon.exe
     ```  
   - Сохраните файл как MyApps. bat.
2. Используйте **SchTasks. exe** для создания задачи, запускающей MyApp. bat.

   Следующая команда создает задачу Monitor, которая запускается каждый раз, когда пользователь входит в систему. Он использует параметр **/TN** для задания имени задачи, а параметр **/tr** — для запуска MyApp. bat. Параметр **/SC** используется для указания типа расписания OnLogon, а параметр **/ru** — для выполнения задачи с разрешениями учетной записи администратора пользователя.  
   ```
   schtasks /create /tn Monitor /tr C:\MyApps.bat /sc onlogon /ru Reskit\Administrator
   ```  
   В результате выполнения этой команды при каждом входе пользователя в систему задача запускается как Просмотр событий, так и системного монитора.

### <a name="to-schedule-a-task-that-runs-on-a-remote-computer"></a><a name=BKMK_remote></a>Планирование задачи, выполняемой на удаленном компьютере

Чтобы запланировать выполнение задачи на удаленном компьютере, необходимо добавить ее в расписание удаленного компьютера. Задачи всех типов могут быть запланированы на удаленном компьютере, но должны выполняться следующие условия.
-   Необходимо иметь разрешение на планирование задачи. Таким образом, необходимо войти на локальный компьютер с учетной записью, которая является членом группы "Администраторы" на удаленном компьютере, или использовать параметр **/u** для предоставления учетных данных администратора удаленного компьютера.
-   Параметр **/u** можно использовать только в том случае, если локальный и удаленный компьютеры находятся в одном домене или если локальный компьютер находится в домене, которому доверяет домен удаленного компьютера. В противном случае удаленный компьютер не может проверить подлинность указанной учетной записи пользователя и не сможет проверить, является ли эта учетная запись членом группы "Администраторы".
-   Задача должна иметь достаточные разрешения для запуска на удаленном компьютере. Необходимые разрешения зависят от задачи. По умолчанию задача выполняется с разрешением текущего пользователя локального компьютера или, если используется параметр **/u** , задача выполняется с разрешением учетной записи, указанной параметром **/u** . Однако можно использовать параметр **/ru** для выполнения задачи с разрешениями для другой учетной записи пользователя или с системными разрешениями.

#### <a name="examples"></a>Примеры

#### <a name="an-administrator-schedules-a-task-on-a-remote-computer"></a>Администратор планирует задачу на удаленном компьютере

Следующая команда планирует запуск программы MyApp на удаленном компьютере SRV01 каждые десять дней сразу же. Команда использует параметр **/s** для задания имени удаленного компьютера. Поскольку локальный текущий пользователь является администратором удаленного компьютера, параметр **/u** , предоставляющий альтернативные разрешения на планирование задачи, не является обязательным.

Обратите внимание, что при планировании задач на удаленном компьютере все параметры ссылаются на удаленный компьютер. Поэтому исполняемый файл, заданный параметром **/tr** , ссылается на копию MyApp. exe на удаленном компьютере.
```
schtasks /create /s SRV01 /tn My App /tr c:\program files\corpapps\myapp.exe /sc daily /mo 10
```
В ответе **команда Schtasks** отображает сообщение об успешном выполнении задачи, указывающее на то, что задача запланирована.

#### <a name="a-user-schedules-a-command-on-a-remote-computer-case-1"></a>Пользователь планирует команду на удаленном компьютере (вариант 1)

Следующая команда планирует запуск программы MyApp на удаленном компьютере SRV06 каждые три часа. Поскольку для планирования задачи требуются разрешения администратора, команда использует параметры **/u** и **/p** для предоставления учетных данных учетной записи администратора пользователя (Admin01 в домене рескитс). По умолчанию эти разрешения также используются для выполнения задачи. Однако поскольку для выполнения задачи не требуются права администратора, команда включает параметры **/u** и **/RP** для переопределения значения по умолчанию и выполнения задачи с разрешением на удаленном компьютере пользователя, не являющегося администратором учетной записи.
```
schtasks /create /s SRV06 /tn My App /tr c:\program files\corpapps\myapp.exe /sc hourly /mo 3 /u reskits\admin01 /p R43253@4$ /ru SRV06\user03 /rp MyFav!!Pswd
```
В ответе **команда Schtasks** отображает сообщение об успешном выполнении задачи, указывающее на то, что задача запланирована.

#### <a name="a-user-schedules-a-command-on-a-remote-computer-case-2"></a>Пользователь планирует команду на удаленном компьютере (вариант 2)

Следующая команда планирует запуск программы MyApp на удаленном компьютере SRV02 в последний день каждого месяца. Поскольку локальный текущий пользователь (user03) не является администратором удаленного компьютера, команда использует параметр **/u** для предоставления учетных данных учетной записи администратора пользователя (Admin01 в домене рескитс). Разрешения учетной записи администратора будут использоваться для планирования задачи и выполнения задачи.
```
schtasks /create /s SRV02 /tn My App /tr c:\program files\corpapps\myapp.exe /sc monthly /mo LASTDAY /m * /u reskits\admin01
```
Так как команда не включала параметр **/p** (Password), команда **schtasks** запрашивает пароль. Затем он отображает сообщение об успешном выполнении и, в данном случае, предупреждение.
```
Type the password for reskits\admin01:********

SUCCESS: The scheduled task My App has successfully been created.

WARNING: The Scheduled task My App has been created, but may not run because
the account information could not be set.
```
Это предупреждение означает, что удаленному домену не удалось проверить подлинность учетной записи, указанной параметром **/u** . В этом случае удаленный домен не может проверить подлинность учетной записи пользователя, так как локальный компьютер не является членом домена, которому доверяет домен удаленного компьютера. В этом случае задание задачи отображается в списке запланированных задач, но задача фактически пуста и не будет запускаться.

Следующее отображение из подробного запроса представляет проблему с задачей. Обратите внимание, что значение параметра **время следующего выполнения** **никогда** **не должно** **быть получено из базы данных планировщика заданий**.

Если этот компьютер был членом того же домена или доверенного домена, задача была успешно запланирована и была выполнена как указанная.
```
HostName: SRV44
TaskName: My App
Next Run Time: Never
Status:
Logon mode: Interactive/Background
Last Run Time: Never
Last Result: 0
Creator: user03
Schedule: At 3:52 PM on day 31 of every month, start
 starting 12/14/2001
Task To Run: c:\program files\corpapps\myapp.exe
Start In: myapp.exe
Comment: N/A
Scheduled Task State: Disabled
Scheduled Type: Monthly
Start Time: 3:52:00 PM
Start Date: 12/14/2001
End Date: N/A
Days: 31
Months: JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NO
V,DEC
Run As User: Could not be retrieved from the task sched
uler database
Delete Task If Not Rescheduled: Enabled
Stop Task If Runs X Hours and X Mins: 72:0
Repeat: Every: Disabled
Repeat: Until: Time: Disabled
Repeat: Until: Duration: Disabled
Repeat: Stop If Still Running: Disabled
Idle Time: Disabled
Power Management: Disabled
```

#### <a name="remarks"></a>Примечания

-   Чтобы выполнить команду **/CREATE** с разрешениями другого пользователя, используйте параметр **/u** . Параметр **/u** допустим только для планирования задач на удаленных компьютерах.
-   Чтобы просмотреть дополнительные примеры для **schtasks/Create** , введите команду **schtasks/Create/?** в командной строке.
-   Чтобы запланировать задачу, которая выполняется с разрешениями другого пользователя, используйте параметр **/ru** . Параметр **/ru** допустим для задач на локальных и удаленных компьютерах.
-   Чтобы использовать параметр **/u** , локальный компьютер должен находиться в том же домене, что и удаленный компьютер, или в домене, которому доверяет домен удаленного компьютера. В противном случае либо задача не создается, либо задание задачи пусто и задача не выполняется.
-   **Команда Schtasks** всегда запрашивает пароль, если вы не предложит его, даже если вы запланируете задание на локальном компьютере с использованием текущей учетной записи пользователя. Это нормальное поведение для **schtasks**.
-   **Команда Schtasks** не проверяет расположение файлов программы или пароли учетных записей пользователей. Если не ввести правильное расположение файла или правильный пароль для учетной записи пользователя, задача будет создана, но не будет запущена. Кроме того, если пароль для учетной записи изменяется или истекает, и пароль, сохраненный в задаче, не изменяется, задача не выполняется.
-   Системная учетная запись не имеет прав интерактивного входа. Пользователи не видят и не могут взаимодействовать с программами, запущенными с разрешениями системы.
-   Каждая задача запускает только одну программу. Однако можно создать пакетный файл, который запускает несколько задач, а затем запланировать задачу, запускающую пакетный файл.
-   Вы можете протестировать задачу сразу после ее создания. Используйте операцию **запуска** для проверки задачи, а затем проверьте файл счедлгу. txt (*системный_корневой_каталог*\счедлгу.ткст) на наличие ошибок.

## <a name="schtasks-change"></a><a name=BKMK_change></a>команда Schtasks Change

Изменяет одно или несколько из следующих свойств задачи.
-   Программа, выполняемая задачей (**/tr**).
-   Учетная запись пользователя, под которой выполняется задача (**/ru**).
-   Пароль для учетной записи пользователя (**/RP**).
-   Добавляет интерактивное свойство в задачу (**/IT**).

### <a name="syntax"></a>Синтаксис

```
schtasks /change /tn <TaskName> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]] [/ru {[<Domain>\]<User> | System}] [/rp <Password>] [/tr <TaskRun>] [/st <StartTime>] [/ri <Interval>] [{/et <EndTime> | /du <Duration>} [/k]] [/sd <StartDate>] [/ed <EndDate>] [/{ENABLE | DISABLE}] [/it] [/z]
```

#### <a name="parameters"></a>Параметры

|          Термин           |                                                                                                                                                                                                                                                                                                                                     Определение                                                                                                                                                                                                                                                                                                                                      |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     /TN \<имя_задания>     |                                                                                                                                                                                                                                                                                                               Определяет задачу, которую необходимо изменить. Введите имя задачи.                                                                                                                                                                                                                                                                                                               |
|     /s \<> компьютера      |                                                                                                                                                                                                                                                                               Указывает имя или IP-адрес удаленного компьютера (с обратными косыми чертами или без них). По умолчанию используется локальный компьютер.                                                                                                                                                                                                                                                                               |
|  /u [\<домен>\]<User>  |                                                                                                                                                                 Выполняет эту команду с разрешениями указанной учетной записи пользователя. По умолчанию заданы разрешения текущего пользователя локального компьютера. Указанная учетная запись пользователя должна быть членом группы "Администраторы" на удаленном компьютере. Параметры **/u** и **/p** допустимы только для изменения задачи на удаленном компьютере (**/s**).                                                                                                                                                                  |
|     /p \<пароль>      |                                                                                                                                                                                              Указывает пароль учетной записи пользователя, указанной в параметре **/u** . Если используется параметр **/u** , но пропущен параметр **/p** или аргумент password, **команда Schtasks** запрашивает пароль.</br>Параметры **/u** и **/p** допустимы только при использовании параметра **/s**.                                                                                                                                                                                               |
| /ru {[\<домен>\]<User> |                                                                                                                                                                                                                                                                                                                                       Системой                                                                                                                                                                                                                                                                                                                                       |
|     /RP \<пароль>     |                                                                                                                                                                                                                                                 Указывает новый пароль для существующей учетной записи пользователя или учетную запись пользователя, указанную параметром **/ru** . Этот параметр не учитывается при использовании с учетной записью локальной системы.                                                                                                                                                                                                                                                  |
|     /TR \<>      |                                                                                                                                                                                  Изменяет программу, выполняемую задачей. Введите полный путь и имя файла исполняемого файла, файла скрипта или пакетного файла. Если опустить путь, программа **schtasks** предполагает, что файл находится в каталоге \<systemroot> выполнять. Указанная программа заменяет исходную программу, выполняемую задачей.                                                                                                                                                                                  |
|    /ST \<> StartTime     |                                                                                                                                                                                                                                                              Указывает время начала задачи с использованием 24-часового формата времени, чч: мм. Например, значение 14:30 эквивалентно 12-часовому времени 2:30 PM.                                                                                                                                                                                                                                                               |
|     /RI \<интервал>     |                                                                                                                                                                                                                                                                           Указывает интервал повторения для запланированной задачи в минутах. Допустимый диапазон — 1-599940 (599940 минут = 9999 часов).                                                                                                                                                                                                                                                                            |
|     > \</et EndTime      |                                                                                                                                                                                                                                                               Задает время окончания задачи с использованием 24-часового формата времени, чч: мм. Например, значение 14:30 эквивалентно 12-часовому времени 2:30 PM.                                                                                                                                                                                                                                                                |
|     /Du \<длительность>     |                                                                                                                                                                                                                                                                                                     Указывает, что задача будет закрыта \<в> EndTime <Duration>или, если она указана.                                                                                                                                                                                                                                                                                                      |
|           /k            |                                                                                                                                                                   Останавливает программу, выполняемую задачей в момент, заданный параметром **/et** или **/du**. Без **/k**программа **schtasks** не запускает программу снова после того, как она достигнет времени, заданного параметром **/et** или **/du**, но не останавливает программу, если она все еще выполняется. Этот параметр является необязательным и действителен только с поминутным или ЕЖЕЧАСным расписанием.                                                                                                                                                                   |
|    /SD \<> StartDate     |                                                                                                                                                                                                                                                                                              Указывает первую дату выполнения задачи. Формат даты — MM/ДД/ГГГГ.                                                                                                                                                                                                                                                                                               |
|     /ED \<> EndDate      |                                                                                                                                                                                                                                                                                                 Указывает последнюю дату выполнения задачи. Формат: мм/дд/гггг.                                                                                                                                                                                                                                                                                                  |
|         Разрешение         |                                                                                                                                                                                                                                                                                                                       Задает включение запланированной задачи.                                                                                                                                                                                                                                                                                                                       |
|        /DISABLE         |                                                                                                                                                                                                                                                                                                                      Задает отключение запланированной задачи.                                                                                                                                                                                                                                                                                                                       |
|           разрешает           | Задает запуск запланированной задачи только в том случае, если пользователь с правами пользователя (учетная запись пользователя, под которой выполняется задача) входит в систему на компьютере.</br>Этот параметр не влияет на задачи, выполняемые с системными разрешениями или задачами, для которых уже задан интерактивный набор свойств. Нельзя использовать команду Change для удаления интерактивного свойства из задачи.</br>По умолчанию пользователь, выполняющий команду от имени, является текущим пользователем локального компьютера, когда задача запланирована, или учетной записью, указанной параметром **/u** , если она используется. Однако если команда включает параметр **/ru** , то пользователь, выполняющий команду, является учетной записью, указанной параметром **/ru** . |
|           /z            |                                                                                                                                                                                                                                                                                                          Указывает, что задача должна быть удалена после завершения ее расписания.                                                                                                                                                                                                                                                                                                          |
|           /?            |                                                                                                                                                                                                                                                                                                                        Отображение справки в командной строке.                                                                                                                                                                                                                                                                                                                         |

### <a name="remarks"></a>Примечания

-   Параметры **/TN** и **/s** обозначают задачу. Параметры **/tr**, **/ru**и **/RP** указывают свойства задачи, которые можно изменить.
-   Параметры **/ru**и **/RP** определяют разрешения, с которыми запускается задача. Параметры **/u** и **/p** указывают разрешения, используемые для изменения задачи.
-   Чтобы изменить задачи на удаленном компьютере, пользователь должен войти на локальный компьютер с помощью учетной записи, которая является членом группы "Администраторы" на удаленном компьютере.
-   Чтобы выполнить команду **/Change** с разрешениями другого пользователя (**/u**, **/p**), локальный компьютер должен находиться в том же домене, что и удаленный компьютер, или в домене, которому доверяет домен удаленного компьютера.
-   Системная учетная запись не имеет прав интерактивного входа. Пользователи не видят и не могут взаимодействовать с программами, запущенными с разрешениями системы.
-   Чтобы указать задачи с помощью свойства **/IT** , используйте подробный запрос (**/query/v**). В подробном запросе на отображение задачи с параметром **/IT**поле **режим входа** имеет значение **только Interactive**.

### <a name="examples"></a>Примеры

### <a name="to-change-the-program-that-a-task-runs"></a>Изменение программы, выполняемой задачей

Следующая команда изменяет программу, которую запускает задача проверки на вирусы с Вирусчекк. exe на VirusCheck2. exe. Эта команда использует параметр **/TN** для определения задачи и параметр **/tr** , чтобы указать новую программу для задачи. (Изменить имя задачи нельзя.)
```
schtasks /change /tn Virus Check /tr C:\VirusCheck2.exe
```
В ответе программа **SchTasks. exe** отображает следующее сообщение об успешном выполнении:
```
SUCCESS: The parameters of the scheduled task Virus Check have been changed.
```
В результате выполнения этой команды задача проверки на вирусы теперь запускает VirusCheck2. exe.

### <a name="to-change-the-password-for-a-remote-task"></a>Изменение пароля для удаленной задачи

Следующая команда изменяет пароль учетной записи пользователя для задачи Реминдме на удаленном компьютере SVR01. Команда использует параметр **/TN** для определения задачи, а параметр **/s** — для указания удаленного компьютера. Для указания нового пароля используется параметр **/RP** p@ssWord3.

Эта процедура необходима при истечении срока действия пароля учетной записи пользователя или изменении. Если пароль, сохраненный в задаче, больше не является допустимым, задача не выполняется.
```
schtasks /change /tn RemindMe /s Svr01 /rp p@ssWord3
```
В ответе программа **SchTasks. exe** отображает следующее сообщение об успешном выполнении:
```
SUCCESS: The parameters of the scheduled task RemindMe have been changed.
```
В результате выполнения этой команды задача Реминдме будет выполняться под исходной учетной записью пользователя, но с новым паролем.

### <a name="to-change-the-program-and-user-account-for-a-task"></a>Изменение программы и учетной записи пользователя для задачи

Следующая команда изменяет программу, выполняемую задачей, и изменяет учетную запись пользователя, под которой выполняется задача. По сути, оно использует старое расписание для новой задачи. Эта команда изменяет задачу Чкневс, которая запускает программу Notepad. exe каждую утро в 9:00 утра, чтобы вместо этого запустить Internet Explorer.

Команда использует параметр **/TN** для задания задачи. Параметр **/tr** используется для изменения программы, выполняемой задачей, а параметр **/ru** — для изменения учетной записи пользователя, от имени которой выполняется задача.

Параметр **/ru**, и **/RP** , который предоставляет пароль для учетной записи пользователя, опускается. Необходимо указать пароль для учетной записи, но можно использовать параметр **/ru**, и **/RP** , ввести пароль в виде открытого текста или подождать, пока **SchTasks. exe** запросит пароль, а затем ввести пароль в скрытом тексте.
```
schtasks /change /tn ChkNews /tr c:\program files\Internet Explorer\iexplore.exe /ru DomainX\Admin01
```
В ответе программа **SchTasks. exe** запрашивает пароль для учетной записи пользователя. Он скрывает введенный текст, поэтому пароль не отображается.
```
Please enter the password for DomainX\Admin01: 
```
Обратите внимание, что параметр **/TN** определяет задачу, а параметры **/tr** и **/ru** изменяют свойства задачи. Нельзя использовать другой параметр для задания задачи, и изменить имя задачи нельзя.

В ответе программа **SchTasks. exe** отображает следующее сообщение об успешном выполнении:
```
SUCCESS: The parameters of the scheduled task ChkNews have been changed.
```
В результате выполнения этой команды задача Чкневс теперь использует Internet Explorer с разрешениями учетной записи администратора.

### <a name="to-change-a-program-to-the-system-account"></a>Изменение программы на системную учетную запись

Следующая команда изменяет задачу Секуритискрипт так, чтобы она выполнялась с разрешениями системной учетной записи. Для указания системной учетной записи используется параметр * */ru * *.
```
schtasks /change /tn SecurityScript /ru 
```
В ответе программа **SchTasks. exe** отображает следующее сообщение об успешном выполнении:
```
INFO: The run as user name for the scheduled task SecurityScript will be changed to NT AUTHORITY\SYSTEM.
SUCCESS: The parameters of the scheduled task SecurityScript have been changed.
```
Так как задачи выполняются с разрешениями системной учетной записи, пароль не требуется, **SchTasks. exe** не запрашивает его.

### <a name="to-run-a-program-only-when-i-am-logged-on"></a>Запуск программы только при входе в систему

Следующая команда добавляет интерактивное свойство в MyApp, существующую задачу. Это свойство гарантирует, что задача выполняется только в том случае, если пользователь с правами запуска от имени, то есть учетная запись пользователя, под которой выполняется задача, входит в систему на компьютере.

Команда использует параметр **/TN** для задания задачи и параметра **/IT** для добавления интерактивного свойства в задачу. Так как задача уже выполняется с разрешениями учетной записи пользователя, мне не нужно изменять параметр **/ru** для задачи.
```
schtasks /change /tn MyApp /it
```
В ответе программа **SchTasks. exe** отображает следующее сообщение об успешном выполнении.
```
SUCCESS: The parameters of the scheduled task MyApp have been changed.
```

## <a name="schtasks-run"></a><a name=BKMK_run></a>команда Schtasks Run

Немедленно запускает запланированную задачу. Операция **запуска** игнорирует расписание, но использует расположение файла программы, учетную запись пользователя и пароль, сохраненные в задаче для немедленного выполнения задачи.

### <a name="syntax"></a>Синтаксис

```
schtasks /run /tn <TaskName> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="parameters"></a>Параметры

|         Термин          |                                                                                                                                                                 Определение                                                                                                                                                                  |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    /TN \<имя_задания>    |                                                                                                                                                       Обязательный. Определяет задачу.                                                                                                                                                        |
|    /s \<> компьютера     |                                                                                                           Указывает имя или IP-адрес удаленного компьютера (с обратными косыми чертами или без них). По умолчанию используется локальный компьютер.                                                                                                           |
| /u [\<домен>\]<User> | Выполняет эту команду с разрешениями указанной учетной записи пользователя. По умолчанию команда выполняется с разрешениями текущего пользователя локального компьютера.</br>Указанная учетная запись пользователя должна быть членом группы "Администраторы" на удаленном компьютере. Параметры **/u** и **/p** допустимы только при использовании параметра **/s**. |
|    /p \<пароль>     |                          Указывает пароль учетной записи пользователя, указанной в параметре **/u** . Если используется параметр **/u** , но пропущен параметр **/p** или аргумент password, **команда Schtasks** запрашивает пароль.</br>Параметры **/u** и **/p** допустимы только при использовании параметра **/s**.                           |
|          /?           |                                                                                                                                                    Отображение справки в командной строке.                                                                                                                                                     |

### <a name="remarks"></a>Примечания

-   Используйте эту операцию для проверки задач. Если задача не выполняется, проверьте журнал транзакций службы планировщик задач, \<СистемныйКорневойКаталог> \счедлгу.ткст, для ошибок.
-   Выполнение задачи не влияет на расписание задач и не изменяет следующее время выполнения, запланированное для задачи.
-   Для удаленного запуска задачи задача должна быть запланирована на удаленном компьютере. При запуске задача выполняется только на удаленном компьютере. Чтобы убедиться, что задача выполняется на удаленном компьютере, используйте диспетчер задач или планировщик задач журнал транзакций, \<СистемныйКорневойКаталог> \счедлгу.ткст.

### <a name="examples"></a>Примеры

### <a name="to-run-a-task-on-the-local-computer"></a>Выполнение задачи на локальном компьютере

Следующая команда запускает задачу «Скрипт безопасности».
```
schtasks /run /tn Security Script
```
В ответе программа **SchTasks. exe** запускает сценарий, связанный с задачей, и отображает следующее сообщение:
```
SUCCESS: Attempted to run the scheduled task Security Script.
```
Как следует из сообщения, программа **schtasks** пытается запустить программу, но она не может быть действительно запущена.

### <a name="to-run-a-task-on-a-remote-computer"></a>Выполнение задачи на удаленном компьютере

Следующая команда запускает задачу обновления на удаленном компьютере SVR01:
```
schtasks /run /tn Update /s Svr01
```
В этом случае **SchTasks. exe** выводит следующее сообщение об ошибке:
```
ERROR: Unable to run the scheduled task Update.
```
Чтобы найти причину ошибки, просмотрите журнал транзакций запланированных задач К:\виндовс\счедлгу.ткст в SVR01. В этом случае в журнале появится следующая запись:
```
Update.job (update.exe) 3/26/2001 1:15:46 PM ** ERROR **
The attempt to log on to the account associated with the task failed, therefore, the task did not run.
The specific error is:
0x8007052e: Logon failure: unknown user name or bad password.
Verify that the task's Run-as name and password are valid and try again.
```
Очевидно, что имя пользователя или пароль в задаче не являются допустимыми в системе. Следующая команда **schtasks/Change** обновляет имя пользователя и пароль для задачи обновления в SVR01:
```
schtasks /change /tn Update /s Svr01 /ru Administrator /rp PassW@rd3
```
После выполнения команды **Change** команда **Run** повторяется. На этот раз программа Update. exe запустится, и **SchTasks. exe** выведет следующее сообщение:
```
SUCCESS: Attempted to run the scheduled task Update.
```
Как следует из сообщения, программа **schtasks** пытается запустить программу, но она не может быть действительно запущена.

## <a name="schtasks-end"></a><a name=BKMK_end></a>команда Schtasks End

Останавливает программу, запущенную задачей.

### <a name="syntax"></a>Синтаксис

```
schtasks /end /tn <TaskName> [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="parameters"></a>Параметры

|         Термин          |                                                                                                                                                               Определение                                                                                                                                                                |
|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    /TN \<имя_задания>    |                                                                                                                                         Обязательный. Определяет задачу, которая запустила программу.                                                                                                                                         |
|    /s \<> компьютера     |                                                                                                                        Указывает имя или IP-адрес удаленного компьютера. По умолчанию используется локальный компьютер.                                                                                                                        |
| /u [\<домен>\]<User> | Выполняет эту команду с разрешениями указанной учетной записи пользователя. По умолчанию команда выполняется с разрешениями текущего пользователя локального компьютера. Указанная учетная запись пользователя должна быть членом группы "Администраторы" на удаленном компьютере. Параметры **/u** и **/p** допустимы только при использовании параметра **/s**. |
|    /p \<пароль>     |                        Указывает пароль учетной записи пользователя, указанной в параметре **/u** . Если используется параметр **/u** , но пропущен параметр **/p** или аргумент password, **команда Schtasks** запрашивает пароль.</br>Параметры **/u** и **/p** допустимы только при использовании параметра **/s**.                         |
|          /?           |                                                                                                                                                             Вывод справки.                                                                                                                                                              |

### <a name="remarks"></a>Примечания

**SchTasks. exe** завершает только экземпляры программы, запущенной назначенной задачей. Для прекращения работы других процессов используйте средство TaskKill. Дополнительные сведения см. в разделе [taskkill](taskkill.md).

### <a name="examples"></a>Примеры

### <a name="to-end-a-task-on-a-local-computer"></a>Завершение задачи на локальном компьютере

Следующая команда останавливает экземпляр Notepad. exe, который был запущен задачей «Мой блокнот»:
```
schtasks /end /tn My Notepad
```
В ответе программа **SchTasks. exe** останавливает экземпляр Notepad. exe, запущенный задачей, и отображает следующее сообщение об успешном выполнении:
```
SUCCESS: The scheduled task My Notepad has been terminated successfully.
```

### <a name="to-end-a-task-on-a-remote-computer"></a>Завершение задачи на удаленном компьютере

Следующая команда останавливает экземпляр Internet Explorer, запущенный задачей Интернетон на удаленном компьютере SVR01:
```
schtasks /end /tn InternetOn /s Svr01
```
В ответе программа **SchTasks. exe** останавливает экземпляр Internet Explorer, запущенный задачей, и отображает следующее сообщение об успешном выполнении:
```
SUCCESS: The scheduled task InternetOn has been terminated successfully.
```

## <a name="schtasks-delete"></a><a name=BKMK_delete></a>команда Schtasks Delete

Удаляет запланированную задачу.

### <a name="syntax"></a>Синтаксис

```
schtasks /delete /tn {<TaskName> | *} [/f] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="parameters"></a>Параметры

|         Термин          |                                                                                                                                                                 Определение                                                                                                                                                                  |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|   /TN {\<имя_задания>    |                                                                                                                                                                     \*}                                                                                                                                                                     |
|          /f           |                                                                                                                                  Подавляет подтверждающее сообщение. Задача удаляется без предупреждения.                                                                                                                                  |
|    /s \<> компьютера     |                                                                                                           Указывает имя или IP-адрес удаленного компьютера (с обратными косыми чертами или без них). По умолчанию используется локальный компьютер.                                                                                                           |
| /u [\<домен>\]<User> | Выполняет эту команду с разрешениями указанной учетной записи пользователя. По умолчанию команда выполняется с разрешениями текущего пользователя локального компьютера.</br>Указанная учетная запись пользователя должна быть членом группы "Администраторы" на удаленном компьютере. Параметры **/u** и **/p** допустимы только при использовании параметра **/s**. |
|    /p \<пароль>     |                          Указывает пароль учетной записи пользователя, указанной в параметре **/u** . Если используется параметр **/u** , но пропущен параметр **/p** или аргумент password, **команда Schtasks** запрашивает пароль.</br>Параметры **/u** и **/p** допустимы только при использовании параметра **/s**.                           |
|          /?           |                                                                                                                                                    Отображение справки в командной строке.                                                                                                                                                     |

### <a name="remarks"></a>Примечания

- Операция **удаления** удаляет задачу из расписания. Она не удаляет программу, выполняемую задачей, или прерывает выполняющуюся программу.
- Команда **DELETE \\ *** удаляет все задачи, запланированные для компьютера, а не только задачи, запланированные текущим пользователем.

### <a name="examples"></a>Примеры

### <a name="to-delete-a-task-from-the-schedule-of-a-remote-computer"></a>Удаление задачи из расписания удаленного компьютера

Следующая команда удаляет задачу «Запуск почты» из расписания удаленного компьютера. Для задания удаленного компьютера используется параметр **/s** .
```
schtasks /delete /tn Start Mail /s Svr16
```
В ответе программа **SchTasks. exe** выводит следующее сообщение с подтверждением. Чтобы удалить задачу, нажмите клавишу Y<strong>.</strong> Чтобы отменить команду, введите **n**:
```
WARNING: Are you sure you want to remove the task Start Mail (Y/N )? 
SUCCESS: The scheduled task Start Mail was successfully deleted.
```

### <a name="to-delete-all-tasks-scheduled-for-the-local-computer"></a>Удаление всех задач, запланированных для локального компьютера

Следующая команда удаляет все задачи из расписания на локальном компьютере, включая задачи, запланированные другими пользователями. Параметр **/TN \\ *** используется для представления всех задач на компьютере, а параметр **/f** — для подавления сообщения с подтверждением.
```
schtasks /delete /tn * /f
```
В ответе программа **SchTasks. exe** выводит следующие сообщения об успешном выполнении, указывающие, что удаляется только запланированная задача секурескрипт.

`SUCCESS: The scheduled task SecureScript was successfully deleted.`

## <a name="schtasks-query"></a><a name=BKMK_query></a>запрос SchTasks

Отображает задачи, запланированные для запуска на компьютере.

### <a name="syntax"></a>Синтаксис

```
schtasks [/query] [/fo {TABLE | LIST | CSV}] [/nh] [/v] [/s <Computer> [/u [<Domain>\]<User> [/p <Password>]]]
```

#### <a name="parameters"></a>Параметры

|         Термин          |                                                                                                                                                                 Определение                                                                                                                                                                  |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|       /Query        |                                                                                                                        Имя операции является необязательным. При вводе команды **schtasks** без параметров выполняется запрос.                                                                                                                         |
|      /FO \<формат>    |  Задает формат выходных данных. Допустимые значения: TABLE, LIST и CSV.                                                                                                                                 |
|          использован          |                                                                                                            Исключает заголовки столбцов из отображаемой таблицы. Этот параметр допустим с выходными форматами **таблиц** и **CSV** .                                                                                                             |
|          /v           |                                                                                                         Добавляет дополнительные свойства задач к отображению.</br>Запросы, использующие **/v** , следует отформатировать как **List** или **CSV**.                                                                                                          |
|    /s \<> компьютера     |                                                                                                           Указывает имя или IP-адрес удаленного компьютера (с обратными косыми чертами или без них). По умолчанию используется локальный компьютер.                                                                                                           |
| /u [\<домен>\]<User> | Выполняет эту команду с разрешениями указанной учетной записи пользователя. По умолчанию команда выполняется с разрешениями текущего пользователя локального компьютера.</br>Указанная учетная запись пользователя должна быть членом группы "Администраторы" на удаленном компьютере. Параметры **/u** и **/p** допустимы только при использовании параметра **/s**. |
|    /p \<пароль>     |                                        Указывает пароль учетной записи пользователя, указанной в параметре **/u** . Если используется параметр **/u**, но параметр **/p** или аргумент password не задан, **команда Schtasks** запрашивает пароль.</br>Параметры **/u** и **/p** допустимы только при использовании параметра **/s**.                                         |
|          /?           |                                                                                                                                                    Отображение справки в командной строке.                                                                                                                                                     |

### <a name="remarks"></a>Примечания

**SchTasks. exe** завершает только экземпляры программы, запущенной назначенной задачей. Для прекращения работы других процессов используйте средство TaskKill. Дополнительные сведения см. в разделе [taskkill](taskkill.md).

### <a name="examples"></a>Примеры

### <a name="to-display-the-scheduled-tasks-on-the-local-computer"></a>Отображение запланированных задач на локальном компьютере

Следующие команды отображают все задачи, запланированные для локального компьютера. Эти команды дают тот же результат и могут использоваться взаимозаменяемыми.
```
schtasks
schtasks /query
```
В ответе программа **SchTasks. exe** отображает задачи в формате простого таблицы по умолчанию, как показано в следующей таблице.
```
TaskName Next Run Time Status
========================= ======================== ==============
Microsoft Outlook At logon time
SecureScript 14:42:00 PM , 2/4/2001
```

### <a name="to-display-advanced-properties-of-scheduled-tasks"></a>Отображение дополнительных свойств запланированных задач

Следующая команда запрашивает подробное отображение задач на локальном компьютере. Он использует параметр **/v** для запроса подробного (подробного) отображения и параметр **/FO List** для форматирования отображения в виде списка для удобного чтения. С помощью этой команды можно убедиться, что созданная задача имеет предполагаемый шаблон повторения.

**Schtasks/Query/FO список/v**

В ответе программа **SchTasks. exe** отображает подробный список свойств для всех задач. На следующем экране показан список задач для задачи, запланированной на выполнение в 4:00 утра. в последнюю пятницу каждого месяца:
```
HostName: RESKIT01
TaskName: SecureScript
Next Run Time: 4:00:00 AM , 3/30/2001
Status: Not yet run
Logon mode: Interactive/Background
Last Run Time: Never
Last Result: 0
Creator: user01
Schedule: At 4:00 AM on the last Fri of every month, starting 3/24/2001
Task To Run: C:\WINDOWS\system32\notepad.exe
Start In: notepad.exe
Comment: N/A
Scheduled Task State: Enabled
Scheduled Type: Monthly
Modifier: Last FRIDAY
Start Time: 4:00:00 AM
Start Date: 3/24/2001
End Date: N/A
Days: FRIDAY
Months: JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC
Run As User: RESKIT\user01
Delete Task If Not Rescheduled: Enabled
Stop Task If Runs X Hours and X Mins: 72:0
Repeat: Until Time: Disabled
Repeat: Duration: Disabled
Repeat: Stop If Still Running: Disabled
Idle: Start Time(For IDLE Scheduled Type): Disabled
Idle: Only Start If Idle for X Minutes: Disabled
Idle: If Not Idle Retry For X Minutes: Disabled
Idle: Stop Task If Idle State End: Disabled
Power Mgmt: No Start On Batteries: Disabled
Power Mgmt: Stop On Battery Mode: Disabled
```

### <a name="to-log-tasks-scheduled-for-a-remote-computer"></a>Ведение журнала задач, запланированных для удаленного компьютера

Следующая команда запрашивает список задач, запланированных для удаленного компьютера, и добавляет эти задачи в файл журнала с разделителями-запятыми на локальном компьютере. Этот формат команды можно использовать для сбора и мониторинга задач, запланированных для нескольких компьютеров.

Команда использует параметр **/s** для определения удаленного компьютера, Reskit16, параметр **/FO** для указания формата, а параметр **/NH** — для подавления заголовков столбцов. Символ **>>** добавления перенаправляет выходные данные в журнал задач p0102. csv на локальном компьютере SVR01. Поскольку команда выполняется на удаленном компьютере, путь к локальному компьютеру должен быть полным.
```
schtasks /query /s Reskit16 /fo csv /nh >> \\svr01\data\tasklogs\p0102.csv
```
В ответе программа **SchTasks. exe** добавляет задачи, запланированные для компьютера Reskit16, в файл p0102. csv на локальном компьютере SVR01.

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
