---
title: defrag
description: 'Раздел Windows команды для ***- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: aaf1d1ac-996a-4282-9b4d-1e8245ff162c
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 6b5f6231273fb9fe9a99a1cd1bf72dbd0bad71af
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66433915"
---
# <a name="defrag"></a>defrag

>Область применения. Windows 10, Windows Server (полугодовой канал), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Находит и объединяет фрагментированные файлы на локальных томах для повышения производительности системы.
Членство в локальной **Администраторы** группы, либо эквивалентной, является минимальным требованием для выполнения этой команды.

## <a name="syntax"></a>Синтаксис
```
defrag <volumes> | /C | /E <volumes>    [/H] [/M [n]| [/U] [/V]]
defrag <volumes> | /C | /E <volumes> /A [/H] [/M [n]| [/U] [/V]]
defrag <volumes> | /C | /E <volumes> /X [/H] [/M [n]| [/U] [/V]]
defrag <volume> [/<Parameter>]*
```
## <a name="parameters"></a>Параметры

|Параметр|Описание|
|-------|--------|
|`<volume>`|Указывает путь диска буквы или подключения точки тома дефрагментации или анализа.|
|Объект|Выполните анализ указанного тома.|
|C|Выполните операцию на всех томах.|
|D|Выполните традиционные дефрагментации (это значение по умолчанию). На многоуровневом томе, традиционных дефрагментация выполняется только на уровне "емкость".|
|E|Выполните операцию на всех томах, кроме указанных.|
|G|Оптимизация уровней хранилища на указанные тома.|
|H|Выполняются операции с обычным приоритетом (по умолчанию — низкий).|
|Я n|Оптимизация уровня будет выполняться не более n секунд каждого тома.|
|K|Консолидация слоев на указанные тома.|
|L|Выполните retrim для указанного тома.|
|M [n]|Запустите программу на каждом томе в параллельном режиме в фоновом режиме. Не более n потоков оптимизации уровней хранилища в параллельном режиме.|
|O|Выполнение правильного оптимизации для каждого типа носителя.|
|T|Отслеживайте операция уже выполняется в указанном томе.|
|U|Печать ход выполнения операции на экране.|
|V|получения более подробных данных, содержащий статистику фрагментации.|
|X|Выполнение консолидации свободного места на указанных томов.|
|?|Отображает эти сведения для справки.|

## <a name="remarks"></a>Примечания
- Не удалось дефрагментировать определенные типы томов файловой системы или дисках:
  -   Не удается дефрагментировать тома, которые заблокированы в файловой системе.
  -   Возможно, повреждены, не могут дефрагментировать тома, которые помечаются как "грязные", файловой системой. Необходимо запустить **chkdsk** на томе "грязных", прежде чем выполнить ее дефрагментацию. Можно определить, является ли том "грязных" с помощью **fsutil** "грязных" команды запроса. Дополнительные сведения о **chkdsk** и **fsutil** "грязной", см. в разделе [Дополнительные ссылки](defrag.md#BKMK_additionalRef).
  -   Не удается дефрагментировать сетевые диски.
  -   Не удается дефрагментировать cdROMs.
  -   Нельзя выполнять дефрагментацию томов файловой системы, которые не являются **NTFS**, **ReFS**, **Fat** или **Fat32**.
- С помощью Windows Server 2008 R2, Windows Server 2008 и Windows Vista, можно запланировать для дефрагментации тома. Тем не менее вы не можете запланировать дефрагментацию твердотельных дисков (SSD) или том на виртуального жесткого диска (VHD), в который находится на диске SSD.
- Для выполнения данной процедуры необходимо входить в группу "Администраторы" на локальном компьютере или получить соответствующие полномочия путем делегирования. Если компьютер присоединен к домену, эту процедуру могут выполнять члены группы "Администраторы домена". В целях безопасности рекомендуется, рассмотрите возможность использования **запуска от имени** для выполнения этой процедуры.
- Том должен иметь по крайней мере 15% свободного пространства для **дефрагментации** для полной и правильной дефрагментации. **Дефрагментация** использует это пространство как область сортировки для фрагментов файлов. Если объем составляет менее 15% свободного пространства, **дефрагментации** выполнит только частичную дефрагментацию. Чтобы увеличить свободное место на томе, удалите ненужные файлы или переместите их на другой диск.
- Хотя **дефрагментации** является анализа и дефрагментации тома, он отображается мигающий курсор. Когда **дефрагментации** завершении анализа и дефрагментацию, она отображает отчет об анализе, отчет о дефрагментации или оба отчета и завершает работу в командную строку.
- По умолчанию **дефрагментации** отображает сводку дефрагментации и анализ отчетов, если вы не укажете **/a** или **/v** параметров.
- Вы можете отправлять отчеты в текстовый файл, введя **>** <em>FileName.txt</em>, где *FileName.txt* имеет заданное вами имя файла. Пример: `defrag volume /v > FileName.txt`
- Чтобы прервать процесс дефрагментации, в командной строке, нажмите клавишу **CTRL + C**.
- Под управлением **дефрагментации** команды и «дефрагментация диска» являются взаимоисключающими. Если вы используете дефрагментации диска для дефрагментации тома и запуске **дефрагментации** команды командной строки, **дефрагментации** из команд завершается неуспешно. И наоборот при запуске **дефрагментации** команды и откройте дефрагментации, дефрагментация в дефрагментации недоступны.

## <a name="BKMK_examples"></a>Примеры
Чтобы выполнить дефрагментацию тома на диске C, то же время предоставляя хода выполнения и подробные выходные данные, введите:
```
defrag C: /U /V
```
Чтобы выполнить дефрагментацию тома на дисках C и D в параллельном режиме в фоновом режиме, введите следующую команду:
```
defrag C: D: /M
```
Чтобы провести анализ фрагментации тома на диске C и обеспечить ход выполнения, введите следующую команду:
```
defrag C: mountpoint /A /U
```
Чтобы дефрагментировать все тома с обычным приоритетом и предоставить подробные выходные данные, введите следующую команду:
```
defrag /C /H /V
```

## <a name="BKMK_scheduledTask"></a>Запланированная задача
Дефрагментация запланированное задание будет выполняться как задача обслуживания и обычно запланировано выполнение каждую неделю. Администратор может изменить периодичность с помощью **оптимизация дисков** приложения.
- При запуске из запланированные задачи, **дефрагментации** имеет ниже политика для SSD:
   - **Традиционное дефрагментации** (т. е. Перемещение файлов, чтобы сделать их достаточно смежных) и **retrim** выполняется только один раз для каждого месяца.
   - Если оба **традиционных дефрагментации** и **retrim** пропускаются, **analysis** не выполняется.
      - Если пользователь запустил **традиционных дефрагментации** вручную на диске SSD, скажем 3 недели после последнего запланированного задач запуска, а затем выполнит следующего запланированного выполнения задачи **analysis** и **retrim** , но Пропустить **традиционных дефрагментации** на SSD.
   - Если **analysis** пропускается, **последний запуск** время в **оптимизация дисков** не будет обновлен.  Поэтому для SSD **последний запуск** время в **оптимизация дисков** может быть месяца назад.
- Эта задача обслуживания может не дефрагментации все тома, в некоторых случаях, так как эта задача выполняет следующие функции:
   - Не пробуждать компьютер для запуска дефрагментации
   - Запускает только в том случае, если компьютер работает от сети и останавливается, если компьютер переключается на питание от батареи
   - Останавливает при выходе компьютера в режиме простоя

## <a name="BKMK_additionalRef"></a>Дополнительные ссылки
-   [chkdsk](chkdsk.md)
-   [fsutil](fsutil.md)
-   ["грязный" fsutil](fsutil-dirty.md)
-   [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
