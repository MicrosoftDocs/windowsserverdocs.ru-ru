---
title: defrag
description: Справочная статья по команде Defrag, которая находит и объединяет фрагментированные файлы на локальных томах для повышения производительности системы.
ms.topic: reference
ms.assetid: aaf1d1ac-996a-4282-9b4d-1e8245ff162c
ms.author: lizross
author: eross-msft
manager: mtillman
ms.date: 10/16/2017
ms.openlocfilehash: f130164415ead6ad480d95d7cba55d7c5017c6b4
ms.sourcegitcommit: d08965d64f4a40ac20bc81b14f2d2ea89c48c5c8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2020
ms.locfileid: "96864243"
---
# <a name="defrag"></a>defrag

> Область применения: Windows 10, Windows Server (половина ежегодного канала), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Находит и объединяет фрагментированные файлы на локальных томах, чтобы повысить производительность системы.

Членство в группе локальных **администраторов** или эквивалентной является минимальным требованием для выполнения этой команды.

## <a name="syntax"></a>Синтаксис

```
defrag <volumes> | /c | /e <volumes>    [/h] [/m [n]| [/u] [v]]
defrag <volumes> | /c | /e <volumes> /a [/h] [/m [n]| [/u] [v]]
defrag <volumes> | /c | /e <volumes> /x [/h] [/m [n]| [/u] [v]]
defrag <volume> [<parameters>]
```

### <a name="parameters"></a>Параметры

| Параметр | Описание: |
| --------- | ----------- |
| `<volume>` | Указывает букву диска или путь к точке подключения тома для дефрагментации или анализа. |
| /a | Выполните анализ указанных томов. |
| /C | Выполните операцию на всех томах. |
| /d | Выполнить традиционную дефрагментацию (это значение по умолчанию). В многоуровневого тома, однако традиционная дефрагментация выполняется только на уровне емкости. |
| /e | Выполните операцию для всех томов, кроме указанных. |
| /g | Оптимизируйте уровни хранилища на указанных томах. |
| /h | Выполните операцию с нормальным приоритетом (по умолчанию низкая). |
| /i [n] | Оптимизация уровней будет выполняться не более n секунд на каждом томе. |
| /k | Выполните консолидацию слоев на указанных томах. |
| /l | Выполните повторное усечение для указанных томов. |
| /m [n] | Выполните операцию на каждом томе параллельно в фоновом режиме. Не более n потоков оптимизируют уровни хранилища параллельно. |
| /o | Выполните правильную оптимизацию для каждого типа носителя. |
| /t | Отследите, что операция уже выполняется на указанном томе. |
| /U | Печать хода выполнения операции на экране. |
| /v | Печать подробных выходных данных, содержащих статистику фрагментации. |
| /x | Выполните консолидацию свободного пространства на указанных томах. |
| /? | Отображает эту справочную информацию. |

#### <a name="remarks"></a>Remarks

- Вы не можете дефрагментировать определенные тома или диски файловой системы, включая:

  - Тома, заблокированные файловой системой.

  - Тома. файловая система помечена как "грязная", что указывает на возможное повреждение.<br>`chkdsk`Перед дефрагментацией тома или диска необходимо запустить. Можно определить, является ли том "грязным", с помощью `fsutil dirty` команды.

  - Сетевые диски.

  - КОМПАКТ-диски.

  - Тома файловой системы, не являющиеся **NTFS**, **ReFS**, **FAT** или **FAT32**.

- Для выполнения данной процедуры необходимо входить в группу "Администраторы" на локальном компьютере или получить соответствующие полномочия путем делегирования. Если компьютер присоединен к домену, эту процедуру могут выполнять члены группы "Администраторы домена". По соображениям безопасности рекомендуется использовать **Запуск от имени** для выполнения этой процедуры.

- Том должен иметь не менее 15% свободного места для **дефрагментации** , чтобы полностью и адекватно дефрагментировать его. **Defrag** использует это пространство как область сортировки для фрагментов файлов. Если объем свободного места на томе меньше 15 **%, Дефрагментация** будет выполнена частично. Чтобы увеличить объем свободного места в томе, удалите ненужные файлы или переместите их на другой диск.

- При анализе и дефрагментации тома в процессе **дефрагментации** отображается мигающий курсор. После завершения анализа и дефрагментации тома в нем отображается отчет об анализе, отчет о дефрагментации или оба отчета **, после чего** выполняется выход из командной строки.

- По умолчанию **Defrag** отображает сводку отчетов об анализе и дефрагментации, если не указаны параметры **/a** или **/v** .

- Отчеты можно отправить в текстовый файл, введя **>** <em>FileName.txt</em>, где *FileName.txt* — это имя файла, которое вы указали. Например: `defrag volume /v > FileName.txt`

- Чтобы прервать процесс дефрагментации, в командной строке нажмите клавиши **CTRL + C**.

- Выполнение команды **дефрагментации** и дефрагментации диска являются взаимоисключающими. Если вы используете дефрагментацию диска для дефрагментации тома и выполняете команду **Defrag** в командной строке, команда **defrag** завершается ошибкой. И наоборот, если выполнить команду **Defrag** и открыть средство дефрагментации диска, параметры дефрагментации в дефрагментации диска будут недоступны.

## <a name="examples"></a>Примеры

Чтобы выполнить дефрагментацию тома на диске C при предоставлении сведений о ходе выполнения и подробных выходных данных, введите:

```
defrag c: /u /v
```

Чтобы дефрагментировать тома на дисках C и D параллельно в фоновом режиме, введите:

```
defrag c: d: /m
```

Чтобы выполнить анализ фрагментации тома, подключенного к диску C, и указать ход выполнения, введите:

```
defrag c: mountpoint /a /u
```

Чтобы дефрагментировать все тома с нормальным приоритетом и предоставить подробные выходные данные, введите:

```
defrag /c /h /v
```

## <a name="scheduled-task"></a>Запланированная задача

Процесс дефрагментации запускает запланированную задачу как задачу обслуживания, которая обычно выполняется каждую неделю. Как администратор вы можете изменить частоту выполнения задачи с помощью приложения " **Оптимизация дисков** ".

- При запуске из запланированной задачи **Defrag** использует приведенные ниже рекомендации по политикам для твердотельных накопителей.

  - **Традиционные процессы оптимизации**. Включает **традиционную дефрагментацию**, например перемещение файлов, чтобы сделать их непрерывными и повторно **обрезанными**. Это выполняется один раз в месяц. Однако при пропуске **традиционной дефрагментации** и повторной **демонтажа** **анализ** не выполняется. Изменение частоты запланированной задачи не влияет на ритмичность одного раза в месяц для твердотельных накопителей.

  - Если вы вручную запустили **обычную дефрагментацию** на SSD, между обычными запланированными запусками, Следующая запланированная задача выполняет **анализ** и повторно **обрезает**, но пропускает **традиционную дефрагментацию** на этом SSD.

  - Если пропустить **анализ**, **Последнее время выполнения** не будет отображаться в приложении **Оптимизация дисков** . По этой причине время **последнего выполнения** может быть не ранее месяца.

  - Может оказаться, что запланированная задача не дефрагментирована все тома. Обычно это происходит по следующим причинам.

    - Процесс не будет пробудить компьютер для запуска.

    - Компьютер не подключен. Этот процесс не будет выполняться, если компьютер работает от аккумулятора.

    - Компьютер запустил резервное копирование (возобновлено из режима простоя).

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)

- [chkdsk](chkdsk.md)

- [fsutil](fsutil.md)

- [fsutil dirty](fsutil-dirty.md)

- [Оптимизация — том PowerShell](/powershell/module/storage/optimize-volume)
