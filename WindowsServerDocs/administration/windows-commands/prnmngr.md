---
title: prnmngr
description: Узнайте, как добавлять, удалять и перечислять принтеры и подключения.
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 39eee1a8-4b41-4c9f-941e-486495135eb8
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 07/11/2018
ms.openlocfilehash: 12981519a1d3bfc079a58e5883bc845955b8a8c6
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71372069"
---
# <a name="prnmngr"></a>prnmngr

>Область применения: Windows Server (Semi-Annual Channel), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Добавляет, удаляет и перечисляет принтеры или подключения принтеров в дополнение к настройке и отображению принтера по умолчанию.

## <a name="syntax"></a>Синтаксис
```
cscript Prnmngr {-a | -d | -x | -g | -t | -l | -?}[c] [-s <ServerName>] 
[-p <printerName>] [-m <printermodel>] [-r <PortName>] [-u <UserName>] 
[-w <Password>]
```

## <a name="parameters"></a>Параметры

|           Параметр           |                                                                                                                                                                                        Описание                                                                                                                                                                                        |
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              -a               |                                                                                                                                                                             добавляет подключение к локальному принтеру.                                                                                                                                                                              |
|              -d               |                                                                                                                                                                               Удаляет подключение принтера.                                                                                                                                                                               |
|              -x               |                                                                                                               Удаляет все принтеры с сервера, указанного параметром **-s** . Если сервер не указан, Windows удаляет все принтеры на локальном компьютере.                                                                                                               |
|              -g               |                                                                                                                                                                               Отображает принтер по умолчанию.                                                                                                                                                                               |
|              -t               |                                                                                                                                                        Задает принтер по умолчанию для принтера, указанного параметром **-p** .                                                                                                                                                         |
|              -l               |                                                                                                         Список всех принтеров, установленных на сервере, заданном параметром **-s** . Если сервер не указан, Windows выводит список принтеров, установленных на локальном компьютере.                                                                                                         |
|               ц               |                                                                                                                                      Указывает, что параметр применяется к подключениям принтера. Можно использовать с параметрами **-a** и **-x** .                                                                                                                                      |
|        -s <ServerName>        |                                                                                                                  Указывает имя удаленного компьютера, на котором размещен принтер, которым требуется управлять. Если компьютер не указан, используется локальный компьютер.                                                                                                                  |
|       -p \<Принтернаме >       |                                                                                                                                                                Указывает имя принтера, которым требуется управлять.                                                                                                                                                                 |
|     -m \<Дривермоделнаме >     |                                                                                                          Указывает (по имени) драйвер, который вы хотите установить. Драйверы часто называются для модели поддерживаемых принтеров. Дополнительные сведения см. в документации принтера.                                                                                                           |
|        -r \<Портнаме >         |                                                                         Указывает порт, к которому подключен принтер. Если это параллельный или последовательный порт, используйте идентификатор порта (например, LPT1: или COM1:). Если это порт TCP/IP, используйте имя порта, указанное при добавлении порта.                                                                          |
| -u \<имя_пользователя >-w \<пароль > | Указывает учетную запись с разрешениями на подключение к компьютеру, на котором размещен принтер, которым требуется управлять. Все члены локальной группы администраторов целевого компьютера имеют эти разрешения, но разрешения также могут быть предоставлены другим пользователям. Если учетная запись не указана, необходимо войти в систему с учетной записью с этими разрешениями, чтобы команда работала. |
|              /?               |                                                                                                                                                                           Отображение справки в командной строке.                                                                                                                                                                            |

## <a name="remarks"></a>Замечания
-   Команда **прндрвр** является сценарием Visual Basic, расположенным в каталоге%windir%\system32\ printing_Admin_Scripts\\<language>. Чтобы использовать эту команду, в командной строке введите **cscript** , а затем полный путь к файлу **прнмнгр** или измените каталоги на соответствующую папку. Например:
    ```
    cscript %WINdir%\System32\printing_Admin_Scripts\en-US\prnmngr
    ```
-   Если предоставленные сведения содержат пробелы, заключите текст в кавычки (например, `"computer Name"`).

## <a name="BKMK_examples"></a>Примеров
Чтобы добавить принтер с именем colorprinter_2, подключенный к порту LPT1 на локальном компьютере, и для него требуется драйвер принтера под названием «цветной принтер Driver1», введите:
```
cscript prnmngr -a -p colorprinter_2 -m "color printer Driver1" -r lpt1:
```
Чтобы удалить принтер с именем colorprinter_2 с удаленного компьютера с именем Хрсервер, введите:
```
cscript prnmngr -d -s HRServer -p colorprinter_2 
```

#### <a name="additional-references"></a>Дополнительные ссылки
[Ключ синтаксиса командной строки](command-line-syntax-key.md)
[Печать справочника по командам](print-command-reference.md)
