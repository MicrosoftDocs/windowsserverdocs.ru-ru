---
title: klist
description: Справочный раздел по * * * *-
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 4689b4a9-1740-47dd-9240-02105efca428
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: f83a46f158cd83aa8393630aa0138271e8868575
ms.sourcegitcommit: ab64dc83fca28039416c26226815502d0193500c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/01/2020
ms.locfileid: "82724755"
---
# <a name="klist"></a>klist



Отображает список кэшированных в настоящее время билетов Kerberos. Эти сведения относятся к Windows Server 2012.

## <a name="syntax"></a>Синтаксис

```
klist [-lh <LogonId.HighPart>] [-li <LogonId.LowPart>] tickets | tgt | purge | sessions | kcd_cache | get | add_bind | query_bind | purge_bind
```

#### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------|-----------|
|— LH|Обозначает старшую часть локального уникального идентификатора (LUID) пользователя, выраженную в шестнадцатеричном формате. Если не указано ни — LH или – Li, команда по умолчанию имеет значение LUID пользователя, выполнившего вход.|
|-Li|Обозначает младшую часть локального уникального идентификатора (LUID) пользователя, выраженную в шестнадцатеричном формате. Если не указано ни — LH или – Li, команда по умолчанию имеет значение LUID пользователя, выполнившего вход.|
|описания|Список текущих кэшированных билетов (TGT) и билетов службы для указанного сеанса входа в систему. Это параметр по умолчанию.|
|TGT|Отображает первоначальный TGT Kerberos.|
|Очистка|Позволяет удалить все билеты указанного сеанса входа в систему.|
|сеансы|Отображает список сеансов входа на этот компьютер.|
|kcd_cache|Отображает сведения кэша ограниченного делегирования Kerberos.|
|get|Позволяет запросить билет на целевом компьютере, заданном именем участника-службы (SPN).|
|add_bind|Позволяет указать предпочтительный контроллер домена для проверки подлинности Kerberos.|
|query_bind|Отображает список кэшированных предпочитаемых контроллеров домена для каждого домена, с которым связывался протокол Kerberos.|
|purge_bind|Удаление кэшированных предпочтительных контроллеров домена для указанных доменов.|
|кдкоптионс|Отображает параметры центр распространения ключей (KDC), указанные в RFC 4120.|
|/?|Отображает справку для этой команды.|

## <a name="remarks"></a>Примечания

Членство в группах **"Администраторы домена" или "** эквивалентное" является минимальным требованием для выполнения всех параметров этой команды.

Если параметры не указаны, klist будет получать все билеты для текущего пользователя.

В параметрах отображаются следующие сведения.
-   **описания**

    Список кэшированных билетов служб, с которыми вы прошли проверку подлинности, с момента входа. Отображает следующие атрибуты всех кэшированных билетов:  
    -   Логонид: LUID
    -   Клиент: объединение имени клиента и имени домена клиента.
    -   Сервер: объединение имени службы и доменного имени службы.
    -   Тип шифрования Кербтиккет: тип шифрования, используемый для шифрования билета Kerberos
    -   Флаги билета: флаги билета Kerberos
    -   Время начала: время, с которого билет будет действителен
    -   Время окончания: время, когда билет стал недействительным. Если срок действия билета истек, он больше не может использоваться для проверки подлинности в службе или для продления.
    -   Время продления: время, когда требуется новая Начальная проверка подлинности
    -   Тип ключа сеанса: алгоритм шифрования, используемый для ключа сеанса.
-   **TGT**

    Список первоначального TGT Kerberos и следующие атрибуты кэшированного билета:  
    -   Логонид: указан в шестнадцатеричном формате
    -   ServiceName: krbtgt
    -   \<Имя субъекта-службы (SPN)>: krbtgt
    -   Имя_домена: имя домена, который выдает TGT.
    -   Таржетдомаиннаме: домен, которому выдан TGT.
    -   Алттаржетдомаиннаме: домен, которому выдан TGT.
    -   Флаги билетов: адрес и целевое действие и тип
    -   Ключ сеанса: длина ключа и алгоритм шифрования
    -   StartTime: время на локальном компьютере, на которое был запрошен билет
    -   EndTime: время, когда билет стал недействительным. Когда билет пройдет на этот раз, он больше не может использоваться для проверки подлинности в службе.
    -   Реневунтил: крайний срок продления билета
    -   Тимескев: разница во времени с центр распространения ключей (KDC)
    -   Енкодедтиккет: закодированный билет
-   **Очистка**

    Позволяет удалить конкретный билет. Удаление билетов уничтожает все кэшированные билеты, поэтому используйте этот атрибут с осторожностью. Это может привести к невозможности проверки подлинности в ресурсах. В этом случае потребуется выйти из системы и снова войти в систему.  
    -   Логонид: указан в шестнадцатеричном формате
-   **активных**

    Позволяет выводить список и отображать сведения обо всех сеансах входа на этом компьютере.  
    -   Логонид: Если указано, отображает сеанс входа только по заданному значению. Если этот параметр не указан, отображаются все сеансы входа на этот компьютер.
-   **kcd_cache**

    Позволяет отображать сведения кэша ограниченного делегирования Kerberos.  
    -   Логонид: Если указано, отображает сведения о кэше для сеанса входа в систему по заданному значению. Если не указано, отображает сведения о кэше для сеанса входа текущего пользователя.
-   **get**

    Позволяет запросить билет в целевом объекте, указанном в имени субъекта-службы.  
    -   Логонид: Если указано, запрашивает билет с помощью сеанса входа в систему по заданному значению. Если не указано, запрашивает билет с помощью сеанса входа текущего пользователя.
    -   кдкоптионс: запрашивается билет с указанными параметрами KDC.
-   **add_bind**

    Позволяет указать предпочтительный контроллер домена для проверки подлинности Kerberos.
-   **query_bind**

    Позволяет отображать кэшированные, предпочитаемые контроллеры домена для доменов.
-   **purge_bind**

    Позволяет удалять кэшированные, предпочитаемые контроллеры домена для доменов.
-   **кдкоптионс**

    Текущий список параметров и их объяснение см. в [документе RFC 4120](http://www.ietf.org/rfc/rfc4120.txt).

**Другие замечания**
-   Klist. exe доступен в Windows Server 2012 и Windows 8 и не требует специальной установки.

## <a name="examples"></a>Примеры

1. При диагностике события с ИДЕНТИФИКАТОРом 27 во время обработки запроса службы на предоставление билетов (TGS) для целевого сервера учетная запись не имеет подходящего ключа для создания билета Kerberos. Klist можно использовать для запроса кэша билетов Kerberos, чтобы определить, отсутствуют ли билеты, если целевой сервер или учетная запись имеют ошибку или если тип шифрования не поддерживается.  
   ```
   klist 
   ```  
   ```
   klist –li 0x3e7
   ```  
2. При диагностике ошибок и необходимости определить особенности каждого билета предоставления билетов, который кэшируется на компьютере для сеанса входа в систему, можно использовать klist для вывода сведений о TGT.  
   ```
   klist tgt
   ```  
3. Если не удается установить подключение и диагностика может занять слишком много времени, можно очистить кэш билетов Kerberos, выйти из системы и снова войти в нее.  
   ```
   klist purge
   ```  
   ```
   klist purge –li 0x3e7
   ```  
4. Если вы хотите диагностировать сеанс входа для пользователя или службы, можно использовать следующую команду для поиска Логонид, используемого в других командах klist.  
   ```
   klist sessions
   ```  
5. Если вы хотите диагностировать сбой ограниченного делегирования Kerberos, можно использовать следующую команду, чтобы найти последнюю обнаруженную ошибку.  
   ```
   klist kcd_cache
   ```  
6. Если вы хотите диагностировать, может ли пользователь или служба получить билет на сервер, можно использовать эту команду для запроса билета для определенного имени участника-службы.  
   ```
   klist get host/%computername%
   ```  
7. При диагностике проблем репликации между контроллерами домена обычно требуется, чтобы клиентский компьютер предназначен для определенного контроллера домена. В таких случаях можно использовать следующую команду, чтобы нацелить клиентский компьютер на конкретный контроллер домена.  
   ```
   klist add_bind CONTOSO KDC.CONTOSO.COM
   ```  
   ```
   klist add_bind CONTOSO.COM KDC.CONTOSO.COM
   ```  
8. Чтобы запросить, к каким контроллерам домена недавно обращался этот компьютер, можно использовать следующую команду.  
   ```
   klist query_bind
   ```  
9. Если требуется повторное обнаружение контроллеров домена с помощью протокола Kerberos, можно использовать следующую команду. Эта команда также может использоваться для очистки кэша перед созданием новых привязок к контроллеру домена с помощью klist add_bind.  
   ```
   klist purge_bind
   ```

## <a name="additional-references"></a>Дополнительные ссылки

-   - [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)