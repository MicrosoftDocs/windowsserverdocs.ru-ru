---
title: diskshadow
description: Раздел команд Windows для сценария DiskShadow, который представляет собой средство, предоставляющее функции, предоставляемые службой теневого копирования томов (VSS).
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: e962537d-b759-4368-b6f1-e8391cf7b221
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 5ded552394b7cf6001929ad4a639e89a660bb09c
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80845397"
---
# <a name="diskshadow"></a>diskshadow

>Область применения: Windows Server (Semi-Annual Channel), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

DiskShadow. exe — это средство, предоставляющее функциональные возможности, предоставляемые службой теневого копирования томов (VSS). По умолчанию в Diskshadow используется интерактивный интерпретатор команд, аналогичный DiskRAID или DiskPart. сценарий Diskshadow также включает в себя режим, поддерживающий сценарии.  
  
> [!NOTE]  
> Членство в группе локальных администраторов или эквивалентной является минимальным требованием для запуска сценария DiskShadow.  
  
Примеры использования команд Diskshadow см. в разделе [примеры](#BKMK_examples).  
  
## <a name="syntax"></a>Синтаксис  
для интерактивного режима введите следующую команду в командной строке, чтобы запустить интерпретатор команд Diskshadow:  
  
```  
diskshadow  
```  
  
в поле режим сценария введите следующую команду, где *script. txt* — файл скрипта, содержащий команды Diskshadow:  
  
```  
diskshadow -s script.txt  
```  
  
## <a name="diskshadow-commands"></a>команды DiskShadow  
Можно выполнить следующие команды в интерпретаторе команд Diskshadow или в файле сценария:  
  
|Параметр|Описание|  
|-------|--------|  
|[set_2](set_2.md)|Задает контекст, параметры, подробный режим и файл метаданных для создания теневых копий.|  
|[Имитировать восстановление](simulate-restore.md)|Выполняет тесты, вовлеченные в сеансы восстановления на компьютере без выдачи событий предварительного **восстановления** или **восстановления** в модули записи.|  
|[Загрузить метаданные](load-metadata.md)|Загружает файл metadata. cab перед импортом транспортной теневой копии или загружает метаданные модуля записи в случае восстановления.|  
|[средство](writer.md)|Проверяет, включено ли средство записи или компонента, или исключает модуль записи или компонент из процедуры резервного копирования или восстановления.|  
|[add](add.md);|Добавляет тома в набор томов, которые должны быть теневыми копиями, или добавляет псевдонимы в среду псевдонима.|  
|[create_1](create_1.md)|Запускает процесс создания теневой копии с использованием текущего контекста и настроек параметров.|  
|[Exec](exec.md)|выполняет файл на локальном компьютере.|  
|[Начало резервного копирования](begin-backup.md)|Запускает полный сеанс резервного копирования.|  
|[Завершение резервного копирования](end-backup.md)|Завершает сеанс полного резервного копирования и при необходимости создает событие **баккупкомплете** с соответствующим состоянием модуля записи.|  
|[Начать восстановление](begin-restore.md)|Запускает сеанс восстановления и выдает событие, выполняемое перед **восстановлением** , в вовлеченные модули записи.|  
|[Завершить восстановление](end-restore.md)|Завершает сеанс восстановления и выдает событие, выполняемое **при восстановлении** , в вовлеченные модули записи.|  
|[reset](reset.md);|Сбрасывает Diskshadow в состояние по умолчанию.|  
|[числ](list.md)|Перечисляет модули записи, теневые копии или зарегистрированные в настоящее время поставщики теневого копирования, которые находятся в системе.|  
|[удалить тени](delete-shadows.md)|Удаляет теневые копии.|  
|[импортиру](import.md)|импортирует переносимую теневую копию из загруженного файла метаданных в систему.|  
|[виде](mask.md)|Удаляет аппаратные теневые копии, импортированные с помощью команды **Import** .|  
|[представлены](expose.md)|предоставляет постоянную теневую копию в виде буквы диска, общего ресурса или точки подключения.|  
|[Unexpose](unexpose.md)|унекспосес теневую копию, которая была предоставлена с помощью команды **предоставления** .|  
|[break_2](break_2.md)|Отменяет связь тома теневой копии с VSS.|  
|[Верните](revert.md)|Возврат тома к указанной теневой копии.|  
|[exit_1](exit_1.md)|выход из сценария DiskShadow.|  
  
## <a name="remarks"></a>Примечания  
  
-   Для создания теневой копии требуется как минимум только **Add** и **CREATE** . Однако это приведет к невозможности настройки контекста и параметров, будет копией резервной копии и будет создавать только теневую копию без скрипта выполнения резервного копирования.  
  
## <a name="examples"></a><a name=BKMK_examples></a>Примеров  
Это пример последовательности команд, которые будут создавать теневые копии для резервного копирования. Его можно сохранить в файле с именем script. ДШ и выполнить с помощью сценария Diskshadow \/s script. ДШ  
  
Предположим следующее:  
  
-   У вас уже есть каталог с именем c:\\дискшадовдата.  
  
-   Системный том — C:, а объем данных — D:.  
  
-   У вас есть файл баккупскрипт. cmd в c:\\дискшадовдата.  
  
-   Файл баккупскрипт. cmd будет выполнять копию теневых данных p: и q: на диске резервного копирования.  
  
Эти команды можно ввести вручную или создать скрипт для них:  
  
```  
#diskshadow script file  
set context persistent nowriters  
set metadata c:\diskshadowdata\example.cab  
set verbose on  
begin backup  
add volume c: alias Systemvolumeshadow  
add volume d: alias Datavolumeshadow  
  
create  
  
expose %Systemvolumeshadow% p:  
expose %Datavolumeshadow% q:  
exec c:\diskshadowdata\backupscript.cmd  
end backup  
#End of script  
```  
  
## <a name="additional-references"></a>Дополнительные материалы  
- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)  
  

