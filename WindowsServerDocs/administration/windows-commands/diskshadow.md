---
title: Diskshadow
description: Справочная статья по команде DiskShadow, которая представляет собой средство, которое предоставляет функциональные возможности, предоставляемые службой теневого копирования томов (VSS).
ms.topic: reference
ms.assetid: e962537d-b759-4368-b6f1-e8391cf7b221
ms.author: lizross
author: eross-msft
manager: mtillman
ms.date: 10/16/2017
ms.openlocfilehash: 69a8eae18261085f697c92b138fce7ad3cff55ca
ms.sourcegitcommit: db2d46842c68813d043738d6523f13d8454fc972
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2020
ms.locfileid: "89635382"
---
# <a name="diskshadow"></a>Diskshadow

> Область применения: Windows Server (половина ежегодного канала), Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Diskshadow.exe — это средство, предоставляющее функции, предоставляемые службой теневого копирования томов (VSS). По умолчанию в Diskshadow используется интерактивный интерпретатор команд, аналогичный DiskRAID или DiskPart. Сценарий Diskshadow также включает в себя режим, поддерживающий сценарии.

> [!NOTE]
> Членство в группе локальных администраторов или эквивалентной является минимальным требованием для запуска сценария DiskShadow.

## <a name="syntax"></a>Синтаксис

Для интерактивного режима введите следующую команду в командной строке, чтобы запустить интерпретатор команд Diskshadow:

```
diskshadow
```

В поле режим сценария введите следующую команду, где *script.txt* — файл скрипта, содержащий команды Diskshadow:

```
diskshadow -s script.txt
```

### <a name="parameters"></a>Параметры

Можно выполнить следующие команды в интерпретаторе команд Diskshadow или в файле сценария. Для создания теневой копии требуется как минимум только **Add** и **CREATE** . Тем не менее, это лишает контекста и параметров, а также резервную копию и создает теневую копию без скрипта выполнения резервного копирования.

| Get-Help | Описание |
| --------- | ----------- |
| [команда Set](set_2.md) | Задает контекст, параметры, подробный режим и файл метаданных для создания теневых копий. |
| [команда загрузки метаданных](load-metadata.md) | Загружает файл metadata. cab перед импортом транспортной теневой копии или загружает метаданные модуля записи в случае восстановления. |
| [Writer, команда](writer.md) | проверяет, включено ли средство записи или компонента, или исключает модуль записи или компонент из процедуры резервного копирования или восстановления. |
| [добавить команду](add.md) | Добавляет тома в набор томов, которые должны быть теневыми копиями, или добавляет псевдонимы в среду псевдонима. |
| [создать команду](create.md) | Запускает процесс создания теневой копии с использованием текущего контекста и настроек параметров. |
| [Exec, команда](exec.md) | Выполняет файл на локальном компьютере. |
| [команда начала резервного копирования](begin-backup.md) | Запускает полный сеанс резервного копирования. |
| [команда завершения резервного копирования](end-backup.md) | Завершает сеанс полного резервного копирования и при необходимости создает событие **баккупкомплете** с соответствующим состоянием модуля записи. |
| [Команда Begin Restore](begin-restore.md) | Запускает сеанс восстановления и выдает событие, выполняемое перед **восстановлением** , в вовлеченные модули записи. |
| [команда завершения восстановления](end-restore.md) | Завершает сеанс восстановления и выдает событие, выполняемое **при восстановлении** , в вовлеченные модули записи. |
| [Команда Reset](reset.md) | Сбрасывает Diskshadow в состояние по умолчанию. |
| [Команда list](list.md) | Перечисляет модули записи, теневые копии или зарегистрированные в настоящее время поставщики теневого копирования, которые находятся в системе. |
| [Команда "удалить тени"](delete-shadows.md) | Удаляет теневые копии. |
| [Команда "Импорт"](import.md) | Импортирует переносимую теневую копию из загруженного файла метаданных в систему. |
| [Mask, команда](mask.md) | Удаляет аппаратные теневые копии, импортированные с помощью команды **Import** . |
| [предоставить команду](expose.md) | Предоставляет постоянную теневую копию в виде буквы диска, общего ресурса или точки подключения. |
| [Команда Unexpose](unexpose.md) | Унекспосес теневую копию, которая была предоставлена с помощью команды **предоставления** . |
| [Команда break](break_2.md) | Отменяет связь тома теневой копии с VSS. |
| [Команда revert](revert.md) | Возврат тома к указанной теневой копии. |
| [Exit, команда](exit.md) | Завершает работу интерпретатора команд или скрипта. |

## <a name="examples"></a>Примеры

Это пример последовательности команд, которые будут создавать теневые копии для резервного копирования. Его можно сохранить в файле с именем script. ДШ и выполнить с помощью `diskshadow /s script.dsh` .

Предположим следующее:

- У вас уже есть каталог с именем c: \\ дискшадовдата.

- Системный том — C:, а объем данных — D:..

- У вас есть файл баккупскрипт. cmd в c: \\ дискшадовдата.

- Файл баккупскрипт. cmd будет выполнять копию теневых данных p: и q: на диске резервного копирования.

Эти команды можно ввести вручную или создать скрипт для них:

```
#Diskshadow script file
set context persistent nowriters
set metadata c:\diskshadowdata\example.cab
set verbose on
begin backup
add volume c: alias systemvolumeshadow
add volume d: alias datavolumeshadow

create

expose %systemvolumeshadow% p:
expose %datavolumeshadow% q:
exec c:\diskshadowdata\backupscript.cmd
end backup
#End of script
```

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
