---
title: Поведение fsutil
ms.prod: windows-server-threshold
manager: dmoss
ms.author: toklima
author: toklima
ms.technology: storage
audience: IT Pro
ms.topic: article
ms.date: 10/16/2017
ms.assetid: 84eaba2c-c0af-49e1-bbbd-2ed2928e5e4b
ms.openlocfilehash: a21237a8694daeca9b6f4253ca924320ab1276c8
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66439108"
---
# <a name="fsutil-behavior"></a>Поведение fsutil

>Область применения. Windows Server (полугодовой канал), Windows Server 2016, Windows 10, Windows Server 2012 R2, Windows 8.1, Windows Server 2012, Windows 8, Windows Server 2008 R2, Windows 7

Запросы, или задает поведение тома NTFS, включая:

-   Создание файла имена в формате 8.3

-   Использование расширенных символов в формате 8.3 знаков короткие имена файлов на томах NTFS

-   Обновление отметку времени последнего обращения при каталоги, перечислены на томах NTFS

-   Частота, с квотой на какие события записываются в журнал системы и в файловую систему NTFS выгружаемого пула и уровней кэша памяти невыгружаемого пула NTFS

-   Размер таблицы главного файла зоны (зоны MFT)

-   Автоматическая удаления данных, когда система обнаруживает повреждение на томе NTFS.

-   Уведомление о удалении файлов (также известное как обрезать или отменить сопоставление)

В разделе [Примеры](#BKMK_examples) показан принцип использования этой команды.

## <a name="syntax"></a>Синтаксис

```
fsutil behavior query {allowextchar | bugcheckoncorrupt | disable8dot3 [<VolumePath>] | disablecompression | disablecompressionlimit | disableencryption | disablefilemetadataoptimization | disablelastaccess | disablespotcorruptionhandling | disabletxf | disablewriteautotiering | encryptpagingfile | mftzone | memoryusage | quotanotify | symlinkevaluation | disabledeletenotify}

fsutil behavior set {allowextchar {1|0} | bugcheckoncorrupt {1|0} | disable8dot3 [ <Value> | [<VolumePath> {1|0}] ] | disablecompression {1|0} | disablecompressionlimit {1|0} | disableencryption {1|0} | disablefilemetadataoptimization {1|0} | disablelastaccess {1|0} | disablespotcorruptionhandling {1|0} | disabletxf {1|0} | disablewriteautotiering {1|0} | encryptpagingfile {1|0} | mftzone <Value> | memoryusage <Value> | quotanotify <Frequency> | symlinkevaluation <SymbolicLinkType> | disabledeletenotify {1|0}}
```

## <a name="parameters"></a>Параметры

|                 Параметр                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|--------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                   запрос                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Запрашивает параметры поведения файловой системы.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                    набора                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Изменяет параметры поведения файловой системы.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|          allowextchar {1&#124;0}           |                                                                                                                                                                                                                                                                                                                                                                                                                                  Разрешает (**1**) или не разрешает (**0**) символов из расширенных символов значение (включая диакритические знаки) для использования в формате 8.3 знаков короткие имена файлов в файловой системе NTFS.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|        Bugcheckoncorrupt {1&#124;0}        |                                                                                                                                                                                                                                                                                                                                                                      Разрешает (**1**) или не разрешает (**0**) поколения проверку на наличие ошибок при наличии повреждения на томе NTFS. Эта функция используется для того, чтобы предотвратить автоматическое удаление данных при использовании с функцией самовосстановления NTFS NTFS.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.<br /><br />Этот параметр применяется к:  Windows Server 2008 R2 и Windows 7.                                                                                                                                                                                                                                                                                                                                                                      |
|   disable8dot3 [<VolumePath>] {1&#124;0}   |                                                                                                                                                                                                                                                                                                                                                                                                                                                       Отключает (**1**) или включает (**0**) Создание файла имена в формате 8.3 на томов FAT и NTFS. При необходимости перед *VolumePath* указан как имя диска, за которым следует двоеточие или GUID.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       disablecompression {1&#124;0}        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Отключает **(1)** или включает **(0)** сжатие NTFS.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|     disablecompressionlimit {1&#124;0}     |                                                                                                                                                                                                                                                                                   Отключает **(1)** или включает **(0)** ограничение сжатие NTFS в томе NTFS. Если сжатый файл достигает определенного уровня фрагментации, а не удалось увеличить размер файла, NTFS прекращает сжатие дополнительных областей памяти файла. Это было сделано так, чтобы разрешить сжатые файлы еще больше, чем обычно. Значение TRUE отключает эту функцию, которая ограничивает размер сжатых файлов в системе. Не рекомендуется отключить эту функцию.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                   |
|        disableencryption {1&#124;0}        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Отключает **(1)** или включает **(0)** шифрование папок и файлов на томах NTFS.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| disablefilemetadataoptimization {1&#124;0} |                                                                                                                                                                                                                                                                                                                      Отключает **(1)** или включает **(0)** файл метаданных оптимизации. NTFS имеет ограничение на количество экстентов, может иметь данного файла. Сжимается и резервов файлов может стать сильно фрагментированного. По умолчанию NTFS периодически сжимает его структуры внутренних метаданных, чтобы разрешить для фрагментации файлов. Значение TRUE отключает этой внутренней оптимизации. Не рекомендуется отключить эту функцию.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                       |
|        disablelastaccess {1&#124;0}        |                                                                                                                                                                                                                                                                                                                                                                                                                                                       Отключает (**1**) или включает (**0**) к последнему обновляет отметку времени доступа для каждого из каталогов, если каталоги, перечислены на томе NTFS.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|  disablespotcorruptionhandling {1&#124;0}  |                                                                                                                                                                                                                                                                                                                                                    Отключает **(1)** или включает **(0)** обработки spot повреждения. Одна из новых функций, появившихся в Windows 8 и Windows Server 2012 — это новая форма CHKDSK высокого уровня доступности. Эта функция дает администраторам возможность запустить программу CHKDSK для анализа состояния тома без перевода в автономный режим. Не рекомендуется отключить эту функцию.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                    |
|           disabletxf {1&#124;0}            |                                                                                                                                                                                                                                                                                                                                                                         Отключает **(1)** или включает **(0)** txf в указанном томе NTFS. TxF является функцией NTFS, предоставляющий транзакции как семантику для операций файловой системы. TxF в настоящий момент deprected на то, что функция по-прежнему доступна. Не рекомендуется отключить эту функцию на том C:.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                          |
|     disablewriteautotiering {1&#124;0}     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Отключает ReFS v2 автоматического распределения по уровням логику для многоуровневых томов.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|        encryptpagingfile {1&#124;0}        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Шифрует (**1**) или не шифрует (**0**) в файл подкачки памяти в операционной системе Windows.<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|              mftzone <Value>               |                                                                                                                                                                                                                                                                                                                                                                                                                                           Задает размер зоны MFT, а выражается в виде нескольких единиц 200 МБ. Задайте *значение* в число из **1** (значение по умолчанию — 200 МБ) для **4** (максимум — 800 МБ).<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|            memoryusage <Value>             |                                                                                                                                                                                                                                                                                   Настраивает внутренние уровни кэша памяти в выгружаемом страничном пуле NTFS и NTFS невыгружаемого пула памяти. Значение **1** или **2**. Если задано значение **1** (по умолчанию), файловая система NTFS использует по умолчанию объем выгружаемого страничного пула памяти. Если задано значение **2**, NTFS увеличивает размер своих резервных списков и пороговые значения для памяти. (Резервный список представляет собой пул буферов фиксированного размера памяти, создаваемых ядром и драйверами устройств как личной кэш-памяти для операций файловой системы, такие как чтение файла.)<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                   |
|          quotanotify <Frequency>           |                                                                                                                                                                                                                                                                                                                                                                                                                                  Настраивает частоту нарушений квоты NTFS выводятся в системном журнале. Допустимые значения находятся в диапазоне от 0 до 4294967295. Частота по умолчанию составляет 3600 секунд (один час).<br /><br />Необходимо перезагрузить компьютер для этого параметра вступили в силу.                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|    symlinkevaluation <SymbolicLinkType>    |                                                                                                                                                                                                                                                                                                                                                                                                   Определяет тип символических ссылок, которые могут быть созданы на компьютере. Допустимые варианты::<br /><br />1.  Локальный для локального символические ссылки, L2L: {0&#124;1}<br />2.  Локальным для удаленного символические ссылки, L2R: {0&#124;1}<br />3.  Удаленное подключение к локальной символические ссылки, R2R: {0&#124;1}<br />4.  Удаленное подключение к удаленной символические ссылки, R2L: {0&#124;1}                                                                                                                                                                                                                                                                                                                                                                                                   |
|            DisableDeleteNotify             | Отключает \( **1** \) или включает \( **0** \) удаление уведомлений. Уведомление об удалении \(также известная как обрезать или отменить сопоставление\) — это функция, которая уведомляет запоминающее устройство кластеров, которые были освобождены из-за файла операции удаления. Дополнительно<br /><br />-Для систем с помощью ReFS v2, предусматривающие усечение отключен по умолчанию. Применяется к Windows Server 2016.<br />-Для систем с помощью ReFS v1, trim включена по умолчанию. Применяется к Windows Server 2012, Windows Server 2012 R2 и Windows Server 2016.<br />— Для систем с помощью NTFS trim включена по умолчанию, если администратор отключает его.<br />-Если жесткого диска или сети хранения данных о том, что он не поддерживает trim, то жесткий диск и сети SAN, не получают уведомления об усечении.<br />— Включение или отключение не требует перезагрузки.<br />-Trim вступает в силу после следующего отмене команды выдается.<br />-Существующие inflight операций ввода-ВЫВОДА не подвержены влиянию изменений в реестр.<br />— Не требуется перезапуск любой службы при включении или отключении trim.<br /><br />Этот параметр впервые появился в Windows Server 2008 R2 и Windows 7. |

## <a name="remarks"></a>Примечания

-   Зоны MFT является зарезервированным область, которая включает основной таблицы файлов (MFT), расширяются таким образом, чтобы избежать фрагментации таблицы MFT. Если средний размер файла в томе 2 КБ или меньше, может быть полезно задать **mftzone** значение 2. Если средний размер файла в томе — 1 КБ или меньше, может быть полезно задать **mftzone** значение 4.

-   Когда **disable8dot3** присваивается **0**, каждый раз, создайте файл с длинным именем файла, NTFS создает вторую запись файла с именем файла 8.3 знаков. Когда NTFS создает файлы в каталоге, необходимо выполнять поиск знаков имен файлов 8.3, которые связаны с длинными именами файлов. Этот параметр обновляет **HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation** раздел реестра.

-   **Allowextchar** обновлений параметров **HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsAllowExtendedCharacterIn8dot3Name** раздел реестра.

-   **Disablelastaccess** параметр уменьшает влияние ведения журнала обновлений до отметки времени последнего доступа для файлов и каталогов. Отключение **время последнего доступа** функция повышает скорость доступа файлов и каталогов. Этот параметр обновляет **HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisableLastAccessUpdate** раздел реестра.

    Примечания.

    -   Файловое **время последнего доступа** запросы являются точными, даже если все значения на диске не является текущей. NTFS возвращает правильное значение на запросы, так как точное значение хранится в памяти.

    -   Один час, максимальное количество времени, который NTFS задерживает обновление **время последнего доступа к** на диске. Если NTFS обновляет другие атрибуты файла, такие как **время последнего изменения**и **время последнего доступа к** обновление является ожидающие обновления NTFS **время последнего доступа** с другими обновлениями без влияние на производительность.

    -   **Disablelastaccess** параметра может повлиять на работу программ резервного копирования и удаленного хранилища, полагаться на эту функцию.

-   Увеличить объем физической памяти не всегда увеличивает объем выгружаемого пула памяти, доступной в файловую систему NTFS. Установка **memoryusage** для **2** объем памяти из выгружаемого пула. Это может повысить производительность, если система открывает и закрывает много файлов, в том же файле значение и не использует большой объем системной памяти для других приложений или кэш-памяти. Если компьютер уже использует большой объем системной памяти для других приложений или кэш-памяти, увеличение допустимого объема NTFS, разбитых на страницы и памяти невыгружаемого пула сокращает доступный объем памяти для других процессов. Это может снизить общую производительность системы. Этот параметр обновляет **HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsMemoryUsage** раздел реестра.

-   Значение, указанное в **mftzone** параметр является приблизительным начального размера таблицы MFT, а также в зону MFT на новый том, и для него задано во время подключения для каждой файловой системы. Так как используется пространство на томе, NTFS корректирует пространство, зарезервированное для будущего расширения таблицы MFT. Если зоны MFT уже имеет большой размер, полный размер зоны MFT снова не резервируется. Так как зоны MFT основана на непрерывном диапазоне в конец таблицы MFT, уменьшается, как используется пространство.

    В файловой системе не определяет новое расположение зоны MFT, пока не будет полностью использована текущей зоны MFT. Обратите внимание на то, что это никогда не происходит в типичной системы.

-   Некоторые устройства может снизиться производительность при включении функции удаления уведомлений. В этом случае следует использовать **disabledeletenotify** параметр, чтобы отключить функцию уведомления.

### <a name="BKMK_examples"></a>Примеры
Чтобы запросить имя поведения disable 8dot3 для тома диска, указан с идентификатором GUID, {928842df-5a01-11de-a85c-806e6f6e6963}, введите:

```
fsutil behavior query disable8dot3 Volume{928842df-5a01-11de-a85c-806e6f6e6963}
```

Имя поведения 8dot3 также можно запрашивать с помощью **8dot3name** подкоманды.

Чтобы запросить системы, чтобы узнать, включена ли TRIM, введите следующую команду:

```
fsutil behavior query DisableDeleteNotify
```
Это дает результат, аналогичный этому:

    NTFS DisableDeleteNotify = 1
    ReFS DisableDeleteNotify is not currently set

Чтобы переопределить поведение по умолчанию для TRIM \(disabledeletenotify\) ReFS v2, введите:

```
fsutil behavior set DisableDeleteNotify ReFS 0
```

Чтобы переопределить поведение по умолчанию для TRIM \(disabledeletenotify\) NTFS и ReFS v1, введите:
```
fsutil behavior set DisableDeleteNotify 1
```

#### <a name="additional-references"></a>Дополнительная справка
[Условные обозначения синтаксиса команд командной строки](Command-Line-Syntax-Key.md)

[fsutil](Fsutil.md)

[fsutil 8dot3name](Fsutil-8dot3name.md)


