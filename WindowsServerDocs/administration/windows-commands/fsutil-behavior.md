---
title: fsutil behavior
description: Справочная статья по команде fsutil behavior, которая запрашивает или задает поведение тома NTFS.
ms.prod: windows-server
manager: dmoss
ms.author: toklima
author: toklima
ms.technology: storage
ms.topic: article
ms.date: 10/16/2017
ms.assetid: 84eaba2c-c0af-49e1-bbbd-2ed2928e5e4b
ms.openlocfilehash: 74a974bcb7f8138d28e563db35bbde7ae689e110
ms.sourcegitcommit: 2afed2461574a3f53f84fc9ec28d86df3b335685
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85931834"
---
# <a name="fsutil-behavior"></a>fsutil behavior

> Область применения: Windows Server (половина ежегодного канала), Windows Server 2019, Windows Server 2016, Windows 10, Windows Server 2012 R2, Windows 8.1, Windows Server 2012, Windows 8

Запрашивает или устанавливает поведение тома NTFS, в том числе:

- Создание имен файлов с символьной длиной 8,3.

- Расширение использования символов в коротких именах файлов длиной 8,3 символов на томах NTFS.

- Обновление метки **времени последнего доступа** , если каталоги указаны на томах NTFS.

- Частота, с которой события квоты записываются в системный журнал и на выгружаемого пула NTFS и на уровне кэша памяти невыгружаемого пула.

- Размер зоны главной таблицы файлов (зона MFT).

- Автоматическое удаление данных при обнаружении системой повреждения тома NTFS.

- Уведомление об удалении файла (также называемое обрезанием или отменой сопоставления).

## <a name="syntax"></a>Синтаксис

```
fsutil behavior query {allowextchar | bugcheckoncorrupt | disable8dot3 [<volumepath>] | disablecompression | disablecompressionlimit | disableencryption | disablefilemetadataoptimization | disablelastaccess | disablespotcorruptionhandling | disabletxf | disablewriteautotiering | encryptpagingfile | mftzone | memoryusage | quotanotify | symlinkevaluation | disabledeletenotify}

fsutil behavior set {allowextchar {1|0} | bugcheckoncorrupt {1|0} | disable8dot3 [ <value> | [<volumepath> {1|0}] ] | disablecompression {1|0} | disablecompressionlimit {1|0} | disableencryption {1|0} | disablefilemetadataoptimization {1|0} | disablelastaccess {1|0} | disablespotcorruptionhandling {1|0} | disabletxf {1|0} | disablewriteautotiering {1|0} | encryptpagingfile {1|0} | mftzone <Value> | memoryusage <Value> | quotanotify <frequency> | symlinkevaluation <symboliclinktype> | disabledeletenotify {1|0}}
```

### <a name="parameters"></a>Параметры

| Параметр | Описание |
| --------- |------------ |
| query | Запрашивает параметры поведения файловой системы. |
| set | Изменяет параметры поведения файловой системы. |
| алловекстчар`{1|0}` | Разрешает использовать (**1**) или запрещает (**0**) символы из расширенного набора символов (включая диакритические знаки) для коротких имен файлов длиной 8,3 символов на томах NTFS.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| бугчекконкоррупт`{1|0}` | Разрешает (**1**) или запрещает (**0**) Создание проверки ошибки при повреждении тома NTFS. Эта функция может использоваться для предотвращения автоматического удаления данных из NTFS при использовании функции самостоятельной восстановления NTFS.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| disable8dot3 [ <volumepath> ]`{1|0}` | Отключает (**1**) или включает (**0**) создание имен файлов с символьной длиной 8,3 в томах с файловой системой FAT и NTFS. При необходимости добавьте в префикс *volumepath* , указанный в качестве имени диска, за которым следует двоеточие или идентификатор GUID. |
| дисаблекомпрессион`{1|0}` | Отключает **(1)** или включает **(0)** сжатие NTFS.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| дисаблекомпрессионлимит`{1|0}` | Отключает **(1)** или включает **(0)** ограничение на сжатие NTFS на томе NTFS. Когда сжатый файл достигает определенного уровня фрагментации, а не не позволяет расширить его, NTFS прекращает сжатие дополнительных экстентов файла. Это было сделано для того, чтобы размер сжатых файлов был больше, чем обычно. Установка этого параметра равным **true** отключает эту функцию, которая ограничивает размер сжатых файлов в системе. Отключить эту функцию не рекомендуется.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| дисаблинкриптион`{1|0}` | Отключает **(1)** или включает **(0)** шифрование папок и файлов на томах NTFS.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| дисаблефилеметадатаоптимизатион`{1|0}` | Отключает **(1)** или включает **(0)** оптимизацию метаданных файла. NTFS имеет ограничение на количество экстентов, которые может иметь данный файл. Сжатые и разреженные файлы могут стать очень фрагментированными. По умолчанию NTFS периодически сжимает свои внутренние структуры метаданных, чтобы обеспечить более фрагментированные файлы. Если задать для этого параметра значение **true** , эта внутренняя оптимизация будет отключена. Отключить эту функцию не рекомендуется.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| параметр disablelastaccess`{1|0}` | Отключает (**1**) или включает (**0**) обновление метки времени последнего доступа в каждом каталоге, если каталоги перечислены на томе NTFS.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| дисаблеспоткорруптионхандлинг`{1|0}` | Отключает **(1)** или включает **(0)** обработку повреждений в плашечных повреждениях. Также позволяет системным администраторам запускать программу CHKDSK для анализа состояния тома без его перевода в автономный режим. Отключить эту функцию не рекомендуется.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| дисаблетксф`{1|0}` | Отключает **(1)** или включает **(0)** TxF на указанном томе NTFS. TxF — это функция NTFS, которая предоставляет такую транзакцию, как семантика операций файловой системы. Система TxF в настоящее время нерекомендуема, но эта функция по-прежнему доступна. Мы не рекомендуем отключать эту функцию на томе C:.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| дисаблевритеаутотиеринг`{1|0}` | Отключает логику автоматического распределения ReFS v2 для многоуровневых томов.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| енкриптпагингфиле`{1|0}` | Шифрует (**1**) или не шифрует (**0**) файл подкачки памяти в операционной системе Windows.<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| мфтзоне`<value>` | Задает размер зоны MFT и выражается в нескольких единицах 200 МБ. Задайте *значение* числа от **1** (по умолчанию — 200 МБ) до **4** (максимум — 800 МБ).<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| memoryusage`<value>` | Настраивает внутренние уровни кэша памяти в невыгружаемом страничном пуле и памяти невыгружаемого пула в файловой системе NTFS. Задайте значение **1** или **2**. Если задано значение **1** (по умолчанию), NTFS использует объем памяти выгружаемого пула по умолчанию. Если задано значение **2**, NTFS увеличивает размер своих списков резервных копий и пороговых значений памяти. (Резервный список — это пул буферов памяти фиксированного размера, которые создаются драйвером ядра и устройства как кэши частной памяти для операций файловой системы, таких как чтение файла.)<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| куотанотифи`<frequency>` | Определяет, как часто регистрируются нарушения квот NTFS в системном журнале. Допустимые значения для находятся в диапазоне от **0 до 4294967295**. Периодичность по умолчанию составляет **3600** секунд (один час).<p>Чтобы этот параметр вступил в силу, необходимо перезагрузить компьютер. |
| симлинкевалуатион`<symboliclinktype>` | Управляет видом символических ссылок, которые могут быть созданы на компьютере. Допустимые варианты:<ul><li>**1** — локальная и локальная символьные ссылки;`L2L:{0|1}`</li><li>**2** — локальная для удаленных символических ссылок;`L2R:{1|0}`</li><li>**3** — удаленные с символами ссылки на локальные символы;`R2R:{1|0}`</li><li>**4** — удаленное на удаленные символические ссылки;`R2L:{1|0}`</li></ul> |
| дисабледелетенотифи | Отключает (**1**) или включает (**0**) Удаление уведомлений. Удаление уведомлений (также называемое обрезанием или отменой сопоставления) — это функция, которая уведомляет базовое устройство хранения кластеров, освобожденных из-за операции удаления файла. Кроме того, примите во внимание:<ul><li>Для систем, использующих ReFS v2, функция Trim по умолчанию отключена.</li><li>Для систем, использующих ReFS v1, функция Trim включена по умолчанию.</li><li>Для систем с файловой системой NTFS функция Trim включена по умолчанию, если администратор не отключил ее.</li><li>Если жесткий диск или сеть SAN сообщают, что они не поддерживают обрезку, жесткие диски и сети SAN не получают уведомления об обрезке.</li><li>Включение или отключение не требует перезагрузки.</li><li>Функция Trim вступает в силу при выполнении следующей команды сопоставления.</li><li>Изменения в реестре не затрагивают существующие операции ввода-вывода порядковых.</li><li>При включении или отключении обрезки не требуется перезапуска службы.</li></ul> |

#### <a name="remarks"></a>Комментарии

- Зона MFT — это зарезервированная область, которая позволяет расширить основную таблицу файлов (MFT), чтобы предотвратить фрагментацию MFT. Если средний размер файла на томе составляет 2 КБ или меньше, может быть полезно установить значение **мфтзоне** равным **2**. Если средний размер файла на томе составляет 1 КБ или меньше, может быть полезно установить значение **мфтзоне** равным **4**.

- Если **disable8dot3** имеет значение **0**, при каждом создании файла с длинным именем файловая система NTFS создает вторую запись файла, имеющую имя файла длиной 8,3 символов. Когда NTFS создает файлы в каталоге, он должен найти 8,3 имен файлов символьной длины, связанных с длинными именами файлов. Этот параметр обновляет раздел реестра **HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation** .

- Параметр **алловекстчар** обновляет раздел реестра **HKLM\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsAllowExtendedCharacterIn8dot3Name** .

- Параметр **параметр disablelastaccess** сокращает влияние обновления ведения журнала на метку **времени последнего доступа** к файлам и каталогам. Отключение функции **времени последнего доступа** повышает скорость доступа к файлам и каталогам. Этот параметр обновляет раздел реестра **хклм\систем\куррентконтролсет\контрол\филесистем\нтфсдисаблеластакцессупдате** .

    **Примечания.**

    - Запросы на файловое **время последнего доступа** являются точными, даже если все значения на диске не являются текущими. NTFS возвращает правильное значение в запросах, так как точное значение хранится в памяти.

    - Один час — это максимальное время, в течение которого NTFS может откладывать обновление **времени последнего доступа** на диске. Если система NTFS обновляет другие атрибуты файлов, такие как **время последнего изменения**, и ожидается **Последнее обновление времени доступа** , NTFS обновляет **время последнего доступа** с другими обновлениями без дополнительного влияния на производительность.

    - Параметр **параметр disablelastaccess** может влиять на такие программы, как резервное копирование и удаленное хранилище, которое зависит от этой функции.

- Увеличение объема физической памяти не всегда увеличивает объем памяти выгружаемого пула, доступный для файловой системы NTFS. При установке **memoryusage** в **2** повышается предельный объем памяти выгружаемого пула. Это может повысить производительность, если система открывает и закрывает много файлов в одном наборе файлов и еще не использует большие объемы системной памяти для других приложений или кэш-памяти. Если компьютер уже использует большие объемы системной памяти для других приложений или кэш-памяти, увеличение предельного объема памяти в выгружаемом и нестраничном пуле уменьшает доступный объем памяти пула для других процессов. Это может снизить общую производительность системы. Этот параметр обновляет раздел реестра **хклм\систем\куррентконтролсет\контрол\филесистем\нтфсмеморюсаже** .

- Значение, указанное в параметре **мфтзоне** , является приближением ИСХОДНОГО размера MFT и зоны MFT на новом томе и задается во время монтирования для каждой файловой системы. По мере использования пространства на томе NTFS корректирует пространство, зарезервированное для будущего роста MFT. Если зона MFT уже велика, полный размер зоны MFT не резервируется снова. Так как зона MFT основана на непрерывном диапазоне после конца MFT, она сжимается по мере использования пространства.

    Файловая система не определяет новое расположение зоны MFT, пока текущая зона MFT не будет полностью использована. Обратите внимание, что это никогда не происходит в обычной системе.

- При включении функции уведомления об удалении некоторые устройства могут испытывать снижение производительности. В этом случае используйте параметр **дисабледелетенотифи** , чтобы отключить функцию уведомления.

### <a name="examples"></a>Примеры

Чтобы запросить режим отключения имени 8dot3 для тома диска, указанного с идентификатором GUID, {928842df-5a01-11de-a85c-806e6f6e6963}, введите:

```
fsutil behavior query disable8dot3 volume{928842df-5a01-11de-a85c-806e6f6e6963}
```

Можно также запрашивать поведение имен 8dot3 с помощью подкоманды **8dot3name** .

Чтобы запросить систему, чтобы узнать, включена ли функция TRIM, введите:

```
fsutil behavior query DisableDeleteNotify
```

В результате получается примерно такой результат:

```
NTFS DisableDeleteNotify = 1
ReFS DisableDeleteNotify is not currently set
```

Чтобы переопределить поведение по умолчанию для функции TRIM (дисабледелетенотифи) для ReFS v2, введите:

```
fsutil behavior set disabledeletenotify ReFS 0
```

Чтобы переопределить поведение по умолчанию для TRIM (дисабледелетенотифи) для NTFS и ReFS v1, введите:

```
fsutil behavior set disabledeletenotify 1
```

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)

- [fsutil](fsutil.md)

- [fsutil 8dot3name](fsutil-8dot3name.md)
