---
title: wecutil
description: 'Раздел Windows команды для ****- '
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 0c82a6cb-d652-429c-9c3d-0f568c78d54b
author: coreyp-at-msft
ms.author: coreyp
manager: dansimps
ms.openlocfilehash: 78005a715a0dbd20124bfb24be27586a8e153310
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71362187"
---
# <a name="wecutil"></a>wecutil



Позволяет создавать и администрировать подписки на события, пересылаемые с удаленных компьютеров. Удаленный компьютер должен поддерживать протокол WS-Management. В разделе [Примеры](#BKMK_examples) показан принцип использования этой команды.


## <a name="syntax"></a>Синтаксис

```
wecutil  [{es | enum-subscription}] 
[{gs | get-subscription} <Subid> [/f:<Format>] [/uni:<Unicode>]] 
[{gr | get-subscriptionruntimestatus} <Subid> [<Eventsource> …]] 
[{ss | set-subscription} [<Subid> [/e:[<Subenabled>]] [/esa:<Address>] [/ese:[<Srcenabled>]] [/aes] [/res] [/un:<Username>] [/up:<Password>] [/d:<Desc>] [/uri:<Uri>] [/cm:<Configmode>] [/ex:<Expires>] [/q:<Query>] [/dia:<Dialect>] [/tn:<Transportname>] [/tp:<Transportport>] [/dm:<Deliverymode>] [/dmi:<Deliverymax>] [/dmlt:<Deliverytime>] [/hi:<Heartbeat>] [/cf:<Content>] [/l:<Locale>] [/ree:[<Readexist>]] [/lf:<Logfile>] [/pn:<Publishername>] [/essp:<Enableport>] [/hn:<Hostname>] [/ct:<Type>]] [/c:<Configfile> [/cun:<Username> /cup:<Password>]]] 
[{cs | create-subscription} <Configfile> [/cun:<Username> /cup:<Password>]] 
[{ds | delete-subscription} <Subid>] 
[{rs | retry-subscription} <Subid> [<Eventsource>…]] 
[{qc | quick-config} [/q:[<Quiet>]]].
```

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------|-----------|
|{ES \| enum-Subscription}|Отображает имена всех существующих удаленных подписок на события.|
|{GS \| Get-Subscription} \<Subid > [/f: \<Format >] [/уни: \<Unicode >]|Отображает сведения о конфигурации удаленной подписки. \<Subid > — это строка, которая уникально идентифицирует подписку. \<Subid > совпадает со строкой, указанной в теге \<SubscriptionId > XML-файла конфигурации, который использовался для создания подписки.|
|{GR \| Get-субскриптионрунтиместатус} \<Subid > [\<Eventsource >...]|Отображает состояние выполнения подписки. \<Subid > — это строка, которая уникально идентифицирует подписку. \<Subid > совпадает со строкой, указанной в теге \<SubscriptionId > XML-файла конфигурации, который использовался для создания подписки. \<Eventsource > — это строка, идентифицирующая компьютер, который выступает в качестве источника событий. \<Eventsource > должно быть полным доменным именем, именем NetBIOS или IP-адресом.|
|{SS \| Set-Subscription} \<Subid > [/e: [\<Subenabled >]] [/ЕСА: \<Address >] [/ЕСЕ: [\<Srcenabled >]] [/АЕС] [/RES] [/Ун: \<Username >] [/Up: \<Password >] [/d: \<Desc >] [/Ури: @no __t-8Uri >] [/cm: \<Configmode >] [/ЕКС: 0Expires >] [/q: 1Query >] [/Диа: 2Dialect >] [/TN: 3Transportname >] [14Transportport: @no__t-/ДМ >] [15Deliverymode: @no__t t-16Deliverymax >] [/дмлт: 7Deliverytime >] [/Хи: 8Heartbeat >] [/КФ: 9Content >] [/l: 0Locale >] [/ри: [1Readexist >]] [/ЛФ: 2Logfile >] [/Пн: 3Publishername >] [/ ессп: 4Enableport >] [/ХН: 5Hostname >] [/КТ: 6Type >]</br>или</br>{SS \| Set-Subscription/c: \<Configfile > [/кун: \<Comusername >/КУП: \<Compassword >]|Изменяет конфигурацию подписки. Можно указать идентификатор подписки и соответствующие параметры для изменения параметров подписки. также можно указать XML-файл конфигурации для изменения параметров подписки.|
|{CS \| Create-Subscription} \<Configfile > [/кун: \<Username >/КУП: \<Password >]|Создает удаленную подписку. \<Configfile > указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога.|
|{DS \| Delete-Subscription} \<Subid >|Удаляет подписку и отменяет подписку на все источники событий, которые доставляют события в журнал событий для подписки. Все события, которые уже получены и записаны в журнал, не удаляются. \<Subid > — это строка, которая уникально идентифицирует подписку. \<Subid > совпадает со строкой, указанной в теге \<SubscriptionId > XML-файла конфигурации, который использовался для создания подписки.|
|{RS \| Retry-Subscription} \<Subid > [\<Eventsource >...]|Повторяет попытку установить соединение и отправить запрос на удаленную подписку неактивной подписке. Пытается повторно активировать все источники событий или указанные источники событий. Отключенные источники не повторяются повторно. \<Subid > — это строка, которая уникально идентифицирует подписку. \<Subid > совпадает со строкой, указанной в теге \<SubscriptionId > XML-файла конфигурации, который использовался для создания подписки. \<Eventsource > — это строка, идентифицирующая компьютер, который выступает в качестве источника событий. \<Eventsource > должно быть полным доменным именем, именем NetBIOS или IP-адресом.|
|{QC \| Quick-Config} [/q: [\<Quiet >]]|Настраивает службу сборщика событий Windows, чтобы обеспечить возможность создания и поддержания подписки с помощью перезагрузки. Это включает следующие шаги:</br>1.  Включите канал ForwardedEvents, если он отключен.</br>2.  Задайте для службы сборщика событий Windows отложенное начало.</br>3.  Запустите службу сборщика событий Windows, если она не запущена.|

## <a name="options"></a>Параметры

|Параметр|Описание|
|------|-----------|
|/f: @no__t 0Format >|Задает формат отображаемых сведений. \<Format > могут быть XML или сжаты. Если <Format> — XML, выходные данные отображаются в формате XML. Если \<Format > сжаты, выходные данные отображаются в парах "имя-значение". Значение по умолчанию — сжатый.|
|/c: \<Configfile >|Указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога. Этот параметр можно использовать только с параметрами **/Кун** и **/КУП** и является взаимоисключающим со всеми другими параметрами.|
|/e: [\<Subenabled >]|Включает или отключает подписку. \<Subenabled > может иметь значение true или false. Значение этого параметра по умолчанию — true.|
|/ЕСА: @no__t — 0Address >|Указывает адрес источника события. \<Address > — это строка, содержащая полное доменное имя, имя NetBIOS или IP-адрес, определяющие компьютер, который выступает в качестве источника событий. Этот параметр следует использовать с параметрами **/ЕСЕ**, **/АЕС**, **/RES**или **/Ун** и **/up** .|
|/ЕСЕ: [\<Srcenabled >]|Включает или отключает источник события. \<Srcenabled > может иметь значение true или false. Этот параметр разрешается, только если указан параметр **/ЕСА** . Значение этого параметра по умолчанию — true.|
|/аес|Добавляет источник событий, указанный параметром **/ЕСА** , если он еще не является частью подписки. Если адрес, указанный параметром **/ЕСА** , уже является частью подписки, то выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/RES|Удаляет источник событий, указанный параметром **/ЕСА** , если он уже является частью подписки. Если адрес, указанный параметром **/ЕСА** , не является частью подписки, выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/Ун: @no__t — 0Username >|Указывает учетные данные пользователя для использования с источником событий, указанным параметром **/ЕСА** . Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/Up: @no__t — 0Password >|Указывает пароль, соответствующий учетным данным пользователя. Этот параметр разрешен только в том случае, если указан параметр **/Ун** .|
|/d: \<Desc >|Содержит описание подписки.|
|/Ури: @no__t — 0Uri >|Указывает тип событий, используемых подпиской. \<Uri > содержит строку URI, которая объединяется с адресом исходного компьютера события для уникальной идентификации источника событий. Строка URI используется для всех адресов источников событий в подписке.|
|/CM: @no__t — 0Configmode >|Задает режим конфигурации. \<Configmode > может быть одной из следующих строк: Обычная, настраиваемая, Минлатенци или MinBandwidth. Режимы "Стандартный", "Минлатенци" и "MinBandwidth" устанавливают режим доставки, максимальное количество элементов доставки, интервал пульса и максимальное время задержки доставки. Параметры **/ДМ**, **/ДМИ**, **/Хи** или **/дмлт** могут быть указаны, только если для режима конфигурации задано значение Custom.|
|/ЕКС: @no__t — 0Expires >|Задает время истечения срока действия подписки. \<Expires > должны быть определены в стандартном формате формата даты и времени XML или ISO8601: гггг-мм-ddThh: mm: SS [. SSS] [Z], где T — это разделитель времени, а Z — время в формате UTC.|
|/q: \<Query >|Указывает строку запроса для подписки. Формат \<Query > может отличаться для разных значений URI и применяется ко всем источникам в подписке.|
|/Диа: @no__t — 0Dialect >|Определяет диалект, используемый в строке запроса.|
|/TN: \<Transportname >|Указывает имя транспорта, используемого для подключения к удаленному источнику событий.|
|/TP: \<Transportport >|Задает номер порта, используемый транспортом при соединении с удаленным источником событий.|
|/дм: @no__t — 0Deliverymode >|Указывает режим доставки. \<Deliverymode > может быть либо Pull, либо Push. Этот параметр допустим только в том случае, если для параметра **/cm** задано значение Custom.|
|/Дми: @no__t — 0Deliverymax >|Задает максимальное число элементов для пакетной доставки. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/дмлт: @no__t — 0Deliverytime >|Задает максимальную задержку при доставке пакета событий. \<Deliverytime > — число миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/Хи: @no__t — 0Heartbeat >|Определяет интервал пульса. \<Heartbeat > — число миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/КФ: @no__t — 0Content >|Задает формат возвращаемых событий. \<Content > могут быть событиями или Рендередтекст. Если значение равно Рендередтекст, то события возвращаются с локализованными строками (например, описание события), прикрепленными к событию. Значение по умолчанию — Рендередтекст.|
|/l: \<Locale >|Задает языковой стандарт для доставки локализованных строк в формате Рендередтекст. \<Locale > — это язык и идентификатор страны или региона, например "EN-US". Этот параметр допустим только в том случае, если для параметра **/КФ** задано значение рендередтекст.|
|/ри: [\<Readexist >]|Определяет события, которые доставляются для подписки. \<Readexist > может иметь значение true или false. Если <Readexist> имеет значение true, все существующие события считываются из источников событий подписки. Если <Readexist> имеет значение false, доставляются только будущие (поступающие) события. Значение по умолчанию — true для параметра **/ри** без значения. Если параметр **/ри** не указан, по умолчанию используется значение false.|
|/ЛФ: @no__t — 0Logfile >|Указывает локальный журнал событий, который используется для хранения событий, полученных из источников событий.|
|/Пн: @no__t — 0Publishername >|Указывает имя издателя. Он должен быть издателем, который владеет или импортирует журнал, указанный параметром **/ЛФ** .|
|/ессп: @no__t — 0Enableport >|Указывает, что номер порта должен быть добавлен к имени участника-службы удаленной службы. \<Enableport > может иметь значение true или false. Номер порта добавляется, если <Enableport> имеет значение true. При добавлении номера порта может потребоваться выполнить некоторые настройки, чтобы предотвратить отказ в доступе к источникам событий.|
|/ХН: @no__t — 0Hostname >|Указывает DNS-имя локального компьютера. Это имя используется удаленным источником событий для отправки событий назад и должно использоваться только для принудительной подписки.|
|/КТ: @no__t — 0Type >|Задает тип учетных данных для доступа к удаленному источнику. \<Type > должны иметь одно из следующих значений: по умолчанию, Negotiate, дайджест, Basic или LocalMachine. Значение по умолчанию — Default.|
|/Кун: @no__t — 0Comusername >|Задает учетные данные общего пользователя, используемые для источников событий, которые не имеют собственных учетных данных пользователя. Если этот параметр указан с параметром **/c** , параметры username и userpassword для отдельных источников событий из файла конфигурации игнорируются. Если вы хотите использовать разные учетные данные для определенного источника событий, следует переопределить это значение, указав параметры **/Ун** и **/up** для определенного источника события в командной строке другой команды **SS** .|
|/КУП: @no__t — 0Compassword >|Задает пароль пользователя для общих учетных данных пользователя. Если параметру \<Compassword > присвоено значение * (звездочка), то пароль считывается из консоли. Этот параметр допустим только в том случае, если указан параметр **/Кун** .|
|/q: [\<Quiet >]|Указывает, запрашивает ли процедура конфигурации подтверждение. \<Quiet > может иметь значение true или false. Если <Quiet> имеет значение true, процедура настройки не запрашивает подтверждение. Значение этого параметра по умолчанию равно false.|

## <a name="remarks"></a>Примечания

> [!IMPORTANT]
> Если появится сообщение "сервер RPC недоступен?" При попытке запустить wecutil необходимо запустить службу сборщика событий Windows (вексвк). Чтобы запустить вексвк, в командной строке с повышенными привилегиями введите net start вексвк.

- В следующем примере показано содержимое файла конфигурации:  
  ```
  <Subscription xmlns="https://schemas.microsoft.com/2006/03/windows/events/subscription">
  <Uri>https://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>
  <!-- Use Normal (default), Custom, MinLatency, MinBandwidth -->
  <ConfigurationMode>Normal</ConfigurationMode>
  <Description>Forward Sample Subscription</Description>
  <SubscriptionId>SampleSubscription</SubscriptionId>
  <Query><![CDATA[
  <QueryList>
  <Query Path="Application">
  <Select>*</Select>
  </Query>
  </QueryList>
  ]]></Query>
  <EventSources>
  <EventSource Enabled="true">
  <Address>mySource.myDomain.com</Address>
  <UserName>myUserName</UserName>
  <Password>*</Password>
  </EventSource>
  </EventSources>
  <CredentialsType>Default</CredentialsType>
  <Locale Language="EN-US"></Locale>
  </Subscription>
  ```

## <a name="BKMK_examples"></a>Примеров

Выходные данные конфигурации для подписки с именем Sub1:
```
wecutil gs sub1
```
Пример вывода команды:
```
EventSource[0]:
Address: localhost
Enabled: true
Description: Subscription 1
Uri: wsman:microsoft/logrecord/sel
DeliveryMode: pull
DeliveryMaxSize: 16000
DeliveryMaxItems: 15
DeliveryMaxLatencyTime: 1000
HeartbeatInterval: 10000
Locale:
ContentFormat: renderedtext
LogFile: HardwareEvents
```
Отображение состояния среды выполнения подписки с именем Sub1:
```
wecutil gr sub1
```
Обновите конфигурацию подписки Sub1 из нового XML-файла с именем WsSelRg2. XML:
```
wecutil ss sub1 /c:%Windir%\system32\WsSelRg2.xml
```
Обновите конфигурацию подписки с именем sub2, указав несколько параметров:
```
wecutil ss sub2 /esa:myComputer /ese /un:uname /up:* /cm:Normal
```
Создайте подписку для перенаправления событий из журнала событий приложений Windows Vista на удаленном компьютере по адресу mySource.myDomain.com в журнал ForwardedEvents (см. раздел Примечания для примера файла конфигурации):
```
wecutil cs subscription.xml
```
Удалите подписку с именем Sub1:
```
wecutil ds sub1
```

#### <a name="additional-references"></a>Дополнительная справка

[Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
