---
title: wecutil
description: Справочная статья по команде wecutil, которая позволяет создавать и администрировать подписки на события, пересылаемые с удаленных компьютеров.
ms.topic: reference
ms.assetid: 0c82a6cb-d652-429c-9c3d-0f568c78d54b
ms.author: lizross
author: eross-msft
manager: mtillman
ms.openlocfilehash: 52ce6018a0aaf6ff10d6e231092464451d80e1b9
ms.sourcegitcommit: 28b5ab74cb0b40539ccc1a83998d6391e87fe51f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2020
ms.locfileid: "96614916"
---
# <a name="wecutil"></a>wecutil

Позволяет создавать и администрировать подписки на события, пересылаемые с удаленных компьютеров. Удаленный компьютер должен поддерживать протокол WS-Management.

> [!IMPORTANT]
> Если появится сообщение "сервер RPC недоступен?" При попытке запустить wecutil необходимо запустить службу сборщика событий Windows (вексвк). Чтобы запустить вексвк, в командной строке с повышенными привилегиями введите `net start wecsvc` .

## <a name="syntax"></a>Синтаксис

```command
wecutil [{es | enum-subscription}] [{gs | get-subscription} <Subid> [/f:<Format>] [/uni:<Unicode>]] [{gr | get-subscriptionruntimestatus} <Subid> [<Eventsource> …]] [{ss | set-subscription} [<Subid> [/e:[<Subenabled>]] [/esa:<Address>] [/ese:[<Srcenabled>]] [/aes] [/res] [/un:<Username>] [/up:<Password>] [/d:<Desc>] [/uri:<Uri>] [/cm:<Configmode>] [/ex:<Expires>] [/q:<Query>] [/dia:<Dialect>] [/tn:<Transportname>] [/tp:<Transportport>] [/dm:<Deliverymode>] [/dmi:<Deliverymax>] [/dmlt:<Deliverytime>] [/hi:<Heartbeat>] [/cf:<Content>] [/l:<Locale>] [/ree:[<Readexist>]] [/lf:<Logfile>] [/pn:<Publishername>] [/essp:<Enableport>] [/hn:<Hostname>] [/ct:<Type>]] [/c:<Configfile> [/cun:<Username> /cup:<Password>]]] [{cs | create-subscription} <Configfile> [/cun:<Username> /cup:<Password>]] [{ds | delete-subscription} <Subid>] [{rs | retry-subscription} <Subid> [<Eventsource>…]] [{qc | quick-config} [/q:[<quiet>]]]
```

### <a name="parameters"></a>Параметры

| Параметр | Описание |
|--|--|
| `{es | enum-subscription}` | Отображает имена всех существующих удаленных подписок на события. |
| `{gs | get-subscription} <Subid> [/f:<Format>] [/uni:<Unicode>]` | Отображает сведения о конфигурации удаленной подписки. `<Subid>` Строка, однозначно определяющая подписку. Это то же самое, что и строка, указанная в `<SubscriptionId>` теге XML-файла конфигурации, который использовался для создания подписки. |
| `{gr | get-subscriptionruntimestatus} <Subid> [<Eventsource> …]` | Отображает состояние выполнения подписки. `<Subid>` Строка, однозначно определяющая подписку. Это то же самое, что и строка, указанная в `<SubscriptionId>` теге XML-файла конфигурации, который использовался для создания подписки. `<Eventsource>` — Это строка, идентифицирующая компьютер, который выступает в качестве источника событий. Это должно быть полное доменное имя, имя NetBIOS или IP-адрес. |
| `{ss | set-subscription} <Subid> [/e:[<Subenabled>]] [/esa:<Address>] [/ese:[<Srcenabled>]] [/aes] [/res] [/un:<Username>] [/up:<Password>] [/d:<Desc>] [/uri:<Uri>] [/cm:<Configmode>] [/ex:<Expires>] [/q:<Query>] [/dia:<Dialect>] [/tn:<Transportname>] [/tp:<Transportport>] [/dm:<Deliverymode>] [/dmi:<Deliverymax>] [/dmlt:<Deliverytime>] [/hi:<Heartbeat>] [/cf:<Content>] [/l:<Locale>] [/ree:[<Readexist>]] [/lf:<Logfile>] [/pn:<Publishername>] [/essp:<Enableport>] [/hn:<Hostname>] [/ct:<Type>]` <br>**OR**<br>`{ss | set-subscription /c:<Configfile> [/cun:<Comusername> /cup:<Compassword>]` | Изменяет конфигурацию подписки. Можно указать идентификатор подписки и соответствующие параметры для изменения параметров подписки. также можно указать XML-файл конфигурации для изменения параметров подписки. |
| `{cs | create-subscription} <Configfile> [/cun:<Username> /cup:<Password>]` | Создает удаленную подписку. `<Configfile>` Указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога. |
| `{ds | delete-subscription} <Subid>` | Удаляет подписку и отменяет подписку на все источники событий, которые доставляют события в журнал событий для подписки. Все события, которые уже получены и записаны в журнал, не удаляются. `<Subid>` Строка, однозначно определяющая подписку. Это то же самое, что и строка, указанная в `<SubscriptionId>` теге XML-файла конфигурации, который использовался для создания подписки. |
| `{rs | retry-subscription} <Subid> [<Eventsource>…]` | Повторяет попытку установить соединение и отправить запрос на удаленную подписку неактивной подписке. Пытается повторно активировать все источники событий или указанные источники событий. Отключенные источники не повторяются повторно. `<Subid>` Строка, однозначно определяющая подписку. Это то же самое, что и строка, указанная в `<SubscriptionId>` теге XML-файла конфигурации, который использовался для создания подписки. `<Eventsource>` — Это строка, идентифицирующая компьютер, который выступает в качестве источника событий. Это должно быть полное доменное имя, имя NetBIOS или IP-адрес. |
| `{qc | quick-config} [/q:[<Quiet>]]` | Настраивает службу сборщика событий Windows, чтобы обеспечить возможность создания и поддержания подписки с помощью перезагрузки. Это включает следующие шаги:<ol><li>Включите канал ForwardedEvents, если он отключен.</li><li>Задайте для службы сборщика событий Windows отложенное начало.</li><li>Запустите службу сборщика событий Windows, если она не запущена.</li></ol> |

#### <a name="options"></a>Параметры

| Параметр | Описание |
|--|--|
| ключа`<Format>` | Задает формат отображаемых сведений. `<Format>` может быть XML или сжатым. Если это **XML**, выходные данные отображаются в формате XML. Если он **сжат**, выходные данные отображаются в парах "имя-значение". Значение по умолчанию — **сжатый**. |
| /c:`<Configfile>` | Указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога. Этот параметр можно использовать только с параметрами **/Кун** и **/КУП** и является взаимоисключающим со всеми другими параметрами. |
| /e: [ `<Subenabled>` ] | Включает или отключает подписку. `<Subenabled>` может иметь значение true или false. Значение этого параметра по умолчанию — **true**. |
| ESA`<Address>` | Указывает адрес источника события. `<Address>` — Это строка, которая содержит полное доменное имя, NetBIOS-имя или адрес IP, определяющие компьютер, который выступает в качестве источника событий. Этот параметр следует использовать с параметрами **/ЕСЕ**, **/АЕС**, **/RES** или **/Ун** и **/up** . |
| /ЕСЕ: [ `<Srcenabled>` ] | Включает или отключает источник события. `<Srcenabled>` может иметь значение true или false. Этот параметр разрешается, только если указан параметр **/ЕСА** . Значение этого параметра по умолчанию — **true**. |
| /аес | Добавляет источник событий, указанный параметром **/ЕСА** , если он еще не является частью подписки. Если адрес, указанный параметром **/ЕСА** , уже является частью подписки, то выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** . |
| /RES | Удаляет источник событий, указанный параметром **/ЕСА** , если он уже является частью подписки. Если адрес, указанный параметром **/ЕСА** , не является частью подписки, выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** . |
| понижен`<Username>` | Указывает учетные данные пользователя для использования с источником событий, указанным параметром **/ЕСА** . Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** . |
| /Up`<Password>` | Указывает пароль, соответствующий учетным данным пользователя. Этот параметр разрешен только в том случае, если указан параметр **/Ун** . |
| /d`<Desc>` | Содержит описание подписки. |
| URI`<Uri>` | Указывает тип событий, используемых подпиской. `<Uri>` содержит строку URI, которая объединяется с адресом исходного компьютера события для уникальной идентификации источника событий. Строка URI используется для всех адресов источников событий в подписке. |
| /cm`<Configmode>` | Задает режим конфигурации. `<Configmode>` может быть одной из следующих строк: **Обычная**, **Настраиваемая**, **минлатенци** или **MinBandwidth**. Режимы " **стандартный**", " **минлатенци**" и " **MinBandwidth** " устанавливают режим доставки, максимальное количество элементов доставки, интервал пульса и максимальное время задержки доставки. Параметры **/ДМ**, **/ДМИ**, **/Хи** или **/дмлт** могут быть указаны, только если для режима конфигурации задано значение **Custom**. |
| символа`<Expires>` | Задает время истечения срока действия подписки. `<Expires>` должен быть определен в стандартном формате даты и времени XML или ISO8601: `yyyy-MM-ddThh:mm:ss[.sss][Z]` , где *T* — это разделитель времени, а *Z* — время в формате UTC. |
| /q`<Query>` | Указывает строку запроса для подписки. Формат `<Query>` может отличаться для разных значений URI и применяется ко всем источникам в подписке. |
| Dia`<Dialect>` | Определяет диалект, используемый в строке запроса. |
| /TN`<Transportname>` | Указывает имя транспорта, используемого для подключения к удаленному источнику событий. |
| ТР`<Transportport>` | Задает номер порта, используемый транспортом при соединении с удаленным источником событий. |
| интеллектуальн`<Deliverymode>` | Указывает режим доставки. `<Deliverymode>` может принимать значение Pull или Push. Этот параметр допустим только в том случае, если для параметра **/cm** задано значение **Custom**. |
| интерфейса`<Deliverymax>` | Задает максимальное число элементов для пакетной доставки. Этот параметр допустим только в том случае, если для **/cm** задано значение **Custom**. |
| /дмлт:`<Deliverytime>` | Задает максимальную задержку при доставке пакета событий. `<Deliverytime>` число миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom. |
| Шина`<Heartbeat>` | Определяет интервал пульса. `<Heartbeat>` число миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение **Custom**. |
| CF`<Content>` | Задает формат возвращаемых событий. `<Content>` могут быть событиями или Рендередтекст. Если значение равно **рендередтекст**, то события возвращаются с локализованными строками (например, описание события), прикрепленными к событию. Значение по умолчанию — **рендередтекст**. |
| /l:`<Locale>` | Задает языковой стандарт для доставки локализованных строк в формате Рендередтекст. `<Locale>` — Это язык и идентификатор страны или региона, например EN-US. Этот параметр допустим только в том случае, если для параметра **/КФ** задано значение **рендередтекст**. |
| /ри: [ `<Readexist>` ] | Определяет события, которые доставляются для подписки. `<Readexist>` может иметь значение true или false. Если значение `<Readexist>` равно true, все существующие события считываются из источников событий подписки. Если значение `<Readexist>` равно false, доставляются только будущие (поступающие) события. Значение по умолчанию — **true** для параметра **/ри** без значения. Если параметр **/ри** не указан, по умолчанию используется значение **false**. |
| возврата`<Logfile>` | Указывает локальный журнал событий, который используется для хранения событий, полученных из источников событий. |
| PN`<Publishername>` | Указывает имя издателя. Он должен быть издателем, который владеет или импортирует журнал, указанный параметром **/ЛФ** . |
| /ессп:`<Enableport>` | Указывает, что номер порта должен быть добавлен к имени участника-службы удаленной службы. `<Enableport>` может иметь значение true или false. Номер порта добавляется, если `<Enableport>` имеет значение true. При добавлении номера порта может потребоваться выполнить некоторые настройки, чтобы предотвратить отказ в доступе к источникам событий. |
| HN`<Hostname>` | Указывает DNS-имя локального компьютера. Это имя используется удаленным источником событий для отправки событий назад и должно использоваться только для принудительной подписки. |
| компьютерной`<Type>` | Задает тип учетных данных для доступа к удаленному источнику. `<Type>` должно иметь одно из следующих значений: **Default**, **Negotiate**, **Digest**, **Basic** или **LocalMachine**. Значение по умолчанию — **Default**. |
| /Кун:`<Comusername>` | Задает учетные данные общего пользователя, используемые для источников событий, которые не имеют собственных учетных данных пользователя. Если этот параметр указан с параметром **/c** , параметры username и userpassword для отдельных источников событий из файла конфигурации игнорируются. Если вы хотите использовать разные учетные данные для определенного источника событий, следует переопределить это значение, указав параметры **/Ун** и **/up** для определенного источника события в командной строке другой команды **SS** . |
| чашк`<Compassword>` | Задает пароль пользователя для общих учетных данных пользователя. Если `<Compassword>` для задано значение * (звездочка), пароль считывается из консоли. Этот параметр допустим только в том случае, если указан параметр **/Кун** . |
| /q: [ `<Quiet>` ] | Указывает, запрашивает ли процедура конфигурации подтверждение. `<Quiet>` может иметь значение true или false. Если `<Quiet>` имеет значение true, процедура настройки не запрашивает подтверждение. Значение этого параметра по умолчанию равно **false**. |

## <a name="examples"></a>Примеры

Чтобы отобразить содержимое файла конфигурации, введите:

```XML
<Subscription xmlns=https://schemas.microsoft.com/2006/03/windows/events/subscription>
<Uri>https://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>
<!-- Use Normal (default), Custom, MinLatency, MinBandwidth -->
<ConfigurationMode>Normal</ConfigurationMode>
  <Description>Forward Sample Subscription</Description>
  <SubscriptionId>SampleSubscription</SubscriptionId>
  <Query><![CDATA[
    <QueryList>
      <Query Path=Application>
        <Select>*</Select>
      </Query>
    </QueryList>]]
  </Query>
<EventSources>
  <EventSource Enabled=true>
    <Address>mySource.myDomain.com</Address>
    <UserName>myUserName</UserName>
    <Password>*</Password>
  </EventSource>
</EventSources>
<CredentialsType>Default</CredentialsType>
<Locale Language=EN-US></Locale>
</Subscription>
```

Чтобы просмотреть сведения о конфигурации выходных данных для подписки с именем *Sub1*, введите:

```command
wecutil gs sub1
```

Выходные данные примера:

```output
EventSource[0]:
Address: localhost
Enabled: true
Description: Subscription 1
Uri: wsman:microsoft/logrecord/sel
DeliveryMode: pull
DeliveryMaxSize: 16000
DeliveryMaxItems: 15
DeliveryMaxLatencyTime: 1000
HeartbeatInterval: 10000
Locale:
ContentFormat: renderedtext
LogFile: HardwareEvents
```

Чтобы отобразить состояние выполнения подписки с именем Sub1, введите:

```command
wecutil gr sub1
```

Чтобы обновить конфигурацию подписки *Sub1* из нового XML-файла с именем *WsSelRg2.xml*, введите:

```command
wecutil ss sub1 /c:%Windir%system32WsSelRg2.xml
```

Чтобы обновить конфигурацию подписки с именем *sub2* и несколькими параметрами, введите:

```command
wecutil ss sub2 /esa:myComputer /ese /un:uname /up:* /cm:Normal
```

Чтобы удалить подписку с именем *Sub1*, введите:
```
wecutil ds sub1
```

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
