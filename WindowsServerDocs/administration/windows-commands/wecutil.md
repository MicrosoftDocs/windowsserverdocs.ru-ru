---
title: wecutil
description: 'Раздел Windows команды для ****- '
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 0c82a6cb-d652-429c-9c3d-0f568c78d54b
author: coreyp-at-msft
ms.author: coreyp
manager: dansimps
ms.openlocfilehash: 78005a715a0dbd20124bfb24be27586a8e153310
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71362187"
---
# <a name="wecutil"></a>wecutil



Позволяет создавать и администрировать подписки на события, пересылаемые с удаленных компьютеров. Удаленный компьютер должен поддерживать протокол WS-Management. В разделе [Примеры](#BKMK_examples) показан принцип использования этой команды.


## <a name="syntax"></a>Синтаксис

```
wecutil  [{es | enum-subscription}] 
[{gs | get-subscription} <Subid> [/f:<Format>] [/uni:<Unicode>]] 
[{gr | get-subscriptionruntimestatus} <Subid> [<Eventsource> …]] 
[{ss | set-subscription} [<Subid> [/e:[<Subenabled>]] [/esa:<Address>] [/ese:[<Srcenabled>]] [/aes] [/res] [/un:<Username>] [/up:<Password>] [/d:<Desc>] [/uri:<Uri>] [/cm:<Configmode>] [/ex:<Expires>] [/q:<Query>] [/dia:<Dialect>] [/tn:<Transportname>] [/tp:<Transportport>] [/dm:<Deliverymode>] [/dmi:<Deliverymax>] [/dmlt:<Deliverytime>] [/hi:<Heartbeat>] [/cf:<Content>] [/l:<Locale>] [/ree:[<Readexist>]] [/lf:<Logfile>] [/pn:<Publishername>] [/essp:<Enableport>] [/hn:<Hostname>] [/ct:<Type>]] [/c:<Configfile> [/cun:<Username> /cup:<Password>]]] 
[{cs | create-subscription} <Configfile> [/cun:<Username> /cup:<Password>]] 
[{ds | delete-subscription} <Subid>] 
[{rs | retry-subscription} <Subid> [<Eventsource>…]] 
[{qc | quick-config} [/q:[<Quiet>]]].
```

## <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------|-----------|
|{ES \| enum-Subscription}|Отображает имена всех существующих удаленных подписок на события.|
|{GS \| Get-Subscription} \<subid > [/f:\<формата >] [/уни:\<Юникод >]|Отображает сведения о конфигурации удаленной подписки. \<subid > — это строка, которая уникально идентифицирует подписку. \<subid > совпадает со строкой, указанной в теге \<SubscriptionId > в XML-файле конфигурации, который использовался для создания подписки.|
|{GR \| Get-субскриптионрунтиместатус} \<subid > [\<EventSource >...]|Отображает состояние выполнения подписки. \<subid > — это строка, которая уникально идентифицирует подписку. \<subid > совпадает со строкой, указанной в теге \<SubscriptionId > в XML-файле конфигурации, который использовался для создания подписки. \<EventSource > — это строка, идентифицирующая компьютер, который выступает в качестве источника событий. \<EventSource > должно быть полным доменным именем, именем NetBIOS или IP-адресом.|
|{SS \| Set-Subscription} \<subid > [/e: [\<подактивированные >]] [/ЕСА:\<адрес >] [/ЕСЕ: [\<Срценаблед >]] [/АЕС] [/RES] [/Ун:\<имя_пользователя >] [/Up:\<password >] [/d:\<DESC >] [/Ури:\<URI >] [/cm:\<Конфигмоде >] [/ЕКС:\<истекает >] [/q:\<query >] [/Диа:\<диалекта >] [/TN:\<транспорта >] [/TP:\<Транспортпорт >] [/дм :\<Деливеримоде >] [/ДМИ:\<Деливеримакс >] [/дмлт:\<Деливеритиме >] [/Хи:\<пульс >] [/КФ:\<содержимого >] [/l:\<locale >] [/ри: [\<Реадексист >]] [/ЛФ:\<файл_журнала >] [/Пн:\<PublisherName >] [/ессп:\<Енаблепорт >] [/HN:\<имя узла >] [/CT:\<типа >]</br>или</br>{SS \| Set-Subscription/c:\<ConfigFile > [/кун:\<Комусернаме >/КУП:\<Компассворд >]|Изменяет конфигурацию подписки. Можно указать идентификатор подписки и соответствующие параметры для изменения параметров подписки. также можно указать XML-файл конфигурации для изменения параметров подписки.|
|{CS \| Create-Subscription} \<ConfigFile > [/кун:\<имя_пользователя >/КУП:\<пароль >]|Создает удаленную подписку. \<ConfigFile > указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога.|
|{DS \| удалить подписку} \<subid >|Удаляет подписку и отменяет подписку на все источники событий, которые доставляют события в журнал событий для подписки. Все события, которые уже получены и записаны в журнал, не удаляются. \<subid > — это строка, которая уникально идентифицирует подписку. \<subid > совпадает со строкой, указанной в теге \<SubscriptionId > в XML-файле конфигурации, который использовался для создания подписки.|
|{RS \| Retry-Subscription} \<subid > [\<EventSource >...]|Повторяет попытку установить соединение и отправить запрос на удаленную подписку неактивной подписке. Пытается повторно активировать все источники событий или указанные источники событий. Отключенные источники не повторяются повторно. \<subid > — это строка, которая уникально идентифицирует подписку. \<subid > совпадает со строкой, указанной в теге \<SubscriptionId > в XML-файле конфигурации, который использовался для создания подписки. \<EventSource > — это строка, идентифицирующая компьютер, который выступает в качестве источника событий. \<EventSource > должно быть полным доменным именем, именем NetBIOS или IP-адресом.|
|{QC \| Quick-Config} [/q: [\<quiet >]]|Настраивает службу сборщика событий Windows, чтобы обеспечить возможность создания и поддержания подписки с помощью перезагрузки. Это включает следующие шаги:</br>1. Включите канал ForwardedEvents, если он отключен.</br>2. Задайте для службы сборщика событий Windows отложенное начало.</br>3. Запустите службу сборщика событий Windows, если она не запущена.|

## <a name="options"></a>Параметры

|Параметр|Описание|
|------|-----------|
|/f: формат\<>|Задает формат отображаемых сведений. Формат \<> может быть XML или сжат. Если <Format> имеет формат XML, выходные данные отображаются в формате XML. Если формат \<> сжат, выходные данные отображаются в парах "имя-значение". Значение по умолчанию — сжатый.|
|/c:\<> ConfigFile|Указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога. Этот параметр можно использовать только с параметрами **/Кун** и **/КУП** и является взаимоисключающим со всеми другими параметрами.|
|/e: [\<, включенные >]|Включает или отключает подписку. \<включенные > могут иметь значение true или false. Значение этого параметра по умолчанию — true.|
|/ЕСА:\<адрес >|Указывает адрес источника события. \<address > — это строка, которая содержит полное доменное имя, NetBIOS-имя или адрес IP, определяющее компьютер, который служит источником событий. Этот параметр следует использовать с параметрами **/ЕСЕ**, **/АЕС**, **/RES**или **/Ун** и **/up** .|
|/ЕСЕ: [\<Срценаблед >]|Включает или отключает источник события. \<Срценаблед > может иметь значение true или false. Этот параметр разрешается, только если указан параметр **/ЕСА** . Значение этого параметра по умолчанию — true.|
|/аес|Добавляет источник событий, указанный параметром **/ЕСА** , если он еще не является частью подписки. Если адрес, указанный параметром **/ЕСА** , уже является частью подписки, то выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/RES|Удаляет источник событий, указанный параметром **/ЕСА** , если он уже является частью подписки. Если адрес, указанный параметром **/ЕСА** , не является частью подписки, выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/Ун:\<имя пользователя >|Указывает учетные данные пользователя для использования с источником событий, указанным параметром **/ЕСА** . Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/Up:\<пароль >|Указывает пароль, соответствующий учетным данным пользователя. Этот параметр разрешен только в том случае, если указан параметр **/Ун** .|
|/d:\<DESC >|Содержит описание подписки.|
|/Ури:\<URI >|Указывает тип событий, используемых подпиской. \<> URI содержит строку URI, которая объединяется с адресом исходного компьютера события для уникальной идентификации источника событий. Строка URI используется для всех адресов источников событий в подписке.|
|/CM:\<Конфигмоде >|Задает режим конфигурации. \<Конфигмоде > может быть одной из следующих строк: обычная, Custom, Минлатенци или MinBandwidth. Режимы "Стандартный", "Минлатенци" и "MinBandwidth" устанавливают режим доставки, максимальное количество элементов доставки, интервал пульса и максимальное время задержки доставки. Параметры **/ДМ**, **/ДМИ**, **/Хи** или **/дмлт** могут быть указаны, только если для режима конфигурации задано значение Custom.|
|/ЕКС: срок действия\<истекает >|Задает время истечения срока действия подписки. \<срок действия > должен быть определен в стандартном формате XML или ISO8601: гггг-мм-ddThh: mm: SS [. SSS] [Z], где T — это разделитель времени, а Z — время в формате UTC.|
|/q:\<запрос >|Указывает строку запроса для подписки. Формат \<запроса > может отличаться для разных значений URI и применяется ко всем источникам в подписке.|
|/Диа:\<диалект >|Определяет диалект, используемый в строке запроса.|
|/TN:\<транспорта >|Указывает имя транспорта, используемого для подключения к удаленному источнику событий.|
|/TP:\<Транспортпорт >|Задает номер порта, используемый транспортом при соединении с удаленным источником событий.|
|/дм:\<Деливеримоде >|Указывает режим доставки. \<Деливеримоде > может быть либо Pull, либо Push. Этот параметр допустим только в том случае, если для параметра **/cm** задано значение Custom.|
|/Дми:\<Деливеримакс >|Задает максимальное число элементов для пакетной доставки. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/дмлт:\<Деливеритиме >|Задает максимальную задержку при доставке пакета событий. \<Деливеритиме > — число миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/Хи: > пульса\<|Определяет интервал пульса. \<пульса > — число миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/КФ:\<> содержимого|Задает формат возвращаемых событий. \<> содержимого могут быть событиями или Рендередтекст. Если значение равно Рендередтекст, то события возвращаются с локализованными строками (например, описание события), прикрепленными к событию. Значение по умолчанию — Рендередтекст.|
|/l:\<языковой стандарт >|Задает языковой стандарт для доставки локализованных строк в формате Рендередтекст. \<языковой стандарт > — это язык и идентификатор страны или региона, например "EN-US". Этот параметр допустим только в том случае, если для параметра **/КФ** задано значение рендередтекст.|
|/ри: [\<Реадексист >]|Определяет события, которые доставляются для подписки. \<Реадексист > может иметь значение true или false. Если <Readexist> имеет значение true, все существующие события считываются из источников событий подписки. Если <Readexist> имеет значение false, доставляются только будущие (поступающие) события. Значение по умолчанию — true для параметра **/ри** без значения. Если параметр **/ри** не указан, по умолчанию используется значение false.|
|/ЛФ:\<файл журнала >|Указывает локальный журнал событий, который используется для хранения событий, полученных из источников событий.|
|/Пн:\<PublisherName >|Указывает имя издателя. Он должен быть издателем, который владеет или импортирует журнал, указанный параметром **/ЛФ** .|
|/ессп:\<Енаблепорт >|Указывает, что номер порта должен быть добавлен к имени участника-службы удаленной службы. \<Енаблепорт > может иметь значение true или false. Номер порта добавляется, если <Enableport> имеет значение true. При добавлении номера порта может потребоваться выполнить некоторые настройки, чтобы предотвратить отказ в доступе к источникам событий.|
|/ХН:\<имя узла >|Указывает DNS-имя локального компьютера. Это имя используется удаленным источником событий для отправки событий назад и должно использоваться только для принудительной подписки.|
|/КТ: тип\<>|Задает тип учетных данных для доступа к удаленному источнику. Тип \<> должен иметь одно из следующих значений: по умолчанию, Negotiate, дайджест, Basic или LocalMachine. Значение по умолчанию — Default.|
|/Кун:\<Комусернаме >|Задает учетные данные общего пользователя, используемые для источников событий, которые не имеют собственных учетных данных пользователя. Если этот параметр указан с параметром **/c** , параметры username и userpassword для отдельных источников событий из файла конфигурации игнорируются. Если вы хотите использовать разные учетные данные для определенного источника событий, следует переопределить это значение, указав параметры **/Ун** и **/up** для определенного источника события в командной строке другой команды **SS** .|
|/КУП:\<Компассворд >|Задает пароль пользователя для общих учетных данных пользователя. Если \<Компассворд > имеет значение * (звездочка), пароль считывается из консоли. Этот параметр допустим только в том случае, если указан параметр **/Кун** .|
|/q: [\<quiet >]|Указывает, запрашивает ли процедура конфигурации подтверждение. \<тихий > может иметь значение true или false. Если <Quiet> имеет значение true, процедура настройки не запрашивает подтверждение. Значение этого параметра по умолчанию равно false.|

## <a name="remarks"></a>Замечания

> [!IMPORTANT]
> Если появится сообщение "сервер RPC недоступен?" При попытке запустить wecutil необходимо запустить службу сборщика событий Windows (вексвк). Чтобы запустить вексвк, в командной строке с повышенными привилегиями введите net start вексвк.

- В следующем примере показано содержимое файла конфигурации:  
  ```
  <Subscription xmlns="https://schemas.microsoft.com/2006/03/windows/events/subscription">
  <Uri>https://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>
  <!-- Use Normal (default), Custom, MinLatency, MinBandwidth -->
  <ConfigurationMode>Normal</ConfigurationMode>
  <Description>Forward Sample Subscription</Description>
  <SubscriptionId>SampleSubscription</SubscriptionId>
  <Query><![CDATA[
  <QueryList>
  <Query Path="Application">
  <Select>*</Select>
  </Query>
  </QueryList>
  ]]></Query>
  <EventSources>
  <EventSource Enabled="true">
  <Address>mySource.myDomain.com</Address>
  <UserName>myUserName</UserName>
  <Password>*</Password>
  </EventSource>
  </EventSources>
  <CredentialsType>Default</CredentialsType>
  <Locale Language="EN-US"></Locale>
  </Subscription>
  ```

## <a name="BKMK_examples"></a>Примеров

Выходные данные конфигурации для подписки с именем Sub1:
```
wecutil gs sub1
```
Пример вывода команды:
```
EventSource[0]:
Address: localhost
Enabled: true
Description: Subscription 1
Uri: wsman:microsoft/logrecord/sel
DeliveryMode: pull
DeliveryMaxSize: 16000
DeliveryMaxItems: 15
DeliveryMaxLatencyTime: 1000
HeartbeatInterval: 10000
Locale:
ContentFormat: renderedtext
LogFile: HardwareEvents
```
Отображение состояния среды выполнения подписки с именем Sub1:
```
wecutil gr sub1
```
Обновите конфигурацию подписки Sub1 из нового XML-файла с именем WsSelRg2. XML:
```
wecutil ss sub1 /c:%Windir%\system32\WsSelRg2.xml
```
Обновите конфигурацию подписки с именем sub2, указав несколько параметров:
```
wecutil ss sub2 /esa:myComputer /ese /un:uname /up:* /cm:Normal
```
Создайте подписку для перенаправления событий из журнала событий приложений Windows Vista на удаленном компьютере по адресу mySource.myDomain.com в журнал ForwardedEvents (см. раздел Примечания для примера файла конфигурации):
```
wecutil cs subscription.xml
```
Удалите подписку с именем Sub1:
```
wecutil ds sub1
```

#### <a name="additional-references"></a>Дополнительная справка

[Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
