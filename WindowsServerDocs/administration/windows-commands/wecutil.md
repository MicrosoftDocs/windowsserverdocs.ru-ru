---
title: wecutil
description: Справочный раздел для wecutil, который позволяет создавать и администрировать подписки на события, пересылаемые с удаленных компьютеров.
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 0c82a6cb-d652-429c-9c3d-0f568c78d54b
author: coreyp-at-msft
ms.author: coreyp
manager: dansimps
ms.openlocfilehash: 6c62d3ce24f539b4176acd6193cbd956ecbf5471
ms.sourcegitcommit: ab64dc83fca28039416c26226815502d0193500c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/01/2020
ms.locfileid: "82725862"
---
# <a name="wecutil"></a>wecutil



Позволяет создавать и администрировать подписки на события, пересылаемые с удаленных компьютеров. Удаленный компьютер должен поддерживать протокол WS-Management. 


## <a name="syntax"></a>Синтаксис

```
wecutil  [{es | enum-subscription}] 
[{gs | get-subscription} <Subid> [/f:<Format>] [/uni:<Unicode>]] 
[{gr | get-subscriptionruntimestatus} <Subid> [<Eventsource> …]] 
[{ss | set-subscription} [<Subid> [/e:[<Subenabled>]] [/esa:<Address>] [/ese:[<Srcenabled>]] [/aes] [/res] [/un:<Username>] [/up:<Password>] [/d:<Desc>] [/uri:<Uri>] [/cm:<Configmode>] [/ex:<Expires>] [/q:<Query>] [/dia:<Dialect>] [/tn:<Transportname>] [/tp:<Transportport>] [/dm:<Deliverymode>] [/dmi:<Deliverymax>] [/dmlt:<Deliverytime>] [/hi:<Heartbeat>] [/cf:<Content>] [/l:<Locale>] [/ree:[<Readexist>]] [/lf:<Logfile>] [/pn:<Publishername>] [/essp:<Enableport>] [/hn:<Hostname>] [/ct:<Type>]] [/c:<Configfile> [/cun:<Username> /cup:<Password>]]] 
[{cs | create-subscription} <Configfile> [/cun:<Username> /cup:<Password>]] 
[{ds | delete-subscription} <Subid>] 
[{rs | retry-subscription} <Subid> [<Eventsource>…]] 
[{qc | quick-config} [/q:[<Quiet>]]].
```

### <a name="parameters"></a>Параметры

|Параметр|Описание:|
|---------|-----------|
|{ES \| enum-Subscription}|Отображает имена всех существующих удаленных подписок на события.|
|{GS \| Get-Subscription} \<Subid> [/F:\<Format>] [/уни:\<Юникод>]|Отображает сведения о конфигурации удаленной подписки. \<Subid> — это строка, которая уникально идентифицирует подписку. \<Subid> совпадает со строкой, указанной в теге \<SubscriptionId> в XML-файле конфигурации, который использовался для создания подписки.|
|{GR \| Get-субскриптионрунтиместатус} \<Subid> [\<EventSource>...]|Отображает состояние выполнения подписки. \<Subid> — это строка, которая уникально идентифицирует подписку. \<Subid> совпадает со строкой, указанной в теге \<SubscriptionId> в XML-файле конфигурации, который использовался для создания подписки. \<EventSource> — это строка, идентифицирующая компьютер, который выступает в качестве источника событий. \<EventSource> должен быть полным доменным именем, именем NetBIOS или IP-адресом.|
|{SS \| Set-Subscription} \<Subid> [/e: [\<подактивировано>]] [/ЕСА:\<Address>] [/ЕСЕ: [\<срценаблед>]] [/АЕС] [/RES] [/Ун:\<имя_пользователя>] [/Up:\<Password>] [/d:\<DESC>] [/Ури:\<URI>] [/cm:\<конфигмоде>] [/ЕКС:\<Expires>] [\</Q:\<\</Диа>] [транспорта::\<транспортпорт>] [/дм:\<деливеримоде>] [/ДМИ:\<Deliverymax>] [/dmlt:\<Deliverytime>] [/HI:\<пульс>] [/CF:\<Content>] [/l:\<locale>] [/Ree: [\<Readexist>]] [/LF:\<файл_журнала>] [/PN:\<PublisherName>] [/ESSP:\<Enableport>] [/HN:\<имя_узла>] [/CT:\<Type>]</br>or</br>{SS \| Set-Subscription/C:\<ConfigFile> [/кун:\<комусернаме>/КУП:\<компассворд>]|Изменяет конфигурацию подписки. Можно указать идентификатор подписки и соответствующие параметры для изменения параметров подписки. также можно указать XML-файл конфигурации для изменения параметров подписки.|
|{CS \| Create-Subscription} \<ConfigFile> [/кун:\<имя_пользователя>/КУП:\<Password>]|Создает удаленную подписку. \<ConfigFile> указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога.|
|{DS \| Delete-Subscription} \<Subid>|Удаляет подписку и отменяет подписку на все источники событий, которые доставляют события в журнал событий для подписки. Все события, которые уже получены и записаны в журнал, не удаляются. \<Subid> — это строка, которая уникально идентифицирует подписку. \<Subid> совпадает со строкой, указанной в теге \<SubscriptionId> в XML-файле конфигурации, который использовался для создания подписки.|
|{RS \| Retry-Subscription} \<Subid> [\<EventSource>...]|Повторяет попытку установить соединение и отправить запрос на удаленную подписку неактивной подписке. Пытается повторно активировать все источники событий или указанные источники событий. Отключенные источники не повторяются повторно. \<Subid> — это строка, которая уникально идентифицирует подписку. \<Subid> совпадает со строкой, указанной в теге \<SubscriptionId> в XML-файле конфигурации, который использовался для создания подписки. \<EventSource> — это строка, идентифицирующая компьютер, который выступает в качестве источника событий. \<EventSource> должен быть полным доменным именем, именем NetBIOS или IP-адресом.|
|{QC \| Quick-Config} [/q: [\<quiet>]]|Настраивает службу сборщика событий Windows, чтобы обеспечить возможность создания и поддержания подписки с помощью перезагрузки. Это включает следующие шаги:</br>1. Включите канал ForwardedEvents, если он отключен.</br>2. Задайте для службы сборщика событий Windows отложенное начало.</br>3. Запустите службу сборщика событий Windows, если она не запущена.|

## <a name="options"></a>Параметры

|Параметр|Описание|
|------|-----------|
|/f:\<форматирование>|Задает формат отображаемых сведений. \<Формат> может быть XML или сжат. Если <Format> параметр имеет значение XML, выходные данные отображаются в формате XML. Если \<формат> сжат, выходные данные отображаются в парах «имя-значение». Значение по умолчанию — сжатый.|
|/c:\<ConfigFile>|Указывает путь к XML-файлу, содержащему конфигурацию подписки. Путь может быть абсолютным или относительным для текущего каталога. Этот параметр можно использовать только с параметрами **/Кун** и **/КУП** и является взаимоисключающим со всеми другими параметрами.|
|/e: [\<включено>]|Включает или отключает подписку. \<Подвключенные> могут иметь значение true или false. Значение этого параметра по умолчанию — true.|
|/ЕСА:\<адрес>|Указывает адрес источника события. \<Address> — это строка, которая содержит полное доменное имя, NetBIOS-имя или адрес IP, определяющие компьютер, который служит источником событий. Этот параметр следует использовать с параметрами **/ЕСЕ**, **/АЕС**, **/RES**или **/Ун** и **/up** .|
|/ЕСЕ: [\<срценаблед>]|Включает или отключает источник события. \<Срценаблед> может иметь значение true или false. Этот параметр разрешается, только если указан параметр **/ЕСА** . Значение этого параметра по умолчанию — true.|
|/аес|Добавляет источник событий, указанный параметром **/ЕСА** , если он еще не является частью подписки. Если адрес, указанный параметром **/ЕСА** , уже является частью подписки, то выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/RES|Удаляет источник событий, указанный параметром **/ЕСА** , если он уже является частью подписки. Если адрес, указанный параметром **/ЕСА** , не является частью подписки, выводится сообщение об ошибке. Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/Ун:\<имя пользователя>|Указывает учетные данные пользователя для использования с источником событий, указанным параметром **/ЕСА** . Этот параметр разрешен только в том случае, если указан параметр **/ЕСА** .|
|/Up:\<пароль>|Указывает пароль, соответствующий учетным данным пользователя. Этот параметр разрешен только в том случае, если указан параметр **/Ун** .|
|/d:\<DESC>|Содержит описание подписки.|
|/Ури:\<URI>|Указывает тип событий, используемых подпиской. \<> URI содержит строку URI, которая объединяется с адресом исходного компьютера события для уникальной идентификации источника событий. Строка URI используется для всех адресов источников событий в подписке.|
|/CM:\<конфигмоде>|Задает режим конфигурации. \<Конфигмоде> может быть одной из следующих строк: обычная, Custom, Минлатенци или MinBandwidth. Режимы "Стандартный", "Минлатенци" и "MinBandwidth" устанавливают режим доставки, максимальное количество элементов доставки, интервал пульса и максимальное время задержки доставки. Параметры **/ДМ**, **/ДМИ**, **/Хи** или **/дмлт** могут быть указаны, только если для режима конфигурации задано значение Custom.|
|/ЕКС:\<срок действия истекает>|Задает время истечения срока действия подписки. \<Срок действия> должен быть определен в стандартном формате XML или ISO8601: YYYY-MM-ddThh: mm: SS [. SSS] [Z], где T — это разделитель времени, а Z — время в формате UTC.|
|/q:\<> запроса|Указывает строку запроса для подписки. Формат> \<запросов может отличаться для разных значений URI и применяется ко всем источникам в подписке.|
|/Диа:\<диалект>|Определяет диалект, используемый в строке запроса.|
|/TN:\<транспорта>|Указывает имя транспорта, используемого для подключения к удаленному источнику событий.|
|/TP:\<транспортпорт>|Задает номер порта, используемый транспортом при соединении с удаленным источником событий.|
|/дм:\<деливеримоде>|Указывает режим доставки. \<Деливеримоде> может быть либо Pull, либо Push. Этот параметр допустим только в том случае, если для параметра **/cm** задано значение Custom.|
|/Дми:\<деливеримакс>|Задает максимальное число элементов для пакетной доставки. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/дмлт:\<деливеритиме>|Задает максимальную задержку при доставке пакета событий. \<Деливеритиме> — это количество миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/Хи:\<пульс>|Определяет интервал пульса. \<> пульса — это количество миллисекунд. Этот параметр допустим только в том случае, если для **/cm** задано значение Custom.|
|/КФ:\<содержимое>|Задает формат возвращаемых событий. \<> содержимого могут быть событиями или Рендередтекст. Если значение равно Рендередтекст, то события возвращаются с локализованными строками (например, описание события), прикрепленными к событию. Значение по умолчанию — Рендередтекст.|
|/l:\<> языкового стандарта|Задает языковой стандарт для доставки локализованных строк в формате Рендередтекст. \<Языковой стандарт> — это язык и идентификатор страны или региона, например EN-US. Этот параметр допустим только в том случае, если для параметра **/КФ** задано значение рендередтекст.|
|/ри: [\<реадексист>]|Определяет события, которые доставляются для подписки. \<Реадексист> может иметь значение true или false. Если значение <Readexist> равно true, все существующие события считываются из источников событий подписки. Если значение <Readexist> равно false, доставляются только будущие (поступающие) события. Значение по умолчанию — true для параметра **/ри** без значения. Если параметр **/ри** не указан, по умолчанию используется значение false.|
|/ЛФ:\<файл журнала>|Указывает локальный журнал событий, который используется для хранения событий, полученных из источников событий.|
|/Пн:\<PublisherName>|Указывает имя издателя. Он должен быть издателем, который владеет или импортирует журнал, указанный параметром **/ЛФ** .|
|/ессп:\<енаблепорт>|Указывает, что номер порта должен быть добавлен к имени участника-службы удаленной службы. \<Енаблепорт> может иметь значение true или false. Номер порта добавляется, если <Enableport> имеет значение true. При добавлении номера порта может потребоваться выполнить некоторые настройки, чтобы предотвратить отказ в доступе к источникам событий.|
|/ХН:\<имя узла>|Указывает DNS-имя локального компьютера. Это имя используется удаленным источником событий для отправки событий назад и должно использоваться только для принудительной подписки.|
|/КТ:\<тип>|Задает тип учетных данных для доступа к удаленному источнику. \<Тип> должен быть одним из следующих: по умолчанию, Negotiate, дайджест, Basic или LocalMachine. Значение по умолчанию — Default.|
|/Кун:\<комусернаме>|Задает учетные данные общего пользователя, используемые для источников событий, которые не имеют собственных учетных данных пользователя. Если этот параметр указан с параметром **/c** , параметры username и userpassword для отдельных источников событий из файла конфигурации игнорируются. Если вы хотите использовать разные учетные данные для определенного источника событий, следует переопределить это значение, указав параметры **/Ун** и **/up** для определенного источника события в командной строке другой команды **SS** .|
|/КУП:\<компассворд>|Задает пароль пользователя для общих учетных данных пользователя. Если \<для параметра компассворд> задано значение * (звездочка), пароль считывается из консоли. Этот параметр допустим только в том случае, если указан параметр **/Кун** .|
|/q: [\<quiet>]|Указывает, запрашивает ли процедура конфигурации подтверждение. \<Тихий> может иметь значение true или false. Если <Quiet> имеет значение true, процедура настройки не запрашивает подтверждение. Значение этого параметра по умолчанию равно false.|

## <a name="remarks"></a>Примечания

> [!IMPORTANT]
> Если появится сообщение "сервер RPC недоступен?" При попытке запустить wecutil необходимо запустить службу сборщика событий Windows (вексвк). Чтобы запустить вексвк, в командной строке с повышенными привилегиями введите net start вексвк.

- Чтобы показать содержимое файла конфигурации, выполните следующие действия.  
  ```
  <Subscription xmlns=https://schemas.microsoft.com/2006/03/windows/events/subscription>
  <Uri>https://schemas.microsoft.com/wbem/wsman/1/windows/EventLog</Uri>
  <!-- Use Normal (default), Custom, MinLatency, MinBandwidth -->
  <ConfigurationMode>Normal</ConfigurationMode>
  <Description>Forward Sample Subscription</Description>
  <SubscriptionId>SampleSubscription</SubscriptionId>
  <Query><![CDATA[
  <QueryList>
  <Query Path=Application>
  <Select>*</Select>
  </Query>
  </QueryList>
  ]]></Query>
  <EventSources>
  <EventSource Enabled=true>
  <Address>mySource.myDomain.com</Address>
  <UserName>myUserName</UserName>
  <Password>*</Password>
  </EventSource>
  </EventSources>
  <CredentialsType>Default</CredentialsType>
  <Locale Language=EN-US></Locale>
  </Subscription>
  ```

## <a name="examples"></a>Примеры

Выходные данные конфигурации для подписки с именем Sub1:
```
wecutil gs sub1
```
Выходные данные примера:
```
EventSource[0]:
Address: localhost
Enabled: true
Description: Subscription 1
Uri: wsman:microsoft/logrecord/sel
DeliveryMode: pull
DeliveryMaxSize: 16000
DeliveryMaxItems: 15
DeliveryMaxLatencyTime: 1000
HeartbeatInterval: 10000
Locale:
ContentFormat: renderedtext
LogFile: HardwareEvents
```
Отображение состояния среды выполнения подписки с именем Sub1:
```
wecutil gr sub1
```
Обновите конфигурацию подписки Sub1 из нового XML-файла с именем WsSelRg2. XML:
```
wecutil ss sub1 /c:%Windir%\system32\WsSelRg2.xml
```
Обновите конфигурацию подписки с именем sub2, указав несколько параметров:
```
wecutil ss sub2 /esa:myComputer /ese /un:uname /up:* /cm:Normal
```
Создайте подписку для перенаправления событий из журнала событий приложений Windows Vista на удаленном компьютере по адресу mySource.myDomain.com в журнал ForwardedEvents (см. раздел Примечания для примера файла конфигурации):
```
wecutil cs subscription.xml
```
Удалите подписку с именем Sub1:
```
wecutil ds sub1
```

## <a name="additional-references"></a>Дополнительные ссылки

- [Условные обозначения синтаксиса команд командной строки](command-line-syntax-key.md)
