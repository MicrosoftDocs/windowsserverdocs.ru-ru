---
title: ktpass
description: 'Раздел Windows команды для ***- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 47087676-311e-41f1-8414-199740d01444
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 7a865b94bbbf2245e8a2e07638064f66de920b90
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59886675"
---
# <a name="ktpass"></a>ktpass

>Область применения. Windows Server (полугодовой канал), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Настраивает имя субъекта-сервера для узла или службы в active directory доменные службы (AD DS) и создает файл .keytab, который содержит общий секретный ключ службы. Файл .keytab основан на реализации Массачусетского технологического института (MIT) проверки подлинности Kerberos. Средство командной строки ktpass позволяет служб отличных от Windows, которые поддерживают проверку подлинности Kerberos для использования возможностей взаимодействия, предоставляемых службой центра распространения ключей Kerberos (KDC). Этот раздел относится к версии операционных систем, указанных в **применяется к** списка в начале этого раздела.  
  
## <a name="syntax"></a>Синтаксис  
```  
ktpass  
[/out <FileName>]   
[/princ <PrincipalName>]   
[/mapuser <UserAccount>]   
[/mapop {add|set}] [{-|+}desonly] [/in <FileName>]  
[/pass {Password|*|{-|+}rndpass}]  
[/minpass]  
[/maxpass]  
[/crypto {DES-CBC-CRC|DES-CBC-MD5|RC4-HMAC-NT|AES256-SHA1|AES128-SHA1|All}]  
[/itercount]  
[/ptype {KRB5_NT_PRINCIPAL|KRB5_NT_SRV_INST|KRB5_NT_SRV_HST}]  
[/kvno <KeyversionNum>]  
[/answer {-|+}]  
[/target]  
[/rawsalt] [{-|+}dumpsalt] [{-|+}setupn] [{-|+}setpass <Password>]  [/?|/h|/help]  
```  
## <a name="parameters"></a>Параметры  
|Параметр|Описание|  
|-------|--------|  
|/ out <FileName>|Задает имя создаваемого Kerberos версии 5 .keytab файла. **Примечание.** Это файл .keytab, перенести на компьютер, на котором не выполняется ОС Windows, и затем заменить или слияния с помощью существующего файла .keytab, /Etc/Krb5.keytab.|  
|/princ <PrincipalName>|Указывает имя участника в форме host/computer.contoso.com@CONTOSO.COM. **Предупреждение:** Этот параметр учитывается регистр символов. См. в разделе ["Примечания"](#BKMK_remarks) Дополнительные сведения.|  
|/mapuser <UserAccount>|Сопоставляет имя участника Kerberos, который задается путем **princ** параметр, для указанной учетной записи домена.|  
|/mapop {добавить&#124;задать}|Указывает, как задается атрибут сопоставления.<br /><br />-   **Добавление** добавляет значение имени указанного локального пользователя. Это значение используется по умолчанию.<br />-   **Задайте** задает значение для данных шифрования стандарт DES-шифрование только для указанного локального имени пользователя.|  
|{-&#124;+}desonly|По умолчанию имеет значение только для DES-шифрование.<br /><br />-   **+** Задает учетную запись для шифрования только для DES.<br />-   **-** Ограничение учетной записи для шифрования DES-только для выпусков. **ВАЖНО:** Начиная с Windows 7 и Windows Server 2008 R2, Windows не поддерживает DES по умолчанию.|  
|/in <FileName>|Указывает файл .keytab для чтения с главного компьютера, на котором не выполняется операционная система Windows.|  
|/pass {Password&#124;*&#124;{-&#124;+}rndpass}|Указывает пароль для имени участника-пользователя, который задается параметром **princ** параметра. Используйте «*» для запроса пароля.|  
|/minpass|Задает минимальную длину случайный пароль до 15 символов.|  
|/maxpass|Задает максимальную длину случайный пароль длиной в 256 символов.|  
|/crypto {DES-CBC-CRC&#124;DES-CBC-MD5&#124;RC4-HMAC-NT&#124;AES256-SHA1&#124;AES128-SHA1&#124;All}|Задает ключи, созданные в файле keytab:<br /><br />-   **DES-CBC-CRC** используется для обеспечения совместимости.<br />-   **DES-CBC-MD5** более точно соответствует реализации MIT и используется для обеспечения совместимости.<br />-   **Версия-кандидат 4-HMAC-NT** использует 128-разрядное шифрование.<br />-   **AES256-SHA1** применяется шифрование AES256-CTS-HMAC-SHA1-96.<br />-   **AES128 SHA1** применяется шифрование AES128-CTS-HMAC-SHA1-96.<br />-   **Все** состояний, что все поддерживаемые типы шифрования можно использовать. **Примечание.** Параметры по умолчанию основаны на более старых версий MIT. Таким образом `/crypto` всегда должен быть указан.|  
|/itercount|Указывает число итераций, который используется для шифрования AES. По умолчанию используется, **itercount** пропускается для-AES шифрованием и составляет 4 096 для шифрования AES.|  
|/ptype {KRB5_NT_PRINCIPAL&#124;KRB5_NT_SRV_INST&#124;KRB5_NT_SRV_HST}|Задает тип участника.<br /><br />-   **KRB5_NT_PRINCIPAL** является общим видом участника (рекомендуется).<br />-   **KRB5_NT_SRV_INST** является пользовательский экземпляр службы.<br />-   **KRB5_NT_SRV_HST** является экземпляр узла службы.|  
|/kvno <KeyversionNum>|Указывает номер версии ключа. Значение по умолчанию — 1.|  
|/answer {-&#124;+}|Устанавливает режим фона ответов:<br /><br />**-** Ответы сброса пароля автоматически с помощью "Нет".<br /><br />**+** Ответы сброса пароля автоматически с помощью Да.|  
|/ target|Задает, какой контроллер домена для использования. По умолчанию используется для контроллера домена, чтобы было обнаружено, на основе имени субъекта. Если не разрешить имя контроллера домена, диалоговое окно запросит действующему контроллеру домена.|  
|/rawsalt|заставляет ktpass используемый алгоритм rawsalt, во время создания ключа. Этот параметр не требуется.|  
|{-&#124;+} dumpsalt|Для этого параметра выходные данные MIT salt алгоритм, который используется для создания ключа.|  
|{-&#124;+}setupn|Задает имя участника-пользователя (UPN) в дополнение к имени участника-службы (SPN). По умолчанию используется для того, и в файле .keytab.|  
|{-&#124;+}setpass <Password>|Задает пароль пользователя, когда задан. Если используется rndpass, будет создан случайный пароль.|  
|/? &#124;/h&#124;/help|Командной строки отображает справку по ktpass.|  
## <a name="BKMK_remarks"></a>"Примечания"  
Можно настроить службы, работающие в системах, работающих не под управлением операционной системы Windows с учетными записями экземпляра службы в доменных службах active directory. Это позволяет любому клиенту проверку подлинности в службах, работающих не под управлением операционной системы Windows с помощью Windows KDC Kerberos.  
Параметр /princ не принимается во внимание ktpass и используется, как указано. Не проверяется, соответствует ли параметр точный регистр **userPrincipalName** значение атрибута при создании файла Keytab. С учетом регистра дистрибутивов Kerberos, с помощью этого файла Keytab могут возникнуть проблемы, если имеется точное совпадение регистра и может привести к сбою во время предварительной проверки подлинности. Проверьте и получите правильный **userPrincipalName** значение атрибута из файла экспорта LDifDE. Пример:  
```  
ldifde /f keytab_user.ldf /d "CN=Keytab User,OU=UserAccounts,DC=contoso,DC=corp,DC=microsoft,DC=com" /p base /l samaccountname,userprincipalname  
```  
## <a name="BKMK_examples"></a>Примеры  
В следующем примере для создания файла .keytab Kerberos, machine.keytab, в текущем каталоге Sample1 пользователя. (Объединит этот файл с файлом Krb5.keytab на главном компьютере, на котором не выполняется операционная система Windows.) Для всех поддерживаемых типах шифрования для общего типа субъекта будет создаваться файл .keytab Kerberos.  
Чтобы создать файл .keytab для главного компьютера, на котором не выполняется операционная система Windows, следуйте инструкциям ниже для сопоставления участника для учетной записи и задать пароль участника узла:  
1.  Использование active directory пользователей и компьютеров – – оснастка для создания учетной записи пользователя для службы на компьютере, на котором не выполняется операционная система Windows. Например создайте учетную запись с именем Sample1.  
2.  Чтобы настроить сопоставление удостоверений для учетной записи пользователя, введя следующую команду в командной строке используйте ktpass:  
    ```  
    ktpass /princ host/Sample1.contoso.com@CONTOSO.COM /mapuser Sample1 /pass MyPas$w0rd /out Sample1.keytab /crypto all /ptype KRB5_NT_PRINCIPAL /mapop set   
    ```  
    
    > [!NOTE]  
    > Не удается сопоставить несколько экземпляров службы в той же учетной записью.  
    
3.  Объединить файл .keytab с файлом /Etc/Krb5.keytab на главном компьютере, на котором не выполняется операционная система Windows. 

#### <a name="additional-references"></a>Дополнительные ссылки  
[Ключ синтаксиса командной строки](command-line-syntax-key.md)  
