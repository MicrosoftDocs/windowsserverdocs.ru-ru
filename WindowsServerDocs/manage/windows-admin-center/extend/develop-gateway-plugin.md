---
title: Разработка подключаемого модуля шлюза
description: Разработка подключаемого модуля шлюза пакета SDK Windows Admin Center (Гонолулу проекта)
ms.technology: manage
ms.topic: article
author: nwashburn-ms
ms.author: niwashbu
ms.date: 09/18/2018
ms.localizationpriority: medium
ms.prod: windows-server-threshold
ms.openlocfilehash: 66e36a349fc6bd38a77ccf4f00d380788ea4b422
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66445953"
---
# <a name="develop-a-gateway-plugin"></a>Разработка подключаемого модуля шлюза

>Область применения. Windows Admin Center, предварительная версия Windows Admin Center

Подключаемый модуль шлюза Windows Admin Center обеспечивает обмен данными API в пользовательском Интерфейсе средства или решения на целевой узел.  Windows Admin Center размещает службу шлюза, который ретранслирует команд и сценариев из шлюза подключаемые модули для выполнения на целевых узлах. Службу шлюза можно расширить для включения подключаемых модулей пользовательского шлюза, которые поддерживают протоколы, отличные от тех, которые по умолчанию.

По умолчанию с Windows Admin Center включаются следующие подключаемые модули шлюза:

* Подключаемый модуль PowerShell шлюза
* Подключаемый модуль шлюза WMI

Если вы хотите взаимодействовать с протокол, отличный от PowerShell или WMI, такие как с помощью REST, можно создать свой собственный подключаемый модуль шлюза.  Подключаемые модули шлюза должны быть загружены в отдельном домене приложения из существующего процесса шлюза, но использовать тот же уровень повышения прав.

> [!NOTE]
> Не знакомы с другим расширением типы? Дополнительные сведения о [типов архитектуры и расширение расширений](understand-extensions.md).

## <a name="prepare-your-environment"></a>Подготовка среды

Если у вас ее еще [Подготовка среды](prepare-development-environment.md) , установив зависимости, так и глобальные необходимые компоненты для всех проектов.

## <a name="create-a-gateway-plugin-c-library"></a>Создание подключаемого модуля шлюза (C# библиотеки)

Чтобы создать настраиваемый шлюз подключаемый модуль, создайте новый C# класс, реализующий ```IPlugIn``` интерфейс из ```Microsoft.ManagementExperience.FeatureInterfaces``` пространства имен.  

> [!NOTE]
> ```IFeature``` Интерфейс, доступный в более ранних версиях пакета SDK, теперь помечен как устаревший.  Вся разработка подключаемого модуля шлюза следует использовать IPlugIn (или, при необходимости, абстрактный класс HttpPlugIn).

### <a name="download-sample-from-github"></a>Скачать образец с GitHub

Чтобы быстро приступить к работе с подключаемым модулем пользовательского шлюза, можно клонировать или загрузить копию наших [пример C# подключаемый модуль проекта](https://github.com/Microsoft/windows-admin-center-sdk/tree/master/GatewayPluginExample/Plugin) из нашего пакета SDK Windows Admin Center [сайт GitHub](https://aka.ms/wacsdk).

### <a name="add-content"></a>Добавление содержимого

Добавить новое содержимое для куда клонирована копия [пример C# подключаемый модуль проекта](https://github.com/Microsoft/windows-admin-center-sdk/tree/master/GatewayPluginExample/Plugin) проекта (или создайте собственный проект), содержат пользовательские API, а затем построить библиотеку DLL подключаемого модуля настраиваемый шлюз файл для использования на следующих шагах.

### <a name="deploy-plugin-for-testing"></a>Развертывание подключаемого модуля для тестирования

Тестирование библиотеки DLL подключаемого модуля пользовательского шлюза, загрузив его в процесс шлюза Windows Admin Center.

Windows Admin Center ищет все подключаемые модули в ```plugins``` папку в папке данных приложения текущего компьютера (с помощью значения перечисления Environment.SpecialFolder CommonApplicationData). В Windows 10 — это расположение ```C:\ProgramData\Server Management Experience```.  Если ```plugins``` папка еще не существует, можно создать папку самостоятельно.

> [!NOTE]
> Расположение подключаемого модуля в отладочной сборке можно переопределить, изменив значение конфигурации «StaticsFolder». Если выполняется отладка локально, этот параметр находится в файле App.Config решения для настольного компьютера. 

В папку plugins (в этом примере ```C:\ProgramData\Server Management Experience\plugins```)

* Создайте новую папку с тем же именем, что ```Name``` значение свойства ```Feature``` DLL подключаемого модуля настраиваемый шлюз (в нашем примерном проекте ```Name``` — «Пример Uno»)
* Скопируйте файл DLL подключаемого модуля настраиваемый шлюз эту новую папку
* Перезапустите процесс Windows Admin Center

После перезапуска процесса администрирования Windows, можно было тестировать API в библиотеку DLL подключаемого модуля пользовательского шлюза, выполнив GET, PUT, PATCH, удалять или ПУБЛИКОВАТЬ в ```http(s)://{domain|localhost}/api/nodes/{node}/features/{feature name}/{identifier}```

### <a name="optional-attach-to-plugin-for-debugging"></a>Дополнительно Присоединение к подключаемый модуль для отладки

В Visual Studio 2017 в меню "Отладка" выберите «Присоединение к процессу». В следующем окне в списке доступных процессов и выберите SMEDesktop.exe, а затем нажмите кнопку «Подключить». Один раз запускается отладчик, можно установить точку останова в коде функции и затем упражнения через выше формат URL-адреса. Для нашего примера проекта (имя компонента: «Пример Uno») является URL-адрес: "<http://localhost:6516/api/nodes/fake-server.my.domain.com/features/Sample%20Uno>"

## <a name="create-a-tool-extension-with-the-windows-admin-center-cli"></a>Создание средства расширения с помощью интерфейса командной строки Windows Admin Center ##

Теперь нам нужно создать средство расширения, из которого можно вызвать настраиваемый шлюз подключаемого модуля.  Создайте или перейдите к папке, где вы хотите сохранить файлы проекта, откройте командную строку и задать эту папку в качестве рабочего каталога.  С помощью CLI Windows Admin Center, который был установлен ранее, создайте новое расширение со следующим синтаксисом:

```
wac create --company "{!Company Name}" --tool "{!Tool Name}"
```

| Значение | Объяснение | Пример |
| ----- | ----------- | ------- |
| ```{!Company Name}``` | Название организации (с пробелами) | ```Contoso Inc``` |
| ```{!Tool Name}``` | Имя инструмента (с пробелами) | ```Manage Foo Works``` |

Вот пример использования:

```
wac create --company "Contoso Inc" --tool "Manage Foo Works"
```

Это создает новую папку внутри текущего рабочего каталога, используя имя, указанное для вашего инструмента, копирует все файлы шаблона в проект и настраивает файлы с именем вашей компании и средства.  

Затем перейдите в папку, в только что создали, а затем установите необходимые зависимости для локального, выполнив следующую команду:

```
npm install
```

По завершении настройки все необходимое для загрузки нового расширения в Windows Admin Center. 

## <a name="connect-your-tool-extension-to-your-custom-gateway-plugin"></a>Подключение средства расширения в подключаемый модуль пользовательского шлюза

Теперь, когда вы создали расширение с помощью интерфейса командной строки Windows Admin Center, вы можете подключить средство расширения в подключаемый модуль пользовательского шлюза, выполнив следующие действия:

- Добавление [пустого модуля](guides/add-module.md)
- Используйте ваши [подключаемый модуль настраиваемый шлюз](guides/use-custom-gateway-plugin.md) средство расширения
 
## <a name="build-and-side-load-your-extension"></a>Сборки и на стороне загрузить расширение

Затем сборки и на стороне загружать расширения в Windows Admin Center.  Откройте окно командной строки, измените каталог в исходном каталоге, а затем приступать к сборке.

* Создание и обслуживание с помощью Gulp:

    ```
    gulp build
    gulp serve -p 4201
    ```

Обратите внимание, что необходимо выбрать порт, который в данный момент будет не занят. Убедитесь, что вы не используете порт, на котором работает Windows Admin Center.

Проект можно загрузить в локальный экземпляр Windows Admin Center для тестирования, присоединив локально обслуживаемый проект к Windows Admin Center.

* Запустите Windows Admin Center в веб-браузере
* Откройте отладчик (F12)
* Откройте консоль и введите следующую команду:

    ```
    MsftSme.sideLoad("http://localhost:4201")
    ```

*   Обновите веб-браузер

Теперь проект будет отображаться в списке "Средства" (неопубликованный) рядом с соответствующим именем.

## <a name="target-a-different-version-of-the-windows-admin-center-sdk"></a>Ориентироваться на разные версии пакета SDK Windows Admin Center

Своевременное обновление расширения с помощью пакета SDK и платформы изменения очень просто.  Читать о том, как [ориентироваться на разные версии](target-sdk-version.md) пакета SDK Windows Admin Center.