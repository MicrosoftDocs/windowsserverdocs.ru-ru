---
title: Программное обеспечение балансировки нагрузки (SLB) для SDN
description: В этом разделе можно использовать для изучения программная Балансировка нагрузки программного обеспечения определены для работы в сети в Windows Server 2016.
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-sdn
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 97abf182-4725-4026-801c-122db96964ed
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 5e08afddde9c7be8d955a0cfdaf44f0fc31b8155
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2018
---
# <a name="software-load-balancing-slb-for-sdn"></a>Программное обеспечение балансировки нагрузки \(SLB\) для SDN

>Область применения: Windows Server (канал точками годовой), Windows Server 2016

В этом разделе можно использовать для изучения программная Балансировка нагрузки программного обеспечения определены для работы в сети в Windows Server 2016.  

Поставщики облачных служб (CSP) и предприятия, развертывающие программно определенные сети (SDN) в Windows Server 2016 можно использовать программную балансировку нагрузки (SLB), чтобы равномерно распределить сетевой трафик клиента между ресурсами виртуальной сети и клиента. Windows Server SLB позволяет размещать же рабочую нагрузку на нескольких серверах, обеспечивает высокой доступности и масштабируемости.
  
Windows Server SLB включает следующие возможности.  
  
-   Уровень 4 (L4) загрузить службы балансировки нагрузки для трафика TCP/UDP «Восток-запад» и «Север-Юг».  
  
-   Открытые и внутренние трафика Балансировка сетевой нагрузки.  
  
-   Поддерживает динамические IP-адреса (DIP) на виртуальные локальные сети (VLAN) и виртуальные сети, созданные с помощью виртуализации сети Hyper-V.  
  
-   Поддержка проверки работоспособности.  
  
-   Готовы масштабе облака, включая возможность масштабирования и масштабировать возможность Мультиплексоры и агентов узлов.  
  
Дополнительные сведения см. в разделе [функции балансировки нагрузки программного обеспечения](#bkmk_features) в этом разделе.  
  
> [!NOTE]  
> Мультитенантности для виртуальных ЛС не поддерживается в сетевой контроллер, тем не менее можно использовать виртуальные ЛС с SLB для поставщика услуг управляемых рабочих нагрузок, например инфраструктуры центров обработки данных и высокой плотности веб-серверов.  
  
С помощью Windows Server SLB, можно расширить возможности с помощью SLB виртуальных машин на одном вычислительные серверы Hyper-V, используемых для остальных рабочих нагрузок виртуальных Машин балансировки нагрузки. По этой причине SLB поддерживает быстрого создания и удаления конечных точек балансировки нагрузки, что требуется для операций CSP. Кроме того Windows Server SLB поддерживает десятки гигабайт на кластер, представлена простая модель подготовки и легко масштаб и в.  
  
**Как работает SLB**  
  
SLB работает путем сопоставления виртуальных IP-адресов (виртуальные IP-адреса) для динамических IP-адресов (DIP), являющиеся частью набора службы облачных ресурсов в центре обработки данных.  
  
Виртуальные IP-адреса — один IP-адреса, предоставляют, общий доступ к пулу нагрузки балансировкой виртуальных машин. Например виртуальные IP-адреса, IP-адреса, которые доступны в Интернете, чтобы клиентов, а пользователи клиента могут подключаться к ресурсам клиента в облаке центра обработки данных.  
  
Значения DIP — это IP-адреса виртуальных машин с балансировкой сетевой нагрузки пула за VIP члена. Значения DIP назначаются в рамках облачной инфраструктуры к ресурсам клиента.  
  
Виртуальные IP-адреса находятся в SLB мультиплексор (Мультиплексирование).  Мультиплексирование состоит из одного или нескольких виртуальных машин (VM).  Сетевой контроллер обеспечивает каждого Мультиплексирования с каждой виртуальных IP-адресов и каждого Мультиплексирования в свою очередь использует протокол пограничного шлюза (BGP) для каждого виртуальных IP-адресов для маршрутизаторов в физической сети, как /32 объявления маршрутов.  BGP позволяет физические сетевые маршрутизаторы для:  
  
-   Узнайте, что виртуальных IP-адресов доступен на каждой Мультиплексирования, даже если MUXes находятся в разных подсетях в сети уровня 3.  
  
-   Распределите нагрузку для каждого виртуальных IP-адресов между все доступные MUXes использования маршрутизации равно многопутевых стоимости (ECMP).  
  
-   Автоматическое определение Мультиплексора сбоя или удаления и прекратить передачу трафика для неудачных Мультиплексирования.  
  
-   Распределены работоспособное MUXes загрузки из неудачных или удаленные Мультиплексирования.  
  
Когда открытый трафик поступает из Интернета, SLB MUX проверяет трафик, который содержит виртуальных IP-адресов как место назначения и сопоставляет и перезаписывает трафик, чтобы он оптимальный отдельных DIP. Для входящего сетевого трафика такая транзакция выполняется в два этапа, распределенный между Мультиплексора виртуальных машин (VM) и узла Hyper-V, где находится конечный DIP:  
  
-   Балансировка нагрузки - использует Мультиплексора виртуальных IP-адресов, чтобы выбрать DIP инкапсулирует пакет и перенаправляет трафик на узел Hyper-V, где находится DIP.  
  
-   Преобразование сетевых адресов (NAT) - узла Hyper-V удаляет инкапсуляция из пакета, переводит VIP к DIP, указывает порты и пересылает пакет DIP виртуальной Машины.  
  
Мультиплексирование знает, как сопоставить виртуальные IP-адреса правильные значения DIP из-за политики, определяющие с помощью сетевого контроллера балансировки нагрузки. Эти правила включают протокола, интерфейсный порта серверной части и алгоритм распространения (кортежей 5, 3 или 2).  
  
При реагировать виртуальные машины клиента и отправки исходящего сетевого трафика к Интернету или расположения удаленного клиента поскольку NAT осуществляется в узле Hyper-V, трафик обходит Мультиплексирование и переход непосредственно к пограничный маршрутизатор с узла Hyper-V. Этот процесс обход Мультиплексора называется прямой возвращать сервера (DSR).  
  
И после установления начальной сетевому трафику входящий трафик обходит SLB MUX полностью.  
  
На следующем рисунке клиентский компьютер выполняет запрос DNS для IP-адреса компании сайта Sharepoint — в этом случае вымышленной компании, с именем Contoso. Происходит следующий процесс.  
  
-   DNS-сервер возвращает клиенту 107.105.47.60 виртуальных IP-адресов.  
  
-   Клиент отправляет запрос HTTP для виртуальных IP-адресов.  
  
-   Физической сети имеется несколько путей, доступных для достижения виртуальных IP-адресов, расположенного на любой Мультиплексирования.  Каждый маршрутизатор попутно использует ECMP для выбора следующего сегмента пути пока запрос поступает в Мультиплексирования.  
  
-   Мультиплексирование, который получает запрос на проверяет настроенных политик и видит, что два значения DIP доступны, 10.10.10.5 и 10.10.20.5 виртуальной сети для обработки запроса на 107.105.47.60 виртуальных IP-адресов  
  
-   Мультиплексирование выбирает DIP 10.10.10.5 и инкапсулирует пакеты с помощью VXLAN, чтобы отправить этот узел, содержащий DIP, с помощью узлов адрес физической сети.  
  
-   Узел получает инкапсулированный пакет и проверяет его.  Он удаляет инкапсуляция и перезаписывает пакета, поэтому теперь является DIP 10.10.10.5 вместо VIP и отправляет трафик виртуальной машины DIP конечного.  
  
-   Запрос теперь достигло сайта Contoso Sharepoint 2 фермы серверов. Сервер формирует ответ и отправляет их на клиенте, используя свой IP-адрес в качестве источника.  
  
-   Узел перехватывает исходящих пакетов в виртуальный коммутатор, который запоминает, клиента, теперь назначения исходного запроса для виртуальных IP-адресов.  Узел перезаписывает источник пакета быть виртуальных IP-адресов, поэтому, чтобы клиент не видит DIP-адрес.  
  
-   Узел перенаправляет пакет непосредственно на шлюз по умолчанию для физической сети, который использует его стандартные таблицы маршрутизации для пересылки пакетов систему клиента, что со временем получения ответа.  
  
![Процесс балансировки нагрузки программного обеспечения](../../../media/Software-Load-Balancing--SLB--for-SDN/slb_process.jpg)  
  
**Балансировку нагрузки для трафика внутреннего центра обработки данных**  
  
Когда балансировку нагрузки сети для трафика внутреннего центра обработки данных, такие как между ресурсами клиента под управлением на разных серверах, входящих в той же виртуальной сети, виртуальный коммутатор Hyper-V, к которому подключены виртуальные машины NAT.  
  
Внутренний трафик балансировки нагрузки, первый запрос отправляется и обрабатываемых Мультиплексирования, который выбирает соответствующий DIP и перенаправляет трафик DIP. С этого момента установленной трафик обходит Мультиплексирование и переходит непосредственно из виртуальной Машины для виртуальной Машины.  
  
**Проверки работоспособности**  
  
SLB включает проверки работоспособности, чтобы проверить работоспособность инфраструктуры сети, включая следующие.  
  
-   Модуль проверки TCP для порта  
  
-   Модуль проверки HTTP для порта и URL-адрес  
  
В отличие от традиционных нагрузки устройство подсистемы балансировки где Проба происходит на устройстве, а перемещается по каналу связи DIP проверка SLB происходит на узле, где находится DIP и переход непосредственно из агента узла SLB DIP дальнейшего распределения рабочих между узлами.  
  
## <a name="bkmk_infrastructure"></a>Инфраструктура балансировки нагрузки программного обеспечения  
Чтобы выполнить развертывание Windows Server SLB, необходимо развернуть сетевой контроллер в Windows Server 2016 и один или несколько виртуальных машин SLB Мультиплексирования.  
  
Кроме того необходимо настроить узлов Hyper-V с помощью виртуального коммутатора Hyper-V включен SDN и убедитесь, что запущен агент узла SLB.  Маршрутизаторы, обслуживающие узлы должны поддерживать протокол пограничного шлюза (BGP) и маршрутизации равной цены multipath (ECMP) и должен быть настроен на прием запросов пиринга BGP от SLB MUXes.  
  
Ниже приведен обзор SLB инфраструктуры.  

![Инфраструктура балансировки нагрузки программного обеспечения](../../../media/Software-Load-Balancing--SLB--for-SDN/slb_overview1.png)  
  
Дополнительные сведения об этих элементах инфраструктуры SLB в следующих разделах.  
  
### <a name="scvmm"></a>SCVMM  
С помощью System Center 2016 сетевого контроллера можно настроить в Windows Server 2016, включая диспетчер SLB и монитор работоспособности. System Center также позволяет развертывать SLB MUXs и установить агенты узла SLB на компьютерах под управлением Windows Server 2016 и Hyper-V.  
  
Дополнительные сведения о System Center 2016 см. в разделе [System Center 2016](https://www.microsoft.com/en-us/server-cloud/products/system-center-2016/).  
  
> [!NOTE]  
> Если вы не хотите использовать System Center 2016, можно использовать Windows PowerShell или другое приложение для управления, чтобы установить и настроить сетевой контроллер и другой инфраструктурой SLB. Дополнительные сведения см. в разделе [развертывание сетевого контроллера с помощью Windows PowerShell](../../../sdn/deploy/Deploy-Network-Controller-using-Windows-PowerShell.md).  
  
### <a name="network-controller"></a>Сетевой контроллер  
Сетевой контроллер размещается SLB Manager и выполняет следующие действия для SLB.  
  
-   Команды SLB процессы передаются помощью северного API-интерфейса с System Center, Windows PowerShell или другое приложение для управления сети.  
  
-   Вычисляет политику для распространения на узлах Hyper-V и SLB MUXes.  
  
-   Предоставляет сведения о состоянии работоспособности инфраструктуры SLB.  
  
### <a name="slb-mux"></a>SLB MUX  
SLB MUX обрабатывает входящий сетевой трафик и сопоставляет виртуальные IP-адреса с использованием значений DIP, а затем перенаправляет трафик на правильный DIP. Каждый Мультиплексора также использует BGP для публикации маршруты виртуальных IP-адресов в edge маршрутизаторы. BGP активности уведомляет о MUXes Мультиплексирования не удается, что позволяет active MUXes распространять нагрузку в случае сбоя Мультиплексирования — по существу, предоставляя балансировки нагрузки для балансировки нагрузки.  
  
### <a name="hosts-that-are-running-hyper-v"></a>Узлы под управлением Hyper-V  
Можно использовать SLB с компьютеров, работающих под управлением Windows Server 2016 и Hyper-V. Виртуальные машины на узле Hyper-V можно запустить любую операционную систему, которая поддерживается пакетом Hyper-V.  
  
### <a name="slb-host-agent"></a>Агент узла SLB  
При развертывании SLB, необходимо использовать System Center, Windows PowerShell или другое приложение для управления для развертывания агента узла SLB на каждом компьютере узла Hyper-V. Агент узла SLB можно установить во всех версиях Windows Server 2016, которые обеспечивают поддержку Hyper-V, включая Nano Server.  
  
Агент узла SLB прослушивает обновления политики SLB из сетевого контроллера. Кроме того агент узла программы SLB от правил в поддержкой SDN Hyper-V виртуальные коммутаторы, которые настроены на локальном компьютере.  
  
### <a name="sdn-enabled-hyper-v-virtual-switch"></a>SDN включен виртуального коммутатора Hyper-V  
Для виртуального коммутатора совместима с SLB необходимо использовать диспетчер виртуальных коммутаторов Hyper-V или Windows PowerShell команды для создания коммутатора и затем виртуальная платформа фильтрации (VFP) должна быть включена для виртуального коммутатора.  
  
Сведения о включении VFP для виртуальных коммутаторов см. команды Windows PowerShell [Get-VMSystemSwitchExtension](https://technet.microsoft.com/en-us/library/hh848603.aspx) и [Enable-VMSwitchExtension](https://technet.microsoft.com/en-us/library/hh848541.aspx?f=255&MSPPError=-2147217396).  
  
SDN включен виртуального коммутатора Hyper-V выполняет следующие действия для SLB.  
  
-   Обрабатывает пути к данным для SLB.  
  
-   Принимает входящий сетевой трафик из Мультиплексирования.  
  
-   Обходит Мультиплексирования для исходящего сетевого трафика, их отправки с помощью DSR маршрутизатора.  
  
-   Запускается на экземплярах сервера Nano, Hyper-v.  
  
### <a name="bgp-enabled-router"></a>Маршрутизатор включен BGP  
Маршрутизатор BGP SLB выполняет следующие действия.  
  
-   Маршруты входящий трафик, поступающий Мультиплексирования, с помощью ECMP.  
  
-   Для исходящего сетевого трафика использует маршрут, заданный узлом.  
  
-   Для обновления маршрутов прослушивает виртуальные IP-адреса из SLB Мультиплексирования.  
  
-   Удаляет SLB MUXes из ротации SLB в случае сбоя активности.  
  
## <a name="bkmk_features"></a>Функции балансировки нагрузки программного обеспечения  
Ниже приведены некоторые функции и возможности SLB.  
  
**Основные функциональные возможности**  
  
-   SLB предоставляет службы для трафика TCP/UDP «Восток-запад» и «Север-Юг» балансировки нагрузки уровня 4  
  
-   Можно использовать SLB в сети на основе виртуализации сети Hyper-V  
  
-   Можно использовать SLB с сети на основе виртуальной ЛС для DIP виртуальных машин, подключенных к SDN включен Hyper-V виртуальный коммутатор.  
  
-   Один экземпляр SLB может обрабатывать несколько клиентов  
  
-   SLB и DIP поддерживают масштабируемую и низкой задержкой обратного пути, как это реализовано путем прямого возвращать сервера (DSR)  
  
-   Функции SLB также используется параметр объединения ВНЕДРЕННЫХ или один корневой виртуализации ввода-вывода (SR-IOV)  
  
-   Протокол IP версии 4 (IPv4) включает SLB поддержки  
  
-   Сценарии использования шлюза сайта для сайта SLB обеспечивает возможности NAT все подключения сайта для сайта для использования одного общего IP  
  
-   Можно установить SLB, включая варианты полной агента узла и Мультиплексирования, в Windows Server 2016, Core и Nano установки.  
  
**Масштаб и производительность**  
  
-   Готовы масштабе облака, включая возможность масштабирования и масштабировать возможность MUXes и агентов узлов.  
  
-   Один active SLB Manager сетевой контроллер модуль может поддерживать 8 Мультиплексора экземпляров  
  
**Высокая доступность**  
  
-   Вы можете развернуть SLB более чем двух узлах в конфигурации активный/активный  
  
-   Можно добавить и удалить из пула Мультиплексора без ущерба для службы SLB MUXes. Это обеспечивает доступность SLB при   
    отдельные MUXes являются вносятся исправления.  
  
-   Отдельные экземпляры Мультиплексора имеют время бесперебойной работы 99%  
  
-   Для управления объектами данных мониторинга работоспособности  
  
**Выравнивание**  
  
-   Можно развернуть и настроить SLB с SCVMM  
  
-   SLB предоставляет мультитенантном единой edge за счет интеграции с Microsoft приборов, таких как мультитенантный шлюз RAS, брандмауэр центра обработки данных и рефлектор маршрутов.  
  

