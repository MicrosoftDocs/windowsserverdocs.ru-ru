---
title: Kerberos с именем субъекта-службы (SPN)
description: Сетевой контроллер поддерживает несколько методов проверки подлинности для взаимодействия с клиентами управления. Вы можете использовать проверку подлинности на основе Kerberos, аутентификацию X509 на основе сертификата. Вы также можете использовать проверку подлинности без аутентификации для тестовых развертываний.
manager: dougkim
ms.prod: windows-server
ms.technology: networking-sdn
ms.topic: article
ms.assetid: bc625de9-ee31-40a4-9ad2-7448bfbfb6e6
ms.author: pashort
author: shortpatti
ms.date: 08/23/2018
ms.openlocfilehash: 78d5d2144e0def8e69a2a4ae5fdc2d7718936710
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71355765"
---
# <a name="kerberos-with-service-principal-name-spn"></a>Kerberos с именем субъекта-службы (SPN)

>Относится к: Windows Server 2019

Сетевой контроллер поддерживает несколько методов проверки подлинности для взаимодействия с клиентами управления. Вы можете использовать проверку подлинности на основе Kerberos, аутентификацию X509 на основе сертификата. Вы также можете использовать проверку подлинности без аутентификации для тестовых развертываний.

System Center Virtual Machine Manager использует проверку подлинности на основе Kerberos. При использовании проверки подлинности на основе Kerberos необходимо настроить имя участника-службы (SPN) для сетевого контроллера в Active Directory. Имя участника-службы — это уникальный идентификатор экземпляра службы сетевого контроллера, который используется проверкой подлинности Kerberos для связывания экземпляра службы с учетной записью входа службы. Дополнительные сведения см. в разделе [имена субъектов-служб](https://docs.microsoft.com/windows/desktop/ad/service-principal-names).

## <a name="configure-service-principal-names-spn"></a>Настройка имен субъектов-служб (SPN)

Сетевой контроллер автоматически настраивает имя субъекта-службы. Все, что нужно сделать, — предоставить разрешения на компьютеры сетевого контроллера для регистрации и изменения имени участника-службы.

1.  На компьютере контроллера домена запустите **Active Directory пользователи и компьютеры**.

2.  Выберите **вид \> дополнительно**.

3.  В разделе **Компьютеры**найдите одну из учетных записей компьютера сетевого контроллера, а затем щелкните ее правой кнопкой мыши и выберите пункт **свойства**.

4.  Перейдите на вкладку **Безопасность** и нажмите кнопку **Дополнительно**.

5.  Если в списке не указаны все учетные записи компьютера сетевого контроллера или группы безопасности с учетными записями всех компьютеров сетевого контроллера, нажмите кнопку **Добавить** , чтобы добавить их.

6.  Для каждой учетной записи компьютера сетевого контроллера или одной группы безопасности, содержащей учетные записи компьютера сетевого контроллера:

    1\.  Выберите учетную запись или группу и нажмите кнопку **изменить**.

    2\.  В разделе Разрешения выберите **проверить запись перезаписи**.

    Г.  Прокрутите вниз и в разделе **Свойства** выберите:

       -  **Чтение и считывание**

       -  **Написание перезаписи**

    Д.  Щелкните дважды **ОК** .

7.  Повторите шаг 3-6 для каждого компьютера сетевого контроллера.

8.  Закройте окно **Пользователи и компьютеры Active Directory**.

## <a name="failure-to-provide-permissions-for-spn-registrationmodification"></a>Не удалось предоставить разрешения для регистрации или изменения имени участника-службы

В **новом** развертывании Windows Server 2019, если выбран параметр Kerberos для проверки подлинности клиента RESTful и не предоставлено разрешение узлам сетевого контроллера регистрировать или изменять имя участника-службы, операции RESTful на сетевом контроллере не позволяют управлять SDN.

Для обновления с Windows Server 2016 до Windows Server 2019 и выбора протокола Kerberos для проверки подлинности клиента RESTFUL операции RESTFUL не блокируются, что обеспечивает прозрачность для существующих рабочих развертываний. 

Если имя участника-службы не зарегистрировано, то для проверки подлинности клиента используется менее безопасный протокол NTLM. Вы также получаете критическое событие в канале администрирования канала событий **нетворкконтроллер-Framework** , предлагающего предоставить разрешения на узлы сетевого контроллера для регистрации SPN. После предоставления разрешения сетевой контроллер регистрирует имя участника-службы автоматически, а все операции клиента используют протокол Kerberos.


>[!TIP]
>Как правило, в сетевом контроллере можно настроить использование IP-адреса или DNS-имени для операций на основе службы "сеть — сеть". Однако при настройке Kerberos нельзя использовать IP-адрес для запросов RESTFUL к сетевому контроллеру. \<Например, можно использовать https://networkcontroller.consotso.com\>, но нельзя использовать \< https://192.34.21.3\>. Имена субъектов-служб не могут работать, если используются адреса IP.
>
>Если вы использовали IP-адрес для операций RESTFUL вместе с проверкой подлинности Kerberos в Windows Server 2016, фактическое взаимодействие потребовалось бы через проверку подлинности NTLM. В таком развертывании после обновления до Windows Server 2019 продолжает использоваться проверка подлинности на основе NTLM. Чтобы перейти на проверку подлинности на основе Kerberos, необходимо использовать DNS-имя сетевого контроллера для операций RESTFUL и предоставить разрешение узлам сетевого контроллера зарегистрировать SPN.

---