---
title: Сетевые адаптеры настройки производительности
description: Этот раздел входит руководство Настройка производительности сетевой подсистемы для Windows Server 2016.
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 0b9b0f80-415c-4f5e-8377-c09b51d9c5dd
manager: brianlic
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 1c6d36966ce6e2d407b6568e16946745256ee69b
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2018
---
# <a name="performance-tuning-network-adapters"></a>Сетевые адаптеры настройки производительности

>Область применения: Windows Server (канал точками годовой), Windows Server 2016

Можно использовать в этом разделе, чтобы сетевые адаптеры настройки производительности, установленных на компьютерах, работающих под управлением Windows Server 2016.

Определение правильных настроек для сетевого адаптера зависит от следующих факторов:

- Сетевой адаптер и набор его функций  

- Тип рабочей нагрузки, выполняемой сервером  

- Аппаратные и программные ресурсы сервера  

- Задачи для сервера  

Если сетевой адаптер предоставляет возможности настройки, можно оптимизировать использование пропускной способности и ресурсов сети для достижения оптимальной пропускной способности на основе параметров, описанные выше.  

В следующих разделах описаны некоторые из параметров настройки производительности.  

##  <a name="bkmk_offload"></a>Включение функций разгрузки

Включение функций разгрузки сетевого адаптера на обычно имеет положительный эффект. Иногда тем не менее, сетевой адаптер недостаточно производителен, чтобы осуществлять функции разгрузки с высокой пропускной способностью.

>[!IMPORTANT]
>Не используйте функции разгрузки **Разгрузка задач IPsec** или **разгрузку TCP Chimney**. Эти технологии устаревшие в Windows Server 2016 и может негативно повлиять на сервер и производительности сети. Кроме того эти технологии могут не поддерживаться корпорацией Майкрософт в будущем.

Например включение разгрузки сегментации может снизить максимальную устойчивую пропускную способность некоторых сетевых адаптеров из-за ограниченности аппаратных ресурсов. Однако если снижение пропускной способности не будет ограничением, следует включить функции разгрузки даже для этого типа сетевой адаптер.

>[!NOTE]
> Некоторых сетевых адаптерах функции разгрузки нужно включать по отдельности для отправки и получения пути.

##  <a name="bkmk_rss_web"></a>Включение масштабирования (RSS) для веб-серверов на стороне приема

RSS способно повысить веб-масштабируемость и производительность, когда число сетевых адаптеров меньше логических процессоров на сервере. Когда веб-трафик проходит через сетевые адаптеры с поддержкой RSS, входящие веб-запросы из разных соединений могут одновременно обрабатываться разными ЦП.

Обратите внимание, что из-за в RSS и передачи гипертекста важно протокола \(HTTP\) распределения нагрузки, производительность может быть значительно снижает, если не поддерживающий RSS сетевого адаптера веб-трафик на сервере, с поддержкой RSS адаптерам. В этом случае необходимо использовать сетевые адаптеры, поддерживающие RSS, или отключить RSS в окне свойств сетевого адаптера **дополнительные свойства** вкладку. Чтобы определить, является ли адаптер с поддержкой RSS, можно просмотреть сведения RSS на свойств сетевого адаптера **дополнительные свойства** вкладку.

### <a name="rss-profiles-and-rss-queues"></a>Профили RSS и очереди RSS

Предопределенные RSS профиль по умолчанию является NUMA Static, который меняет поведение по умолчанию предыдущих версий операционной системы. Чтобы начать работу с профилями RSS, можно ознакомиться с доступными профилями, чтобы понять, когда они будут полезны и как они применяются к сети или оборудованию.

Например если откройте диспетчер задач и просмотрите логические процессоры на сервере, они недостаточно загружены приемом трафика, можно попробовать увеличить число очередей RSS со значения по умолчанию 2 до максимального, которое поддерживается сетевым адаптером. Сетевой адаптер может быть параметры для изменения числа очередей RSS в драйвере.

##  <a name="bkmk_resources"></a>Увеличение ресурсов для сетевых адаптеров

Для сетевых адаптеров, которые позволяют вручную настраивать ресурсы, такие как получать и отправлять буферы следует увеличить выделение ресурсов. 

Некоторые сетевые адаптеры мал буферы приема для экономии выделенной памяти от узла. Это ведет к потере пакетов и снижению производительности. Поэтому для сценариев с интенсивным приемом рекомендуется увеличить значение буфер приема до максимума.

>[!NOTE]
>Если сетевой адаптер не предоставляет вручную, он либо настраивает их динамически ресурсов или ресурсы приводятся фиксированным значением, которое нельзя изменить.

### <a name="enabling-interrupt-moderation"></a>Включение управления прерываниями

Для управления прерываниями, в некоторых сетевых адаптерах предлагаются различные уровни прерываниями, параметры объединения буферов (иногда отдельно для буфера приема и передачи), или оба.

Рекомендуется контроля прерываний для рабочих нагрузок, связанных с ЦП и учитывать баланс между экономией процессорных Ресурсов узла и задержкой и увеличением экономии процессорных Ресурсов узла, из-за большего числа прерываний и снижения задержки. Если сетевой адаптер не ведет управление прерываниями, но он предоставляет буфера, объединение, увеличение числа объединенных буферов позволяет объединять буферы для отправки или получения, который повышает производительность.

##  <a name="bkmk_low"></a>Настройка производительности для обработки пакетов с низкими задержками

Многие сетевые адаптеры позволяют параметры для оптимизации задержка, вызванная операционной системы. Задержка — это время между обработкой входящего пакета сетевым драйвером и отправкой этого пакета обратно сетевые драйверы. Обычно это время измеряется в микросекундах. Для сравнения время передачи пакетов на длинные дистанции обычно измеряется в миллисекундах \ (larger\ порядка). Эта настройка не сокращает время, затрачиваемое на пакет во время передачи.

Ниже приведены некоторые предложения для сетей микросекунда по настройке производительности.

- BIOS компьютера установите значение **высокая производительность**, отключите C-состояния. Однако обратите внимание, что это системы и зависимые BIOS, и некоторые системы обеспечивают большую производительность, если операционная система управляет электропитанием. Можно проверить и изменить параметры управления питанием из **параметры** или с помощью **powercfg** команды. Дополнительные сведения см. в разделе [параметры командной строки Powercfg](https://technet.microsoft.com/library/cc748940.aspx)

- Установите профиль управления электропитанием ОС **высокой производительности системы**. Обратите внимание, что это не будет правильно Если было задано в BIOS компьютера отключен контроль операционной системы управления питанием.

- Включите статические разгрузки, например контрольные суммы UDP, контрольные суммы TCP и разгрузки большой отправки (LSO).

- Включите RSS, если трафик передается несколькими потоками, например при масштабной многоадресной рассылке.

-   Отключить **прерываниями** параметр драйверах сетевых адаптеров, которые требуется самая низкая задержка. Помните, это может использоваться больше времени ЦП, и он компромиссом.

- Обрабатывайте прерывания сетевого адаптера и DPC на основном процессоре, который совместно использует Процессорный кэш с ядром, который используется программой (пользовательским потоком), обрабатывающей пакет. Для передачи процесса конкретным логическим процессорам вместе с настройкой RSS для выполнения этой задачи можно использовать настройку фиксации ЦП. Использование одного ядра для прерываний, DPC и пользовательского потока ведет к снижению производительности увеличения нагрузки, поскольку ISR, DPC и поток будут конкурировать за ядро.

##  <a name="bkmk_smi"></a>Прерывания управления системой

Во многих аппаратных системах прерывания управления системы \(SMI\) для различных функций обслуживания, включая отчеты об кода \(ECC\) ошибках памяти, устаревшие совместимости USB, управление вентиляторами и BIOS через управления питанием. 

Прерывание SMI имеет наивысший приоритет в системе и переводит ЦП в режим управления, который блокирует все другие действия, пока выполняется процедура служебного прерывания, обычно находящаяся в BIOS.

К сожалению это может привести к скачкообразному росту задержки до 100 микросекунд и многое другое. 

Если необходимо обеспечить минимальную задержку, следует запросить версия BIOS у поставщика оборудования, в которой прерывания SMI имеют наименьший возможный приоритет. Они являются часто называют «BIOS низкой задержки» или «BIOS без SMI». В некоторых случаях это невозможно для аппаратной платформе полностью устранить операции SMI, поскольку он используется для управления важными функциями (например, вентиляторов).

>[!NOTE]
>Операционная система может не имеет контроля над SMI, потому что логический процессор работает в особом служебном режиме, который блокирует вмешательство операционной системы.

##  <a name="bkmk_tcp"></a>Настройка производительности TCP

 Вы можете настроить производительность TCP с помощью следующих элементов.

###  <a name="bkmk_tcp_params"></a>Автонастройка окна получения TCP

До Windows Server 2008 в сетевом стеке использовалось окно фиксированного размера на стороне приема (65535 байтов) что ограничивало общую пропускную способность для соединений. Одна из самых существенных изменений в реализации стека TCP — TCP появление автонастройки окна получения. 

При использовании фиксированного размера окна по мере получения TCP можно рассчитать общую пропускную способность одного соединения:

**Общая достижимая пропускная способность в байтах = TCP размер окна в байтах \ * (1 / задержка соединения в секундах)**

Например, общая достижимая пропускная способность составляет лишь 51 Мбит/с для соединения с задержкой 10 мс \ (разумное значение infrastructure\ больших корпоративной сети). 

С помощью автоматической настройки, однако автонастройке окно получения регулируется и может вырастать в соответствии с требованиями отправителя. Это возможно, для подключения, чтобы добиться всю емкость канала в 1 Гбит/с-подключения. Сценарии использования сети, которые могут быть ограничены в прошлом общей достижимой пропускной способностью TCP-соединения теперь полностью можно использовать сети.

#### <a name="deprecated-tcp-parameters"></a>Устаревшие параметры TCP

Следующие параметры реестра из Windows Server 2003 больше не поддерживаются и игнорируются в более поздних версиях.

Все эти параметры было следующий раздел реестра:

    ```  
    HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters  
    ```  

- TcpWindowSize

- NumTcbTablePartitions  

- MaxHashTableSize  



###  <a name="bkmk_wfp"></a>Платформа фильтрации Windows

Windows фильтрации платформы (WFP), появившихся в Windows Vista и Windows Server 2008 предоставляет API-интерфейсы для сторонних независимых поставщиков программных (продуктов ISV) для создания фильтров обработки пакетов. Примеры брандмауэра и антивирусных программ.

>[!NOTE]
>Плохой фильтр WFP может существенно снижать сетевую производительность сервера. Дополнительные сведения см. в разделе [обработки перенос пакетов драйверов и приложений для платформы фильтрации Windows](https://msdn.microsoft.com/windows/hardware/gg463267.aspx) в центре разработки для Windows.


Ссылки на все разделы в этом руководстве в разделе [Настройка производительности сетевой подсистемы](net-sub-performance-top.md).
