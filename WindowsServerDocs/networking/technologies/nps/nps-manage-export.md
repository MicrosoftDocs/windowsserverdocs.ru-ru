---
title: Экспортировать конфигурацию с NPS для импорта на другом сервере
description: Чтобы узнать, как экспортировать конфигурацию сервера политики сети в Windows Server 2016 можно использовать в этом разделе.
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: d268dc57-78f8-47ba-9a7a-a607e8b9225c
ms.author: pashort
author: shortpatti
ms.openlocfilehash: a5f28c317f1d58fd1889fb55d345463dc8a62999
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59816425"
---
# <a name="export-an-nps-configuration-for-import-on-another-server"></a>Экспортировать конфигурацию с NPS для импорта на другом сервере

Область применения. Windows Server 2016

Вы можете экспортировать всю конфигурацию сервера политики сети, включая RADIUS-клиенты и серверы политики сети, политики запросов на подключение, реестра и конфигурацию ведения журнала — от одного сервера политики сети для импорта на другой сервер политики сети. 

Чтобы экспортировать конфигурацию сервера политики сети, используйте одно из следующих средств:

- В Windows Server 2016, Windows Server 2012 R2 и Windows Server 2012 можно использовать как Netsh, или можно использовать Windows PowerShell.
- В Windows Server 2008 R2 и Windows Server 2008 используете Netsh.

>[!IMPORTANT]
>Не используйте эту процедуру, если база данных-источник NPS имеет более высокий номер версии, чем номер версии целевой базы данных, сервер политики сети. Можно просмотреть номер версии базы данных NPS из отображения **netsh nps Показать config** команды.

Поскольку конфигурации сервера политики сети, не шифруются в экспортированный файл XML, их отправкой по сети может представлять угрозу безопасности, поэтому принимать меры предосторожности при перемещении XML-файл с исходного сервера на конечных серверах. Например добавьте файл в зашифрованный, защищенный архивный файл пароля перед перемещением файл. Кроме того сохраните файл в безопасном месте, чтобы не позволить злоумышленникам получить доступ к устройству.

>[!NOTE]
>Если ведение журнала SQL Server настроен на исходном NPS, параметры ведения журнала SQL Server, не экспортируются в XML-файл. После импорта в файл на другой сервер политики сети, необходимо вручную настроить ведение журнала SQL Server.

## <a name="export-and-import-the-nps-configuration-by-using-windows-powershell"></a>Экспорт и импорт конфигурации сервера политики сети с помощью Windows PowerShell

Для Windows Server 2012 и более поздних версиях операционной системы можно экспортировать конфигурацию сервера политики сети с помощью Windows PowerShell.

Ниже приведен синтаксис команды для экспорта конфигурации NPS. 

    Export-NpsConfiguration -Path <filename>

В следующей таблице перечислены параметры для **NpsConfiguration экспорта** в Windows PowerShell. Параметры выделены полужирным шрифтом, являются обязательными.

|Параметр|Описание|
|---------|-----------|
|Путь|Указывает имя и расположение XML-файла, к которому вы хотите экспортировать конфигурацию сервера политики сети.|

**Учетные данные администратора**

Для выполнения этой процедуры необходимо быть членом группы "Администраторы".

### <a name="export-example"></a>Пример экспорта 

В следующем примере конфигурации NPS экспортируется в XML-файл, расположенный на локальном диске. Для выполнения этой команды, запустите Windows PowerShell от имени администратора на исходном NPS, введите следующую команду и нажмите клавишу ВВОД.

`Export-NpsConfiguration –Path c:\config.xml` 

Дополнительные сведения см. в разделе [NpsConfiguration экспорта](https://technet.microsoft.com/library/jj872749.aspx).

После экспорта конфигурации сервера политики сети, скопируйте XML-файл на конечный сервер.

Ниже приведен синтаксис команд для импорта конфигурации NPS на сервере назначения.

    Import-NpsConfiguration [-Path] <String> [ <CommonParameters>]

### <a name="import-example"></a>Пример импорта

Следующая команда импортирует параметры из файла с именем C:\Npsconfig.xml на сервер политики сети. Для выполнения этой команды, запустите Windows PowerShell от имени администратора на конечном сервере политики сети, введите следующую команду и нажмите клавишу ВВОД.

    PS C:\> Import-NpsConfiguration -Path "C:\Npsconfig.xml"

Дополнительные сведения см. в разделе [NpsConfiguration импорта](https://technet.microsoft.com/library/jj872750.aspx).

## <a name="export-and-import-the-nps-configuration-by-using-netsh"></a>Экспорт и импорт конфигурации сервера политики сети с помощью Netsh

Можно использовать сетевой оболочки \(Netsh\) Чтобы экспортировать конфигурацию сервера политики сети с помощью **netsh nps export** команды.

Когда **импорта netsh nps** команда, NPS обновляется автоматически с параметрами конфигурации. Необходимо остановить сервер политики сети на конечном компьютере для выполнения **импорта netsh nps** команды, однако если во время импорта конфигурации открыта консоль NPS или оснастки NPS MMC, изменения в конфигурацию сервера не отображаются до обновления представления. 

>[!NOTE]
>При использовании **netsh nps export** команды необходимо указать параметр команды **exportPSK** со значением **Да**. Этот параметр и значение явно указать, что вы понимаете, что при экспорте конфигурации сервера политики сети и что этот файл содержит в незашифрованном виде общие секреты клиентов RADIUS и членов удаленных групп серверов RADIUS.

**Учетные данные администратора**

Для выполнения этой процедуры необходимо быть членом группы "Администраторы".

### <a name="to-copy-an-nps-configuration-to-another-nps-using-netsh-commands"></a>Для копирования конфигурации NPS на другой сервер политики сети, с помощью команды Netsh

1. На исходный сервер политики сети, откройте **командной**, тип **netsh**, и нажмите клавишу ВВОД.

2. В **netsh** , введите **nps**, и нажмите клавишу ВВОД. 

3. В **netsh nps** , введите **Экспорт filename =**"*path\file.xml*" **exportPSK = YES**, где *путь* местоположение папки, где нужно сохранить в файл конфигурации сервера политики сети, и *файл* имя XML-файл, который требуется сохранить. Нажмите клавишу ВВОД. 

Хранит параметры конфигурации \(в том числе параметры реестра\) в XML-файл. Путь может быть относительным или абсолютным, или он может быть Universal Naming Convention \(UNC\) путь. После нажатия клавиши ВВОД, отображается сообщение является признаком того, экспорт в файл выполнен успешно.

4. Скопируйте созданный файл в место назначения NPS.

5. Введите в командной строке на сервере назначения NPS **netsh nps импортировать filename =**"*path\file.xml*«, и нажмите клавишу ВВОД. Появится сообщение об импорта XML-файла, было ли успешным.

Дополнительные сведения о команде netsh см. в разделе [сетевой оболочки (Netsh)](../netsh/netsh.md).

