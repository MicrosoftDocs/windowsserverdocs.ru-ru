---
title: Экспорт конфигурации NPS для импорта на другом сервере
description: С помощью этого раздела можно узнать, как экспортировать конфигурацию сервера политики сети в Windows Server 2016.
manager: brianlic
ms.topic: article
ms.assetid: d268dc57-78f8-47ba-9a7a-a607e8b9225c
ms.author: lizross
author: eross-msft
ms.openlocfilehash: 7558a431d2745866d03edbed1346b75604dc20ff
ms.sourcegitcommit: d08965d64f4a40ac20bc81b14f2d2ea89c48c5c8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2020
ms.locfileid: "96866463"
---
# <a name="export-an-nps-configuration-for-import-on-another-server"></a>Экспорт конфигурации NPS для импорта на другом сервере

Область применения. Windows Server 2016

Вы можете экспортировать всю конфигурацию NPS, включая клиенты и серверы RADIUS, политику сети, политику запросов на подключение, реестр и конфигурацию ведения журнала, из одного сервера политики сети для импорта на другой сервер политики сети.

Для экспорта конфигурации NPS используйте одно из следующих средств.

- В Windows Server 2016, Windows Server 2012 R2 и Windows Server 2012 можно использовать команду netsh, или можно использовать Windows PowerShell.
- В Windows Server 2008 R2 и Windows Server 2008 используйте команду netsh.

> [!IMPORTANT]
> Не используйте эту процедуру, если исходная база данных NPS имеет более высокий номер версии, чем номер версии целевой базы данных NPS. Номер версии базы данных NPS можно просмотреть, выводимой командой **netsh nps View config** .

Так как конфигурации NPS не шифруются в экспортированном XML-файле, их отправка по сети может представлять угрозу безопасности, поэтому при перемещении XML-файла с исходного сервера на целевые серверы необходимо соблюдать определенные меры предосторожности. Например, перед перемещением файла добавьте файл в зашифрованный защищенный паролем архивный файл. Кроме того, храните файл в безопасном месте, чтобы предотвратить доступ злоумышленников к нему.

> [!NOTE]
> Если SQL Server ведение журнала настроено на исходном сервере политики сети, SQL Server параметры ведения журнала не экспортируются в XML-файл. После импорта файла на другой сервер политики сети необходимо вручную настроить ведение журнала SQL Server.

## <a name="export-and-import-the-nps-configuration-by-using-windows-powershell"></a>Экспорт и импорт конфигурации NPS с помощью Windows PowerShell

Для операционных систем Windows Server 2012 и более поздних версий можно экспортировать конфигурацию NPS с помощью Windows PowerShell.

Синтаксис команды для экспорта конфигурации NPS выглядит следующим образом.

```powershell
Export-NpsConfiguration -Path <filename>
```

В следующей таблице перечислены параметры для командлета **Export-нпсконфигуратион** в Windows PowerShell. Параметры, выделенные жирным шрифтом, являются обязательными.

|Параметр|Описание:|
|---------|-----------|
|Путь|Задает имя и расположение XML-файла, в который необходимо экспортировать конфигурацию NPS.|

**Учетные данные администратора**

Для выполнения этой процедуры необходимо быть членом группы Администраторы.

### <a name="export-example"></a>Пример экспорта

В следующем примере конфигурация NPS экспортируется в XML-файл, расположенный на локальном диске. Чтобы выполнить эту команду, запустите Windows PowerShell от имени администратора в исходном NPS, введите следующую команду и нажмите клавишу ВВОД.

```powershell
Export-NpsConfiguration –Path c:\config.xml
```

Дополнительные сведения см. в разделе [Export-нпсконфигуратион](/powershell/module/nps/export-npsconfiguration).

После экспорта конфигурации NPS скопируйте XML-файл на целевой сервер.

Ниже приведен синтаксис команды для импорта конфигурации NPS на целевом сервере.

```powershell
Import-NpsConfiguration [-Path] <String> [ <CommonParameters>]
```

### <a name="import-example"></a>Пример импорта

Следующая команда импортирует параметры из файла с именем C:\Npsconfig.xml на сервер политики сети. Чтобы выполнить эту команду, запустите Windows PowerShell от имени администратора в целевом NPS, введите следующую команду и нажмите клавишу ВВОД.

```powershell
Import-NpsConfiguration -Path "C:\Npsconfig.xml"
```

Дополнительные сведения см. в разделе [Import-нпсконфигуратион](/powershell/module/nps/import-npsconfiguration).

## <a name="export-and-import-the-nps-configuration-by-using-netsh"></a>Экспорт и импорт конфигурации NPS с помощью команды netsh

Для экспорта конфигурации NPS с помощью команды **netsh nps export** можно использовать сетевую оболочку (Netsh).

При выполнении команды **netsh nps import** сервер политики сети автоматически обновляется с использованием обновленных параметров конфигурации. Для выполнения команды **netsh nps import** не нужно прекращать работу сервера политики сети на конечном компьютере, однако если консоль NPS или оснастка MMC NPS открыта во время импорта конфигурации, изменения конфигурации сервера будут видны только после обновления представления.

> [!NOTE]
> При использовании команды **netsh nps export** необходимо указать параметр команды **Експортпск** со значением **Yes**. Этот параметр и значение явно понимают, что вы экспортируете конфигурацию NPS и что экспортированный XML-файл содержит незашифрованные общие секреты для клиентов RADIUS и членов групп удаленных серверов RADIUS.

**Учетные данные администратора**

Для выполнения этой процедуры необходимо быть членом группы Администраторы.

### <a name="to-copy-an-nps-configuration-to-another-nps-using-netsh-commands"></a>Копирование конфигурации NPS в другой сервер политики сети с помощью команд Netsh

1. В исходном NPS откройте **командную строку**, введите команду **netsh** и нажмите клавишу ВВОД.

2. В командной строке **netsh** введите **NPS** и нажмите клавишу ВВОД.

3. В командной строке **netsh nps** введите **Export имя_файла =**"*path\file.xml*" **експортпск = Yes**, где *path* — это расположение папки, в которой нужно сохранить файл конфигурации NPS, а *File* — имя XML-файла, который необходимо сохранить. Нажмите клавишу ВВОД.

    В нем сохраняются параметры конфигурации (включая параметры реестра) в XML-файле. Путь может быть относительным или абсолютным, либо может быть путем в формате UNC. После нажатия клавиши Ввод появится сообщение о том, успешно ли выполнен экспорт в файл.

4. Скопируйте созданный файл в службу NPS назначения.

5. В командной строке на целевом сервере политики сети введите **команду netsh nps import filename =**"*path\file.xml*" и нажмите клавишу ВВОД. Появится сообщение о том, успешно ли выполнен импорт из XML-файла.

## <a name="additional-references"></a>Дополнительная справка

- [Сетевая оболочка (Netsh)](../netsh/netsh.md)
