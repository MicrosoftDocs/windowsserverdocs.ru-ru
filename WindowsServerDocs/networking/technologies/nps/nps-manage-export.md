---
title: Экспорт конфигурации NPS для импорта на другом сервере
description: С помощью этого раздела можно узнать, как экспортировать конфигурацию сервера политики сети в Windows Server 2016.
manager: brianlic
ms.prod: windows-server
ms.technology: networking
ms.topic: article
ms.assetid: d268dc57-78f8-47ba-9a7a-a607e8b9225c
ms.author: pashort
author: shortpatti
ms.openlocfilehash: cbebd0388ccd5dd2540a20f5d325d7f97c7e2bb3
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71405438"
---
# <a name="export-an-nps-configuration-for-import-on-another-server"></a>Экспорт конфигурации NPS для импорта на другом сервере

Область применения. Windows Server 2016

Вы можете экспортировать всю конфигурацию NPS, включая клиенты и серверы RADIUS, политику сети, политику запросов на подключение, реестр и конфигурацию ведения журнала, из одного сервера политики сети для импорта на другой сервер политики сети. 

Для экспорта конфигурации NPS используйте одно из следующих средств.

- В Windows Server 2016, Windows Server 2012 R2 и Windows Server 2012 можно использовать команду netsh, или можно использовать Windows PowerShell.
- В Windows Server 2008 R2 и Windows Server 2008 используйте команду netsh.

> [!IMPORTANT]
> Не используйте эту процедуру, если исходная база данных NPS имеет более высокий номер версии, чем номер версии целевой базы данных NPS. Номер версии базы данных NPS можно просмотреть, выводимой командой **netsh nps View config** .

Так как конфигурации NPS не шифруются в экспортированном XML-файле, их отправка по сети может представлять угрозу безопасности, поэтому при перемещении XML-файла с исходного сервера на целевые серверы необходимо соблюдать определенные меры предосторожности. Например, перед перемещением файла добавьте файл в зашифрованный защищенный паролем архивный файл. Кроме того, храните файл в безопасном месте, чтобы предотвратить доступ злоумышленников к нему.

> [!NOTE]
> Если SQL Server ведение журнала настроено на исходном сервере политики сети, SQL Server параметры ведения журнала не экспортируются в XML-файл. После импорта файла на другой сервер политики сети необходимо вручную настроить ведение журнала SQL Server.

## <a name="export-and-import-the-nps-configuration-by-using-windows-powershell"></a>Экспорт и импорт конфигурации NPS с помощью Windows PowerShell

Для операционных систем Windows Server 2012 и более поздних версий можно экспортировать конфигурацию NPS с помощью Windows PowerShell.

Синтаксис команды для экспорта конфигурации NPS выглядит следующим образом. 

    Export-NpsConfiguration -Path <filename>

В следующей таблице перечислены параметры для командлета **Export-нпсконфигуратион** в Windows PowerShell. Параметры, выделенные жирным шрифтом, являются обязательными.

|Параметр|Описание|
|---------|-----------|
|Path|Задает имя и расположение XML-файла, в который необходимо экспортировать конфигурацию NPS.|

**Учетные данные администратора**

Для выполнения этой процедуры необходимо быть членом группы администраторов.

### <a name="export-example"></a>Пример экспорта 

В следующем примере конфигурация NPS экспортируется в XML-файл, расположенный на локальном диске. Чтобы выполнить эту команду, запустите Windows PowerShell от имени администратора в исходном NPS, введите следующую команду и нажмите клавишу ВВОД.

`Export-NpsConfiguration –Path c:\config.xml` 

Дополнительные сведения см. в разделе [Export-нпсконфигуратион](https://technet.microsoft.com/library/jj872749.aspx).

После экспорта конфигурации NPS скопируйте XML-файл на целевой сервер.

Ниже приведен синтаксис команды для импорта конфигурации NPS на целевом сервере.

    Import-NpsConfiguration [-Path] <String> [ <CommonParameters>]

### <a name="import-example"></a>Пример импорта

Следующая команда импортирует параметры из файла с именем К:\нпсконфиг.ксмл на сервер политики сети. Чтобы выполнить эту команду, запустите Windows PowerShell от имени администратора в целевом NPS, введите следующую команду и нажмите клавишу ВВОД.

    PS C:\> Import-NpsConfiguration -Path "C:\Npsconfig.xml"

Дополнительные сведения см. в разделе [Import-нпсконфигуратион](https://technet.microsoft.com/library/jj872750.aspx).

## <a name="export-and-import-the-nps-configuration-by-using-netsh"></a>Экспорт и импорт конфигурации NPS с помощью команды netsh

Чтобы экспортировать конфигурацию NPS с помощью команды **netsh nps export** , можно использовать сетевую оболочку \(Netsh @ no__t-1.

При выполнении команды **netsh nps import** сервер политики сети автоматически обновляется с использованием обновленных параметров конфигурации. Для выполнения команды **netsh nps import** не нужно прекращать работу сервера политики сети на конечном компьютере, однако если консоль NPS или оснастка MMC NPS открыта во время импорта конфигурации, изменения конфигурации сервера будут видны только после обновления представления. 

> [!NOTE]
> При использовании команды **netsh nps export** необходимо указать параметр команды **Експортпск** со значением **Yes**. Этот параметр и значение явно понимают, что вы экспортируете конфигурацию NPS и что экспортированный XML-файл содержит незашифрованные общие секреты для клиентов RADIUS и членов групп удаленных серверов RADIUS.

**Учетные данные администратора**

Для выполнения этой процедуры необходимо быть членом группы администраторов.

### <a name="to-copy-an-nps-configuration-to-another-nps-using-netsh-commands"></a>Копирование конфигурации NPS в другой сервер политики сети с помощью команд Netsh

1. В исходном NPS откройте **командную строку**, введите команду **netsh**и нажмите клавишу ВВОД.

2. В командной строке **netsh** введите **NPS**и нажмите клавишу ВВОД. 

3. В командной строке **netsh nps** введите **Export имя_файла =** "*пас\филе.ксмл*" **експортпск = Yes**, где *путь* — это расположение папки, в которой нужно сохранить файл конфигурации NPS, а *файл* — имя XML-файла, который необходимо сохранить. Нажмите клавишу ВВОД. 

В нем хранятся параметры конфигурации \(including реестра @ no__t-1 в XML-файле. Путь может быть относительным или абсолютным или может быть универсальным соглашением об именовании \(UNC @ no__t-1 Path. После нажатия клавиши Ввод появится сообщение о том, успешно ли выполнен экспорт в файл.

4. Скопируйте созданный файл в службу NPS назначения.

5. В командной строке на целевом сервере политики сети введите **команду netsh nps import filename =** "*пас\филе.ксмл*" и нажмите клавишу ВВОД. Появится сообщение о том, успешно ли выполнен импорт из XML-файла.

Дополнительные сведения о команде netsh см. в разделе [Сетевая оболочка (Netsh)](../netsh/netsh.md).

