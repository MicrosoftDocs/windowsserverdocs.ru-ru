---
title: Настройка шаблонов сертификатов для требований PEAP и EAP
description: Этот раздел содержит сведения об использовании сертификатов с сервера политики сети и удаленного доступа в Windows Server 2016.
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 2af0a1df-5c44-496b-ab11-5bc340dc96f0
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 41f6f88705fa3d58be695fd825d960e7df21cd24
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59885885"
---
# <a name="configure-certificate-templates-for-peap-and-eap-requirements"></a>Настройка шаблонов сертификатов для требований PEAP и EAP

>Относится к: Windows Server (полугодовой канал), Windows Server 2016

Все сертификаты, которые используются для проверки подлинности доступа к сети с помощью расширяемого протокола проверки подлинности\-Transport Layer Security \(EAP\-TLS\), защищенный наращиваемый протокол аутентификации\- Безопасность на транспортном уровне \(PEAP\-TLS\)и PEAP\-Майкрософт протокола CHAP версии 2 \(MS\-CHAP v2\) необходимо соответствует требованиям для сертификатов X.509 и работать для подключений, использующих Secure Socket слоя/уровень безопасности транспорта (SSL/TLS). Сертификаты клиента и сервера имеют дополнительные требования.

>[!IMPORTANT]
>Этот раздел содержит инструкции по настройке шаблонов сертификатов. Чтобы использовать эти инструкции, это необходимо, вы развернули собственную инфраструктуру открытого ключа \(PKI\) со службами сертификатов Active Directory \(AD CS\).

## <a name="minimum-server-certificate-requirements"></a>Минимальным требованиям

С помощью протокола PEAP\-MS\-CHAP v2, PEAP\-TLS или EAP\-TLS в качестве метода проверки подлинности сервером политики сети необходимо использовать сертификат сервера, который соответствует минимальным требованиям. 

Клиентские компьютеры можно настроить для проверки сертификатов сервера с помощью **проверять сертификат сервера** параметр на клиентском компьютере или в групповой политике. 

Клиентский компьютер принимает попытки проверки подлинности сервера, если сертификат сервера соответствует следующим требованиям.

- Имя субъекта содержит значение. Если к серверу под управлением сервера политики в сети (NPS), который содержит пустое имя субъекта сертификата, сертификат не доступен для проверки подлинности на сервере политики сети. Чтобы настроить шаблон сертификата с именем субъекта:

    1. Откройте "Шаблоны сертификатов".
    2. В области сведений щелкните правой кнопкой мыши шаблон сертификата, который вы хотите изменить и нажмите кнопку **свойства** .
    3. Нажмите кнопку **имя субъекта** , а затем щелкните **строится на основе данных Active Directory**.
    4. В **формат имени субъекта**, выберите значение, отличное от **None**.

- Сертификат компьютера на сервере привязан к доверенным корневым центром сертификации (ЦС) и прошел проверки, выполняемые CryptoAPI, указанные в политике удаленного доступа или политики сети.

- Сертификат компьютера для сервера политики сети или VPN настраивается с целью проверки подлинности сервера в расширениях расширенное использование ключа (EKU). (Идентификатор объекта для проверки подлинности сервера — 1.3.6.1.5.5.7.3.1).

- Настройте сертификат сервера с обязательный параметр криптографии:

    1. Откройте "Шаблоны сертификатов".
    2. В области сведений щелкните правой кнопкой мыши шаблон сертификата, который вы хотите изменить и нажмите кнопку **свойства**.
    3. Нажмите кнопку **криптографии** вкладку и убедитесь, что следующие настройки:
       - **Категория поставщика:** Поставщик хранилища ключей
       - **Имя алгоритма:** RSA
       - **Поставщики:** Поставщик криптографии для платформы Microsoft
       - **Минимальный размер ключа:** 2048
       - **Хэш-алгоритм:** SHA2
    4. Нажмите кнопку **Далее**.

- Расширение альтернативное имя субъекта (SubjectAltName), если используется, должен содержать DNS-имя сервера. Чтобы настроить шаблон сертификата с именем регистрацию сервера доменных имен (DNS): 

    1. Откройте "Шаблоны сертификатов".
    2. В области сведений щелкните правой кнопкой мыши шаблон сертификата, который вы хотите изменить и нажмите кнопку **свойства** .
    3. Нажмите кнопку **имя субъекта** , а затем щелкните **строится на основе данных Active Directory**.
    4. В **включить эту информацию в альтернативное имя субъекта**выберите **DNS-имя**.

При использовании протокола PEAP и EAP-TLS, NPSs отобразить список всех установленных сертификатов в хранилище сертификатов на компьютере, за исключением следующих случаев:

- Сертификаты, не содержащих цель проверки подлинности сервера в расширениях, не отображаются.

- Сертификаты, которые не содержат имени субъекта, не отображаются.

- На основе реестра и сертификаты со смарт-картой не отображаются.

Дополнительные сведения см. в разделе [развертывание сертификатов сервера для проводных сетей 802.1 X и беспроводных развертываний](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/server-certs/deploy-server-certificates-for-802.1x-wired-and-wireless-deployments).

## <a name="minimum-client-certificate-requirements"></a>Требования к сертификатам минимальное клиентом

EAP-TLS или PEAP-TLS сервер принимает попытки проверки подлинности клиента, если сертификат отвечает следующим требованиям:

- Сертификат клиента выдан центром сертификации предприятия или сопоставлена с учетной записью пользователя или компьютера в доменных службах Active Directory \(AD DS\).

- Сертификат в цепочке с доверенным корневым ЦС, пользователя или компьютера содержит проверка подлинности клиента в расширениях \(идентификатор объекта для проверки подлинности клиента — 1.3.6.1.5.5.7.3.2\)и завершается ошибкой, ни проверяет, выполняются CryptoAPI, а также указаны в политике удаленного доступа или политики сети, а также проверки идентификатора объекта сертификата, указанные в политики сети.

- Клиент 802.1 X не использует сертификаты на основе реестра, которые являются либо смарт картой или сертификаты, защищенные паролем.

- Для сертификатов пользователей, то альтернативное имя получателя \(SubjectAltName\) расширений в сертификате содержится имя участника-пользователя \(имени участника-пользователя\). Чтобы настроить имя участника-пользователя в шаблоне сертификата:

    1. Откройте "Шаблоны сертификатов".
    2. В области сведений щелкните правой кнопкой мыши шаблон сертификата, который вы хотите изменить и нажмите кнопку **свойства**.
    3. Нажмите кнопку **имя субъекта** , а затем щелкните **строится на основе данных Active Directory**.
    4. В **включить эту информацию в альтернативное имя субъекта**выберите **имя участника-пользователя \(имени участника-пользователя\)**.

- Для сертификатов компьютеров, то альтернативное имя получателя \(SubjectAltName\) расширение в сертификате должно содержать полное доменное имя \(полное доменное имя\) клиента, который также называется  *DNS-имя*. Чтобы настроить это имя в шаблоне сертификата:

    1. Откройте "Шаблоны сертификатов".
    2. В области сведений щелкните правой кнопкой мыши шаблон сертификата, который вы хотите изменить и нажмите кнопку **свойства**.
    3. Нажмите кнопку **имя субъекта** , а затем щелкните **строится на основе данных Active Directory**.
    4. В **включить эту информацию в альтернативное имя субъекта**выберите **DNS-имя**.

С помощью протокола PEAP\-TLS и EAP\-TLS, клиенты отобразить список всех установленных сертификатов в оснастке сертификатов, за исключением следующих случаев:

- Не отображать беспроводных клиентов на базе реестра и сертификаты со смарт-картой. 

- Беспроводные клиенты и VPN-клиенты не отображают сертификаты, защищенные паролем. 

- Сертификаты, которые не содержат цель проверки подлинности клиента в расширениях, не отображаются.


Дополнительные сведения о сервере политики сети, см. в разделе [сервера политики сети (NPS)](nps-top.md).
