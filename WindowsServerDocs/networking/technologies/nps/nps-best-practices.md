---
title: Передовые практики по работе с сервером политики сети
description: В этом разделе приведены рекомендации по развертыванию и управлению сервера политики сети в Windows Server 2016.
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: 90e544bd-e826-4093-8c3b-6a6fc2dfd1d6
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 6cbd606edec06a80767ee997ef6a1397b66b7843
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59834235"
---
# <a name="network-policy-server-best-practices"></a>Передовые практики по работе с сервером политики сети

>Относится к: Windows Server (полугодовой канал), Windows Server 2016

Дополнительные сведения о рекомендациях для развертывания и управления сервера политики сети можно использовать в этом разделе \(NPS\).

Следующие разделы содержат рекомендации для различных аспектов развертывания NPS.

## <a name="accounting"></a>Учет

Ниже приведены рекомендации для ведения журнала сервера политики сети.

Существует два вида учета или ведение журнала на сервере политики сети.

- Ведение журнала событий для сервера политики сети. Ведение журнала событий для записи событий сервера политики сети можно использовать в журнале событий системы и безопасности. Используется главным образом для аудита и устранения неполадок попытки подключения.

- Ведение журнала запросов учета и проверки подлинности пользователя. Можно записывать в журнал запросы проверки подлинности и учета пользователей в файлы журнала в текстовом формате или формате базы данных, или вы можете войти в хранимую процедуру в базе данных SQL Server 2000. Ведение журнала запросов используется главным образом для подключения анализа и выставления счетов, а также полезна как средство исследования системы безопасности, предоставляя метод отслеживание действия злоумышленника.

Чтобы обеспечить наиболее эффективное NPS ведения журнала:

- Включите ведение журнала \(изначально\) для проверки подлинности и учетных записей. Измените набор компонентов, определив определяется разрешениями, подходящими для вашей среды.

- Убедитесь, что ведение журнала событий с емкостью, достаточное для ведения журналов.

- Создавать резервные копии всех файлов журнала на регулярной основе, так как они не может быть созданы заново при их повреждения или удаления.

- Используйте атрибут класса RADIUS, чтобы отследить использование и упростить определение отделения или пользователя взимать плату за использование. Несмотря на то, что автоматически созданный атрибут класса является уникальным для каждого запроса, в случаях, когда ответ на сервер доступа теряется и повторном запросе могут существовать повторяющиеся записи. Может потребоваться удаление из журналов для точного отслеживания использования.

- Если ваши серверы доступа к сети и прокси-серверы RADIUS на сервер политики сети, чтобы проверить, что сервер политики сети находится в сети, используйте периодически отправлять сообщения запроса вымышленной подключения **ping имя_пользователя** параметр реестра. Этот параметр позволяет настроить NPS так, чтобы автоматически отклонять запросы false подключения без обработки. Кроме того сервер политики сети не записывает транзакций, относящихся к вымышленное имя пользователя во всех файлах журнала, что облегчает интерпретировать в журнал событий.

- Отключить пересылку уведомлений NAS. Вы можете отключить перенаправление start и stop сообщения от серверы доступа к сети (NAS), членам удаленного RADIUS-сервера группы, IS, настроены на сервере политики сети. Дополнительные сведения см. в разделе [отключить пересылку уведомлений NAS](nps-disable-nas-notifications.md).

Дополнительные сведения см. в разделе [настроить сетевой политики сервера Accounting](nps-accounting-configure.md).

- Для обеспечения отказоустойчивости и избыточности с помощью ведения журнала SQL Server, установите два компьютера с SQL Server в разных подсетях. Используйте SQL Server **мастера создания публикации** для настройки базы данных репликации между двумя серверами. Дополнительные сведения см. в разделе [Техническая документация по SQL Server](https://msdn.microsoft.com/library/ms130214.aspx) и [репликации SQL Server](https://msdn.microsoft.com/library/ms151198.aspx).

## <a name="authentication"></a>Проверка подлинности

Ниже приведены рекомендации для проверки подлинности.

- Использовать методы проверки подлинности на основе сертификата, например защищенный наращиваемый протокол аутентификации \(PEAP\) и расширяемого протокола проверки подлинности \(EAP\) надежную проверку подлинности. Не следует использовать методы проверки подлинности только с паролем, так как они уязвимы для различных атак и не являются безопасными. Для безопасной проверки подлинности беспроводной сети, с использованием протокола PEAP\-MS\-CHAP v2 рекомендуется, поскольку сервер NPS подтверждает свою подлинность с беспроводным клиентам, воспользовавшись сертификатом сервера, когда пользователям подтверждать свою личность с помощью свои имя пользователя и пароль.  Дополнительные сведения об использовании сервера политики сети в развертывание по беспроводному соединению см. в разделе [развертывание паролю 802.1 X беспроводной доступ с проверкой подлинности](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/wireless/a-deploy-8021x-wireless-access).
- Развернуть собственный центр сертификации \(ЦС\) с Active Directory&reg; службы сертификатов \(AD CS\) при использовании методов строгой проверки подлинности на основе сертификатов, например PEAP и EAP, который требуется использовать сертификат сервера на NPSs. Ваш центр сертификации также можно регистрировать сертификаты и сертификаты пользователя. Дополнительные сведения о развертывании сертификатов сервера для серверов политики сети и удаленного доступа, см. в разделе [развертывание сертификатов сервера для проводных сетей 802.1 X и беспроводных развертываний](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/server-certs/deploy-server-certificates-for-802.1x-wired-and-wireless-deployments).

## <a name="client-computer-configuration"></a>Настройка клиентского компьютера

Ниже приведены рекомендации по конфигурации клиентского компьютера.

- Автоматически настройте все ваши член домена 802.1 X клиентских компьютеров с помощью групповой политики. Дополнительные сведения см. в разделе «Настройка беспроводной сети (IEEE 802.11) политики» в разделе [развертывания беспроводного доступа](https://technet.microsoft.com/windows-server-docs/networking/core-network-guide/cncg/wireless/e-wireless-access-deployment#bkmk_policies).

## <a name="installation-suggestions"></a>Советы по установке

Ниже приведены рекомендации по установке сервера политики сети.

- Прежде чем устанавливать сервер политики сети, установите и проверьте все серверы доступа к сети, с помощью локальных методов проверки подлинности, перед настройкой их в качестве RADIUS-клиентов на сервере политики сети.

- После установки и настройки сервера политики сети, сохраните конфигурацию с помощью команды Windows PowerShell [NpsConfiguration экспорта](https://technet.microsoft.com/library/jj872749.aspx). Сохраните конфигурацию сервера политики сети с помощью следующей команды, каждый раз перенастроить сервер NPS.

>[!CAUTION]
>- Экспортированный файл конфигурации NPS содержит незашифрованные общие секреты клиентов RADIUS и членов удаленных групп серверов RADIUS. По этой причине убедитесь, что сохраните файл в безопасное место.
>- Процесс экспорта не включает параметры ведения журнала для Microsoft SQL Server в экспортированном файле. Если импортировать экспортированный файл на другой сервер политики сети, необходимо вручную настроить ведения журнала SQL Server на новом сервере.

## <a name="performance-tuning-nps"></a>Настройка NPS производительности

Ниже приведены рекомендации по настройке сервера политики сети производительности.

- Для оптимизации времени отклика проверки подлинности и авторизации сервера политики сети и свести к минимуму сетевой трафик и установке сервера политики сети на контроллере домена.

- Когда универсальные имена участника- \(имена участников-пользователей\) или использовании доменов Windows Server 2008 и Windows Server 2003, сервер политики сети использует глобальный каталог для проверки подлинности пользователей. Чтобы свести к минимуму время, необходимое для этого, установите сервер политики сети на сервер глобального каталога или сервер, на той же подсети, что сервер глобального каталога.

- Если у вас есть настроенные группы внешних RADIUS-серверов и, в NPS политики запросов на подключение, снимите **записи учетных данных на серверах в следующей внешней группы RADIUS-сервера** флажок, эти группы представлены по-прежнему Отправлено сервера доступа к сети \(NAS\) запускать и останавливать сообщений уведомления. При этом создается лишний сетевой трафик. Чтобы исключить этот трафик, отключите пересылку уведомлений сервера для отдельных серверов в каждой группе удаленных RADIUS-сервера, сняв **вперед сети запуска и остановки сервера** "флажок".

## <a name="using-nps-in-large-organizations"></a>С помощью сервера политики сети в крупных организациях

Ниже приведены рекомендации по использованию сервера политики сети в крупных организациях.

- Если вы используете политики сети для ограничения доступа для всех, кроме некоторых групп, создайте универсальную группу для всех пользователей, которым вы хотите разрешить доступ и создайте политику сети, которая предоставляет доступ для этой универсальной группы. Не помещайте всех пользователей непосредственно в универсальную группу, особенно в том случае, если у вас есть большое количество их в сети. Вместо этого создайте отдельные группы, которые являются членами универсальной группы и добавлять пользователей в эти группы.

- Используйте имя участника-пользователя для ссылки на пользователей, когда это возможно. Пользователь может иметь одно основное имя пользователя независимо от членства в домене. Это обеспечивает масштабируемость, что может быть необходимым в организациях с большим числом доменов.

- Если вы установили сервер политики сети \(NPS\) на компьютере, отличном от домена контроллера и сервером политики сети получает большое количество запросов проверки подлинности в секунду, можно повысить производительность сервера политики сети, увеличив количество одновременных проверок подлинности между сервером политики сети и контроллером домена. Для получения дополнительных сведений см. 

## <a name="security-issues"></a>Проблемы безопасности

Ниже приведены рекомендации для сокращения проблем безопасности.

При удаленном администрировании сервера политики сети не отправляются важные или конфиденциальные данные (например, общие секреты или пароли) по сети в виде обычного текста. Существует два рекомендуемых метода для удаленного администрирования NPSs:

- Получить доступ к NPS служб удаленных рабочих столов. При использовании служб удаленных рабочих столов, не передаются между клиентом и сервером. Только пользовательский интерфейс сервера (например, рабочий стол операционной системы и изображение консоли сервера политики сети) отправляется клиенту служб удаленных рабочих столов, которая называется подключение удаленного рабочего стола в Windows&reg; 10. Клиент отправляет клавиатуру и мышь, локально обрабатывается на сервер с поддержкой служб удаленных рабочих столов. При входе пользователей служб удаленных рабочих столов, они могут просматривать только свои отдельных клиентских сеансов, которые управляются сервером и не зависят друг от друга. Кроме того удаленный рабочий стол предоставляет 128-битное шифрование между клиентом и сервером.

- Используйте безопасность протокола IP (IPsec) для шифрования конфиденциальных данных. Можно использовать IPsec для шифрования обмена данными между сервером политики сети и удаленного клиентского компьютера, который используется для администрирования сервера политики сети. Для удаленного администрирования сервера, можно установить [удаленного сервера администрирования средств для Windows 10](https://www.microsoft.com/download/details.aspx?id=45520) на клиентском компьютере. После установки используйте консоль управления (MMC) для добавления оснастки NPS в консоль.

>[!IMPORTANT]
>Удаленный сервер администрирования средств для Windows 10 можно установить только на полную версию Windows 10 Профессиональная или Windows 10 Корпоративная.

Дополнительные сведения о сервере политики сети, см. в разделе [сервера политики сети (NPS)](nps-top.md).

