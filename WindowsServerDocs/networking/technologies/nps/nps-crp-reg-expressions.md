---
title: Использование регулярных выражений в NPS
description: В этом разделе описывается использование регулярных выражений для сопоставления шаблонов в NPS в Windows Server 2016. Этот синтаксис можно использовать для указания условий атрибутов политики сети и сфер RADIUS.
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking
ms.topic: article
ms.assetid: bc22d29c-678c-462d-88b3-1c737dceca75
ms.author: pashort
author: shortpatti
ms.openlocfilehash: f51bfb1c767c0eee3aed64df9879dd0a97f2f7b1
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66446162"
---
# <a name="use-regular-expressions-in-nps"></a>Использование регулярных выражений в NPS

>Относится к: Windows Server (полугодовой канал), Windows Server 2016

В этом разделе описывается использование регулярных выражений для сопоставления шаблонов в NPS в Windows Server 2016. Этот синтаксис можно использовать для указания условий атрибутов политики сети и сфер RADIUS.

## <a name="pattern-matching-reference"></a>Ссылки для поиска совпадения с шаблоном

Следующие таблицы можно использовать как источник ссылки при создании регулярного выражения с синтаксисом поиска совпадения с шаблоном.


|  Символ  |                                                                                 Описание                                                                                  |                                                                 Пример                                                                 |
|-------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
|     `\`     |                                                              Отмечает следующий символ как символ для сопоставления.                                                               |                      `/n/ matches the character "n". The sequence /\n/ matches a line feed or newline character.`                       |
|     `^`     |                                                                 Соответствует началу ввода или строки.                                                                  |                                                                 &nbsp;                                                                  |
|     `$`     |                                                                    Соответствует концу ввода или строки.                                                                     |                                                                 &nbsp;                                                                  |
|     `*`     |                                                             Совпадает с предыдущим символом ноль или более раз.                                                              |                                                  `/zo*/ matches either "z" or "zoo."`                                                   |
|     `+`     |                                                              Совпадает с предыдущим символом один или несколько раз.                                                              |                                                   `/zo+/ matches "zoo" but not "z."`                                                    |
|     `?`     |                                                              Совпадает с предыдущим символом ноль или один раз.                                                              |                                                 `/a?ve?/ matches the "ve" in "never."`                                                  |
|     `.`     |                                                           Соответствует любому одиночному символу, кроме символа новой строки.                                                           |                                                                 &nbsp;                                                                  |
| `(pattern)` |                         Соответствует «шаблон» и сохраняет совпадение.<br />Чтобы соответствует буквенным символам `(` и `)` (скобки), используйте `\(` или `\)`.                         |                                                                 &nbsp;                                                                  |
|     \`x     |                                                                                     y \`                                                                                     |                                                         Совпадает с x или y.                                                          |
|   `{n} `    |                                                          Сопоставляет ровно n раз \(n не\-отрицательное целое число\).                                                           |               `/o{2}/ does not match the "o" in "Bob," but matches the first two instances of the letter o in "foooood."`               |
|   `{n,}`    |                                                          По крайней мере n раз \(n не\-отрицательное целое число\).                                                          | `/o{2,}/ does not match the "o" in "Bob" but matches all of the instances of the letter o in "foooood." /o{1,}/ is equivalent to /o+/.` |
|   `{n,m}`   |                                                По крайней мере n и не более m раз \(m и n — не\-отрицательные целые числа\).                                                |                               `/o{1,3}/ matches the first three instances of the letter o in "fooooood."`                               |
|   `[xyz]`   |                                                       Соответствует любому из символов в скобках \(кодировки\).                                                        |                                                  `/[abc]/ matches the "a" in "plain."`                                                  |
|  `[^xyz]`   |                                                  Соответствует любые символы, которые не заключаются \(отрицательный набор символов\).                                                  |                                                 `/[^abc]/ matches the "p" in "plain."`                                                  |
|    `\b`     |                                                              Соответствует границе слова \(например, пробел\).                                                               |                                              `/ea*r\b/ matches the "er" in "never early."`                                              |
|    `\B`     |                                                                         Соответствует границе не относящемуся к слову.                                                                          |                                             `/ea*r\B/ matches the "ear" in "never early."`                                              |
|    `\d`     |                                                       Соответствует цифровому символу \(эквивалентно цифр от 0 до 9\).                                                        |                                                                 &nbsp;                                                                  |
|    `\D`     |                                                           Соответствует знаку \(эквивалентно `[^0-9]` \).                                                           |                                                                 &nbsp;                                                                  |
|    `\f`     |                                                                        Совпадения перевода символов.                                                                        |                                                                 &nbsp;                                                                  |
|    `\n`     |                                                                        Совпадения символ перевода строки.                                                                        |                                                                 &nbsp;                                                                  |
|    `\r`     |                                                                     Соответствует символу возврата каретки.                                                                     |                                                                 &nbsp;                                                                  |
|    `\s`     |                                   Соответствует любому символу пустое пространство, включая пробел, вкладка и перевода страницы \(эквивалентно `[ \f\n\r\t\v]` \).                                   |                                                                 &nbsp;                                                                  |
|    `\S`     |                                                  Соответствует любому символу, отличный от пробела \(эквивалентно `[^ \f\n\r\t\v]` \).                                                   |                                                                 &nbsp;                                                                  |
|    `\t`     |                                                                           Соответствует знаку табуляции.                                                                           |                                                                 &nbsp;                                                                  |
|    `\v`     |                                                                      Соответствует знаку вертикальной табуляции.                                                                       |                                                                 &nbsp;                                                                  |
|    `\w`     |                                              Соответствует любому словообразующему символу, включая знак подчеркивания \(эквивалентно `[A-Za-z0-9_]` \).                                              |                                                                 &nbsp;                                                                  |
|    `\W`     |                                           Соответствует любой не\-словообразующему символу, за исключением подчеркивания \(эквивалентно `[^A-Za-z0-9_]` \).                                           |                                                                 &nbsp;                                                                  |
|   `\num`    | Ссылается на сохраненные совпадения \( `?num`, где число — положительное целое число\).  Этот параметр может использоваться только в **замените** текстовое поле при настройке атрибутами. |                                       `\1` заменяет первый сохраненное совпадение.                                       |
|   `/n/ `    |                      Позволяет вставлять коды ASCII в регулярных выражениях \( `?n`, где n — это значение escape восьмеричные, шестнадцатеричном или десятичном\).                       |                                                                 &nbsp;                                                                  |

## <a name="examples-for-network-policy-attributes"></a>Примеры для атрибутов политики сети

Ниже описывается использование синтаксис соответствия шаблону для указания атрибутов политики сети:

- Чтобы указать все телефонные номера с кодом города 899, используется следующий синтаксис:

     `899.*`

- Чтобы задать диапазон IP-адресов, которые начинаются с 192.168.1, используется следующий синтаксис:

    `192\.168\.1\..+`

## <a name="examples-for-manipulation-of-the-realm-name-in-the-user-name-attribute"></a>Примеры для работы со имени области в атрибуте имени пользователя

В следующих примерах описывается использование синтаксиса поиска совпадения с шаблоном для работы с именем сферы для атрибута имени пользователя, которая находится на **атрибут** окна свойств политики запросов на подключение.

**Чтобы удалить часть области атрибута имени пользователя**

В внешнего сценарии удаленного доступа, в котором поставщик услуг Интернета \(поставщика услуг Интернета\) направляет запросы на подключение к организации NPS, прокси-сервер RADIUS поставщика услуг Интернета может потребоваться имя сферы для маршрутизации запроса проверки подлинности. Тем не менее сервер политики сети может не распознать имя сферы, являющееся частью имени пользователя. Таким образом имени области необходимо удалить прокси-сервер RADIUS поставщика услуг Интернета, пока будут отправлены в организацию NPS.

- Поиск: @microsoft \.com

- Замена:

**Чтобы заменить <em>user@example.microsoft.com</em> с *example.microsoft.com\user***

- Найти:`(.*)@(.*)`

- Замените:`$2\$1`



**Чтобы заменить *"домен\имя пользователя"* с *specific_domain\user***

- Найти:`(.*)\\(.*)`

- Замена: *определенный_домен*`\$2`



<strong>Чтобы заменить *пользователя* с *user@specific_domain</strong>*

- Найти:`$`

- Замена: @*определенный_домен*

## <a name="example-for-radius-message-forwarding-by-a-proxy-server"></a>Пример для пересылки сообщений RADIUS через прокси-сервер

Можно создать правила маршрутизации, которые пересылают сообщения RADIUS с именем указанной области для набора серверов RADIUS, когда сервер политики сети используется в качестве RADIUS-прокси. Ниже приведен рекомендованный синтаксис для направления запросов на основе имени области.

- **NetBIOS-имя**: `WCOAST`
- **Шаблон**:      `^wcoast\\`

В следующем примере wcoast.microsoft.com является суффиксом уникального пользователя имени участника (UPN) для домена DNS и Active Directory wcoast.microsoft.com. С помощью указанного шаблона, прокси-сервер политики сети можно направлять сообщения на основе NetBIOS-имя домена или суффикс имени участника-пользователя.

- **NetBIOS-имя**: `WCOAST`
- **Суффикс имени участника-пользователя**:   `wcoast.microsoft.com`
- **Шаблон**:      `^wcoast\\|@wcoast\.microsoft\.com$`


Дополнительные сведения об управлении NPS см. в разделе [управление сервером политики сети](nps-manage-top.md).

Дополнительные сведения о сервере политики сети, см. в разделе [сервера политики сети (NPS)](nps-top.md).
