---
title: Планирование использования vRSS
description: С помощью этого раздела можно подготовить виртуальную машину и узел Hyper-V для использования vRSS в Windows Server 2016.
ms.prod: windows-server
ms.technology: networking
ms.topic: article
ms.assetid: 695e6192-5e84-4ab4-b33e-8ebf6b8f5cbb
ms.localizationpriority: medium
manager: dougkim
ms.author: lizross
author: eross-msft
ms.date: 09/04/2018
ms.openlocfilehash: befd2839319571827b88a1c7b2777c55861e31fa
ms.sourcegitcommit: da7b9bce1eba369bcd156639276f6899714e279f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2020
ms.locfileid: "80315264"
---
# <a name="plan-the-use-of-vrss"></a>Планирование использования vRSS

>Область применения: Windows Server (Semi-Annual Channel), Windows Server 2016

В Windows Server 2016 vRSS включен по умолчанию, однако необходимо подготовить среду, чтобы обеспечить правильную работу vRSS на виртуальной машине \(виртуальной машины\) или на виртуальном адаптере узла \(vNIC\). В Windows Server 2012 R2 vRSS был отключен по умолчанию.

При планировании и подготовке использования vRSS убедитесь, что:

- Физический сетевой адаптер совместим с очередь виртуальной машины \(VMQ\) и имеет скорость связи 10 Гбит/с или более.
- VMQ включается на физическом сетевом адаптере и на порте виртуального коммутатора Hyper\-V.
- Отсутствует однокорневой входной\-выходной виртуализации \(SR\-IOV\) настроены для виртуальной машины.
- Объединение сетевых карт настроено правильно.
- Виртуальная машина имеет несколько логических процессоров \(LPs\).

>[!NOTE]
>vRSS также включается по умолчанию для всех узлов vNIC, на которых включен RSS.

Ниже приведены дополнительные сведения, необходимые для выполнения этих подготовительных действий.
  
1. **Емкость сетевого адаптера**. Убедитесь, что сетевой адаптер совместим с очередь виртуальной машины \(VMQ\) и имеет скорость связи 10 Гбит/с или более. Если скорость связи меньше 10 Гбит/с, виртуальный коммутатор Hyper\-V по умолчанию отключает VMQ, даже несмотря на то, что в результате выполнения команды Windows PowerShell **Get-нетадаптервмк**она по-прежнему отображает VMQ как включенные. Один из способов, который можно использовать для проверки того, что VMQ включен или отключен, заключается в использовании команды **Get-нетадаптервмккуеуе**.  Если функция VMQ отключена, результаты этой команды показывают отсутствие Куеуеид, назначенных виртуальному сетевому адаптеру виртуальной машины или узла. 
  
2. **Включите VMQ**. Убедитесь, что VMQ включена на хост-компьютере. vRSS не работает, если узел не поддерживает VMQ. Чтобы проверить, включен ли VMQ, запустите **Get-VMSwitch** и найдите адаптер, используемый виртуальным коммутатором. После этого запустите **Get-NetAdapterVmq** и убедитесь, что адаптер отображается в результатах и VMQ на нем включена.
  
3. **Отсутствие SR\-IOV**. Убедитесь, что одна корневая входная\-выходной виртуализации \(SR\-IOV\) виртуальная функция \(драйвер VF\) не подключена к сетевому интерфейсу виртуальной машины. Это можно проверить с помощью команды **Get-нетадаптерсриов** . Если загружен драйвер VF, RSS использует параметры масштабирования из этого драйвера, а не настройки vRSS. Если драйвер VF не поддерживает RSS, то функция vRSS отключена.
  
4. **Настройка объединения сетевых карт**. Если вы используете объединение сетевых карт, важно правильно настроить VMQ для работы с параметрами объединения сетевых карт. Подробные сведения о развертывании и управлении с объединением сетевых карт см. в разделе [Объединение сетевых](https://docs.microsoft.com/windows-server/networking/technologies/nic-teaming/nic-teaming)карт.

5. **Число LPS**. Убедитесь, что в виртуальной машине имеется более одного логического процессора \(LP\). для параллельной обработки vRSS использует RSS в виртуальной машине или на узле Hyper-V для балансировки нагрузки трафика, полученного в несколько LPs. Вы можете узнать, сколько LPs виртуальной машины, выполнив команду Windows PowerShell **Get-вмпроцессор** на узле. После выполнения команды можно просмотреть запись в столбце Count для числа LPs.

Узел vNIC всегда имеет доступ ко всем физическим процессорам. Чтобы настроить vNIC узла для использования определенного числа процессоров, используйте параметры **-басепроцессорнумбер** и **-макспроцессорс** при выполнении команды **Set-нетадаптеррсс** Windows PowerShell.

---