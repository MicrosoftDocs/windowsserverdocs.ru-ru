---
title: Сценарии политики качества обслуживания
description: В этом разделе приводятся сценарии политики качества обслуживания (QoS), демонстрирующие использование групповая политика для определения приоритета сетевого трафика конкретных приложений и служб в Windows Server 2016.
ms.prod: windows-server
ms.technology: networking
ms.topic: article
ms.assetid: c4306f06-a117-4f65-b78b-9fd0d1133f95
manager: brianlic
ms.author: lizross
author: eross-msft
ms.openlocfilehash: 927232a3b191be86ae91b1dd0d6af767d4f024ae
ms.sourcegitcommit: da7b9bce1eba369bcd156639276f6899714e279f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2020
ms.locfileid: "80315428"
---
# <a name="qos-policy-scenarios"></a>Сценарии политики качества обслуживания

>Область применения: Windows Server (Semi-Annual Channel), Windows Server 2016

Этот раздел можно использовать для просмотра гипотетических сценариев, демонстрирующих, как, когда и зачем использовать политику QoS.

В этом разделе используются следующие два сценария:

1. Определение приоритетов сетевого трафика для бизнес-приложения
2. Определение приоритетов сетевого трафика для серверного приложения HTTP

>[!NOTE]
>Некоторые разделы этого раздела содержат общие шаги, которые можно предпринять для выполнения описанных действий. Более подробные инструкции по управлению политикой QoS см. в статье [Управление политикой QoS](qos-policy-manage.md).

## <a name="scenario-1-prioritize-network-traffic-for-a-line-of-business-application"></a>Сценарий 1. определение приоритета сетевого трафика для бизнес-приложения

В этом сценарии ИТ-отдел имеет несколько целей, которые могут быть выполнены с помощью политики QoS:

- Повышенная производительность сети для задач\-критически важных приложений.
- Обеспечить лучшую производительность сети для набора ключей пользователей, когда они используют конкретное приложение.
- Убедитесь, что приложение для резервного копирования больших объемов данных компании\-не повлияет на производительность сети, используя слишком много пропускной способности.

ИТ-отдел решает настроить политику QoS для определения приоритета конкретных приложений с помощью кодовой точки службы дифференцирования \(DSCP\) значений для классификации сетевого трафика и настройки его маршрутизаторов для обеспечения предварительной обработки трафика с более высоким приоритетом. 

>[!NOTE]
>Дополнительные сведения о DSCP см. в разделе **определение приоритета качества обслуживания с помощью Приоритизированные службы кодовой точки** в [политике качества обслуживания (QoS)](qos-policy-top.md).

Помимо значений DSCP, политики качества обслуживания могут задавать частоту регулирования. Регулирование влияет на весь исходящий трафик, соответствующий политике качества обслуживания, до определенной скорости отправки.

### <a name="qos-policy-configuration"></a>Настройка политики качества обслуживания

С помощью трех отдельных целей ИТ-администратор решает создать три различные политики качества обслуживания.

#### <a name="qos-policy-for-lob-app-servers"></a>Политика QoS для серверов приложений LOB

Первое\-критическое приложение, для которого ИТ-отдел создает политику качества обслуживания, — это корпоративное\-ное планирование ресурсов предприятия \(ERP\) Application. Приложение ERP размещается на нескольких компьютерах под управлением Windows Server 2016. В службах домен Active Directory Services эти компьютеры являются членами подразделения \(\) подразделения, созданного для бизнес-\(LOB\) серверов приложений. Клиентский компонент\-для приложения ERP устанавливается на компьютерах под управлением Windows 10 и Windows 8.1.

В групповая политика ИТ – администратор выбирает объект групповая политика \(объекте групповой политики\), к которому будет применена политика качества обслуживания. С помощью мастера политики качества обслуживания ИТ-администратор создает политику качества обслуживания, называемую "бизнес-политика сервера", которая задает значение DSCP с высоким\-приоритетом 44 для всех приложений, любых IP-адресов, TCP и UDP и номеров портов.

Политика QoS применяется только к бизнес-серверам путем связывания объекта групповой политики с подразделением, содержащим только эти серверы, с помощью средства консоль управления групповыми политиками \(GPMC\). Эта политика LOB начального сервера применяет высокий\-приоритет DSCP каждый раз, когда компьютер отправляет сетевой трафик. Впоследствии эту политику качества обслуживания можно изменить \(в средстве редактор объектов групповой политики,\) включить номера портов приложения ERP, что ограничивает применение политики только при использовании указанного номера порта.

#### <a name="qos-policy-for-the-finance-group"></a>Политика качества обслуживания для группы "Финансы"

Хотя многие группы в компании обращаются к приложению ERP, Группа Финансы зависит от этого приложения при работе с клиентами, и группа должна постоянно иметь высокую производительность приложения.

Чтобы Группа «Финансы» могла поддерживать своих клиентов, она должна классифицировать трафик пользователей как высокий приоритет. Однако политика не должна применяться, если члены группы «Finance» используют приложения, отличные от ERP. 

По этой причине ИТ-отдел определяет вторую политику качества обслуживания, называемую "Клиентская политика клиента", в средстве редактор объектов групповой политики, которое применяет значение DSCP, равное 60, когда группа пользователей Финансы выполняет приложение ERP.

#### <a name="qos-policy-for-a-backup-app"></a>Политика качества обслуживания для приложения резервного копирования

На всех компьютерах работает отдельное приложение резервного копирования. Чтобы убедиться, что трафик приложения резервного копирования не использует все доступные сетевые ресурсы, ИТ-отдел создает политику резервного копирования данных. Эта политика архивации задает значение DSCP, равное 1, на основе имени исполняемого файла для приложения резервного копирования, которое является **BACKUP. exe**. 

Третий объект групповой политики создается и развертывается для всех клиентских компьютеров в домене. Всякий раз, когда приложение резервного копирования отправляет данные, применяется значение DSCP с низким приоритетом, даже если оно исходит от компьютеров в финансовом отделе.
  
>[!NOTE]
>Сетевой трафик без политики качества обслуживания отправляется со значением DSCP, равным 0.

### <a name="scenario-policies"></a>Политики сценариев

В следующей таблице перечислены политики QoS для этого сценария.
  
|Имя политики|Значение DSCP|Частота регулирования|Применено к подразделениям|Описание|  
|-----------------|----------------|-------------------|-----------------------------------|-----------------|
|[Нет политики]|0|Нет|[Нет развертывания]|Оптимальные усилия (по умолчанию) для неклассифицированного трафика.|  
|Архивация данных|1|Нет|Все клиенты|Применяет значение DSCP с низким приоритетом для этих небольших данных.|  
|LOB сервера|44|Нет|Подразделение компьютеров для ERP Server|Применение DSCP с высоким приоритетом для трафика сервера ERP|  
|LOB клиента|60|Нет|Группа пользователей Финансы|Применение DSCP с высоким приоритетом для клиентского трафика ERP|  

>[!NOTE]
>Значения DSCP представлены в десятичной форме.

Если политики QoS определены и применены с помощью групповая политика, исходящий сетевой трафик получает указанное в политике значение DSCP. Затем маршрутизаторы обеспечивают разностное обработку на основе этих значений DSCP с помощью очередей. Для этого ИТ-отдела маршрутизаторы настраиваются с четырьмя очередями: с высоким приоритетом, с посредним уровнем, с наибольшими усилиями и с низким приоритетом.

Когда трафик поступает на маршрутизатор со значениями DSCP из "политики LOB сервера" и "бизнес-политика клиента", данные помещаются в очереди с высоким приоритетом. Трафик со значением DSCP, равным 0, получает оптимальный уровень обслуживания. Пакеты со значением DSCP, равным 1 (из приложения резервного копирования), получают обработку с низким приоритетом.  
  
### <a name="prerequisites-for-prioritizing-a-line-of-business-application"></a>Необходимые условия для определения приоритетов бизнес-приложений

Чтобы выполнить эту задачу, убедитесь в соблюдении следующих требований.

- Участвующие компьютеры используют службу QoS\-совместимые операционные системы.

- Вовлеченные компьютеры являются членами домен Active Directory Services \(AD DS\) домена, чтобы их можно было настроить с помощью групповая политика.

- Сети TCP/IP настроены с маршрутизаторами, настроенными для DSCP \(\)RFC 2474. Дополнительные сведения см. в [документе RFC 2474](https://www.ietf.org/rfc/rfc2474.txt).

- Требования к административным учетным данным соблюдены.

#### <a name="administrative-credentials"></a>Учетные данные администратора

Для выполнения этой задачи необходимо иметь возможность создавать и развертывать объекты групповая политика.
  
#### <a name="setting-up-the-test-environment-for-prioritizing-a-line-of-business-application"></a>Настройка тестовой среды для определения приоритетов бизнес-приложения

Чтобы настроить тестовую среду, выполните следующие задачи.

- Создайте домен AD DS с клиентами и пользователями, сгруппированными в подразделение. Инструкции по развертыванию AD DS см. в разделе [основное сетевое руководством](https://docs.microsoft.com/windows-server/networking/core-network-guide/core-network-guide).

- Настройте маршрутизаторы для разностной очереди на основе значений DSCP. Например, значение DSCP 44 вводит в очередь "Platinum", а все остальные — в очередь.

>[!NOTE]
> Можно просматривать значения DSCP с помощью сетевых захватов, таких как сетевой монитор. После выполнения записи в сеть можно наблюдать за полем TOS в захваченных данных.

#### <a name="steps-for-prioritizing-a-line-of-business-application"></a>Действия по назначению приоритета бизнес-приложения

Чтобы определить приоритет бизнес-приложения, выполните следующие задачи.

1. Создание и связывание объекта групповая политика \(объект групповой политики\) с политикой качества обслуживания.

2. Настройте маршрутизаторы для разностного использования бизнес-приложения (с помощью очереди) на основе выбранных значений DSCP. Процедуры этой задачи будут зависеть от типа маршрутизаторов.

## <a name="scenario-2-prioritize-network-traffic-for-an-http-server-application"></a>Сценарий 2. определение приоритета сетевого трафика для серверного приложения HTTP

В Windows Server 2016 качество обслуживания на основе политик включает в себя политики на основе URL-адресов компонентов. Политики URL-адресов позволяют управлять пропускной способностью для HTTP-серверов.

Многие корпоративные приложения разрабатываются и размещаются на службы IIS \(IIS\) веб-серверах, а веб-приложения доступны из браузеров на клиентских компьютерах.

В этом сценарии предполагается, что вы управляете набором серверов IIS, на которых размещаются обучающие видеоматериалы для всех сотрудников вашей организации. Ваша цель состоит в том, чтобы убедиться в том, что трафик с этих видеосерверов не будет перегружать сеть и что видеотрафик будет отличаться от голоса и трафика данных в сети. 

Задача аналогична задаче в сценарии 1. Вы разрабатываете и настраиваете параметры управления трафиком, такие как значение DSCP для видеопотока, и скорость регулирования так же, как и для бизнес-приложений. Но при указании трафика вместо имени приложения необходимо ввести только URL-адрес, на который будет отвечать приложение HTTP-сервера: например, https://hrweb/training.
  
> [!NOTE]
>Политики QoS на основе URL-адресов нельзя использовать для определения приоритетов сетевого трафика для компьютеров под управлением операционных систем Windows, выпущенных до Windows 7 и Windows Server 2008 R2.

### <a name="precedence-rules-for-url-based-policies"></a>Правила приоритета для политик на основе URL-адресов

Все следующие URL-адреса являются допустимыми и могут быть указаны в политике качества обслуживания и одновременно применены к компьютеру или пользователю.

- https://video

- https://training.hr.mycompany.com

- https://10.1.10.249:8080/tech  

- HTTPS://*/ебукс

Но какой из них будет приоритетным? Правила просты. Политики на основе URL-адресов имеют приоритет в порядке чтения слева направо. Таким образом, от наивысшего приоритета до самого низкого приоритета поля URL-адреса будут:
  
[1. Схема URL-адресов](#bkmk_QoS_UrlScheme)

[2. узел URL-адреса](#bkmk_QoS_UrlHost)

[3. URL-адрес порта](#bkmk_QoS_UrlPort)

[4. путь URL-адреса](#bkmk_QoS_UrlPath)

Сведения приведены ниже.

####  <a name="1-url-scheme"></a><a name="bkmk_QoS_UrlScheme"></a>1. Схема URL-адресов

 `https://` имеет более высокий приоритет, чем `https://`.

####  <a name="2-url-host"></a><a name="bkmk_QoS_UrlHost"></a>2. узел URL-адреса

 От наивысшего приоритета к наименьшему, это:

1. Hostname

2. IPv6-адрес

3. IPv4-адрес

4. Подстановочные знаки

В случае имени узла имя узла с более точечными элементами (более глубина) имеет более высокий приоритет, чем имя узла с меньшим числом точечных элементов. Например, между следующими именами узлов:

- video.internal.training.hr.mycompany.com (глубина = 6)
  
- selfguide.training.mycompany.com (глубина = 4)
  
- обучение (глубина = 1)
  
- Библиотека (глубина = 1)
  
  **Video.internal.Training.hr.mycompany.com** имеет наивысший приоритет, а **selfguide.Training.mycompany.com** имеет следующий высший приоритет. **Обучение** и **Библиотека** имеют одинаковый самый низкий приоритет.  
  
####  <a name="3-url-port"></a><a name="bkmk_QoS_UrlPort"></a>3. URL-адрес порта

Конкретный или неявный номер порта имеет более высокий приоритет, чем порт с подстановочными знаками.

####  <a name="4-url-path"></a><a name="bkmk_QoS_UrlPath"></a>4. путь URL-адреса

Как и имя узла, путь URL-адреса может состоять из нескольких элементов. Элемент с большим числом элементов всегда имеет более высокий приоритет, чем тот, с меньшим значением. Например, следующие пути перечислены по приоритету:  

1.  /ебукс/теч/виндовс/нетворкинг/кос

2.  /ебукс/теч/виндовс/

3.  /ебукс

4.  /

Если пользователь выбирает включение всех подкаталогов и файлов по URL-адресу, этот путь будет иметь более низкий приоритет, чем если бы выбор не был сделан.

Пользователь может также указать IP-адрес назначения в политике на основе URL-адресов. Конечный IP-адрес имеет более низкий приоритет, чем любое из четырех указанных выше полей URL-адреса.
  
### <a name="quintuple-policy"></a>Политика пятиэлементные

Политика пятиэлементные указывается с помощью идентификатора протокола, исходного IP-адреса, исходного порта, целевого IP-адреса и целевого порта. Политика пятиэлементные всегда имеет более высокий приоритет, чем любая политика на основе URL-адреса. 

Если политика пятиэлементные уже применена для пользователя, Новая политика на основе URL-адресов не приведет к конфликтам на клиентских компьютерах этого пользователя.

Следующий раздел в этом руководстве содержит сведения об [управлении политикой QoS](qos-policy-manage.md).

Для первого раздела в этом руководстве см. раздел [Политика качества обслуживания (QoS)](qos-policy-top.md).
