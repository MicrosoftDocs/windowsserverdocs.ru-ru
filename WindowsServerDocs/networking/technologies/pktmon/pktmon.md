---
title: Монитор пакетов (Пктмон)
description: В этом разделе приводятся общие сведения о средстве диагностики сети (Пктмон) монитора пакетов.
ms.topic: overview
author: khdownie
ms.author: v-kedow
ms.date: 11/12/2020
ms.openlocfilehash: 3db2bcf2719c3cfb5430d8feb8fcac1684578452
ms.sourcegitcommit: 8808f871c8cf131f819ef5540286218bd425da96
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2020
ms.locfileid: "94632654"
---
# <a name="packet-monitor-pktmon"></a>Пктмон монитора пакетов \(\)

>Область применения: Windows Server (половина ежегодного канала), Windows Server 2019, Windows 10, Azure Stack ХЦИ, центр Azure Stack, Azure

Монитор пакетов (Пктмон) — это встроенное средство диагностики сети для Windows. Он может использоваться для записи пакетов, обнаружения пакетов, фильтрации пакетов и подсчета. Этот инструмент особенно полезен в сценариях виртуализации, например в сетях контейнеров и SDN, так как он обеспечивает видимость сетевого стека. Он доступен в окне с помощью команды pktmon.exe и с помощью расширений центра администрирования Windows. 

## <a name="overview"></a>Обзор

Любой компьютер, который обменивается данными по сети, имеет по крайней мере один сетевой адаптер. Все компоненты между этим адаптером и приложением формируют сетевой стек: набор сетевых компонентов, которые обрабатывают и перемещают сетевой трафик. В традиционных сценариях сетевой стек невелик, и все маршрутизация пакетов и переключение происходят во внешних устройствах.

<center>

:::image type="content" source="media/networking-stack.png" alt-text="Сетевой стек в традиционных сценариях" border="false":::

</center>

Однако с появлением виртуализации сети размер стека сети был умножен. Этот расширенный сетевой стек теперь включает такие компоненты, как виртуальный коммутатор, обрабатывающий обработку пакетов и переключение. Такая гибкая среда обеспечивает гораздо лучшее использование ресурсов и изоляцию безопасности, но также оставляет больше места для ошибок конфигурации, которые трудно диагностировать. Монитор пакетов обеспечивает расширенную видимость сетевого стека, который часто требуется для выявления этих ошибок.

<center>

:::image type="content" source="media/packet-capture.png" alt-text="Запись пакетов между компонентами Паккетмон" border="false":::

</center>

Монитор пакетов перехватывает пакеты в нескольких расположениях в сетевом стеке, предоставляя маршрут пакета. Если пакет был удален поддерживаемым компонентом в сетевом стеке, то монитор пакетов сообщит о том, что пакет удаляется. Это позволяет пользователям отличать компонент, который является предполагаемым местом назначения для пакета, и компонентом, который мешает работе пакета. Кроме того, монитор пакетов сообщит о причинах удаления. Например, MTU Мистматч, Filtered VLAN и т. д. Эти причины отбрасывания дают основную причину проблемы без необходимости исчерпания всех возможностей. Монитор пакетов также предоставляет счетчики пакетов для каждой точки перехвата, обеспечивая высокий уровень проверки потока пакетов без необходимости длительного анализа журналов.

<center>

:::image type="content" source="media/drop-detection.png" alt-text="Обнаружение удаления Паккетмон" border="false":::

</center>

## <a name="functionality"></a>функциональное назначение;

Функциональные возможности монитора пакетов обрабатываются с помощью выпусков Windows. В таблице ниже показаны основные возможности и соответствующий выпуск Windows.

| Функция                                                                  | RS5 (17763) | 19H1 (18362) | Вибраниум (19041) |
|:---------------------------------------------------------------------------:|:-----------:|:------------:|:-----------------:|
| Мониторинг пакетов и подсчет в нескольких расположениях в сетевом стеке | &#x2611;    | &#x2611;     | &#x2611;          |
| Удаленное обнаружение пакетов в нескольких расположениях стека                          | &#x2611;    | &#x2611;     | &#x2611;          |
| Гибкая фильтрация пакетов среды выполнения                                           | &#x2611;    | &#x2611;     | &#x2611;          |
| Поддержка инкапсуляции                                                       | &#x2610;    | &#x2611;     | &#x2611;          |
| Анализ сети на основе синтаксического анализа пакетов TcpDump                            | &#x2610;    | &#x2611;     | &#x2611;          |
| Анализ метаданных пакетов (OOB)                                              | &#x2610;    | &#x2610;     | &#x2611;          |
| Мониторинг пакетов на экране в режиме реального времени                                       | &#x2610;    | &#x2610;     | &#x2611;          |
| Ведение журнала в памяти большого объема                                               | &#x2610;    | &#x2610;     | &#x2611;          |
| Поддержка формата Wireshark и сетевой монитор                                | &#x2610;    | &#x2610;     | &#x2611;          |

>[!NOTE]
>Клиенты центра ХЦИ и Azure Stack должны рассчитывать на функции вибраниум. Azure Stack

## <a name="limitations"></a>Ограничения

Ниже приведены наиболее существенные ограничения для монитора пакетов.

- Беспроводная поддержка мультимедиа доступна только в сборках с утюгом
- Без интеграции брандмауэра
- Инструкция DROP Reporting доступна только для интегрированных компонентов

## <a name="get-started-with-packet-monitor"></a>Начало работы с монитором пакетов

Следующие ресурсы помогут приступить к работе с монитором пакетов.

### <a name="pktmon-command-syntax-and-formatting"></a>[Синтаксис и форматирование команд пктмон](pktmon-syntax.md)

Монитор пакетов доступен в окне с помощью команды pktmon.exe в вибраниум OS (сборка 19041). С [помощью этого раздела](pktmon-syntax.md) вы узнаете, как понять синтаксис, команды, форматирование и выходные данные пктмон.

### <a name="packet-monitoring-extension-in-windows-admin-center"></a>[Расширение мониторинга пакетов в центре администрирования Windows](pktmon-wac-extension.md)

Расширение мониторинга пакетов позволяет выполнять и использовать монитор пакетов через центр администрирования Windows. Расширение помогает диагностировать сеть путем записи и отображения сетевого трафика через сетевой стек в журнале, который легко отслеживать и манипулировать. С [помощью этого раздела](pktmon-wac-extension.md) вы узнаете, как работать с инструментом и понять его выходные данные.

### <a name="sdn-data-path-diagnostics-extension-in-windows-admin-center"></a>[Расширение диагностики пути к данным SDN в центре администрирования Windows](pktmon-sdn-data-path-wac-extension.md)

Диагностика пути к данным SDN — это средство в расширении системы мониторинга SDN в центре администрирования Windows. Средство автоматизирует запись пакетов на основе монитора пакетов в соответствии с различными сценариями SDN и представляет выходные данные в одном представлении, которое легко отслеживать и манипулировать ими. С [помощью этого раздела](pktmon-sdn-data-path-wac-extension.md) вы узнаете, как работать с инструментом и понять его выходные данные.

### <a name="microsoft-network-monitor-netmon-support"></a>[Поддержка Microsoft Network Monitor (Netmon)](pktmon-netmon-support.md)

Монитор пакетов создает журналы в формате ETL. Эти журналы можно анализировать с помощью Microsoft Network Monitor (Netmon) с помощью специальных средств синтаксического анализа. В [этом разделе](pktmon-netmon-support.md) объясняется, как анализировать созданные монитором пакетов ETL-файлы в Netmon.

### <a name="wireshark-pcapng-format-support"></a>[Поддержка Wireshark (формат пкапнг)](pktmon-pcapng-support.md)

Монитор пакетов может преобразовать журналы в формат пкапнг. Эти журналы можно анализировать с помощью Wireshark (или любого пкапнг анализатора). В [этом разделе](pktmon-pcapng-support.md) объясняются ожидаемые выходные данные и способы их использования.

## <a name="provide-feedback-to-engineering-team"></a>Отправить отзыв специалистам по разработке

Сообщите об ошибках или отправьте отзыв через центр обратной связи, выполнив следующие действия.

1. Запустите  **центр обратной связи** в   меню " **Пуск** ".

1. Выберите кнопку **сообщить о проблеме** или нажмите кнопку **предложить функцию** .

1. Введите осмысленный отзыв в поле **Сводка по вопросу**   .

1. Укажите сведения и шаги для воспроизведения проблемы в поле **Дополнительные сведения**   .

1. В верхней категории выберите  **сеть и Интернет**   , а затем — **монитор пакетов (pktmon.exe)** в качестве подкатегории.

1. Чтобы помочь нам быстрее выявление и устранение ошибки, зафиксируйте снимки экрана, вложите выходной журнал пктмон и (или) Воссоздайте проблему.

1. Нажмите кнопку **Отправить**.

После отправки отзыва или ошибки Группа инженеров может просмотреть отзывы и решить ее.
