---
title: Использование политики DNS для балансировки нагрузки приложений с географического местоположения
description: Этот раздел является частью DNS политики сценарий руководство для Windows Server 2016
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking-dns
ms.topic: article
ms.assetid: b6e679c6-4398-496c-88bc-115099f3a819
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 7637d927c7b22b83053e7f9100b07581c11bafc0
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2018
---
# <a name="use-dns-policy-for-application-load-balancing-with-geo-location-awareness"></a>Использование политики DNS для балансировки нагрузки приложений с географического местоположения

>Область применения: Windows Server (канал точками годовой), Windows Server 2016

Можно использовать в этом разделе описывается настройка политики DNS, чтобы сбалансировать приложения с помощью сведений о географическом расположении.

Предыдущий раздел в данном руководстве [использование политики DNS для балансировки нагрузки приложения](https://technet.microsoft.com/windows-server-docs/networking/dns/deploy/app-lb), использует пример вымышленные компании - Services оплаты Contoso -, которая предоставляет online подарить свой служб и которой веб-сайт с именем contosogiftservices.com. Службы оплаты Contoso распределение их online веб-приложений между серверами в Северной Америке центрах обработки данных, расположенных в Сиэтл, Вашингтон, Чикаго, штат Иллинойс и Даллас, Техас.

>[!NOTE]
>Рекомендуется ознакомиться с разделом [использование политики DNS для балансировки нагрузки приложения](https://technet.microsoft.com/windows-server-docs/networking/dns/deploy/app-lb) перед выполнением инструкции в этом сценарии.

В этом разделе использует же вымышленной компании и сетевой инфраструктуры в качестве основы для нового развертывания пример, включающий географического местоположения.

В этом примере службы оплаты Contoso успешно развернут их наличие по всему миру.

Подобно Северной Америки компании теперь у веб-серверы, размещенные в европейской центрах обработки данных.

Contoso оплаты службы DNS-сервера требуется настроить балансировки нагрузки приложений для европейских центров обработки данных так же, как для реализации политики DNS в Соединенных Штатах с трафика приложения распределена между веб-серверы, расположенные в Дублин, Ирландия, Амстердам, Голландия и других странах.

Администраторам DNS также могут потребоваться все запросы из других мест в мире распределены поровну между всеми свои центры обработки данных.

В следующих разделах рассказывается, как для достижения целей, аналогичные тем Администраторы DNS Contoso в своей сети.

## <a name="how-to-configure-application-load-balancing-with-geo-location-awareness"></a>Настройка балансировки нагрузки приложений с географического местоположения

Ниже показано, как Настройка политики DNS для балансировки нагрузки приложений с географического местоположения.

>[!IMPORTANT]
>В следующих разделах приведены примеры Windows PowerShell команд, содержащих примеры значений для многих параметров. Убедитесь, замените примеры значений в этих командах со значениями, подходящими для вашего развертывания, прежде чем выполнять эти команды.

###<a name="bkmk_clientsubnets"></a>Создание подсети клиента DNS

Вам необходимо определить подсетей, или пространство IP-адресов области Северной Америки и Европы.

Эти сведения можно получить из карты географического-IP. На основании этих IP-географического распределения, необходимо создать подсети клиента DNS.

Подсеть клиента DNS является логической группой подсети IPv4 или IPv6, из которых запросы отправляются на DNS-сервер.

Создание подсети клиента DNS можно использовать следующие команды Windows PowerShell. 

    
    Add-DnsServerClientSubnet -Name "AmericaSubnet" -IPv4Subnet 192.0.0.0/24,182.0.0.0/24
    Add-DnsServerClientSubnet -Name "EuropeSubnet" -IPv4Subnet 141.1.0.0/24,151.1.0.0/24
    
Дополнительные сведения см. в разделе [добавить DnsServerClientSubnet](https://technet.microsoft.com/library/mt126261.aspx).

###<a name="bkmk_zscopes2"></a>Создание областей зоны

После подсети клиента необходимо разделить contosogiftservices.com зоны в области другой зоны, каждого центра обработки данных.

Область зоны представляет уникальный экземпляр зоны. Зона DNS может иметь несколько областей зоны, с каждой областью зону, содержащую собственный набор DNS-записей. Ту же запись может быть представлен в нескольких областях, различные IP-адреса или одинаковые IP-адреса.

>[!NOTE]
>По умолчанию область зоны существует для зон DNS. Эта область зоны имеет то же имя, что зона и устаревших операции DNS-сервера работают в этой области.

Предыдущего сценария о балансировке нагрузки приложения показано, как настроить три области зоны для центров обработки данных в Северной Америке.

С приведенные ниже команды можно создать два дополнительных области зоны, для Dublin и Амстердам центрах обработки данных. 

Можно добавить эти области зоны без изменений для трех областей существующих Северной Америки зоны в той же зоны. Кроме того после создания эти области зоны, не нужно перезапустить DNS-сервера.

Следующие команды Windows PowerShell можно использовать для создания областей зоны.

    
    Add-DnsServerZoneScope -ZoneName "contosogiftservices.com" -Name "DublinZoneScope"
    Add-DnsServerZoneScope -ZoneName "contosogiftservices.com" -Name "AmsterdamZoneScope"
    

Дополнительные сведения см. в разделе [добавить DnsServerZoneScope](https://technet.microsoft.com/library/mt126267.aspx)

###<a name="bkmk_records2"></a>Добавить записи в области зоны

Теперь необходимо добавить записи, представляющий веб-сервера в области зоны.

Записи для центров обработки данных Америки были добавлены в предыдущем сценарии. Можно использовать следующие команды Windows PowerShell для добавления записей к области зоны для европейских центров обработки данных.
 
    
    Add-DnsServerResourceRecord -ZoneName "contosogiftservices.com" -A -Name "www" -IPv4Address "151.1.0.1" -ZoneScope "DublinZoneScope”
    Add-DnsServerResourceRecord -ZoneName "contosogiftservices.com" -A -Name "www" -IPv4Address "141.1.0.1" -ZoneScope "AmsterdamZoneScope"
    

Дополнительные сведения см. в разделе [добавить DnsServerResourceRecord](https://technet.microsoft.com/library/jj649925.aspx).

###<a name="bkmk_policies2"></a>Создание политик DNS

После создания разделов (зоны областей) и добавления записей, необходимо создать политики DNS, которые распределять входящие запросы между этих областей.

В этом примере распространения запроса на серверах приложений в различных центрах обработки данных отвечает следующим требованиям.

1. При получении запроса DNS из источника в Северной Америке клиентской подсети, 50% ответов DNS пункты центре обработки данных Сиэтл 25% ответов точка Чикаго центра обработки данных, и остальные 25% ответов точка Даллас центра обработки данных.
2. При получении запроса DNS из источника в европейской клиентской подсети 50% ответов DNS точка Dublin центра обработки данных, и 50% ответов DNS точка Амстердам центра обработки данных.
3. Если запрос подается из других мест в мире, ответов DNS распространяются на все пять центров обработки данных.

Следующие команды Windows PowerShell можно использовать для реализации этих политик DNS.

    
    Add-DnsServerQueryResolutionPolicy -Name "AmericaLBPolicy" -Action ALLOW -ClientSubnet "eq,AmericaSubnet" -ZoneScope "SeattleZoneScope,2;ChicagoZoneScope,1; TexasZoneScope,1" -ZoneName "contosogiftservices.com" –ProcessingOrder 1
    
    Add-DnsServerQueryResolutionPolicy -Name "EuropeLBPolicy" -Action ALLOW -ClientSubnet "eq,EuropeSubnet" -ZoneScope "DublinZoneScope,1;AmsterdamZoneScope,1" -ZoneName "contosogiftservices.com" -ProcessingOrder 2
    
    Add-DnsServerQueryResolutionPolicy -Name "WorldWidePolicy" -Action ALLOW -FQDN "eq,*.contoso.com" -ZoneScope "SeattleZoneScope,1;ChicagoZoneScope,1; TexasZoneScope,1;DublinZoneScope,1;AmsterdamZoneScope,1" -ZoneName "contosogiftservices.com" -ProcessingOrder 3
    
    

Дополнительные сведения см. в разделе [добавить DnsServerQueryResolutionPolicy](https://technet.microsoft.com/library/mt126273.aspx).

Вы успешно создали политики DNS, которая обеспечивает приложения балансировку нагрузки на веб-серверы, расположенные в пяти различных центрах обработки данных на несколько континентах.

Можно создать тысячи политик DNS в соответствии с трафик требования к управлению, и все новые политики применяются динамически — без перезагрузки DNS-сервер — на входящие запросы.
