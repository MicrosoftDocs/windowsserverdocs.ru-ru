---
title: Использование политики DNS для балансировки нагрузки приложений
description: Этот раздел является частью DNS политики сценарий руководство для Windows Server 2016
manager: brianlic
ms.prod: windows-server-threshold
ms.technology: networking-dns
ms.topic: article
ms.assetid: f9c313ac-bb86-4e48-b9b9-de5004393e06
ms.author: pashort
author: shortpatti
ms.openlocfilehash: d156c258b971c45bf1c4c20739440bd5cc9e239f
ms.sourcegitcommit: 19d9da87d87c9eefbca7a3443d2b1df486b0b010
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2018
---
# <a name="use-dns-policy-for-application-load-balancing"></a>Использование политики DNS для балансировки нагрузки приложений

>Область применения: Windows Server (канал точками годовой), Windows Server 2016

Чтобы узнать, как настроить политику DNS для выполнения балансировки нагрузки приложений можно использовать в этом разделе.

Предыдущие версии Windows Server DNS, предоставляется только балансировки нагрузки с помощью циклического перебора ответы; Однако с помощью DNS в Windows Server 2016, можно настроить политики DNS для балансировки нагрузки приложений.

При развертывании нескольких экземпляров приложения можно использовать политики DNS для балансировки нагрузки трафика между экземплярами другое приложение, тем самым динамически распределение нагрузки трафика для приложения.

## <a name="example-of-application-load-balancing"></a>Пример балансировки нагрузки приложений

Ниже приведен пример того, как использовать политику DNS для балансировки нагрузки приложений.

В этом примере используется один вымышленной компании - Services оплаты Contoso - обеспечивающее online gifing services, и с веб-сайта с именем **contosogiftservices.com**.

Contosogiftservices.com веб-сайт размещается в нескольких центрах обработки данных, имеющих разные IP-адреса.

В Северной Америке, которая является основной рынка для оплаты служб Contoso, веб-сайт размещается в трех центров обработки данных: Чикаго, штат Иллинойс, Даллас, Техас и Сиэтл, Вашингтон.

Сиэтл веб-сервер имеет лучший конфигурацию оборудования и может обрабатывать два раза больше нагрузки в два других сайтов. Службы оплаты Contoso хочет приложения трафик, направленный следующим образом.

- Поскольку Сиэтл веб-сервера включает дополнительные ресурсы, часть приложения клиентов будут направляться на этот сервер
- Один квартал приложения клиентов направляются Даллас, Техас центра обработки данных
- Один квартал приложения клиентов направляются в центре обработки данных в Чикаго, штат Иллинойс

Этот сценарий показана на следующем рисунке.

![DNS-сервера приложения балансировки нагрузки с помощью политики DNS](../../media/Dns-App-Lb/dns-app-lb.jpg)


### <a name="how-application-load-balancing-works"></a>Как приложение балансировки нагрузки поддерживает

После настройки DNS-сервера с помощью политики DNS для приложения загрузки балансировки этот пример сценария с помощью DNS-сервер отвечает 50% времени в Сиэтле адрес веб-сервера, 25% времени Даллас веб-адресу сервера и 25% времени Чикаго веб-адресу сервера.

Таким образом для каждые четыре запросы, получаемые DNS-сервер, он отобразит двух ответов для Сиэтла и одному для каждой Даллас и в Чикаго.

Одна из возможных проблем с балансировки нагрузки с помощью политики DNS является кэширование записи DNS с помощью DNS-клиента и сопоставитель или LDNS, который может мешать балансировку нагрузки, поскольку клиент или распознаватель не отправлять запрос на DNS-сервер.

Можно снизить влияние это поведение с помощью низкое значение времени жизни заполнением \(TTL\) для записей DNS, которые должны быть балансировкой нагрузки.

### <a name="how-to-configure-application-load-balancing"></a>Настройка балансировки нагрузки приложений

Ниже показано, как настроить политики DNS для балансировки нагрузки приложений.

#### <a name="create-the-zone-scopes"></a>Создание областей зоны

Кроме того, необходимо сначала создать областей contosogiftservices.com зоны для центров обработки данных в которых они размещены.

Область зоны представляет уникальный экземпляр зоны. Зона DNS может иметь несколько областей зоны, с каждой областью зону, содержащую собственный набор DNS-записей. Ту же запись может быть представлен в нескольких областях, различные IP-адреса или одинаковые IP-адреса.

>[!NOTE]
>По умолчанию область зоны существует для зон DNS. Эта область зоны имеет то же имя, что зона и устаревших операции DNS-сервера работают в этой области.

Следующие команды Windows PowerShell можно использовать для создания областей зоны.
    
    Add-DnsServerZoneScope -ZoneName "contosogiftservices.com" -Name "SeattleZoneScope"
    
    Add-DnsServerZoneScope -ZoneName "contosogiftservices.com" -Name "DallasZoneScope"
    
    Add-DnsServerZoneScope -ZoneName "contosogiftservices.com" -Name "ChicagoZoneScope"

Дополнительные сведения см. в разделе [добавить DnsServerZoneScope](https://technet.microsoft.com/library/mt126267.aspx)

####<a name="bkmk_records"></a>Добавить записи в области зоны

Теперь необходимо добавить записи, представляющий веб-сервера в области зоны.

В **SeattleZoneScope**, вы можете добавить записи www.contosogiftservices.com с IP-адресом 192.0.0.1, который находится в Сиэтле центра обработки данных.

В **ChicagoZoneScope**, можно добавить же \(www.contosogiftservices.com\) записи с IP-адресом 182.0.0.1 в Чикаго центре обработки данных.

Аналогичным образом в **DallasZoneScope**, \(www.contosogiftservices.com\) записи с IP-адресом 162.0.0.1 можно добавить в Чикаго центре обработки данных.

Можно использовать следующие команды Windows PowerShell для добавления записей в зоне области.
    
    Add-DnsServerResourceRecord -ZoneName "contosogiftservices.com" -A -Name "www" -IPv4Address "192.0.0.1" -ZoneScope "SeattleZoneScope
    
    Add-DnsServerResourceRecord -ZoneName "contosogiftservices.com" -A -Name "www" -IPv4Address "182.0.0.1" -ZoneScope "ChicagoZoneScope"
    
    Add-DnsServerResourceRecord -ZoneName "contosogiftservices.com" -A -Name "www" -IPv4Address "162.0.0.1" -ZoneScope "DallasZoneScope"
    

Дополнительные сведения см. в разделе [добавить DnsServerResourceRecord](https://technet.microsoft.com/library/jj649925.aspx).

####<a name="bkmk_policies"></a>Создание политик DNS

После создания разделов (зоны областей) и добавления записей, необходимо создать политики DNS, которые распределять входящие запросы между этих областей, а 50% запросов для contosogiftservices.com ответить IP-адрес для веб-сервера в центре обработки данных Сиэтла и остальные равномерно распределяются между Чикаго и Даллас центрах обработки данных.

Следующие команды Windows PowerShell можно использовать для создания политики DNS, которая распределяет трафик приложения между этими тремя центрами обработки данных.

>[!NOTE]
>В примере команды ниже выражение – зонаобласть «SeattleZoneScope, 2; ChicagoZoneScope 1; DallasZoneScope, 1" настраивает DNS-сервер с массивом, который включает в себя сочетание параметров \ < ZoneScope\ > \ < weight\ >.
    
    Add-DnsServerQueryResolutionPolicy -Name "AmericaPolicy" -Action ALLOW – -ZoneScope "SeattleZoneScope,2;ChicagoZoneScope,1;DallasZoneScope,1" -ZoneName "contosogiftservices.com"
    

Дополнительные сведения см. в разделе [добавить DnsServerQueryResolutionPolicy](https://technet.microsoft.com/library/mt126273.aspx).  

Вы успешно создали политики DNS, которая обеспечивает приложения балансировку нагрузки на веб-серверы в трех различных центрах обработки данных.

Можно создать тысячи политик DNS в соответствии с трафик требования к управлению, и все новые политики применяются динамически — без перезагрузки DNS-сервер — на входящие запросы.