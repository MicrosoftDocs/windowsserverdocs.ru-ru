---
ms.assetid: 6086947f-f9ef-4e18-9f07-6c7c81d7002c
title: Средства службы времени Windows и параметры
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: networking
ms.openlocfilehash: 70b7ee4a9955e023d1664a3c29295a22cd5dc75b
ms.sourcegitcommit: fd6a46b702b235f38d90814dd769106ab37cd61b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2018
---
# <a name="windows-time-service-tools-and-settings"></a>Средства службы времени Windows и параметры

>Область применения: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012


**В этом разделе**  
  
-   [Средства службы времени Windows](#w2k3tr_times_tools_dyax)  
  
-   [Записи реестра для службы времени Windows](#w2k3tr_times_tools_uhlp)  
  
-   [Параметры политики группа службы времени Windows](#w2k3tr_times_tools_vwtt)  
  
-   [Сетевые порты, используемым службой времени Windows](#w2k3tr_times_tools_suxb)  
  
-   [Связанные сведения](#w2k3tr_times_tools_qoep)  
  
> [!NOTE]  
> Этот раздел содержит сведения только о средства и параметры службы времени Windows (W32Time). Если требуется только для синхронизации времени для присоединенных к домену клиентского компьютера, см. раздел [Настройка клиентского компьютера для синхронизации времени автоматического домена](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/cc816884%28v%3dws.10%29). Дополнительные разделы, посвященные настройке службы времени Windows см. список статей в разделе [где найти Windows времени сведений о конфигурации службы](https://technet.microsoft.com/library/cc773061.aspx).  
  
> [!CAUTION]  
> Не следует использовать команды Net time для настройки или установки времени, при запуске службы времени Windows.  

Кроме того, на более старых компьютерах, работающих под управлением Windows XP или более ранних версиях команды Net time /querysntp отображает имя сервера протокола сетевого времени (NTP), с которым компьютер настроен для синхронизации, но NTP-сервером используется только в том случае, если компьютер клиента настроен как NTP или AllSync. Поскольку команда устарел.  
  
Большинство компьютеров домена имеют тип клиента времени NT5DS, это означает, что они синхронизацию времени в иерархии домена. Только типичные исключения — контроллер домена, который работает в качестве основного домена (PDC) контроллеру хозяин операций эмулятора корневого домена леса, как правило, настроенное для синхронизации времени с внешним источником времени. Чтобы просмотреть настройки времени компьютера, выполните W32tm//query /configuration команду из командной строки с повышенными привилегиями в начиная с Windows Server 2008 и Windows Vista и чтение **тип** строка в выходных данных команды. Дополнительные сведения см. в разделе [принципы работы службы времени Windows ](https://go.microsoft.com/fwlink/?LinkId=117753). Можно выполнить команду **выполнении команды reg query HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Parameters** и прочитать значение **NTP-сервер** в выходных данных команды.  
  
> [!IMPORTANT]  
> До выхода Windows Server 2016 служба W32Time не была разработана для удовлетворения потребностей приложения определенное время.  Тем не менее, обновления для Windows Server 2016 теперь позволяют реализовать решение для 1 мс точности в вашем домене.  В разделе [времени точность 2016 Windows](accurate-time.md) и [поддержки границы, чтобы настроить службу времени Windows для сред высокая точность](https://go.microsoft.com/fwlink/?LinkID=179459) Дополнительные сведения.  
  
## <a name="w2k3tr_times_tools_dyax"></a>Средства службы времени Windows  
Следующие средства связаны со службой времени Windows.  
  
#### <a name="w32tmexe-windows-time"></a>W32tm.exe: времени Windows  
**Категория**  

Это средство устанавливается в составе Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 по умолчанию установок.  
  
**Совместимость версий**  
  
Это средство работает в Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 по умолчанию установок.  
  
W32tm.exe используется для настройки параметров службы времени Windows. Может также использоваться для диагностики проблем со службой времени. W32tm.exe является средством предпочтительные командной строки для настройки, мониторинга и устранения неполадок службы времени Windows.  
  
В следующих таблицах описаны параметры, которые будут использоваться с W32tm.exe.  
  
**Параметры основного W32tm.exe**  
  
|Параметр|Описание|  
|-------------|---------------|  
|W32tm /?|Справка по командной строке W32tm|  
|W32tm//register|Регистрирует службу времени для запуска службы и добавляет конфигурация по умолчанию в реестре.|  
|W32tm//unregister|Отменяет регистрацию службы времени и удаляет все данные о конфигурации из реестра.|  
|W32tm//monitor<br /><br />[/domain:<domain name>] [/computers:<name>[,<name>[,<name>...]]] [/Threads:<num>]|домен - указывает, какой домен для отслеживания. Если имя домена не задано или домена ни компьютеров параметр указан, используется домен по умолчанию. Этот параметр может использоваться более одного раза.<br /><br />компьютеры - отслеживает конкретного списка компьютеров. Имена компьютеров разделяются запятыми без пробелов. Если с префиксом имени "*", оно интерпретируется как основным контроллером домена. Этот параметр может использоваться более одного раза.<br /><br />потоки - указывает число компьютеров, для анализа одновременно. Значение по умолчанию — 3. Допустимый диапазон — 1 – 50.|  
|w32tm /ntte <NT time epoch>|Преобразование системное время NT (10 ^ -7) s интервалах 1 января 1601, в удобном для чтения формате.|  
|w32tm /ntpte <NTP time epoch>|Преобразование времени NTP (2 ^ -32) s интервалах 1 января 1900 в удобном для чтения формате.|  
|w32tm//resync<br /><br />[/computer:<computer>]<br /><br />[/nowait]<br /><br />[/Rediscover]<br /><br />[/Soft]|Указывает компьютер, что следует выполнить синхронизацию часов как можно быстрее, и сбросить статистику накопленных ошибок.<br /><br />компьютер:<computer> -компьютер, который следует выполнить синхронизацию. Если не указан, будет выполнена повторная синхронизация локального компьютера.<br /><br />nowait - не ожидает ресинхронизировать возникает; немедленно возвращается. В противном случае дождитесь ресинхронизировать для выполнения перед возвратом.<br /><br />повторному — обнаружить конфигурации сети и повторному сетевые источники, а затем повторная синхронизация.<br /><br />мягкое - повторная синхронизация с использованием существующей статистики ошибок. Не полезным, предоставленных для обеспечения совместимости.|  
|w32tm /stripchart<br /><br />/computer:<target><br /><br />[/Period:<refresh>]<br /><br />[/dataonly]<br /><br />[/Samples:<count>]<br/><br/>[/rdtsc]<br/>|Отображение диаграммы различий между локальным компьютером и другим компьютером.<br /><br />компьютер:<target> -компьютер для сравнения.<br /><br />период:<refresh> — время между примерами в секундах. По умолчанию-2 секунды.<br /><br />dataonly - отображались лишь те данные без графики.<br /><br />Примеры:<count> - собрать <count> примеры, которые затем остановить. Если не указано, будет ли собирать образцы в до **Ctrl + C** нажата.<br/><br/>RDTSC: для каждого образца этот параметр выводит запятыми вместе с заголовки RdtscStart, RdtscEnd, FileTime, RoundtripDelay, NtpOffset вместо рисунок текста.<br/><ul><li>[RdtscStart — RDTSC (счетчик метку времени чтения)](https://en.wikipedia.org/wiki/Time_Stamp_Counter) значение собранные непосредственно перед NTP-запрос был создан.</li><li>RdtscEnd — просто собранных после NTP-ответа был получит и обработает значение RDTSC (счетчик метку времени чтения).</li><li>FileTime — локальный FILETIME значение используется в запросе NTP-Сервером.</li><li>RoundtripDelay — время в секундах между созданием NTP-запрос и обработки полученных NTP-ответа, вычисляется в соответствии с NTP перевода вычислений.</li><li>NTPOffset — время в секундах между локальным компьютером и сервером NTP offset вычисления согласно NTP смещения вычислений.</li></ul>|
|w32tm /config<br /><br />[/computer:<target>]<br /><br />[/Update]<br /><br />[/manualpeerlist:<peers>]<br /><br />[/syncfromflags:<source>]<br /><br />[/LocalClockDispersion:<seconds>]<br /><br />[/Reliable: (Да & #124; нет)]<br /><br />[/largephaseoffset:<milliseconds>]|компьютер:<target> -Настройка <target>. Если не указан, по умолчанию используется локальный компьютер.<br /><br />Update - уведомление службы времени, что конфигурация была изменена, из-за которой изменения вступили в силу.<br /><br />manualpeerlist:<peers> -задает список вручную узел <peers>, который является перечень DNS-сервера или IP-адресов. При указании нескольких узлов, этот параметр должен быть заключен в кавычки.<br /><br />syncfromflags:<source> -задает какие источники NTP-клиента необходимо синхронизировать с. <source> следует список разделенных запятыми эти ключевые слова (без учета регистра).<br /><br />ВРУЧНУЮ - включают одноранговые элементы из списка.<br /><br />DOMHIER - синхронизировать с контроллера домена (DC) в иерархии доменов.<br /><br />LocalClockDispersion:<seconds> -настраивает точность внутренних часах, который предполагается W32Time, и не может получить время из настроенных исходных.<br /><br />надежное: (Да & #124; нет) — задайте ли этот компьютер является надежным источником времени.<br /><br />Этот параметр применяется только на контроллерах домена.<br /><br />Да - этот компьютер является доверенной службы времени.<br /><br />НЕ - этот компьютер не является доверенной службы времени.<br /><br />largephaseoffset:<milliseconds> -задает разница во времени между локальной и сетевой времени, что W32Time будет считать, что резкое.|  
|W32tm /tz|Отображение текущего часового пояса.|  
|w32tm /dumpreg<br /><br />[/Subkey:<key>]<br /><br />[/computer:<target>]|Отображение значения, связанные с разделом реестра.<br /><br />Ключ по умолчанию является HKLM\System\CurrentControlSet\Services\W32Time<br /><br />(Этот корневой ключ службы времени).<br /><br />подраздел:<key> -отображает значения, связанные с подраздел <key> ключа по умолчанию.<br /><br />компьютер:<target> -запрашивает параметры реестра для компьютера <target>|  
|W32tm//query [/computer:<target>] {/source & #124; /configuration & #124; /Peers & #124; /status} [/verbose]|Этот параметр впервые появился в клиентских версиях времени Windows, Windows Vista и Windows Server 2008.<br /><br />Отобразить сведения о службе времени Windows на компьютере.<br /><br />**компьютер:<target> ** -запрашивать сведения из ** <target> **. Если не указано, значение по умолчанию используется локальный компьютер.<br /><br />**Источник** -отображения источника времени.<br /><br />**Конфигурация** -Отображение конфигурации время выполнения и откуда параметр. Режим подробного протоколирования undefined или неиспользуемые параметр слишком отображать.<br /><br />**Одноранговые элементы** -отобразить список одноранговых элементов и их состояние.<br /><br />**состояние** -состояние службы времени Windows для отображения.<br /><br />**Подробный** -задать режим подробного протоколирования для отображения дополнительных сведений.|  
|W32tm//debug {/disable & #124; {/Enable /file:<name> /size:<bytes> /entries:<value> [/truncate]}}|Этот параметр впервые появился в клиентских версиях времени Windows, Windows Vista и Windows Server 2008.<br /><br />Включение или отключение локального компьютера закрытый журнал службы времени Windows.<br /><br />**Отключить** -отключить закрытого журнала.<br /><br />**включить** -включить закрытого журнала.<br /><br />-   **файл:<name> ** — укажите имя файла абсолютный.<br />-   **Размер:<bytes> ** -укажите максимальный размер для циклическое ведение журнала.<br />-   **записи:<value> ** — содержит список флаги, указанному номеру и через запятую, определяющих типы информации, которую должно регистрироваться. Допустимые числа являются от 0 до 300. Диапазон номеров является допустимым, кроме одного числа, например 0-100,103 106. Значение 0 – 300 для ведения журнала вся информация.<br /><br />**усечение** -выполнить усечение файла, если он существует.|  
  
Дополнительные сведения о **W32tm.exe**, см. центр справки и поддержки Windows XP, Windows Vista, Windows 7, Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2.  
  
## <a name="w2k3tr_times_tools_uhlp"></a>Записи реестра для службы времени Windows  
Следующие параметры реестра связаны со службой времени Windows.  
  
Эта информация является предоставляются в виде справочника для использования в устранении неполадок или проверки правильности применения нужных параметров. Что вы не изменять реестр напрямую, если есть другие возможности не рекомендуется. Изменения в реестре не проверяются редактором реестра или операционной системой Windows, после чего они применяются в результате могут сохраниться неверные значения. Это может приведет к неустранимым ошибкам в системе.  
  
По возможности используйте групповую политику или других средств Windows, таких как Microsoft Management Console (MMC), для выполнения задач, а не редактирования реестра напрямую. Если необходимо изменить реестр, соблюдайте крайнюю осторожность.  
  
> [!WARNING]  
> Некоторые из стандартных значений, настроенных в системе административные (System.adm) файл шаблона для объекта Групповой политики параметры групповой политики, отличаются от соответствующих записей реестра по умолчанию. Если вы планируете использовать объект групповой Политики для настройки параметров, которые служба времени Windows, убедитесь, что ознакомиться со статьей [стандартных значений для параметров групповой политики службы времени Windows отличаются от соответствующих записи реестра для службы времени Windows в Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Эта проблема распространяется на Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 и Windows Server 2003.  
  
Многие записи реестра для службы времени Windows являются так же, как параметр групповой политики с тем же именем. Параметры групповой политики соответствуют записи реестра с тем же именем, находятся в:  
  
>**HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\\**

  
Существует несколько разделов реестра в этом разделе реестра. Параметры времени Windows хранятся в значения для всех этих разделов:
* [Параметры](#Parameters)
* [Конфигурации](#Configuration)
* [NTP-клиент](#NtpClient)
* [NTP-сервер](#NtpServer)
  
> [!NOTE]  
> Многие значения в разделе реестра W32Time используются внутренне W32Time для хранения информации. Эти значения не следует вручную изменить в любое время. Не изменяйте параметры в этом разделе, если вы знакомы с параметром и не уверены, что новое значение будет работать должным образом. Следующие параметры реестра находятся в разделе:

>>**HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\\**  
  
Некоторые параметры хранятся в тактов в реестре, а некоторые — в секундах. Для преобразования тактов время в секундах:  
  
-   1 минуту = 60 сек  
  
-   1 сек = 1000 мс  
  
-   1 мс = 10000 тактов в системе Windows, как описано в [свойство DateTime.Ticks](https://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx).  
  
Например, 5 минут станет 5 * 60\ * 1000\ * 10000 = 3000000000 тактов часов. 

Входят во все версии Windows 7, Windows 8, Windows 10, Windows Server 2008 и Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, Windows Server 2016.  Некоторые записи доступны только в более новыми версиями Windows.


#### <a name="Parameters"></a>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Parameters

|Запись реестра|Версия|Описание|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Все|Этот параметр указывает, что нестандартные режим комбинации разрешено в синхронизации между одноранговыми узлами. Значение по умолчанию для членов домена — 1. Значение по умолчанию для автономного клиентов и серверов — 1.|
|NTP-сервер|Все|Эта запись определяет перечень узлов, с которых компьютер получает метки времени, состоящий из одного или нескольких DNS-имена или IP-адресов в каждой строке. Каждый DNS-имя или IP-адрес должен быть уникальным. Компьютеры, подключенные к домену необходимо синхронизировать с более надежным источником времени, например официальные часы США.  <ul><li>0x01 SpecialInterval </li><li>0x02 UseAsFallbackOnly</li><li>SymmetricActive 0x04 — Дополнительные сведения об этом режиме см. в разделе [время Windows Server: 3.3 режимы работы](https://go.microsoft.com/fwlink/?LinkId=208012).</li><li>0x08 клиента</li></ul><br />Нет нет значения по умолчанию для этой записи реестра на членах домена. Значение по умолчанию на изолированных компьютеров и серверов — time.windows.com 0x1.<br /><br />Примечание: Дополнительные сведения о доступных NTP-серверов см. в разделе [статье базы знаний Майкрософт 262680 - список серверов времени простой сети времени протокол SNTP, доступные в Интернете](https://go.microsoft.com/fwlink/?LinkId=186067)|
|ServiceDll|Все|Данная операция поддерживается путем W32Time. Он содержит зарезервированные данные, которые используются операционной системой Windows и любые изменения этого параметра может привести к непредсказуемым результатам. По умолчанию для этой библиотеки DLL для членов домена и изолированных компьютеров и серверов — % windir%\System32\W32Time.dll.  |
|ServiceMain|Все|Данная операция поддерживается путем W32Time. Он содержит зарезервированные данные, которые используются операционной системой Windows и любые изменения этого параметра может привести к непредсказуемым результатам. Значение по умолчанию на членах домена — SvchostEntry_W32Time. Значение по умолчанию на изолированных компьютеров и серверов — SvchostEntry_W32Time.  "|
|Тип|Все|Указывает, в которой одноранговые элементы для приема синхронизации из этой записи:  <ul><li>**NoSync**. Служба времени не синхронизируется с других источников.</li><li>**NTP-СЕРВЕРОМ.** Служба времени синхронизируется с серверов, указанных в **NTP-сервер**. запись реестра.</li><li>**Nt5DS**. Служба времени синхронизирует из иерархии доменов.  </li><li>**AllSync**. Служба времени использует все доступные способы синхронизации.  </li></ul>Значение по умолчанию на членах домена **NT5DS**. Значение по умолчанию на изолированных компьютеров и серверов — **NTP**.   |

#### <a name="Configuration"></a>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Config

|Запись реестра|Версия|Описание|
|------------------------------------|---------------|----------------------------|
|AnnounceFlags|Все|Эта запись определяет, является ли этот компьютер помечен как надежным сервером времени. Компьютер не отмечена как надежный, если он отмечается как сервер времени.<br /> -0x00 не сервера времени  <br /> -сервер времени всегда 0x01  <br /> -0x02 автоматическое время сервера  <br /> -0x04 всегда надежным сервером времени  <br /> -0x08 автоматического надежным сервером времени  <br />Значение по умолчанию для членов домена — 10. Значение по умолчанию для автономного клиентов и серверов — 10.|
|EventLogFlags|Все|Эта запись определяет события, которые заносит в журнал службы времени.  <br />-Время перехода: 0x1  <br />-Исходная изменение: 0x2  <br />Значение по умолчанию на членах домена — 2. Значение по умолчанию на изолированных компьютеров и серверов — 2.  |
|FrequencyCorrectRate|Все|Эта запись определяет скорость, с которой будет исправлено часы. Если это значение слишком мал, часы нестабильна и overcorrects. Если значение слишком велико, часы занимает много времени для синхронизации. Значение по умолчанию на членах домена — 4. Значение по умолчанию на изолированных компьютеров и серверов — 4.  <br /><br />Обратите внимание, что 0 недопустимое значение параметра реестра FrequencyCorrectRate. В Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 компьютеры Если указано значение 0 для службы времени Windows будет автоматически измените его на 1.  |
|HoldPeriod|Все|Эта запись определяет период времени, для которого является отключено пик обнаружения, чтобы быстро перенести часов локального в синхронизации. Резкое — пример времени, указывающее, что время отключен количество секунд и обычно принимается после возврата примеры неплохо, постоянно. Для членов домена по умолчанию равно 5. На изолированных компьютеров и серверов по умолчанию равно 5.  |
|LargePhaseOffset|Все|Эта запись указывает, что время offset больше или равно это значение в 10<sup>-7</sup> секунд считается резкое. Прерывания работы сети, например большой объем трафика может привести к резкое. Резкое будет игнорироваться, если он не устраняется в течение длительного периода времени. Значение по умолчанию на членах домена — 50000000. Значение по умолчанию на изолированных компьютеров и серверов — 50000000.  |
|LastClockRate|Все|Данная операция поддерживается путем W32Time. Он содержит зарезервированные данные, которые используются операционной системой Windows и любые изменения этого параметра может привести к непредсказуемым результатам. Значение по умолчанию на членах домена — 156250. Значение по умолчанию на изолированных компьютеров и серверов — 156250.  |
|LocalClockDispersion|Все|Эта запись определяет распределение (в секундах), необходимо самостоятельно при только источника времени встроенных CMOS часов. Значение по умолчанию на членах домена — 10. Значение по умолчанию на изолированных компьютеров и серверов — 10.|
|MaxAllowedPhaseOffset|Все|Эта запись определяет максимальное смещение (в секундах), для которого W32Time пытается настроит часы компьютера с помощью частоты синхронизации. Если смещение превышает данное значение, служба W32Time непосредственно изменяет часы компьютера. Для членов домена по умолчанию — 300. Значение по умолчанию для автономного клиентов и серверов — 1.  [Дополнительные сведения см. ниже](#MaxAllowedPhaseOffset).|
|MaxClockRate|Все|Данная операция поддерживается путем W32Time. Он содержит зарезервированные данные, которые используются операционной системой Windows и любые изменения этого параметра может привести к непредсказуемым результатам. Значение по умолчанию для членов домена — 155860. Значение по умолчанию для автономного клиентов и серверов — 155860.  |
|MaxNegPhaseCorrection|Все|Этот параметр задает наибольшее коррекции отрицательного времени, служба времени. Если окажется, что изменения, больше не требуется, он регистрирует событие вместо. Особый случай: 0xFFFFFFFF означает всегда коррекции времени. Значение по умолчанию для членов домена — 0xFFFFFFFF. Значение по умолчанию для автономного клиентов и серверов — 54 000 (15 часов).  |
|MaxPollInterval|Все|Эта запись указывает максимальный интервал в секундах log2, разрешенных для интервала опроса системы. Обратите внимание, что во время системы должен опросить согласно расписанию, поставщик может отклоняют запрос для этого. Значение по умолчанию для контроллеров доменов — 10. Для членов домена по умолчанию равен 15. Для изолированных компьютеров и серверов по умолчанию равен 15.  |
|MaxPosPhaseCorrection|Все|Эта запись указывает наибольшее положительной коррекции времени в секундах, которое делает службу. Если окажется, что изменения, больше не требуется, он регистрирует событие вместо. Особый случай: 0xFFFFFFFF означает всегда коррекции времени. Значение по умолчанию для членов домена — 0xFFFFFFFF. Значение по умолчанию для автономного клиентов и серверов — 54 000 (15 часов).  |
|MinClockRate|Все|Данная операция поддерживается путем W32Time. Он содержит зарезервированные данные, которые используются операционной системой Windows и любые изменения этого параметра может привести к непредсказуемым результатам. Значение по умолчанию для членов домена — 155860. Значение по умолчанию для автономного клиентов и серверов — 155860.  |
|MinPollInterval|Все|Эта запись разрешение наименьший интервал в секундах log2 для интервала опроса системы. Обратите внимание, что во время системы без запроса примеры чаще, чем это, поставщик может давать примеры время от времени, отличных от запланированному интервалу. Значение по умолчанию для контроллеров домена — 6. Значение по умолчанию для членов домена — 10. Значение по умолчанию для автономного клиентов и серверов — 10.  |
|PhaseCorrectRate|Все|Эта запись определяет скорость, с которой этап ошибка не будет устранена. Указание низкое значение быстрого исправления ошибок этап, но может привести к нестабильной часов. Если значение слишком велико, занимает больше времени для исправления ошибки этапа. <br /><br />Значение по умолчанию на членах домена — 1. Значение по умолчанию на изолированных компьютеров и серверов — 7.<br /><br />Примечание: 0 является недопустимым значением записи реестра PhaseCorrectRate. На Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 компьютеры Если указано значение 0, служба времени Windows автоматически устанавливает его значение 1.  |
|PollAdjustFactor|Все|Эта запись определяет решение, чтобы увеличить или уменьшить интервал опроса для системы. Чем больше значение, тем меньше объема ошибка, которая вызывает интервал опроса уменьшить. Для членов домена по умолчанию равно 5. На изолированных компьютеров и серверов по умолчанию равно 5. |
|SpikeWatchPeriod|Все|Эта запись определяет количество времени, необходимо сохранить подозрительных смещение прежде чем он будет принят правильными (в секундах). Значение по умолчанию на членах домена — 900. Значение по умолчанию для изолированных компьютеров и рабочих станций — 900.  |
|TimeJumpAuditOffset|Все|Целое число без знака, указывающее переходов аудита пороговое значение времени, в секундах. Если служба времени корректирует часов локального, установив часы напрямую и коррекции времени превышает это значение, служба времени регистрирует событие аудита.|
|UpdateInterval|Все|Эта запись определяет число тактов между корректировки исправление этап. Значение по умолчанию для контроллеров домена — 100. Значение по умолчанию для членов домена — 30 000. Значение по умолчанию для автономного клиентов и серверов — 360,000.  <br /><br />**Примечание**: ноль не является допустимым значением записи реестра UpdateInterval. На компьютерах под управлением Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 Если указано значение 0 служба времени Windows автоматически устанавливает его значение 1.<br /><br />Следующие три параметры реестра не являются частью W32Time конфигурация по умолчанию, но можно добавить в реестр для получения возможности повышения ведения журнала. Можно изменить сведения, зарегистрированных в журнале системных событий, изменив значение параметра EventLogFlags в редакторе объектов групповой политики. По умолчанию служба времени создает журнал в средстве просмотра событий, каждый раз, чтобы он переключается на новый источник времени.<br /><br />**Предупреждение**: некоторые из стандартных значений, настроенных в системе административные (System.adm) файл шаблона для объекта Групповой политики параметры групповой политики, отличаются от соответствующих по умолчанию записи реестра. Если вы планируете использовать объект групповой Политики для настройки параметров, которые служба времени Windows, убедитесь, что ознакомиться со статьей [стандартных значений для параметров групповой политики службы времени Windows отличаются от соответствующих записи реестра для службы времени Windows в Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Эта проблема распространяется на Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 и Windows Server 2003. |
|UtilizeSslTimeData|Учет Windows 10, сборка 1511|Запись 1 указывает, что W32Time будет использовать несколько отметок времени SSL для часов, этот способ крайне неточными.|

Чтобы включить ведение журнала W32Time необходимо добавить следующие записи реестра:  

|Запись реестра|Версия|Описание|
|------------------------------------|---------------|----------------------------|
|FileLogEntries|Все|Эта запись определяет количество записей, созданных в файле журнала времени Windows. Значение по умолчанию — none, который входит в систему не любых действий времени Windows. Допустимые значения: от 0 до 300. Это значение не влияет на записи журнала событий, обычно созданные времени Windows|
|FileLogName|Все|Эта запись определяет расположение и имя файла журнала времени Windows. Значение по умолчанию пустое и не должен быть изменен только **FileLogEntries** изменяется. Допустимое значение — это полный путь и имя файла, которое будет использовать служба времени Windows для создания файла журнала. Это значение не влияет на записи журнала событий, обычно созданные времени Windows.  |
|FileLogSize|Все|Эта запись определяет поведение циклическое ведение журнала файлов журнала времени Windows. Когда **FileLogEntries** и **FileLogName** будут определены, эта запись определяет размер, в байтах, позволяющие перезаписать старые записи журнала новыми записями, при достижении этого файла журнала. Допустимо любое положительное число и рекомендуется 3000000. Это значение не влияет на записи журнала событий, обычно созданные времени Windows.  |



#### <a name="NtpClient"></a>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient

|Запись реестра|Версия|Описание|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Все|Этот параметр указывает, что нестандартные режим комбинации разрешено в синхронизации между одноранговыми узлами. Значение по умолчанию для членов домена — 1. Значение по умолчанию для автономного клиентов и серверов — 1.|
|CompatibilityFlags содержит|Все|Эта запись определяет следующие совместимости флаги и значения: <br /><br />-DispersionInvalid: 0x00000001  <br />-IgnoreFutureRefTimeStamp: 0x00000002  <br /> -AutodetectWin2K: 0x80000000  <br />-AutodetectWin2KStage2: 0x40000000  <br /><br />Значение по умолчанию для членов домена — 0x80000000. Значение по умолчанию для автономного клиентов и серверов — 0x80000000.  |
|CrossSiteSyncFlags|Все|Эта запись определяет ли служба выбирает партнеров синхронизации за пределами домена компьютера. Параметры и значения приведены ниже.  <br /><br />-None: 0  <br />-PdcOnly: 1  <br />-Все: 2  <br /><br />Это значение игнорируется, если не задано значение NT5DS. Значение по умолчанию для членов домена — 2. Значение по умолчанию для автономного клиентов и серверов — 2.  |
|DllName|Все|Эта запись определяет расположение библиотеки DLL, данный поставщик времени.  <br /><br />По умолчанию для этой библиотеки DLL для членов домена и изолированных компьютеров и серверов — % windir%\System32\W32Time.dll.|
|Включен|Все|Этот параметр указывает, включено ли поставщик NTP-клиент в службу текущего времени.  <br /><ul><li>Да 1</li><li>Нет 0</li></ul>Значение по умолчанию на членах домена — 1. Значение по умолчанию на изолированных компьютеров и серверов — 1.|
|EventLogFlags|Все|Этот параметр задает событий, регистрируемых службой времени Windows.<ul><li>0x1 помещать изменения</li><li>0x2 большой образец отклонение (это относится к Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 только)</li></ul>По умолчанию на членах домена имеют значение 0x1. Значение по умолчанию на изолированных компьютеров и серверов — 0x1.|
|InputProvider|Все|Этот параметр указывает, включен ли поставщик NTP-клиент.  <ul><li>Да 1  </li><li>Нет 0 </li></ul>Значение по умолчанию на членах домена — 1. Значение по умолчанию на изолированных компьютеров и серверов — 1.  |
|LargeSampleSkew|Все|Этот параметр задает наклон большой образец для ведения журнала в секундах. В соответствии с требованиями к безопасности и Exchange комиссии (сек.), это должно быть присвоено три секунды. События будут регистрироваться для этого параметра только в том случае, когда EventLogFlags явным образом настроен для 0x2 большой образец отклонение. Значение по умолчанию на членах домена — 3. Значение по умолчанию на изолированных компьютеров и серверов — 3.  |
|ResolvePeerBackOffMaxTimes|Все|Этот параметр задает максимальное число двойной интервал ожидания при повторяющихся попыток найдите одноранговый элемент для синхронизации с fail. Значение 0 означает, что интервал ожидания всегда минимальным. Значение по умолчанию на членах домена — 7. Значение по умолчанию на изолированных компьютеров и серверов — 7. |
|ResolvePeerBackoffMinutes|Все|Этот параметр задает интервал начальной ожидания в минутах, прежде чем пытаться обнаружить одноранговый элемент для синхронизации с. Для членов домена по умолчанию равен 15. На изолированных компьютеров и серверов по умолчанию равен 15.  |
|SpecialPollInterval|Все|Эта запись указывает интервал опроса в секундах для одноранговых узлов, вручную. Если включен флаг SpecialInterval 0x1, W32Time использует этот интервал опроса вместо интервала опроса определить операционной системой. Значение по умолчанию на членах домена — 3600. Значение по умолчанию на изолированных компьютеров и серверов — 604 800.<br/><br/>Новые сборки 1702 SpecialPollInterval содержится MinPollInterval и MaxPollInterval Config значениями реестра.|
|SpecialPollTimeRemaining|Все|Данная операция поддерживается путем W32Time. Он содержит зарезервированные данные, которые используются операционной системой Windows. Он задает время в секундах, прежде чем W32Time будет выполнена повторная синхронизация после перезагрузки компьютера. Любые изменения этого параметра может привести к непредсказуемым результатам. Значение по умолчанию для обоих членов домена и изолированных клиенты и серверы оставлено пустым.  |

#### <a name="NtpServer"></a>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\TimeProviders\NtpServer

|Запись реестра|Версия|Описание|
|------------------------------------|---------------|----------------------------|
|AllowNonstandardModeCombinations|Все|Этот параметр указывает, что нестандартные режим комбинации разрешено в синхронизации между клиентами и серверами. Значение по умолчанию для членов домена — 1. Значение по умолчанию для автономного клиентов и серверов — 1.|
|DllName|Все|Эта запись определяет расположение библиотеки DLL, данный поставщик времени.<br /><br />По умолчанию для этой библиотеки DLL для членов домена и изолированных компьютеров и серверов — % windir%\System32\W32Time.dll.  |
|Включен|Все|Этот параметр указывает, включено ли поставщик NTP-сервер в службе текущего времени. <ul><li>Да 1</li><li>Нет 0</li></ul>Значение по умолчанию на членах домена — 1. Значение по умолчанию на изолированных компьютеров и серверов — 1.  |
|InputProvider|Все|Этот параметр указывает, включен ли поставщик NTP-сервер.  <ul><li>Да 1  </li><li>Нет 0 </li></ul>Значение по умолчанию на членах домена — 1. Значение по умолчанию на изолированных компьютеров и серверов — 1.  |

#### <a name="MaxAllowedPhaseOffset"></a>Сведения о MaxAllowedPhaseOffset
Чтобы W32Time задать часы компьютера постепенно смещение MaxAllowedPhaseOffset значение меньше и удовлетворять следующей формулой одновременно:  
```  
|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) < SystemClockRate / 2  
``` 
CurrentTimeOffset измеряется в тактов, где 1 мс = 10 000 часов тактов в системе Windows.  
  
SystemClockRate и PhaseCorrectRate также измеряется в тактов. Чтобы получить SystemClockRate, можно использовать следующую команду и преобразовании секунд для синхронизации с помощью формулы секунд тактов * 1000\ * 10000:  
  
```  
W32tm /query /status /verbose  
ClockRate: 0.0156000s  
```  
  
SystemclockRate — это скорость часов в системе. С помощью 156000 секунд, в качестве примера, SystemclockRate бы быть = 0.0156000 * 1000 \ * 10000 = 156000 тактов часов.  
  
MaxAllowedPhaseOffset также задается в секундах. Чтобы преобразовать его в часов тактов, умножьте MaxAllowedPhaseOffset * 1000\ * 10000.  
  
В следующих двух примерах показано применение  
  
**Пример 1**: время отличается 4 минуты (например, время 11:05:00 и Образец времени получены от однорангового узла и должен быть правильный — 11:09:00).  
```
phasecorrectRate = 1  
  
UpdateInterval = 30000 (clock ticks)  
  
systemclockRate = 156000 (clock ticks)  
  
MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  
  
|currentTimeOffset| = 4mins = 4*60\*1000\*10000 = 2400000000 ticks  
  
Is CurrentTimeOffset < MaxAllowedPhaseOffset?  
  
2400000000 < 6000000000 = TRUE  
```
И удовлетворяют выше уравнение? 
```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) < SystemClockRate / 2)  
  
Is 2,400,000,000 / (30000*1) < 156000/2  
  
Is 100,000 < 78,000  
  
NO/FALSE  
```  
Поэтому W32tm устанавливал часов назад немедленно.  
  
> [!NOTE]  
> В этом случае если вы хотите медленно установить часы, необходимо изменить значения PhaseCorrectRate или updateInterval в реестре также для получения результатов уравнение в значение TRUE.  
  
**Пример 2**: время отличается 3 минут.  
```  
phasecorrectRate = 1  
  
UpdateInterval = 30000 (clock ticks)  
  
systemclockRate = 156000 (clock ticks)  
  
MaxAllowedPhaseOffset = 10min = 600 seconds = 600*1000\*10000=6000000000 clock ticks  
  
currentTimeOffset = 3mins = 3*60\*1000\*10000 = 1800000000 clock ticks  
  
Is CurrentTimeOffset < MaxAllowedPhaseOffset?  
  
1800000000 < 6000000000 = TRUE  
```  
И удовлетворяют выше уравнение?
```
(|CurrentTimeOffset| / (PhaseCorrectRate*UpdateInterval) < SystemClockRate / 2)  
  
Is 3 mins (1,800,000,000) / (30000*1) < 156000/2  
  
Is 60,000 < 78,000  
  
YES/TRUE  
```  
В этом случае часы будет перевести медленно.  
  
## <a name="w2k3tr_times_tools_vwtt"></a>Параметры политики группа службы времени Windows  
Большинство параметров W32Time можно настроить с помощью редактора объектов групповой политики. Сюда входит Настройка компьютера NTP-сервер или NTP-клиент, настройке механизм синхронизации времени и компьютер для надежного источника времени.  
  
> [!NOTE]  
> Параметры групповой политики для службы времени Windows можно настроить на Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2 контроллеры домена и может применяться только к компьютерам под управлением Windows Server 2003, Windows Server 2003 R2, Windows Server 2008 и Windows Server 2008 R2.  
  
Вы можете найти групповой политики, параметры, используемые для настройки W32Time в оснастке "Редактор объектов групповой политики" в следующих местах.  
  
-   Служба времени Templates\System\Windows Конфигурация компьютера  
  
    Настройка **глобальные параметры конфигурации** здесь.  
  
-   Поставщиков Service\Time времени Templates\System\Windows Конфигурация компьютера  
  
    Настройка **NTP-клиент Windows** параметры здесь.  
  
    Включить **NTP-клиент Windows** здесь.  
  
    Включить **NTP-сервера Windows** здесь.  
  
> [!WARNING]  
> Некоторые из стандартных значений, настроенных в системе административные (System.adm) файл шаблона для объекта Групповой политики параметры групповой политики, отличаются от соответствующих записей реестра по умолчанию. Если вы планируете использовать объект групповой Политики для настройки параметров, которые служба времени Windows, убедитесь, что ознакомиться со статьей [стандартных значений для параметров групповой политики службы времени Windows отличаются от соответствующих записи реестра для службы времени Windows в Windows Server 2003](https://go.microsoft.com/fwlink/?LinkId=186066). Эта проблема распространяется на Windows Server 2008 R2, Windows Server 2008, Windows Server 2003 R2 и Windows Server 2003.  
  
В следующей таблице перечислены глобальные параметры групповой политики, которые связаны с службу времени Windows и предварительно заданное значение, связанное с каждым параметром. Дополнительные сведения о каждом параметре см. в разделе соответствующие записи реестра в «[реестра, службы времени Windows](#w2k3tr_times_tools_uhlp)» ранее в этой теме. Содержатся следующие параметры в один объект групповой Политики именем **глобальные параметры конфигурации**.  
  
**Параметры глобальной групповой политики, связанных с временем Windows**  
  
|Параметр групповой политики|Предварительно заданное значение.|  
|------------------------|------------------|  
|AnnounceFlags|10|  
|EventLogFlags|2|  
|FrequencyCorrectRate|4|  
|HoldPeriod|5|  
|LargePhaseOffset|1280000|  
|LocalClockDispersion|10|  
|MaxAllowedPhaseOffset|300|  
|MaxNegPhaseCorrection|54 000 (15 часов)|  
|MaxPollInterval|15|  
|MaxPosPhaseCorrection|54 000 (15 часов)|  
|MinPollInterval|10|  
|PhaseCorrectRate|7|  
|PollAdjustFactor|5|  
|SpikeWatchPeriod|90|  
|UpdateInterval|100|  
  
В следующей таблице перечислены доступные параметры для **настроить NTP-клиент Windows** объекта групповой Политики и предварительно заданного значения, связанные со службой времени Windows. Дополнительные сведения о каждом параметре см. в разделе соответствующие записи реестра в «[реестра, службы времени Windows](#w2k3tr_times_tools_uhlp)» ранее в этой теме.  
  
**Параметры NTP клиента групповой политики, связанные с времени Windows**  
  
|Параметр групповой политики|Значение по умолчанию|  
|------------------------|-----------------|  
|NTP-сервер|time.windows.com 0x1|  
|Тип|Параметры по умолчанию:<br /><br />-   **NTP-СЕРВЕРОМ.** Использовать на компьютерах, которые не присоединены к домену.<br />-   **NT5DS.** Использовать на компьютерах, которые присоединены к домену.|  
|CrossSiteSyncFlags|2|  
|ResolvePeerBackoffMinutes|15|  
|ResolvePeerBackoffMaxTimes|7|  
|SpecialPollInterval|3600|  
|EventLogFlags|0|  
  
## <a name="w2k3tr_times_tools_suxb"></a>Сетевые порты, используемым службой времени Windows  
Служба времени Windows соответствует спецификации NTP-Сервером, для которого необходимо использовать порт UDP 123 вся связь синхронизации времени. Этот порт зарезервирован времени Windows и остается зарезервированный в любой момент. Всякий раз, когда компьютер синхронизирует системное его или дает время для другого компьютера, подобный обмен данными осуществляется на UDP-порт 123.  
  
> [!NOTE]  
> Если у компьютера есть несколько сетевых адаптеров (также называемый многосетевого компьютера), нельзя включить выборочно службы времени Windows, в зависимости от сетевого адаптера.  
  
## <a name="w2k3tr_times_tools_qoep"></a>Связанные сведения  
Следующие ресурсы содержат дополнительные сведения, относящиеся к этому разделу.  
  
-   RFC *1305* в базе данных IETF RFC  

