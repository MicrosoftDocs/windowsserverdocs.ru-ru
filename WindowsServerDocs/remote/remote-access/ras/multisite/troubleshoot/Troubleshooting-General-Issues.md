---
title: Диагностика проблем общего характера
description: Эта статья является частью руководств по развертыванию нескольких серверов удаленного доступа в многосайтовом развертывании в Windows Server 2016.
manager: brianlic
ms.topic: article
ms.assetid: 354ae5e3-bae1-44f9-afd7-7eaba70f2346
ms.author: lizross
author: eross-msft
ms.openlocfilehash: 911d12088acc5071e18e7e24000364d9fe539250
ms.sourcegitcommit: dfa48f77b751dbc34409aced628eb2f17c912f08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2020
ms.locfileid: "87958482"
---
# <a name="troubleshooting-general-issues"></a>Диагностика проблем общего характера

>Область применения. Windows Server (Semi-Annual Channel), Windows Server 2016

В этом разделе содержатся сведения об устранении общих проблем, связанных с удаленным доступом.

## <a name="gpo-retrieval-error"></a>Ошибка при получении объекта групповой политики
**Произошла ошибка**. Не удается получить параметры объекта групповой политики сервера DirectAccess. Убедитесь, что у вас есть разрешения на изменение объекта групповой политики.

После получения этой ошибки консоль управления удаленным доступом не отвечает.

**Причина**

DirectAccess не может получить доступ к объекту GPO одной из точек входа в развертывании, и в результате не удается загрузить конфигурацию.

**Решение**

Убедитесь, что каждая точка входа в развертывании имеет соответствующий объект GPO на контроллере домена, и убедитесь, что пользователь, выполнивший вход в систему, имеет разрешения на чтение и запись для всех объектов групповой политики, настроенных в развертывании удаленного доступа.

В качестве обходного решения используйте командлеты конфигурации вместо использования консоли управления удаленным доступом. Например, с помощью `Get-RemoteAccess` и `Get-DAEntryPoint` .

> [!NOTE]
> Этот сценарий не происходит, если объект групповой политики сервера текущей точки входа недоступен.

С помощью `Get-DAEntryPointDC` командлета можно получить список всех контроллеров домена, на которых хранятся объекты групповой политики сервера и `Get-DAMultiSite` в сочетании с `Get-RemoteAccess` для получения полного списка объектов групповой политики сервера в развертывании. Например:

```
$ServerGpos = Get-DAEntryPointDC | ForEach-Object {
   @{
       GpoName = (Get-RemoteAccess -EntryPoint $_.EntryPointName).ServerGpoName;
        DC = $_.DomainControllerName }
}
$ServerGpos | ForEach-Object { $GpoName = $_['GpoName'] ; $DC = $_['DC'] ; Write-Host "Server GPO '$GpoName' on DC '$DC'" }
```

## <a name="windows-7-to-windows-8-or-10-client-upgrade"></a>Обновление Windows 7 до Windows 8 или 10 клиентов
**Симптом**. После обновления клиента Windows 7 до Windows 10 или Windows 8 в многосайтовом развертывании подключение DirectAccess не отображается в списке сетей.

**Причина**

Объекты групповой политики Windows 7 в многосайтовом развертывании не содержат конфигурации помощника по сетевым подключениям Windows 8.

 Клиенты Windows 7 должны использовать помощник по подключению DirectAccess для мониторинга состояния подключения DirectAccess, для чего требуется отдельная настройка вручную в объектах групповой политики клиента Windows 7. Когда клиенты Windows 7 обновляются до Windows 10 или Windows 8, помощник по подключению к сети не будет работать, если все еще применяется объект групповой политики клиента Windows 7.

**Решение**

Если параметры помощника по подключению DirectAccess настроены в объектах групповой политики Windows 7, эту проблему можно устранить перед обновлением клиентских компьютеров, изменив объекты групповой политики Windows 7 с помощью следующих командлетов PowerShell:

```
Set-GPRegistryValue -Name <Windows7GpoName> -Domain <DomainName> -Key "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkConnectivityAssistant" -ValueName "TemporaryValue" -Type Dword -Value 1
Remove-GPRegistryValue -Name <Windows7GpoName> -Domain <DomainName> -Key "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\NetworkConnectivityAssistant"
```

Если клиент уже обновлен или DCA не настроен, переместите клиентский компьютер в группу безопасности Windows 10 или Windows 8.

## <a name="general-cmdlet-errors"></a>Общие ошибки командлета

-   **Проблема 1**

    **Произошла ошибка**. Не удается подключиться к <> domain_controller контроллера домена для <server_name или entry_point_name>.

    **Причина**

    Для поддержания согласованности конфигурации в многосайтовом развертывании важно, чтобы каждым объектом групповой политики управлял один контроллер домена. Если контроллер домена, управляющий объектом групповой политики сервера точки входа, недоступен, параметры конфигурации удаленного доступа не могут быть прочитаны или изменены.

    **Решение**

    Выполните процедуру "Изменение контроллера домена, который управляет объектами групповой политики сервера", описанным в [2,4. Настройка объектов групповой политики](assetId:///b1960686-a81e-4f48-83f1-cc4ea484df43#ConfigGPOs).

-   **Проблема 2**

    **Произошла ошибка**. Не удается подключиться к основному контроллеру домена в домене <domain_name>.

    **Причина**

    Для поддержания согласованности конфигурации в многосайтовом развертывании важно, чтобы каждым объектом групповой политики управлял один контроллер домена. Управление клиентскими объектами групповой политики осуществляется на основном контроллере домена. Если основной контроллер домена недоступен, чтение или изменение параметров конфигурации удаленного доступа невозможно.

    **Решение**

    Выполните процедуру "перенесите роль эмулятора PDC", описанную в [2,4. Настройка объектов групповой политики](assetId:///b1960686-a81e-4f48-83f1-cc4ea484df43#ConfigGPOs).



