---
title: Размеры виртуальных машин
description: Рекомендации по определению размера для каждого типа рабочей нагрузки.
ms.author: helohr
ms.date: 02/16/2021
ms.topic: article
author: Heidilohr
manager: lizross
ms.openlocfilehash: 420b6734b064c1e3cc2bbed66127c9a27319af59
ms.sourcegitcommit: 2cde1af7dc29b2396924961cbb34161346ce8927
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "100632789"
---
# <a name="virtual-machine-sizing-guidelines"></a>Рекомендации по выбору размера виртуальной машины

Независимо от того, используете ли вы виртуальную машину в службах удаленных рабочих столов или Виртуальном рабочем столе Windows, для разных типов рабочих нагрузок требуются разные конфигурации виртуальных машин узла сеансов. Масштабируйте развертывание в зависимости от потребностей пользователей, чтобы получить наилучшие результаты.

## <a name="multi-session-recommendations"></a>Рекомендации для многосеансового режима

Примеры в этом разделе представляют собой общие рекомендации. Их следует использовать только для первоначальной оценки производительности. В следующей таблице указано максимальное число пользователей на виртуальный центральный процессор (виртуальный ЦП) и минимальная конфигурация виртуальной машины для каждой рабочей нагрузки. Эти рекомендации основаны на [рабочих нагрузках Удаленного рабочего стола](remote-desktop-workloads.md).

В следующей таблице приведен пример пилотного сценария с небольшой рабочей нагрузкой менее чем с 20 пользователями:

| Тип рабочей нагрузки | Максимальное число пользователей на виртуальный ЦП | Минимальный объем хранилища виртуального ЦП, а также ОЗУ/ОС | Примеры экземпляров Azure | Минимальный объем хранилища контейнера профилей |
| --- | --- | --- | --- | --- |
| Легкий | 4 | 4 виртуальных ЦП, 16 ГБ ОЗУ, 32 ГБ хранилища | D4s_v3, F4s_v2, D4as_v4 | 30 ГБ |
| Средний | 4 | 4 виртуальных ЦП, 16 ГБ ОЗУ, 32 ГБ хранилища | D4s_v3, F4s_v2, D4as_v4 | 30 ГБ |
| Тяжелый | 2 | 4 виртуальных ЦП, 16 ГБ ОЗУ, 32 ГБ хранилища | D8s_v3, F8s_v2, D8as_v4, D16s_v3, F16s_v2, D16as_v4 | 30 ГБ |
| Мощный | 1 | 6 виртуальных ЦП, 56 ГБ ОЗУ, 340 ГБ хранилища | D4s_v3, F4s_v2, D4as_v4, NV12, NVv4 | 30 ГБ |

В этой таблице приведены примеры стандартных или крупных рабочих нагрузок с 20 или более пользователями:

| Тип рабочей нагрузки | Максимальное число пользователей на виртуальный ЦП | Минимальный объем хранилища виртуального ЦП, а также ОЗУ/ОС | Примеры экземпляров Azure | Минимальный объем хранилища контейнера профилей |
| --- | --- | --- | --- | --- |
| Легкий | 6 | 8 виртуальных ЦП, 16 ГБ ОЗУ, 16 ГБ хранилища | D8s_v3, F8s_v2, D8as_v4, D16s_v3, F16s_v2, D16as_v4 | 30 ГБ |
| Средний | 4 | 8 виртуальных ЦП, 16 ГБ ОЗУ, 32 ГБ хранилища | D8s_v3, F8s_v2, D8as_v4, D16s_v3, F16s_v2, D16as_v4 | 30 ГБ |
| Тяжелый | 2 | 8 виртуальных ЦП, 16 ГБ ОЗУ, 32 ГБ хранилища | D8s_v3, F8s_v2, D8as_v4, D16s_v3, F16s_v2, D16as_v4 | 30 ГБ |
| Мощный | 1 | 6 виртуальных ЦП, 56 ГБ ОЗУ, 340 ГБ хранилища | D8s_v3, F8s_v2, D8as_v4, D16s_v3, F16s_v2, D16as_v4, NV12, NVv4 | 30 ГБ |

## <a name="recommended-vm-sizes-for-standard-or-larger-environments"></a>Рекомендуемые размеры виртуальных машин для стандартных или крупных сред

Мы рекомендуем ограничить размер виртуальной машины, используя от 4 до 24 виртуальных ЦП. Мы не рекомендуем использовать 2 ядра или 32 либо больше ядер для стандартных и крупных сред. Почему?

### <a name="all-vms-should-have-more-than-two-cores"></a>На всех виртуальных машинах должно быть больше двух ядер

Для ОС Windows 10 и ее компонентов пользовательского интерфейса предполагается использование не менее двух параллельных потоков для выполнения некоторых ресурсоемких операций визуализации. Наличие нескольких пользователей на двухъядерной виртуальной машине приведет к нестабильной работе пользовательского интерфейса и приложений, что снижает качество взаимодействия с пользователем. Четыре ядра — это минимальное возможное число ядер, которое может иметь стабильно работающая виртуальная машина с несколькими пользователями.

### <a name="vms-should-not-have-more-than-32-cores"></a>Число ядер в виртуальных машинах не должно превышать 32.

По мере увеличения числа ядер увеличивается и дополнительная нагрузка на систему, связанная с синхронизацией. Для большинства рабочих нагрузок при увеличении числа ядер свыше 16 начинает снижаться окупаемость инвестиций, при этом значительная часть дополнительной производительности нивелируется затратами на синхронизацию. Скорее всего, вы получите больше производительности от двух виртуальных машин с 16 ядрами, чем от одной с 32 ядрами.

При увеличении числа ядер рекомендуемый диапазон от 4 до 24 ядер обеспечит оптимальную производительность для пользователей. Например, предположим, что 12 пользователей одновременно входят в виртуальную машину с четырьмя ядрами. Отношение составляет три пользователя на ядро. В то же время, на виртуальной машине с восемью ядрами и 14 пользователями отношение составляет 1,75 пользователя на ядро. Сценарий с отношением 1,75 предлагает более высокую производительность для приложений с непродолжительной нагрузкой на ЦП.

В сценариях с 20 или более подключениями на одной виртуальной машине несколько небольших виртуальных машин будут работать лучше, чем одна или две крупные виртуальные машины. Например, если вы ожидаете, что 30 или более пользователей одновременно выполнят вход на один узел сеанса в течение 10 минут, две виртуальные машины с восемью ядрами справятся с нагрузкой лучше, чем одна 16-ядерная виртуальная машина. Вы также можете использовать балансировку нагрузки в ширину для равномерного распределения пользователей между разными виртуальными машинами.

Лучше использовать большое количество виртуальных машин меньшего размера, чем несколько крупных виртуальных машин. Так вам будет проще выключить виртуальные машины, которые нужно обновить или которые сейчас не используются. В случае с более крупными виртуальными машинами у вас всегда гарантированно будет хотя бы один выполнивший вход пользователь, что не позволит вам завершить работу виртуальной машины. Если же используется много небольших виртуальных машин, вероятнее, что некоторые из них будут полностью свободны. При этом вы сможете безопасно отключить неиспользуемые виртуальные машины, чтобы сэкономить ресурсы, сделав развертывание простым в обслуживании, более устойчивым и менее затратным.

## <a name="single-session-recommendations"></a>Рекомендации для односеансового режима

Ввиду рекомендаций по определению размеров виртуальных машин для односеансовых сценариев, мы рекомендуем как минимум два физических ядра ЦП на каждую виртуальную машину (обычно четыре виртуальных ЦП с технологией Hyper-Threading). Если вам нужны более конкретные рекомендации по выбору размера виртуальных машин для односеансовых сценариев, обратитесь к поставщикам программного обеспечения, относящимся к вашей рабочей нагрузке. Размеры виртуальных машин для односеансовых виртуальных машин, скорее всего, будут соответствовать руководствам к физическим устройствам.

## <a name="general-virtual-machine-recommendations"></a>Общие рекомендации по использованию виртуальных машин

Требования к виртуальной машине для запуска операционной системы см. в [Как найти информацию о требованиях, которые Windows 10 предъявляет к техническим характеристикам компьютеров, на которых планируется ее установка](https://www.microsoft.com/windows/windows-10-specifications).

Для производственных рабочих нагрузок, для которых требуется соглашение об уровне обслуживания (SLA) рекомендуется использовать хранилище SSD (цен. категория "Премиум") на диске ОС. Дополнительные сведения см. в разделе [Соглашение об уровне обслуживания для Виртуальных машин](https://azure.microsoft.com/support/legal/sla/virtual-machines/v1_8/).

Графические процессоры хорошо подходят пользователям, которые регулярно используют ресурсоемкие графические программы для отрисовки видео, трехмерного проектирования и моделирования. Чтобы узнать больше об ускорении обработки графики, ознакомьтесь с разделом [Выбор технологии отрисовки графики](rds-graphics-virtualization.md). В Azure есть несколько вариантов развертывания средств ускорения обработки графики и доступно несколько размеров виртуальных машин с поддержкой GPU. Узнайте больше об этих [размерах виртуальных машин, оптимизированных для GPU](/azure/virtual-machines/windows/sizes-gpu).

[B-series burstable VMs](/azure/virtual-machines/windows/b-series-burstable) (Виртуальные машины с разбивкой серии B) являются хорошим выбором для пользователей, которым не всегда требуется максимальная производительность ЦП. Дополнительные сведения о типах и размерах ВМ см. в [Sizes for Windows virtual machines in Azure](/azure/virtual-machines/windows/sizes) (Размеры для виртуальных машин Windows в Azure) и раздел сведений о ценах на странице [Серия виртуальных машин](https://azure.microsoft.com/pricing/details/virtual-machines/series/).

## <a name="test-your-workload"></a>Тестирование рабочей нагрузки

Наконец, мы рекомендуем использовать инструменты моделирования для тестирования развертывания с помощью нагрузочных тестов и моделирования реальных ситуаций использования. Убедитесь, что система реагирует на запросы и достаточно устойчива для удовлетворения потребностей пользователей, и не забывайте менять размер нагрузки во избежание непредвиденных результатов.
