---
title: Настройка веб-клиента удаленного рабочего стола для пользователей
description: Описывается, как администратор может настроить веб-клиент удаленного рабочего стола.
ms.prod: windows-server-threshold
ms.technology: remote-desktop-services
ms.author: helohr
ms.date: 11/2/2018
ms.topic: article
author: Heidilohr
ms.localizationpriority: medium
ms.openlocfilehash: 2cb819a7f91646c61b84c3ee70550af6033ba340
ms.sourcegitcommit: 491c94b25501732c4a4abda533cc62b8bd278ed2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/22/2019
ms.locfileid: "9099187"
---
# Настройка веб-клиента удаленного рабочего стола для пользователей

Веб-клиент удаленного рабочего стола позволяет пользователям доступ к инфраструктуре удаленных рабочих столов вашей организации с помощью совместимых веб-браузера. Он сможет взаимодействовать с удаленного приложения или настольные компьютеры, так, как они с локального компьютера независимо от того, где они находятся. После настройки вашей веб-клиент удаленного рабочего стола, пользователям необходимые для начала работы достаточно URL-адрес которых доступа к клиенту, свои учетные данные и поддерживаемые веб-браузера.

>[!IMPORTANT]
>Веб-клиент не поддерживает использование прокси-сервера приложения Azure и вообще не поддерживают веб-прокси приложения. Дополнительные сведения см. [С помощью служб удаленных рабочих СТОЛОВ с помощью службы прокси-сервера приложений](../rds-supported-config.md#using-remote-desktop-services-with-application-proxy-services) .

## Вам потребуется настроить веб-клиент

Перед началом работы, имейте в виду следующее.

* Убедитесь, что [развертывания удаленных рабочих столов](../rds-deploy-infrastructure.md) имеет шлюза удаленных рабочих Столов, подключение к удаленному Рабочему столу и веб-доступа к удаленному рабочему Столу на Windows Server 2016 или 2019 г.
* Убедитесь, что развертывание настроено для [каждого пользователя клиентских лицензий](../rds-client-access-license.md) (CAL) вместо каждого устройства, в противном случае будет использоваться все лицензии.
* Установка, [обновление Windows 10 KB4025334](https://support.microsoft.com/en-us/help/4025334/windows-10-update-kb4025334) на шлюз удаленных рабочих Столов. Далее накопительных обновлений может уже содержит эту статью.
* Убедитесь, что открытые доверенные сертификаты, настроенным для роли шлюза удаленных рабочих Столов и веб-доступа к удаленному рабочему Столу.
* Убедитесь, что все компьютеры, которые ваши пользователи будут подключаться к под управлением одной из следующих версий операционной системы.
  * Windows 10
  * Windows Server 2008 R2 или более поздней версии

Ваши пользователи будут видеть более высокую производительность подключение Windows Server 2016 (или более поздней версии) и Windows 10 (версии 1611 или более поздней версии).

>[!IMPORTANT]
>Если используется веб-клиент во время периода предварительного просмотра и установки версии до 1.0.0, сначала необходимо удалить старого клиента перед переходом на новую версию. Если вы получили сообщение о том, «веб-клиент была установлена с помощью более ранней версии RDWebClientManagement и сначала должен быть удален перед развертыванием новой версии», выполните следующие действия.
>
>1. Откройте командную строку PowerShell.
>2. Запустите **RDWebClientManagement модуль удаления** для удаления новый модуль.
>3. Закройте и снова откройте командную строку с повышенными привилегиями PowerShell.
>4. Запустите **version> \<old RDWebClientManagement установки модуля параметров-RequiredVersion для установки старый модуль.**
>5. Запустите **RDWebClient удаления** для удаления старые веб-клиент.
>6. Запустите **RDWebClientManagement модуль удаления** для удаления старый модуль.
>7. Закройте и снова откройте командную строку с повышенными привилегиями PowerShell.
>8. Повторите шаги обычной установки с следующим образом.

## Публикация веб-клиент удаленного рабочего стола

Чтобы установить веб-клиент в первый раз, выполните следующие действия.

1. На сервере посредника подключений к удаленному рабочему Столу получить сертификат, используемый для подключения к удаленному рабочему столу и экспортировать в виде CER-файл. Скопируйте CER-файл из посредника подключений к удаленному рабочему Столу на сервер, выполняющий роль Web удаленных рабочих Столов.
2. На сервере веб-доступа к удаленному рабочему Столу откройте командную строку PowerShell.
3. В Windows Server 2016 обновите модуль PowerShellGet так как версии папки "Входящие" не поддерживает установку клиента управления веб-модуля. Чтобы обновить PowerShellGet, выполните следующий командлет:
    ```PowerShell
    Install-Module -Name PowerShellGet -Force
    ```

    >[!IMPORTANT]
    >Вам потребуется перезапустить PowerShell, прежде чем обновления можно вступают в силу, в противном случае модуль, могут не работать.

4. Установите модуль PowerShell, клиент управления удаленного рабочего стола web из коллекции PowerShell с помощью следующего командлета:
    ```PowerShell
    Install-Module -Name RDWebClientManagement
    ```

5. После этого выполните следующий командлет скачать последнюю версию веб-клиент удаленного рабочего стола:
    ```PowerShell
    Install-RDWebClientPackage
    ```

6. Затем запустите этот командлет со значением в квадратных скобках заменяются путь к CER-файл, который был скопирован из к удаленному Рабочему столу:
    ```PowerShell
    Import-RDWebClientBrokerCert <.cer file path>
    ```

7. Наконец запустите этот командлет для публикации веб-клиент удаленного рабочего стола:
    ```PowerShell
    Publish-RDWebClientPackage -Type Production -Latest
    ```
    Убедитесь, что вы может получить доступ к веб-клиент на URL-адрес клиента имя сервера, в формате <https://server_FQDN/RDWeb/webclient/index.html>. Очень важно использовать имя сервера, соответствующий открытого сертификата веб-доступа к удаленному рабочему Столу в URL-адрес (обычно FQDN сервера).

    >[!NOTE]
    >При выполнении командлета **RDWebClientPackage публикации** , вы можете увидеть предупреждение с текстом клиентских лицензий на устройство, не поддерживаются, даже если развертывание настроено для клиентских лицензий на пользователя. Если в развертывании применяется клиентских лицензий на пользователя, это предупреждение можно игнорировать. Этот ресурс отображается и убедитесь, что вы знакомы ограничение конфигурации.
8. Когда вы будете готовы пользователям доступ к веб-клиент, просто отправьте их URL-адрес клиента вы создали.

>[!NOTE]
>Чтобы просмотреть список всех поддерживаемых командлеты для модуля RDWebClientManagement, выполните следующий командлет в PowerShell.
>```PowerShell
>Get-Command -Module RDWebClientManagement
>```

## Обновление веб-клиент удаленного рабочего стола

Когда новую версию веб-клиент удаленного рабочего стола, выполните следующие действия для обновления развертывания с помощью нового клиента.

1. Откройте командную строку PowerShell на сервере веб-доступа к удаленному рабочему Столу и выполните следующий командлет скачать последнюю доступную версию веб-клиент:
    ```PowerShell
    Install-RDWebClientPackage
    ```

2. При желании вы можете опубликовать клиент для тестирования до официального выпуска, выполнение этого командлета:
    ```PowerShell
    Publish-RDWebClientPackage -Type Test -Latest
    ```

    Клиент должен отображаться на URL-адрес теста, который соответствует вашей URL-адрес клиента (например, <https://server_FQDN/RDWeb/webclient-test/index.html>).
3. Публикация клиента для пользователей, выполнив следующий командлет:
    ```PowerShell
    Publish-RDWebClientPackage -Type Production -Latest
    ```

    Это приведет к замене клиента для всех пользователей при их перезапустите веб-страницы.

## Удаление веб-клиент удаленного рабочего стола

Чтобы удалить все следы веб-клиент, выполните следующие действия.

1. На сервере веб-доступа к удаленному рабочему Столу откройте командную строку PowerShell.
2. Отмена публикации тестовой и рабочей клиенты, удалите все локальные пакеты и удалите веб-параметров клиента:

   ```PowerShell
   Uninstall-RDWebClient
   ```

3. Удаление модуля PowerShell web клиента удаленного рабочего стола управления:

   ```PowerShell
   Uninstall-Module -Name RDWebClientManagement
   ```

## Установка веб-клиент удаленного рабочего стола без подключения к Интернету

Выполните следующие действия, чтобы развернуть веб-клиент на сервер веб-доступа к удаленному рабочему Столу, у которого нет подключения к Интернету.

> [!NOTE]
> Установка без подключения к Интернету доступна в версии 1.0.1 и более поздних версий модуля RDWebClientManagement PowerShell.

> [!NOTE]
> Вы по-прежнему нужен администратор Компьютере с доступом к Интернету загрузить необходимые файлы перед передачей их для автономного сервера.

> [!NOTE]
> На Компьютере конечного пользователя требуется подключение к Интернету сейчас. Она будет устранена в будущих выпусках клиента для предоставления полный автономный сценарий.

### С устройства с доступом к Интернету

1. Откройте командную строку PowerShell.

2. Импортируйте модуль PowerShell web клиент удаленного рабочего стола управления из коллекции PowerShell:
    ```PowerShell
    Import-Module -Name RDWebClientManagement
    ```

3. Скачайте последнюю версию веб-клиент удаленного рабочего стола для установки на другом устройстве:
    ```PowerShell
    Save-RDWebClientPackage "C:\WebClient\"
    ```

4. Скачайте последнюю версию модуля RDWebClientManagement PowerShell:
    ```PowerShell
    Find-Module -Name "RDWebClientManagement" -Repository "PSGallery" | Save-Module -Path "C:\WebClient\"
    ```

5. Скопируйте содержимое «C:\WebClient\» на сервер веб-доступа к удаленному рабочему Столу.

### С сервера веб-доступа к удаленному рабочему Столу

Следуйте инструкциям в разделе [Публикация веб-клиент удаленного рабочего стола](remote-desktop-web-client-admin.md#how-to-publish-the-remote-desktop-web-client), заменив следующие шаги 4 и 5.

4. Импортируйте модуль PowerShell web клиент удаленного рабочего стола управления из локальной папке:
    ```PowerShell
    Import-Module -Name "C:\WebClient\"
    ```

5. Развертывание последней версии веб-клиент удаленного рабочего стола с локальной папкой (Замените соответствующие ZIP-файл):
    ```PowerShell
    Install-RDWebClientPackage -Source "C:\WebClient\rdwebclient-1.0.1.zip"
    ```

## Подключение к удаленному Рабочему столу без шлюза удаленных рабочих Столов в Windows Server 2019 г.
В этом разделе описываются способы включения web клиента подключение к удаленному Рабочему столу без шлюза удаленных рабочих Столов в Windows Server 2019.

### Настройка сервера к удаленному Рабочему столу

#### Выполните следующие действия, если нет сертификата, привязанного к серверу к удаленному Рабочему столу

1. Откройте **Диспетчер сервера** > **служб удаленных рабочих столов**.

2. В разделе **Общие сведения о развертывании** выберите в раскрывающемся меню **задачи** .

3. Откроется выберите **Изменение свойств развертывания**нового окна под названием **Свойств развертывания** .

4. В окне **Свойств развертывания** выберите **сертификаты** в меню слева.

5. В списке уровней сертификата выберите **Посредника подключений к удаленному рабочему Столу - Включить единый вход**. У вас есть два варианта: (1) создайте новый сертификат или (2) существующего сертификата.

#### Выполните следующие действия, если есть сертификат ранее привязаны к серверу к удаленному Рабочему столу

1. Откройте сертификата, привязанного к брокер и скопируйте значение **отпечатка** .

2. Чтобы привязать этот сертификат безопасности порт 3392, откройте окно PowerShell с повышенными привилегиями и выполните следующую команду, заменив **«> < отпечаток»** со значением, скопирован из предыдущего шага:

    ```PowerShell
    netsh http add sslcert ipport=0.0.0.0:3392 certhash="<thumbprint>" certstorename="Remote Desktop" appid="{00000000-0000-0000-0000-000000000000}"
    ```

    > [!NOTE]
    > Чтобы проверить, если сертификат привязан правильно, выполните следующую команду:
    >
    > ```PowerShell
    > netsh http show sslcert
    > ```
    >
    > В списке привязки SSL-сертификат убедитесь, что правильный сертификат привязан к порту 3392.

3. Откройте реестр Windows (regedit) и nagivate для ```HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp``` и найдите раздел **WebSocketURI**. Должно быть присвоено значение **https://+:3392/rdp/**.

### Настройка узлов сеансов удаленных рабочих Столов
Если сервера узла сеансов удаленных рабочих Столов отличается от сервера к удаленному Рабочему столу, выполните следующие действия.

1. Создание сертификата для компьютера узла сеансов удаленных рабочих Столов, откройте его и скопируйте значение **отпечатка** .

2. Чтобы привязать этот сертификат безопасности порт 3392, откройте окно PowerShell с повышенными привилегиями и выполните следующую команду, заменив **«> < отпечаток»** со значением, скопирован из предыдущего шага:

    ```PowerShell
    netsh http add sslcert ipport=0.0.0.0:3392 certhash="<thumbprint>" appid="{00000000-0000-0000-0000-000000000000}"
    ```

    > [!NOTE]
    > Чтобы проверить, если сертификат привязан правильно, выполните следующую команду:
    >
    > ```PowerShell
    > netsh http show sslcert
    > ```
    >
    > В списке привязки SSL-сертификат убедитесь, что правильный сертификат привязан к порту 3392.

3. Откройте реестр Windows (regedit) и nagivate для ```HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp``` и найдите раздел **WebSocketURI**. Должно быть присвоено значение **https://+:3392/rdp/**.

### Общие наблюдений

* Убедитесь, что сервера узла сеансов удаленных рабочих Столов и к удаленному Рабочему столу под управлением Windows Server 2019.

* Убедитесь, открытый доверенных сертификатов, настроенным для сервера узла сеансов удаленных рабочих Столов и к удаленному Рабочему столу.
    > [!NOTE]
    > Если узлов сеансов удаленных рабочих Столов и сервера к удаленному Рабочему столу совместно использовать тот же компьютер, установите только сертификата сервера к удаленному Рабочему столу. Если сервер узла сеансов удаленных рабочих Столов и к удаленному Рабочему столу использовать другие компьютеры, оба должны быть настроены уникальных сертификатов.

* **Альтернативы имя субъекта (SAN)** для каждого сертификата должно быть присвоено компьютера **Полное доменное имя (FQDN)**. **Обычное имя (CN)** должно соответствовать SAN для каждого сертификата.

## Поиск и устранение неисправностей

Если пользователь сообщает, какие-либо из следующих проблем при открытии веб-клиент в первый раз, приведенные ниже сообщит, что делать их устранения.

### Что делать, если в браузере пользователя отображает предупреждение о безопасности при попытке доступа к веб-клиент

Роль веб-доступа к удаленному рабочему Столу может не быть с помощью доверенного сертификата. Убедитесь, что роль веб-доступа к удаленному рабочему Столу с открытый доверенный сертификат.

Если это не поможет, имя сервера в Интернете URL-адрес клиента может не соответствовать имени предоставляемые веб-удаленных рабочих Столов сертификата. Убедитесь, что ваш URL-адрес используется полное доменное имя сервера, на котором веб-удаленных рабочих Столов роль.

### Что делать, если пользователь не сможет подключиться к ресурсу с помощью веб-клиент несмотря на то, что они могут просматривать элементы в списке все ресурсы

Если пользователь сообщает, что они не удается подключиться с веб-клиент, несмотря на то, что они видят перечисленные ресурсы, проверьте следующее:

* Роль шлюза удаленных рабочих Столов правильно настроено для использования доверенного открытого сертификата?
* На сервере шлюза удаленных рабочих Столов установлены необходимые обновления? Убедитесь, что сервер имеет [обновления KB4025334](https://support.microsoft.com/en-us/help/4025334/windows-10-update-kb4025334) установки.

Если пользователь получает ошибку «сертификат проверки подлинности сервера непредвиденных было получено» сообщения при попытке подключения, а затем сообщения будут отображаться отпечаток сертификата. Поиск с помощью этого отпечаток найти правильный сертификат диспетчера сертификатов сервера к удаленному Рабочему столу. Убедитесь, что сертификат настроен для роли к удаленному Рабочему столу на странице свойств развертывания удаленного рабочего стола. После убедитесь, что сертификат еще не с истекшим сроком действия, копирование в формат файла .cer сертификата на сервер веб-доступа к удаленному рабочему Столу и выполните следующую команду на сервере веб-доступа к удаленному рабочему Столу со значением в квадратных скобках заменен путь к файлу сертификата:

```PowerShell
Import-RDWebClientBrokerCert <certificate file path>
```

### Диагностика проблем, связанных с журнале консоли

Если не удается устранить эту проблему, в зависимости от инструкциями по устранению неполадок в этой статье, попробуйте для диагностики источник проблемы самостоятельно, слежение консоли войти в браузере. Веб-клиент предоставляет метод для записи действий журнала консоли браузера при работе с веб-клиент для диагностики проблем.

* Выберите кнопку с многоточием в правом верхнем углу и перейдите на страницу **о** в раскрывающемся меню.
* В разделе **сведений о поддержке захвата** нажмите кнопку **Начать запись** .
* Выполняйте операции в веб-клиент, которое вызвало проблему, которую вы пытаетесь для диагностики.
* Перейдите на страницу **о** и выберите **Остановить запись**.
* Браузер автоматически загрузит txt-файл под названием **Logs.txt консоли удаленных рабочих Столов**. Этот файл будет содержать журнала активности полный консоли, созданные во время воспроизведения проблемы целевого объекта.

Консоль может также будут доступны непосредственно с помощью браузера. Консоль обычно расположен в папке средства разработчика. Например, вы открыть журнал, можно в Microsoft Edge с помощью клавиши **F12** или выбрав кнопку с многоточием, то переход на **Дополнительные инструменты** > **Средства разработчика**.

## Получите помощь в решении веб-клиент

Если возникли проблемы, не может быть решена сведения в этой статье, можно сообщить о ней [нами по электронной почте](mailto:rdwbclnt@microsoft.com) . Можно также запросить или проголосовать за новые возможности в наших [поле для предложений](https://aka.ms/rdwebfbk).