---
title: Настройка веб-клиента удаленного рабочего стола для пользователей
description: Описывает, как администратор может настроить веб-клиента удаленного рабочего стола.
ms.prod: windows-server-threshold
ms.technology: remote-desktop-services
ms.author: helohr
ms.date: 11/2/2018
ms.topic: article
author: Heidilohr
ms.localizationpriority: medium
ms.openlocfilehash: 45164e9eca0873c82148aa3b7baa179a3f626dd7
ms.sourcegitcommit: d888e35f71801c1935620f38699dda11db7f7aad
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/07/2019
ms.locfileid: "66804972"
---
# <a name="set-up-the-remote-desktop-web-client-for-your-users"></a>Настройка веб-клиента удаленного рабочего стола для пользователей

Веб-клиент удаленного рабочего стола позволяет пользователям получать доступ к инфраструктуре удаленного рабочего стола организации через браузер, совместимый. Они будут взаимодействовать с удаленными приложениями или настольных компьютеров, как и при работе с локальным Компьютером, независимо от того, где они находятся. После настройки веб-клиент удаленного рабочего стола, пользователям нужно приступить к работе всего лишь URL-адрес которой они клиент и можно найти свои учетные данные, поддерживаемые веб-браузер.

>[!IMPORTANT]
>Веб-клиента не поддерживается с помощью прокси приложения Azure и вообще не поддерживают прокси веб-приложения. См. в разделе [с помощью служб удаленных рабочих СТОЛОВ с помощью служб прокси-сервера приложений](../rds-supported-config.md#using-remote-desktop-services-with-application-proxy-services) подробные сведения.

## <a name="what-youll-need-to-set-up-the-web-client"></a>Что потребуется для настройки веб-клиента

Перед началом работы необходимо помнить следующее:

* Убедитесь, что ваш [развертывания удаленных рабочих столов](../rds-deploy-infrastructure.md) имеет шлюз удаленных рабочих Столов, посредник подключений к удаленному рабочему Столу и веб-доступа к удаленным рабочим Столам, под управлением Windows Server 2016 или 2019 г.
* Убедитесь, что развертывание настроено для [клиентские лицензии на пользователя](../rds-client-access-license.md) (CAL) вместо каждого устройства, в противном случае все лицензии будут использоваться.
* Установка [обновление Windows 10 KB4025334](https://support.microsoft.com/en-us/help/4025334/windows-10-update-kb4025334) на шлюзе удаленных рабочих Столов. Позже накопительные пакеты обновления могут уже содержит этой статьи базы Знаний.
* Убедитесь, что открытые сертификаты доверенных настроены для роли шлюза удаленных рабочих Столов и веб-доступа к удаленным рабочим Столам.
* Убедитесь, что запущены все компьютеры, которые ваши пользователи будут подключаться к одной из следующих версий операционной системы:
  * Windows 10
  * Windows Server 2008 R2 или более поздней версии

Пользователи увидят лучшую производительность подключения к Windows Server 2016 (или более поздней версии) и Windows 10 (версии 1611 или более поздней версии).

>[!IMPORTANT]
>Если вы использовали веб-клиента во время действия предварительной версии и установить версию до 1.0.0, сначала необходимо удалить старый клиент прежде чем перейти к новой версии. Если появится сообщение об ошибке: «веб-клиента был установлен с помощью более старой версии RDWebClientManagement и сначала должен быть удален перед развертыванием новой версии», выполните следующие действия.
>
>1. Откройте строки PowerShell с повышенными привилегиями.
>2. Запустите **RDWebClientManagement Uninstall-Module** удаление нового модуля.
>3. Закройте и снова откройте строки PowerShell с повышенными правами.
>4. Запустите **RDWebClientManagement Install-Module - RequiredVersion \<старую версию > для установки старого модуля.**
>5. Запустите **RDWebClient удаления** для удаления старых веб-клиента.
>6. Запустите **RDWebClientManagement Uninstall-Module** удаление старого модуля.
>7. Закройте и снова откройте строки PowerShell с повышенными правами.
>8. Выполните действия, обычная установка следующим образом.

## <a name="how-to-publish-the-remote-desktop-web-client"></a>Как опубликовать веб-клиент удаленного рабочего стола

Чтобы установить веб-клиента в первый раз, выполните следующие действия.

1. На сервере посредника подключений к удаленному рабочему Столу получить сертификат, используемый для подключений удаленного рабочего стола и экспортируйте его как файл CER. Скопируйте CER-файл из посредника подключений к удаленному рабочему Столу на сервер удаленных рабочих Столов веб-роли.
2. На сервере веб-доступа к удаленным рабочим Столам откройте строки PowerShell с повышенными привилегиями.
3. В Windows Server 2016 обновите модуль PowerShellGet, так как версия папки "Входящие" не поддерживает установку клиента управления веб-модуля. Чтобы обновить PowerShellGet, выполните следующий командлет:
    ```PowerShell
    Install-Module -Name PowerShellGet -Force
    ```

    >[!IMPORTANT]
    >Необходимо перезапустить PowerShell, чтобы обновления вступили в силу, в противном случае модуль может не работать.

4. Установите модуль PowerShell web клиента удаленного рабочего стола управления из коллекции PowerShell с помощью этого командлета:
    ```PowerShell
    Install-Module -Name RDWebClientManagement
    ```

5. После этого выполните следующий командлет, чтобы скачать последнюю версию веб-клиента удаленного рабочего стола:
    ```PowerShell
    Install-RDWebClientPackage
    ```

6. Затем выполните этот командлет со значением в квадратных скобках, заменить на путь к CER-файл, который был скопирован из посредника:
    ```PowerShell
    Import-RDWebClientBrokerCert <.cer file path>
    ```

7. Наконец используйте этот командлет для публикации веб-клиента удаленного рабочего стола:
    ```PowerShell
    Publish-RDWebClientPackage -Type Production -Latest
    ```
    Убедитесь, что можно получить доступ к веб-клиента в URL-адрес клиента на имя вашего сервера, в формате <https://server_FQDN/RDWeb/webclient/index.html>. Очень важно использовать имя сервера, который соответствует сертификату открытого веб-доступа к удаленным рабочим Столам в URL-АДРЕСЕ (обычно полное доменное имя сервера).

    >[!NOTE]
    >При выполнении **RDWebClientPackage публикации** командлета, может появиться предупреждение об ошибке клиентские лицензии на устройство, не поддерживаются, даже если развертывание настроено для клиентских лицензий на пользователя. Если в развертывании используются клиентские лицензии на пользователя, это предупреждение можно игнорировать. Мы отображаем его, чтобы убедиться, что вы знакомы ограничение конфигурации.
8. Когда вы будете готовы для пользователей для доступа к веб-клиента, просто отправьте их URL-адрес клиента вы создали.

>[!NOTE]
>Чтобы просмотреть список всех поддерживаемых командлетов для модуля RDWebClientManagement, выполните следующий командлет PowerShell:
>```PowerShell
>Get-Command -Module RDWebClientManagement
>```

## <a name="how-to-update-the-remote-desktop-web-client"></a>Как обновить веб-клиента удаленного рабочего стола

Если доступна новая версия веб-клиента удаленного рабочего стола, выполните следующие действия для обновления развертывания с новым клиентом.

1. Откройте повышенными привилегиями PowerShell на сервере веб-доступа к удаленным рабочим Столам и выполните следующий командлет, чтобы скачать последней доступной версии веб-клиента:
    ```PowerShell
    Install-RDWebClientPackage
    ```

2. При необходимости вы можете опубликовать клиент для тестирования перед официальным выпуском, выполнив командлет:
    ```PowerShell
    Publish-RDWebClientPackage -Type Test -Latest
    ```

    Клиент должен появляться в тестовый URL-адрес, соответствующий вашей URL-адрес клиента (например, <https://server_FQDN/RDWeb/webclient-test/index.html>).
3. Публикация клиента для пользователей, выполнив следующий командлет:
    ```PowerShell
    Publish-RDWebClientPackage -Type Production -Latest
    ```

    Это заменит клиента для всех пользователей, когда они перезапустите веб-страницы.

## <a name="how-to-uninstall-the-remote-desktop-web-client"></a>Удаление веб-клиента удаленного рабочего стола

Чтобы удалить все следы веб-клиента, выполните следующие действия.

1. На сервере веб-доступа к удаленным рабочим Столам откройте строки PowerShell с повышенными привилегиями.
2. Отменить публикацию клиентов тестовой и рабочей, удалите все локальные пакеты, а затем удалить веб-параметров клиента:

   ```PowerShell
   Uninstall-RDWebClient
   ```

3. Удаление модуля PowerShell управления клиента web удаленного рабочего стола:

   ```PowerShell
   Uninstall-Module -Name RDWebClientManagement
   ```

## <a name="how-to-install-the-remote-desktop-web-client-without-an-internet-connection"></a>Установка веб-клиента удаленного рабочего стола без подключения к Интернету

Выполните следующие действия для развертывания веб-клиента к серверу веб-доступа к удаленному рабочему Столу, не подключен к Интернету.

> [!NOTE]
> Установка без подключения к Интернету доступна в версии 1.0.1 и более поздних версий модуля RDWebClientManagement PowerShell.

> [!NOTE]
> Необходимо по-прежнему ПК администратора с доступом к Интернету, чтобы скачать необходимые файлы перед передачей их в автономный сервер.

> [!NOTE]
> Компьютере конечного пользователя требуется подключение к Интернету сейчас. Это будет устранена в будущих версиях клиенту предоставлять полный сценарий автономного режима.

### <a name="from-a-device-with-internet-access"></a>С устройства с доступом к Интернету

1. Откройте командную строку PowerShell.

2. Импортируйте модуль PowerShell web клиента удаленного рабочего стола управления из коллекции PowerShell:
    ```PowerShell
    Import-Module -Name RDWebClientManagement
    ```

3. Загрузите последнюю версию веб-клиента удаленного рабочего стола для установки на другом устройстве:
    ```PowerShell
    Save-RDWebClientPackage "C:\WebClient\"
    ```

4. Загрузите последнюю версию модуля RDWebClientManagement PowerShell:
    ```PowerShell
    Find-Module -Name "RDWebClientManagement" -Repository "PSGallery" | Save-Module -Path "C:\WebClient\"
    ```

5. Скопируйте его содержимое «C:\WebClient\" на сервер RD Web Access.

### <a name="from-the-rd-web-access-server"></a>С сервера веб-доступа к удаленным рабочим Столам

Следуйте инструкциям в разделе [как опубликовать веб-клиент удаленного рабочего стола](remote-desktop-web-client-admin.md#how-to-publish-the-remote-desktop-web-client), заменив следующие шаги 4 и 5.

4. Импортируйте модуль PowerShell web клиента удаленного рабочего стола управления в локальной папке:
    ```PowerShell
    Import-Module -Name "C:\WebClient\"
    ```

5. Развертывайте последнюю версию веб-клиента удаленного рабочего стола в локальной папке (Замените соответствующие ZIP-файл):
    ```PowerShell
    Install-RDWebClientPackage -Source "C:\WebClient\rdwebclient-1.0.1.zip"
    ```

## <a name="connecting-to-rd-broker-without-rd-gateway-in-windows-server-2019"></a>К компоненту Service Broker удаленных рабочих Столов без шлюза удаленных рабочих Столов в Windows Server 2019 г.
В этом разделе описывается включение подключения клиента web на брокер удаленных рабочих Столов без шлюз удаленных рабочих Столов в Windows Server 2019.

### <a name="setting-up-the-rd-broker-server"></a>Настройка сервера посредника

#### <a name="follow-these-steps-if-there-is-no-certificate-bound-to-the-rd-broker-server"></a>Выполните следующие действия, если сертификат не привязан к сервер посредника

1. Откройте **диспетчера серверов** > **служб удаленных рабочих столов**.

2. В **Общие сведения о развертывании** выберите **задачи** раскрывающееся меню.

3. Выберите **изменение свойств развертывания**, новое окно под названием **свойства развертывания** будет открыт.

4. В **свойства развертывания** выберите **сертификаты** в меню слева.

5. В списке уровней сертификат, выберите **посредника подключений к удаленному рабочему Столу — Включить единый вход**. У вас есть два варианта: (1) создайте новый сертификат или (2) существующего сертификата.

#### <a name="follow-these-steps-if-there-is-a-certificate-previously-bound-to-the-rd-broker-server"></a>Выполните следующие действия, при наличии сертификата, ранее привязанного к сервер посредника

1. Откройте сертификат, привязанный к брокеру и копирования **отпечаток** значение.

2. Чтобы привязать этот сертификат для безопасного порта 3392, откройте окно PowerShell с повышенными привилегиями и выполните следующую команду, заменив **«< отпечаток >»** со значением, скопированным на предыдущем шаге:

    ```PowerShell
    netsh http add sslcert ipport=0.0.0.0:3392 certhash="<thumbprint>" certstorename="Remote Desktop" appid="{00000000-0000-0000-0000-000000000000}"
    ```

    > [!NOTE]
    > Чтобы проверить, если сертификат был привязан правильно, выполните следующую команду:
    >
    > ```PowerShell
    > netsh http show sslcert
    > ```
    >
    > В списке привязки SSL-сертификатов убедитесь, что выбран правильный сертификат привязан к порту 3392.

3. Откройте Windows реестра (regedit) и nagivate для ```HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp``` и найдите раздел **WebSocketURI**. Значение должно быть присвоено <strong>https://+:3392/rdp/</strong>.

### <a name="setting-up-the-rd-session-host"></a>Настройка узла сеансов удаленных рабочих Столов
Если сервер узла сеансов удаленных рабочих Столов отличается от сервер посредника, выполните следующие действия.

1. Создайте сертификат для компьютера узла сеансов удаленных рабочих Столов, откройте его и скопируйте **отпечаток** значение.

2. Чтобы привязать этот сертификат для безопасного порта 3392, откройте окно PowerShell с повышенными привилегиями и выполните следующую команду, заменив **«< отпечаток >»** со значением, скопированным на предыдущем шаге:

    ```PowerShell
    netsh http add sslcert ipport=0.0.0.0:3392 certhash="<thumbprint>" appid="{00000000-0000-0000-0000-000000000000}"
    ```

    > [!NOTE]
    > Чтобы проверить, если сертификат был привязан правильно, выполните следующую команду:
    >
    > ```PowerShell
    > netsh http show sslcert
    > ```
    >
    > В списке привязки SSL-сертификатов убедитесь, что выбран правильный сертификат привязан к порту 3392.

3. Откройте Windows реестра (regedit) и nagivate для ```HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp``` и найдите раздел **WebSocketURI**. Значение должно быть присвоено <https://+:3392/rdp/>.

### <a name="general-observations"></a>Общие наблюдения

* Убедитесь, что сервер узла сеансов удаленных рабочих Столов и посредника выполняется Windows Server 2019.

* Убедитесь, что public доверенных сертификатов, настроенные для сервера узла сеансов удаленных рабочих Столов и посредника.
    > [!NOTE]
    > Если узла сеансов удаленных рабочих Столов и сервер посредника совместно используют тот же компьютер, необходимо задайте только сертификат сервера посредника. Если сервер узла сеансов удаленных рабочих Столов и посредника использовать разных компьютерах, оба должны быть настроены уникальные сертификаты.

* **Альтернативного имени субъекта (SAN)** для каждого сертификата должно быть присвоено компьютера **полное доменное имя (FQDN)** . **Общее имя (CN)** должно соответствовать по сети SAN для каждого сертификата.

## <a name="how-to-pre-configure-settings-for-remote-desktop-web-client-users"></a>Как предварительно настроить параметры для пользователей клиента удаленного рабочего стола web
В этом разделе о том, как использовать PowerShell для настройки параметров удаленного рабочего стола развертывание веб-клиента. Эти PowerShell командлеты управления пользователя возможность изменять параметры основаны на вопросах безопасности вашей организации либо предназначен рабочего процесса. Следующие параметры находятся в **параметры** боковой панели веб-клиента. 

### <a name="suppress-telemetry"></a>Отключение телеметрии
По умолчанию пользователи могут выбирать включить или отключить сбор данных телеметрии, который отправляется в корпорацию Майкрософт. Сведения о собираемых корпорацией Майкрософт данных телеметрии, см. в заявлении о конфиденциальности через ссылку в **о** боковой панели.

Будучи администратором вы можете отключить сбор данных телеметрии для развертывания с помощью командлета PowerShell:

   ```PowerShell
    Set-RDWebClientDeploymentSetting -SuppressTelemetry $true
   ```

По умолчанию пользователь может выбрать включение и отключение телеметрии. Значение типа boolean **$false** будет соответствовать поведение клиента по умолчанию. Значение типа boolean **$true** отключает телеметрии и запрещает включение телеметрии пользователя.

### <a name="remote-resource-launch-method"></a>Метод запуска удаленный ресурс
По умолчанию пользователи могут выбирать для запуска удаленных ресурсов (1) в браузере или (2), загрузив RDP-файл с помощью другого клиента, на своем компьютере. Будучи администратором вы можете ограничить метод запуска удаленный ресурс для развертывания с помощью следующей команды Powershell:

   ```PowerShell
    Set-RDWebClientDeploymentSetting -LaunchResourceInBrowser ($true|$false)
   ```
 По умолчанию пользователь может выбрать либо метод запуска. Значение типа boolean **$true** вынудит пользователя для запуска ресурсов в браузере. Значение типа boolean **$false** вынудит пользователя для запуска ресурсов, загрузив RDP-файл для обработки с помощью локально установленного клиента RDP.

### <a name="reset-rdwebclientdeploymentsetting-configurations-to-default"></a>Сброс конфигурации RDWebClientDeploymentSetting к значениям по умолчанию
Чтобы сбросить все веб-уровня развертывания клиентских параметров конфигурации по умолчанию, выполните следующий командлет PowerShell:

   ```PowerShell
    Reset-RDWebClientDeploymentSetting 
   ```

## <a name="troubleshooting"></a>Устранение неполадок

Если пользователь сообщает следующие проблемы при открытии веб-клиента в первый раз, приведенные ниже сообщит, что нужно сделать для их устранения.

### <a name="what-to-do-if-the-users-browser-shows-a-security-warning-when-they-try-to-access-the-web-client"></a>Что делать, если в браузере пользователя отображается предупреждение о безопасности при попытке получения доступа к веб-клиента

Роли RD Web Access могут не использовать доверенный сертификат. Убедитесь, что роли RD Web Access настроено общедоступный доверенный сертификат.

Если это не поможет, имя сервера в Интернете URL-адрес клиента могут отличаться имя, указанное с помощью сертификата Web удаленных рабочих Столов. Убедитесь, что URL-адрес использует полное ДОМЕННОЕ имя сервера, где размещается удаленных рабочих Столов веб-роли.

### <a name="what-to-do-if-the-user-cant-connect-to-a-resource-with-the-web-client-even-though-they-can-see-the-items-under-all-resources"></a>Что делать, если пользователь не может подключиться к ресурсу с веб-клиента несмотря на то, что они могут видеть элементы в папке все ресурсы

Если пользователь сообщает, что они не может подключиться с помощью веб-клиента, несмотря на то, что они могут видеть в ресурсах, перечисленных, проверьте следующее:

* Роль шлюза удаленных рабочих Столов правильно настроен на использование общедоступный доверенный сертификат?
* Сервере шлюза удаленных рабочих Столов установлены необходимые обновления? Убедитесь, что сервер имеет [обновление KB4025334](https://support.microsoft.com/en-us/help/4025334/windows-10-update-kb4025334) установлен.

Если пользователь получает ошибку «был получен непредвиденный сертификат проверки подлинности» сообщение при попытке подключения, то сообщение будет отображаться отпечаток сертификата. Поиск диспетчера сертификатов сервер посредника, с помощью этого отпечатка для поиска правильного сертификата. Убедитесь, что сертификат настроен для использования для роли посредника на странице свойств развертывания удаленного рабочего стола. После убедившись, что сертификат еще не истек, скопируйте сертификат в формате CER-файл на сервер RD Web Access и выполните следующую команду на сервере веб-доступа к удаленному рабочему Столу со значением в квадратных скобках заменяется путь к файлу сертификата:

```PowerShell
Import-RDWebClientBrokerCert <certificate file path>
```

### <a name="diagnose-issues-with-the-console-log"></a>Диагностика проблем с помощью журнал консоли

Если не удается решить проблему, в соответствии с инструкциями по устранению неполадок в этой статье, попробуйте самостоятельно изучить источник проблемы, с консоли входа в браузере. Веб-клиент предоставляет метод для записи журнала активности консоли браузера через веб-клиента для диагностики проблем.

* Нажмите кнопку с многоточием в правом верхнем углу и перейдите к **о** страницы в раскрывающемся меню.
* В разделе **записи сведения о поддержке** выберите **начать запись** кнопки.
* Выполните операции в веб-клиента, который создал задачу, которую вы пытаетесь диагностировать.
* Перейдите к **о** и укажите **остановить запись**.
* Браузер будет автоматически загружать txt-файл под названием **Logs.txt консоли к удаленному рабочему Столу**. Этот файл будет содержать действия журнала полный консоли, созданные при воспроизведении проблему целевой.

Консоль также доступны непосредственно через браузер. Консоль обычно находится в средствах разработчика. К примеру, можно открыть журнал в Microsoft Edge, нажав клавиши **F12** ключа или выбрав кнопку с многоточием, затем открыть меню **больше средств** > **средств разработчика**.

## <a name="get-help-with-the-web-client"></a>Получите помощь по веб-клиента

Если возникла проблема, которая не может быть решена путем сведения в этой статье, вы можете [нами по электронной почте](mailto:rdwbclnt@microsoft.com) чтобы сообщить о ней. Также вы можете запросить или проголосовать за новые возможности в наших [поле для предложений](https://aka.ms/rdwebfbk).
