---
ms.assetid: 7dd905ea-4235-4519-8400-31b4fa0ed1bf
title: Включение возможности определения ближайшего контроллера домена в клиентах
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.date: 08/08/2018
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adds
ms.openlocfilehash: ce946fb0fe581a66f4a4e29cf8491f00294b5bcb
ms.sourcegitcommit: d5e27c1f2f168a71ae272bebf8f50e1b3ccbcca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "86953586"
---
# <a name="enabling-clients-to-locate-the-next-closest-domain-controller"></a>Включение возможности определения ближайшего контроллера домена в клиентах

> Область применения. Windows Server 2019, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Если у вас есть контроллер домена под управлением Windows Server 2008 или более поздней версии, можно сделать так, чтобы клиентские компьютеры под управлением Windows Vista или более поздней версии или Windows Server 2008 или более поздней версии могли более эффективно искать контроллеры домена, включив параметр **попробовать следующий ближайший сайт** групповая политика. Этот параметр улучшает локатор контроллеров доменов (локатор контроллера домена), помогая оптимизировать сетевой трафик, особенно в крупных предприятиях, имеющих множество филиалов и сайтов.

Этот новый параметр может повлиять на настройку стоимости связи сайтов, так как он влияет на порядок расположения контроллеров домена. Для предприятий, имеющих много центральных сайтов и филиалов, можно значительно сократить Active Directory трафика в сети, гарантируя отработку отказа клиентов на ближайшие ближайшие узлы концентратора, если им не удается найти контроллер домена на ближайшем сайте концентратора.

Рекомендуется как можно более упростить топологию сайта и стоимость связи сайтов, если включить параметр **попробовать следующий ближайший сайт** . На предприятиях со многими узлами-концентраторами это позволяет упростить любые планы, которые вы захотите использовать для обработки ситуаций, в которых клиенты на одном сайте должны выполнить отработку отказа на контроллер домена на другом сайте.

По умолчанию параметр **попробовать следующий ближайший сайт** не включен. Если параметр не включен, локатор контроллеров домена использует следующий алгоритм.

- Попробуйте найти контроллер домена в том же сайте.
- Если контроллер домена недоступен на том же сайте, попробуйте найти любой контроллер домена в этом домене.

> [!NOTE]
> Это тот же алгоритм, который локатор контроллеров домена использовал в предыдущих версиях Active Directory. Дополнительные сведения см. в статье [как работает поддержка DNS для Active Directory](/previous-versions/windows/it-pro/windows-server-2003/cc759550(v=ws.10)).

Если включить параметр **попробовать следующий ближайший сайт** , то локатор контроллера домена будет использовать следующий алгоритм для поиска контроллера доменов:

- Попробуйте найти контроллер домена в том же сайте.
- Если контроллер домена недоступен на том же сайте, попробуйте найти контроллер домена на следующем ближайшем сайте. Сайт находится ближе, если затраты на сайт меньше, чем у другого сайта с более высокой стоимостью связи между сайтами.
- Если контроллер домена недоступен на ближайшем сайте, попробуйте найти любой контроллер домена в домене.

Параметр **попробовать следующий ближайший сайт** работает в координации с автоматическим покрытием сайта. Например, если на следующем ближайшем сайте нет контроллера домена, локатор КОНТРОЛЛЕРов домена пытается найти контроллер, который выполняет автоматическое покрытие сайта для этого сайта.

По умолчанию локатор контроллеров домена не учитывает сайт, содержащий контроллер домена только для чтения (RODC), при определении ближайшего ближайшего сайта. Кроме того, когда клиент получает ответ от контроллера домена, который работает под управлением более ранней версии, чем Windows Server 2008, то поведение локатора КОНТРОЛЛЕРов домена аналогично значению параметра не включено.

Например, предположим, что топология сайта содержит четыре сайта со значениями связей сайтов на следующем рисунке. В этом примере все контроллеры домена являются контроллерами домена с возможностью записи под управлением Windows Server 2008 или более поздней версии.

![включение клиентов для поиска контроллера домена](media/Enabling-Clients-to-Locate-the-Next-Closest-Domain-Controller/beff4087-fb2a-463b-96ac-d440a9e29b75.gif)

Если в этом примере включен параметр **попробовать следующий ближайший сайт** групповая политика, если клиентский компьютер в Site_B пытается найти контроллер домена, он сначала пытается найти контроллер домена в своем собственном Site_B. Если в Site_B нет доступных, он пытается найти контроллер домена в Site_A.

Если параметр не включен, клиент пытается найти контроллер домена в Site_A, Site_C или Site_D, если в Site_B не доступен ни один контроллер домена.

> [!NOTE]
> Параметр **попробовать следующий ближайший сайт** работает в координации с автоматическим покрытием сайта. Например, если на следующем ближайшем сайте нет контроллера домена, локатор КОНТРОЛЛЕРов домена пытается найти контроллер, который выполняет автоматическое покрытие сайта для этого сайта.

Чтобы применить параметр **попробовать следующий ближайший сайт** , можно создать объект Групповая политика (GPO) и связать его с соответствующим объектом для Организации. также можно изменить политику домена по умолчанию, чтобы она влияла на всех клиентах, работающих под управлением Windows Vista или более поздней версии и windows Server 2008 или более поздней версии в домене. Дополнительные сведения о задании параметра " **попробовать следующий ближайший сайт** " см. в разделе [включение клиентов на поиск контроллера домена на следующем ближайшем сайте](/previous-versions/windows/it-pro/windows-server-2008-r2-and-2008/cc772592(v=ws.10)).
