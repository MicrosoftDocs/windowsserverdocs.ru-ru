---
ms.assetid: d7a4d2e1-217d-4ffc-93f0-817149bd9e7f
title: Способы решения проблем
description: ''
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adds
ms.openlocfilehash: b2233a638aa0a422d5792f8c949c46ac8de099ba
ms.sourcegitcommit: 07c9d4ea72528401314e2789e3bc2e688fc96001
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "76822047"
---
# <a name="avenues-to-compromise"></a>Способы решения проблем

>Область применения: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

*Номер закона семь. наиболее безопасная сеть хорошо администрируется.* - [10 непреложных законов по администрированию безопасности](https://technet.microsoft.com/library/cc722488.aspx)  
  
В организациях, имеющих серьезные разрушительные события, оценки обычно считают, что Организации ограничены реальным состоянием ИТ ИТ – инфраструктуры, что может значительно отличаться от их «в документации». состояния. Эти дисперсии представляют уязвимости, которые предоставляют среде для компрометации, часто с небольшим риском обнаружения до тех пор, пока злоумышленники не попадают в среду, в которой взломщики эффективно «владеют» средой.  
  
Подробные оценки таких организаций, как конфигурация AD DS, инфраструктуры открытых ключей (PKI), серверы, рабочие станции, приложения, списки управления доступом (ACL) и другие технологии, позволяют выявить неправильные настройки и уязвимости, которые, если исправлено, может быть предотвращена первоначальная компрометация.  
  
Анализ документации по ИТ, процессам и процедурам определяет уязвимости, появившиеся в административных рекомендациях, которые были использованы злоумышленниками для получения привилегий, которые использовались для полной компрометации Active Directoryного леса. Полностью скомпрометированный лес — это тот, в котором злоумышленники подпадают не только отдельные системы, приложения или учетные записи пользователей, но и получают доступ к уровню привилегий, в котором они могут изменять или уничтожать все аспекты леса. Когда Active Directoryная установка была скомпрометирована на этот уровень, злоумышленники могут вносить изменения, позволяющие им поддерживать присутствие во всей среде или хуже, чтобы уничтожить каталог и системы и учетные записи, которыми он управляет.  
  
Хотя ряд часто используемых уязвимостей в приведенных ниже описаниях не является атакой на Active Directory, они позволяют злоумышленникам установить укрепиться в среде, которую можно использовать для повышения привилегий (также называемых привилегиями). повышение прав) и в конечном итоге нацеливание и компрометация AD DS.  
  
Этот раздел документа посвящен описанию механизмов, которые обычно используются злоумышленниками для получения доступа к инфраструктуре и, в конечном итоге, для запуска атак с повышенными правами. См. также следующие разделы:  
  
-   [Сокращение Active Directory уязвимой зоны](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md) Подробные рекомендации по безопасной конфигурации Active Directory.  
  
-   [Мониторинг Active Directory для подписывания компромисса](../../../ad-ds/plan/security-best-practices/Monitoring-Active-Directory-for-Signs-of-Compromise.md) Рекомендации, помогающие обнаружить компромисс  
  
-   [Планирование компрометации](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) Высокоуровневые подходы, помогающие подготовиться к атакам с инфраструктурой с точки зрения ИТ и бизнес-перспектив  
  
> [!NOTE]  
> Хотя в этом документе основное внимание уделяется Active Directory и системам Windows, которые являются частью домена AD DS, злоумышленники редко сосредоточены исключительно на Active Directory и Windows. В средах с сочетанием операционных систем, каталогов, приложений и хранилищ данных часто можно обнаружить, что системы, не относящиеся к системе Windows, также были скомпрометированы. Это особенно верно, если системы предоставляют "мост" между средами Windows и системами, отличными от Windows, например, к файловым серверам, к которым обращаются клиенты Windows и UNIX или Linux, каталоги, предоставляющие службы проверки подлинности нескольким операционным системам, или метадиректориес, которые синхронизируют данные в разнородных каталогах.  
>   
> AD DS предназначено для централизованного управления доступом и конфигурацией, он предоставляет не только системы Windows, но и другие клиенты. Любой другой каталог или приложение, предоставляющее службы проверки подлинности и управления конфигурацией, могут быть назначены определенными злоумышленниками. Несмотря на то, что этот документ ориентирован на защиту, которая может снизить вероятность компрометации Active Directory установок, каждая организация, которая включает компьютеры, каталоги, приложения или хранилища данных, не относящиеся к Windows, должна также подготовиться к атаки на эти системы.  
  
## <a name="initial-breach-targets"></a>Цели первоначального нарушения  
Никто намеренно не создает ИТ – инфраструктуру, которая предоставляет Организации возможность компрометации. При первом создании Active Directory леса обычно поддерживалась и Current. По мере приобретения новых операционных систем и приложений они добавляются в лес. Так как преимущества управляемости, предоставляемые Active Directory, будут добавлены в каталог, другие пользователи интегрируют свои компьютеры или приложения с AD DS, а домены обновлены для поддержки новых функций, предлагаемых наиболее текущие версии операционной системы Windows. Тем не менее, с течением времени это происходит, даже если добавляется новая инфраструктура, другие части инфраструктуры могут не поддерживаться, и, соответственно, системы и приложения работают должным образом и, следовательно, не получают Обратите внимание, и организации начинают забыть, что они не устранили устаревшую инфраструктуру. В зависимости от того, что мы увидим при оценке скомпрометированных инфраструктур, чем более старая, крупная и более сложная среда, тем более вероятно, что существует множество экземпляров часто используемых уязвимостей.  
  
Независимо от причин злоумышленника большинство нарушений информационной безопасности начинается с компрометации одной или двух систем за раз. Эти начальные события или точки входа в сеть часто используют уязвимые места, которые могли быть исправлены, но не были. [Отчет об исследовании уязвимости данных 2012 (дбир)](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf), который является ежегодным исследованием, созданным Группой Verizonных рисков в сотрудничество с несколькими национальными агентствами безопасности и другими компаниями, указывает на то, что 96 процентов атак были «не очень сложными», и что «97% нарушений в работе с помощью простых или промежуточных элементов управления». Эти выводы могут быть прямой следствием часто используемых уязвимостей.  
  
### <a name="gaps-in-antivirus-and-antimalware-deployments"></a>Пробелы в развертываниях антивирусных и антивредоносных программ  
*Номер закона восемь: устаревшее средство проверки на наличие вредоносных программ имеет более высокий уровень, чем отсутствие сканера.* - [десять неизменяемых законов безопасности (версия 2,0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Анализ антивирусных и антивредоносных развертываний организаций часто открывает среду, в которой большинство рабочих станций настроены с включенным и актуальным антивирусным и антивредоносным программным обеспечением. Исключения обычно часто подключаются к корпоративной среде или устройствам сотрудников, для которых может быть трудно развертывать, настраивать и обновлять антивирусные и Антивредоносные программы.  
  
Тем не менее, заполнение сервера, однако, в большинстве скомпрометированных сред снижается. Как сообщило об обнаружении [нарушений в данных 2012](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf), 94 процентов всех данных приводят к снижению количества задействованных серверов, что представляет 18% увеличения предыдущего года и 69 процентов атак, зараженных вредоносными программами. При заполнении сервера нередко обнаруживается, что установка антивирусных и антивредоносных программ настроена неправильно, устарела, неправильно настроена или даже отключена. В некоторых случаях антивирусные и Антивредоносные программы отключаются административным персоналом, но в других случаях злоумышленники отключают программное обеспечение после взлома сервера с помощью других уязвимостей. Когда антивирусное и антивредоносное по отключено, злоумышленники затем набросают вредоносные программы на сервере и сосредоточиться на распространении компромиссов между заполнением сервера.  
  
Важно не только обеспечить защиту систем с помощью текущей, комплексной защиты от вредоносных программ, но также отслеживать системы для отключения или удаления антивирусных и антивредоносных программ и автоматического перезапуска защиты при отключено вручную. Несмотря на то, что антивирусные и Антивредоносные программы могут гарантировать предотвращение и обнаружение всех заражений, правильно настроенная и развернутая реализация антивирусной и антивредоносной программы может снизить вероятность заражения.  
  
### <a name="incomplete-patching"></a>Незавершенная установка исправлений  
*Номер закона 3. Если вы не будете поддерживать исправления безопасности, ваша сеть будет недоступна для вас.* - [10 непреложных законов по администрированию безопасности](https://technet.microsoft.com/library/cc722488.aspx)  
  
Корпорация Майкрософт выпускает бюллетени по безопасности во второй вторник каждого месяца, хотя в редких случаях обновления безопасности выпускаются между ежемесячными обновлениями системы безопасности (они также называются "обновлениями по внешнему каналу"), когда обнаружена уязвимость. срочной риск для систем клиентов. Независимо от того, настраивает ли компьютер Windows использование Центр обновления Windows для управления исправлениями системы и приложений или крупной организации, использует программное обеспечение для управления, такое как Microsoft Endpoint Configuration Manager для развертывания исправлений в соответствии с подробными сведениями, иерархические планы, многие клиенты своевременно исправляют свои инфраструктуры Windows.  
  
Однако в некоторых инфраструктурах есть только компьютеры Windows и приложения Майкрософт, а в скомпрометированных средах часто обнаруживается, что стратегия управления исправлениями в организации содержит пробелы. Системы Windows в этих средах не установлены в соответствии с исправлениями. Обновления для операционных систем, отличных от Windows, обновляются регулярно, если вообще. Коммерческие приложения, работающие за пределами полки (Котс), содержат уязвимости, для которых существуют исправления, но они не были применены. Сетевые устройства часто настраиваются с использованием учетных данных по умолчанию и не обновляются в течение года после установки. Приложения и операционные системы, которые больше не поддерживаются поставщиками, часто остаются работающими, несмотря на то, что они больше не могут быть исправлены для уязвимостей. Каждая из этих неисправленных систем представляет еще одну потенциальную точку входа для злоумышленников.  
  
На потребителей ИТ были добавлены дополнительные трудности в том, что устройства, принадлежащие сотрудникам, используются для доступа к корпоративным данным, и организация может иметь немало контроля над установкой исправлений и конфигурацией персональных устройств сотрудников. Оборудование корпоративного класса обычно поставляется с корпоративными возможностями настройки и функциями управления, за счет чего меньше выбора в индивидуальной настройке и выборе устройств. Оборудование, ориентированное на сотрудников, предлагает более широкий спектр изготовителей, поставщиков, аппаратных средств безопасности, функций безопасности программного обеспечения, возможностей управления и параметров конфигурации, а также многие корпоративные функции могут вообще отсутствовать.  
  
#### <a name="patch-and-vulnerability-management-software"></a>Программное обеспечение для управления исправлениями и уязвимостью  
Если для систем Windows и приложений Майкрософт установлена действующая система управления исправлениями, часть уязвимой уязвимости, которая была создана, была устранена. Однако, если не установлены системы сторонних разработчиков, сторонние приложения, сетевая инфраструктура и устройства сотрудников, также постоянно обновляются исправления и другие исправления, инфраструктура остается уязвимой. В некоторых случаях поставщик приложения может предоставлять возможности автоматического обновления; в других случаях может потребоваться разработать подход к регулярному извлечению и применению исправлений и других исправлений.
  
### <a name="outdated-applications-and-operating-systems"></a>Устаревшие приложения и операционные системы  
*"Вы не можете рассчитывать на устаревшую операционную систему в течение шести лет, чтобы защитить вас от атак на шесть месяцев."* -Information Security Professional с 10-летним опытом защиты корпоративных установок  
  
Несмотря на то, что "получить текущий, оставаться актуальным" может показаться маркетинговой фразой, устаревшие операционные системы и приложения создают риск во многих ИТ-инфраструктурах Организации. Операционная система, выпущенная в 2003, может по-прежнему поддерживаться поставщиком и поставляется с обновлениями для устранения уязвимостей, но эта операционная система может не содержать функции безопасности, добавленные в более поздних версиях операционной системы. Устаревшие системы могут даже потребовать ослабления определенной AD DS конфигурации безопасности для поддержки меньших возможностей этих компьютеров.  
  
Приложения, написанные для использования устаревших протоколов проверки подлинности поставщиками, которые больше не поддерживают приложение, обычно не могут быть использованы для поддержки более надежных механизмов проверки подлинности. Однако домен Active Directory организации по-прежнему может быть настроен для хранения хэшей LAN Manager или обратимо зашифрованных паролей для поддержки таких приложений. Приложения, написанные до появления новых операционных систем, могут работать неправильно или вообще в текущих операционных системах, что требует организации поддерживать старые и более старые системы, а в некоторых случаях — полностью неподдерживаемое оборудование и программное обеспечение.  
  
Даже в случаях, когда Организации обновили свои контроллеры домена до Windows Server 2012, Windows Server 2008 R2 или Windows Server 2008, обычно приходится искать значительные части заполнения рядового сервера под Windows Server 2003, Windows 2000 Server или Windows NT Server 4,0 (которые полностью не поддерживаются). Чем длиннее организация обслуживает системы старения, тем больше превышаются различия между наборами функций, тем больше вероятность, что рабочие системы будут не поддерживаться. Кроме того, поддерживается более длинный Active Directory лес, тем больше мы видим, что устаревшие системы и приложения в планах обновления отсутствуют. Это может означать, что один компьютер, на котором работает одно приложение, может вызвать уязвимости уровня домена или леса, так как Active Directory настроена для поддержки устаревших протоколов и механизмов проверки подлинности.  
  
Для устранения устаревших систем и приложений необходимо сначала сосредоточиться на их идентификации и каталогизации, а затем определить, следует ли обновить или заменить приложение или узел. Хотя найти замены для строго специализированных приложений, для которых не существует ни поддержки, ни способа обновления, может быть трудно, вы можете использовать концепцию «творческого уничтожения» для замены устаревшего приложения новым. , предоставляющий необходимые функции. [Планирование компромиссов](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) описано более подробно в разделе «Планирование компромисса» далее в этом документе.  
  
### <a name="misconfiguration"></a>Неправильной настройки  
*Закон номер 4. Установка исправлений безопасности на компьютер, который никогда не был защищен с помощью, не имеет смысла.* - [10 непреложных законов по администрированию безопасности](https://technet.microsoft.com/library/cc722488.aspx)  
  
Даже в средах, где обычно хранятся актуальные и исправленные системы, мы обычно выявление пробелов или недопустимых настроек в операционной системе, приложениях, выполняющихся на компьютерах, и Active Directory. Некоторые недопустимые настройки предоставляют уязвимости только локальный компьютер, но после признания компьютера злоумышленники обычно сосредоточиться на дальнейшем распространении компромисса между другими системами и, в конечном итоге, к Active Directory. Ниже приведены некоторые распространенные области, в которых определяются конфигурации, представляющие риск.  
  
#### <a name="in-active-directory"></a>В Active Directory  
Учетные записи в Active Directory, наиболее часто используемые злоумышленниками, являются членами групп с самыми высокими привилегиями, такими как члены групп "Администраторы домена" (DA), "Администраторы предприятия" (EA) или "Встроенные администраторы (BA)" в Active Каталоги. Членство в этих группах следует уменьшить до наименьшего допустимого количества учетных записей, чтобы атака этих групп была ограничена. Можно также исключить "постоянное" членство в этих привилегированных группах. то есть можно реализовать параметры, позволяющие временно заполнять эти группы, только если требуются права уровня домена и леса. Если используются учетные записи с высоким уровнем привилегий, их следует использовать только в определенных, защищенных системах, таких как контроллеры домена или защищенные административные узлы. Подробные сведения, помогающие реализовать все эти конфигурации, приведены в [сокращении Active Directoryной](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)уязвимости.  
  
При оценке членства в группах с наибольшим числом привилегированных пользователей в Active Directory мы часто нашли чрезмерное членство во всех трех группах с наибольшим уровнем привилегий. В некоторых случаях организации имеют десятки и даже сотни учетных записей в группах DA. В других случаях организации размещают учетные записи непосредственно во встроенных группах администраторов, что подумывает, что Группа «менее привилегированных», чем группа DAs. Нет. В корневом домене леса часто встречается несколько постоянных членов группы EA, несмотря на тот факт, что привилегии EA редко и временно требуются. Нахождение повседневной административной учетной записи пользователя во всех трех группах также распространено, несмотря на то, что это эффективно избыточная конфигурация. Как описано в разделе [уменьшение Active Directory](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)уязвимой зоны, является ли учетная запись постоянной участником одной из этих групп или ее всех, учетная запись может использоваться для компрометации и даже уничтожения среды AD DS, а также систем и учетных записей, управляемых ИТ. Рекомендации по безопасной настройке и использованию привилегированных учетных записей в Active Directory предоставляются в целях [уменьшения Active Directory](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md)уязвимой зоны.  
  
#### <a name="on-domain-controllers"></a>На контроллерах домена  
При оценке контроллеров домена часто настраиваются и управляются не так, как рядовые серверы. Контроллеры домена иногда запускают те же приложения и служебные программы, установленные на рядовых серверах, а не потому, что они необходимы на контроллерах домена, но так как приложения являются частью стандартной сборки. Эти приложения могут обеспечить минимальную функциональность на контроллерах домена, но значительно возлагаются на уязвимую зону, запросив параметр конфигурации открывать порты, создавать учетные записи служб с высоким уровнем привилегий или предоставлять доступ к системе пользователям, которые не следует подключаться к контроллеру домена для любых целей, кроме проверки подлинности и групповая политика приложения. В некоторых случаях злоумышленники использовали средства, уже установленные на контроллерах домена, не только для получения доступа к контроллерам домена, но и для изменения или повреждения базы данных AD DS.  
  
При извлечении параметров конфигурации Internet Explorer на контроллерах домена мы обнаружили, что пользователи выполнили вход с учетными записями с высоким уровнем привилегий в Active Directory и использовали учетные записи для доступа к Интернету и интрасети из домена. Контролер. В некоторых случаях учетные записи настроили параметры Internet Explorer на контроллерах домена, чтобы разрешить загрузку интернет-содержимого, а остальные служебные программы были загружены с веб-сайтов и установлены на контроллерах домена. Конфигурация усиленной безопасности Internet Explorer включена для пользователей и администраторов по умолчанию, но мы часто наблюдаем, что отключено для администраторов. Когда учетная запись с высоким уровнем привилегий обращается к Интернету и скачивает содержимое на любой компьютер, этот компьютер подвергается серьезному риску. Если компьютер является контроллером домена, вся установка AD DS подвергается риску.  
  
##### <a name="protecting-domain-controllers"></a>Защита контроллеров домена  
Контроллеры домена должны рассматриваться как критически важные компоненты инфраструктуры, что обеспечивает более строгую и более жесткую настройку, чем файлы, печать и серверы приложений. Контроллеры домена не должны запускать программное обеспечение, которое не требуется контроллеру домена для работы, или не защищает контроллер домена от атак. Контроллерам домена не следует разрешен доступ к Интернету, а параметры безопасности должны быть настроены и принудительно применены групповая политика объектами (GPO). Подробные рекомендации по безопасной установке, настройке и управлению контроллерами домена предоставляются в целях [защиты контроллеров домена от атак](../../../ad-ds/plan/security-best-practices/Securing-Domain-Controllers-Against-Attack.md).  
  
#### <a name="within-the-operating-system"></a>В операционной системе  
*Номер закона 2. Если злоумышленник может изменить операционную систему на компьютере, это больше не ваш компьютер.* - [десять неизменяемых законов безопасности (версия 2,0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Хотя некоторые организации создают базовые конфигурации для серверов различных типов и разрешают ограниченную настройку операционной системы после ее установки, анализ скомпрометированных сред часто приводит к обнаружению большого количества серверов, развернутых в нерегламентированные и настроенные вручную и независимо друг от друга. Конфигурации между двумя серверами, выполняющими одну и ту же функцию, могут быть совершенно разными, если ни один из серверов не настроен безопасно. И наоборот, шаблоны базовой конфигурации сервера могут постоянно применяться принудительно, но они также постоянно настроены. Это значит, что серверы настроены таким образом, что создает ту же уязвимость на всех серверах заданного типа. Некоторая конфигурация включает в себя такие рекомендации, как отключение функций безопасности, предоставление учетным записям избыточных прав и разрешений (в частности, учетных записей служб), использование идентичных локальных учетных данных в системах и разрешение установки Неавторизованные приложения и служебные программы, которые создают уязвимые места.  
  
##### <a name="disabling-security-features"></a>Отключение функций безопасности  
Организации иногда отключают брандмауэр Windows в повышенной безопасности (WFAS) из-за того, что в WFAS трудно настраивать или требовать интенсивную работу в рабочей конфигурации. Однако начиная с Windows Server 2008, когда какая-либо роль или компонент устанавливается на сервере, она по умолчанию настроена с минимальными привилегиями, необходимыми для функционирования роли или компонента, а брандмауэр Windows автоматически настраивается для поддержки роли. или. Если отключить WFAS (и не использовать на своем месте другой брандмауэр на основе узла), организации увеличивают область атаки для всей среды Windows. Брандмауэры периметра обеспечивают некоторую защиту от атак, непосредственно направленных в среду из Интернета, но они не обеспечивают защиту от атак, которые используют другие векторы атак, такие как атаки [типа "диск-от](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) " или атаки, полученные от скомпрометированных систем в интрасети.  
  
Параметры контроля учетных записей (UAC) иногда отключены на серверах, так как административные сотрудники находят запросы на вмешательство пользователя. Несмотря на то, что в [Служба поддержки Майкрософт статье 2526083](https://support.microsoft.com/kb/2526083) описываются сценарии, в которых UAC может быть отключен в Windows Server, если только не выполняется установка Server Core (если контроль учетных записей отключен при проектировании), не следует отключать контроль учетных записей на серверах без тщательного рассмотрения и исследования.  
  
В других случаях параметры сервера настроены на менее безопасные значения, так как организации применяют устаревшие параметры конфигурации сервера к новым операционным системам, например к применению базовых планов Windows Server 2003 на компьютерах под управлением Windows Server 2012, Windows Сервер 2008 R2 или Windows Server 2008 без изменения базовых показателей для отражения изменений в операционной системе. Вместо того, чтобы применять старые базовые показатели сервера к новым операционным системам, при развертывании новой операционной системы ознакомьтесь с изменениями безопасности и параметрами конфигурации, чтобы убедиться, что применяемые параметры применимы и подходят для новой операционной системы.  
  
##### <a name="granting-excessive-privilege"></a>Предоставление чрезмерных прав доступа  
Почти во всех средах, за которые мы оценены, избыточные привилегии предоставляются локальным и доменным учетным записям в системах Windows. Пользователям предоставляются права локального администратора на рабочих станциях, рядовые серверы выполняют службы, для которых настроены права, помимо тех, которые им необходимы, а группы локальных администраторов в пределах заполнения сервера содержат десятки или даже сотни локальные и доменные учетные записи. Компрометация только одной привилегированной учетной записи на компьютере позволяет злоумышленникам нарушать учетные записи каждого пользователя и службы, которые подключаются к компьютеру, а также собирать и использовать учетные данные для распространения компромисса к другим системам.  
  
Несмотря на то, что Pass-The-hash (PTH) и другие атаки по краже учетных данных находятся повсеместно, это обусловлено тем, что существует свободное средство, позволяющее легко и без труда извлекать учетные данные других привилегированных учетных записей, когда злоумышленник получает права администратора. или доступ на уровне системы к компьютеру. Даже без инструментов, позволяющих собирать учетные данные из сеансов входа в систему, злоумышленник с привилегированным доступом к компьютеру может просто установить средства ведения журнала нажатия клавиш, которые захватывают нажатия клавиш, снимки экрана и содержимое буфера обмена. Злоумышленник с привилегированным доступом к компьютеру может отключить антивредоносное по, установить rootkit-программы, изменить защищенные файлы или установить вредоносные программы на компьютере, который автоматизирует атаки, или превратить сервер в узел [загрузки диска](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) .  
  
Тактика, используемая для расширения нарушений, находящихся за одним компьютером, может быть различной, но ключ для распространения компромисса — это приобретение высокопривилегированного доступа к дополнительным системам. Уменьшая количество учетных записей с привилегированным доступом к любой системе, вы сокращаете область атаки не только на этом компьютере, но и атакующий злоумышленник, который получает ценные учетные данные с компьютера.  
  
##### <a name="standardizing-local-administrator-credentials"></a>Стандартизация учетных данных локального администратора  
У специалистов по безопасности есть много споров о том, есть ли в переименовании учетных записей локального администратора на компьютерах Windows значение. На самом деле важна учетная запись локального администратора, настроена ли для них одинаковое имя пользователя и пароль на нескольких компьютерах.  
  
Если учетная запись локального администратора имеет одно и то же значение на разных серверах, а пароль, назначенный учетной записи, также настроен на то же самое значение, злоумышленники могут извлекать учетные данные учетной записи на одном компьютере, на котором администратор или доступ на уровне системы был получен. Злоумышленнику не нужно первоначально нарушать учетную запись администратора. им требуется только компрометация учетной записи пользователя, который является членом локальной группы администраторов, или учетной записи службы, настроенной для запуска от имени LocalSystem или с правами администратора. Затем злоумышленник может извлечь учетные данные для учетной записи администратора и воспроизвести эти учетные данные при входе в сеть на других компьютерах в сети.  
  
Если на другом компьютере есть локальная учетная запись с тем же именем пользователя и паролем (или хэшем пароля), что и учетные данные учетной записи, то попытка входа в систему завершается успешно и злоумышленник получает привилегированный доступ к целевому компьютеру. В текущих версиях Windows встроенная учетная запись администратора [отключена по умолчанию](https://technet.microsoft.com/library/cc753450.aspx), но в устаревших операционных системах учетная запись включена по умолчанию.  
  
> [!NOTE]  
> Некоторые организации намеренно настроили учетные записи локального администратора, чтобы они были включены в том случае, если все остальные привилегированные учетные записи заблокированы в системе. Однако даже если учетная запись локального администратора отключена и нет других учетных записей, которые могут включить учетную запись или войти в систему с правами администратора, систему можно загрузить в безопасный режим, а встроенную учетную запись локального администратора можно снова включить, как описано в [Служба поддержки Майкрософт статье 814777](https://support.microsoft.com/kb/814777). Кроме того, если система по-прежнему успешно применяет объекты групповой политики, объект групповой политики можно изменить на (временно) повторно включить учетную запись администратора, или настроить группы с ограниченными правами, чтобы добавить учетную запись домена в локальную группу администраторов. Можно выполнить восстановление, и учетную запись администратора можно снова отключить. Для эффективного предотвращения нарушения безопасности бокового смещения, использующей встроенные учетные данные локального администратора, уникальные имена пользователей и пароли должны быть настроены для учетных записей локального администратора. Сведения о развертывании уникальных паролей для учетных записей локального администратора с помощью объекта групповой политики см. в разделе [решение для управления паролем встроенной учетной записи администратора с помощью объекта групповой политики](https://technet.microsoft.com/mt227395.aspx) на сайте TechNet.  
  
##### <a name="permitting-installation-of-unauthorized-applications"></a>Разрешение установки неавторизованных приложений  
*Номер закона один: если злоумышленник может убедить вас запустить свою программу на своем компьютере, он больше не является вашим компьютером.* - [десять неизменяемых законов безопасности (версия 2,0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Независимо от того, развертывает ли Организация согласованные базовые параметры на серверах, не следует разрешать установку приложений, которые не являются частью определенной роли сервера. Разрешая установку программного обеспечения, не являющегося частью назначенных серверу функций, серверы становятся непреднамеренной или вредоносной установкой программного обеспечения, увеличивающего контактную зону для атак сервера, вводит уязвимости приложения или вызывают нестабильность системы.  
  
#### <a name="applications"></a>Приложения  
Как было сказано ранее, приложения часто устанавливаются и настраиваются для использования учетных записей, которым предоставлено больше прав, чем требуется приложению. В некоторых случаях в документации приложения указано, что учетные записи служб должны быть членами локальной группы администраторов сервера или должны быть настроены для работы в контексте LocalSystem. Это часто не так, потому что приложению требуются эти права, но, поскольку определение прав и разрешений, необходимых учетным записям службы приложения, требует инвестиций за дополнительное время и усилия. Если приложение не устанавливается с минимальными привилегиями, необходимыми для функционирования приложения и его настроенных функций, система становится уязвимой для атак, использующих привилегии приложения без каких-либо атак на саму операционную систему.  
  
### <a name="lack-of-secure-application-development-practices"></a>Отсутствие защищенных методов разработки приложений  
Инфраструктура существует для поддержки рабочих нагрузок бизнеса. Если эти рабочие нагрузки реализованы в пользовательских приложениях, очень важно обеспечить разработку приложений с использованием оптимальных методов защиты. Анализ основных причин инцидентов в масштабе предприятия часто показывает, что первоначальный компромисс влияет на пользовательские приложения, в частности те, которые работают в Интернете. Большая часть этих компромиссов достигается за счет взлома известных атак, таких как атака путем внедрения кода SQL (скрытых) и атаки с использованием межсайтовых сценариев (XSS).  
  
Внедрение кода SQL — это уязвимость приложения, которая позволяет пользовательским входным данным изменять инструкцию SQL, которая передается в базу данных для выполнения. Эти входные данные могут быть предоставлены через поле в приложении — параметр (например, строка запроса или файл cookie) или другие методы. Результатом этого внедрения является то, что инструкция SQL, предоставляемая базе данных, является принципиально отличной от той, которую планировал разработчик. Возьмем, к примеру, общий запрос, используемый при вычислении комбинации имени пользователя и пароля:  
  
`SELECT userID FROM users WHERE username = 'sUserName' AND password = 'sPassword'`  
  
Когда сервер базы данных получает это сообщение, он указывает серверу на то, что он просматривает таблицу "Пользователи", и возвращает любую запись userID, в которой имя пользователя и пароль совпадают с указанными пользователем (предположительно через форму входа). Естественно, цель разработчика — возврат действительной записи только в том случае, если пользователь может предоставить правильные имя пользователя и пароль. Если указано неверное значение, сервер базы данных не сможет найти соответствующую запись и вернуть пустой результат.  
  
Проблема возникает, когда злоумышленник делает что-то непредвиденное, например предоставление собственного SQL вместо допустимых данных. Поскольку SQL интерпретируется на лету сервером базы данных, встраиваемый код будет обрабатываться так, как будто разработчик поместил его самостоятельно. Например, если злоумышленник вводит в качестве пароля учетную **запись администратора** для идентификатора пользователя и **XYZ** или **1 = 1** , результирующая инструкция, обрабатываемая базой данных, будет выглядеть следующим образом:  
  
`SELECT userID FROM users WHERE username = 'administrator' AND password = 'xyz' OR 1=1`  
  
Когда этот запрос обрабатывается сервером базы данных, все строки в таблице будут возвращены в запросе, так как 1 = 1 всегда будет оцениваться как истинное, поэтому не имеет значения, является ли правильное имя пользователя и пароль известными или предоставлены. В большинстве случаев в итоге пользователь будет входить в систему как первый пользователь в базе данных пользователя; в большинстве случаев это будет пользователь с правами администратора.  
  
Помимо простого входа в систему, такие инструкции SQL можно использовать для добавления, удаления или изменения данных, а также для удаления (удаления) целых таблиц из базы данных. В самых крайних случаях, когда скрытых сочетается с чрезмерным уровнем привилегий, можно запустить команды операционной системы, чтобы обеспечить возможность создания новых пользователей, загрузки средств атаки или выполнения других действий, выбираемых злоумышленниками.  
  
В случае межсайтовых сценариев уязвимость появилась в выходных данных приложения. Атака начинается с злоумышленника, предоставляя приложению неправильно сформированные данные, но в данном случае неверно сформированные данные находятся в виде кода скрипта (например, JavaScript), который будет выполняться браузером жертвы. Использование уязвимости XSS может позволить злоумышленнику запускать любые функции целевого приложения в контексте пользователя, запустившего браузер. Атаки XSS обычно инициируются с помощью phishing-сообщений. пользователь должен щелкнуть ссылку, которая подключится к приложению, и запустить код атаки.  
  
XSS часто используется в интерактивных банковских операциях и сценариях электронной коммерции, когда злоумышленник может совершать покупки или передавать деньги в контексте пользователя с злоумышленником. В случае целевой атаки в пользовательском веб-приложении управления удостоверениями оно может позволить злоумышленнику создать свои удостоверения, изменить разрешения и права и привести к нарушению безопасности системы.  
  
Хотя полное обсуждение межузловых сценариев и внедрения кода SQL выходит за рамки этого документа, [проект Open Web Application Security (OWASP)](https://www.owasp.org/index.php/Main_Page) публикует 10 лучших списков с подробным описанием уязвимостей и контрмер.  
  
Независимо от инвестиций в систему безопасности инфраструктуры, если плохо спроектированные и написанные приложения развернуты в этой инфраструктуре, среда становится уязвимой для атак. Даже хорошо защищенные инфраструктуры часто не могут обеспечить эффективные меры противодействия атакам этих приложений. Если решить проблему, плохо спроектированные приложения могут потребовать, чтобы учетным записям служб были предоставлены чрезмерные разрешения для работы приложения.  
  
Жизненный цикл разработки защищенных приложений (Майкрософт) (SDL) представляет собой набор структурных элементов управления процессами, которые позволяют повысить уровень безопасности, начиная с момента сбора и расширения жизненного цикла приложения до тех пор, пока не будет списано. Такая интеграция эффективных элементов управления безопасностью не только важна с точки зрения безопасности, но крайне важна для обеспечения безопасности приложений и планирования эффективности. Оценка приложения на наличие проблем безопасности при эффективном кодировании требует организации принимать решения о безопасности приложений только до или даже после развертывания приложения. Организация может устранить недостатки приложения перед развертыванием приложения в рабочей среде, затратами и задержками, а также развернуть приложение в рабочей среде с известными дефектами безопасности, предоставляя Организации возможность компрометации.  
  
Некоторые организации размещают полную стоимость устранения проблем безопасности в рабочем коде выше $10 000 за каждую неполадку, и приложения, разработанные без эффективной SDL, могут усреднить более десяти проблем с высокой серьезностью в 100 000 строк кода. В больших приложениях затраты быстро переключаются. Многие компании, напротив, устанавливают тест производительности менее чем одной проблемы в 100 000 строк кода на заключительном этапе проверки кода SDL и не дают нулевых проблем в приложениях с высоким уровнем риска в рабочей среде.  
  
Реализация SDL повышает безопасность, включая требования к безопасности на ранних этапах сбора и проектирования приложения, что обеспечивает моделирование угроз для приложений с высоким риском; требует эффективного обучения и мониторинга разработчиков; и требует четких, единообразных стандартов кода и рекомендаций. Побочный результат SDL — значительные улучшения в области безопасности приложений, а также снижение затрат на разработку, развертывание, Обслуживание и списание приложения. Хотя подробное обсуждение разработки и реализации SDL выходит за рамки этого документа, ознакомьтесь с подробными инструкциями и сведениями в разделе [жизненный цикл разработки системы безопасности Майкрософт](https://www.microsoft.com/security/sdl/default.aspx) .  
  


