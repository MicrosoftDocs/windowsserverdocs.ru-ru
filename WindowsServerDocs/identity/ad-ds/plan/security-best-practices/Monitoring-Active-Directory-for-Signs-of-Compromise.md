---
ms.assetid: a7ef2fba-b05c-4be2-93b2-b9456244c3ad
title: Мониторинг Active Directory для обнаружения признаков компрометации
description: ''
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 40d0d06f8d6d25c2c1dbf4662d3296a996d22055
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59882945"
---
# <a name="monitoring-active-directory-for-signs-of-compromise"></a>Мониторинг Active Directory для обнаружения признаков компрометации

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

*Закон цифра пять: Нескончаемые бдительность является ценой безопасности.* - [10 непреложных законов безопасности администрирования](https://technet.microsoft.com/library/cc722488.aspx)  
  
Сплошной журнал событий, система мониторинга — это критически важная часть любого безопасного проектирования Active Directory. Много компромиссных решений безопасности компьютера могут быть обнаружены на ранних событий Если пострадавшим силу соответствующий журнал событий, мониторинга и оповещений. Независимые отчеты уже давно поддерживают такому выводу. Например [отчет нарушения безопасности данных Verizon 2009](http://www.verizonbusiness.com/resources/security/reports/2009_databreach_rp.pdf) состояний:  
  
«Очевидно ineffectiveness анализа событий мониторинга и log продолжает быть что-то вроде enigma. Существует возможность обнаружения; исследователей отметить, что 66% из жертв имеет достаточные свидетельства, доступные в свои журналы для обнаружения нарушения, они были более тщательного анализа таких ресурсов.»  
  
Отсутствие активных журналов событий мониторинга остается согласованные уязвимости в планы защиты от безопасности многих компаний. [Отчетов 2012 нарушения безопасности данных Verizon](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf) найден, что несмотря на то, что 85 процентов нарушений потребовалось бы несколько недель, чтобы заметить, 84 процент жертв было свидетельство о нарушении в свои журналы событий.  
  
## <a name="windows-audit-policy"></a>Политика аудита Windows

Ниже приведены ссылки на блог Microsoft enterprise официальной поддержки. Содержимое этих блоги предоставляет советы, рекомендации и рекомендации об аудите, помогает повысить безопасность вашей инфраструктуры Active Directory и являются ценным ресурсом при разработке политики аудита.  
  
* [Аудит доступа к глобальным объектам является Magic](http://blogs.technet.com/b/askds/archive/2011/03/10/global-object-access-auditing-is-magic.aspx) -описывает механизм управления, называемый конфигурация расширенной политики аудита, добавленный в Windows 7 и Windows Server 2008 R2, которая позволяет задать, какие типы данных требуется аудит легко, а не в состоянии жонглировать сценарии и auditpol.exe.  
* [Знакомство с аудит изменений в Windows 2008](http://blogs.technet.com/b/askds/archive/2007/10/19/introducing-auditing-changes-in-windows-2008.aspx) -введено аудита изменений, внесенных в Windows Server 2008.  
* ["Холодный" Аудит рекомендации в Vista и 2008](http://blogs.technet.com/b/askds/archive/2007/11/16/cool-auditing-tricks-in-vista-and-2008.aspx) -объясняет интересных возможностей аудита Windows Vista и Windows Server 2008, который может использоваться для устранения неполадок или видеть, что происходит в вашей среде.  
* [Единое средство для аудита в Windows Server 2008 и Windows Vista](http://blogs.technet.com/b/askds/archive/2008/03/27/one-stop-shop-for-auditing-in-windows-server-2008-and-windows-vista.aspx) -содержит компиляции аудита функции и сведения, содержащиеся в Windows Server 2008 и Windows Vista.  
  
Следующие ссылки предоставляют сведения об улучшениях для аудита в Windows 8 и Windows Server 2012 Windows и сведения о Доменных службах Active Directory аудита в Windows Server 2008.  
  
* [Новые возможности аудита безопасности](https://technet.microsoft.com/library/hh849638.aspx) -обзор новых возможностей в Windows 8 и Windows Server 2012 аудита безопасности.  
* [AD DS аудит Пошаговое руководство по использованию](https://technet.microsoft.com/library/a9c25483-89e2-4202-881c-ea8e02b4b2a5.aspx) -описывается новая функция аудита доменных служб Active Directory (AD DS) в Windows Server 2008. Он также предоставляет процедуры, реализуемые этой новой функции.  
  
### <a name="windows-audit-categories"></a>Категорий аудита Windows

До Windows Vista и Windows Server 2008 Windows имел только девять категорий политики аудита в журнал событий:  
  
* События входа  
* Управление учетными записями  
* Доступ к службе каталогов  
* События входа в систему  
* Доступ к объектам  
* Изменение политики  
* Использование привилегий  
* Процесс отслеживания  
* Системные события  
  
Эти девять категорий аудита традиционных составляют политику аудита. Каждой категории политики аудита можно включить успех, сбой, или Успех и отказ события. Их описание, включаются в следующем разделе.  
  
#### <a name="audit-policy-category-descriptions"></a>Описание категории политики аудита  
Категории политик аудита включить следующие типы сообщений журнала событий.  
  
##### <a name="audit-account-logon-events"></a>Аудит событий входа в систему  
Сообщает каждого экземпляра субъекта безопасности (например, пользователь, компьютер или учетная запись службы), вход или выход из системы с одного компьютера, в котором используется другой компьютер для проверки учетной записи. События входа учетной записи создаются при проверке подлинности учетную запись участника безопасности домена на контроллере домена. Проверки подлинности локального пользователя на локальном компьютере создает событие входа в систему, которая заносится в локальный журнал безопасности. События выхода из системы не регистрируются.  
  
Эта категория создает большой объем «шум» Windows постоянно у пользователей учетных записей, войти в систему и из локальных и удаленных компьютерах во время обычной деятельности. Тем не менее любой план безопасности должен содержать Успех и отказ этой категории аудита.  
  
##### <a name="audit-account-management"></a>Аудит управления учетными записями  
Эта политика аудита определяет, следует ли отслеживать управление пользователями и группами. Например пользователи и группы должны отслеживаться при создании, изменены или удалены; пользователь или учетная запись компьютера, группы безопасности или группы рассылки Если учетной записи пользователя или компьютера переименован, отключен или включен; или при изменении пароля пользователя или компьютера. Для пользователей или групп, при добавлении или удалении из других групп, которые могут создаваться события.  
  
##### <a name="audit-directory-service-access"></a>Аудит доступа к службе каталогов  

Этот параметр политики определяет для аудита субъекту безопасности доступ к объекту Active Directory, имеет ли собственный указанной системой управления доступом (SACL). Как правило эта категория следует включать только на контроллерах домена. Если этот параметр включен, этот параметр создает большой объем «шума».  
  
##### <a name="audit-logon-events"></a>Аудит входа в систему  
События входа формируются при проверке подлинности участника локальной безопасности на локальном компьютере. События входа в систему записывает входов в домен, на локальном компьютере. События выхода из системы не формируются. При включении событий входа в систему создает массу «шум», но они должны быть включены по умолчанию в любой план аудита безопасности.  
  
##### <a name="audit-object-access"></a>Аудит доступа к объектам  
Доступ к объектам может генерировать события при доступе к впоследствии определенные объекты с включенной функцией аудита (для пример, Opened, чтения, переименован, удален или закрыто). После включения основной категории аудита администратору по отдельности следует определить, какие объекты будут аудит включен. Многие объекты системы Windows поставляются с включенной функцией аудита, поэтому включение этой категории обычно начинает создавать события перед любой определил администратор.  
  
В этой категории «искаженной» и будет создано пять-десять событий для каждого доступа к объектам. Он может быть трудно администраторами новый объект зависимости, для получения полезной информации. Его следует включать только при необходимости.  
  
##### <a name="auditing-policy-change"></a>Аудит изменений политики  
Этот параметр политики определяет, следует ли аудиту каждый факт изменения политик назначения прав пользователей, политики брандмауэра Windows, политики доверия или изменения политики аудита. Эта категория должна быть включена на всех компьютерах. Он создает очень немного шума.  
  
##### <a name="audit-privilege-use"></a>Аудит использования привилегий  

Существуют десятки права и разрешения в Windows (например, вход в качестве пакетного задания и работа в качества части операционной системы). Этот параметр политики определяет, следует ли проводить аудит каждого экземпляра субъекта безопасности, используя право пользователя или прав доступа. Включение этой категории результатов во многих «шум», но он может быть полезным, учетные записи участника безопасности, с использованием повышенных привилегий.  
  
##### <a name="audit-process-tracking"></a>Аудит отслеживания процессов  
Этот параметр политики определяет, следует ли проводить аудит подробное описание процесса, события, такие как программы активации, завершение процесса, повторение дескрипторов и косвенный доступ к объекту. Это полезно для отслеживания злоумышленников и вредоносных программ, которые они используют.  
  
Включение аудита отслеживания процесса создает большое число событий, поэтому обычно он устанавливается в значение **нет аудита**. Однако этот параметр можно предоставить большое преимущество во время реагирования на инциденты из подробный журнал процессов, запущенных и время, которое они были запущены. Для контроллеров домена и другие серверы инфраструктуры одной роли в этой категории можно безопасно включено постоянно. Серверы одной роли не создают много отслеживания трафика в его обязанности в ходе обычного процесса. Таким образом они станут доступны для записи событий несанкционированного в том случае, если они встречаются.  
  
##### <a name="system-events-audit"></a>События аудита системы  

Системные события является практически универсальные универсальным категорией, регистрации различных событий, которые влияют на компьютере, его безопасность системы или журнал безопасности. Он включает события для завершений работы и перезапуска, сбоев питания, изменения системного времени, инициализации пакета проверки подлинности, clearings журнала аудита, проблем олицетворения и целый ряд других общие события. Как правило Включение этой категории аудита создает массу «шум», но создает достаточное количество событий очень полезно, что трудно когда-нибудь рекомендуем не включить его.  
  
#### <a name="advanced-audit-policies"></a>Расширенные политики аудита

Начиная с Windows Vista и Windows Server 2008, корпорация Microsoft улучшила способа выбора категории журнала событий можно сделать путем создания подкатегорий в каждой основной категории аудита. Подкатегории обеспечивают дополнительную детализацию, чем в противном случае с использованием основных категорий аудита. С помощью подкатегорий можно включить только части определенной основной категории и пропустить создания события, для которых у вас нет. Каждую подкатегорию политики аудита можно включить для отслеживания событий успеха, отказа либо успеха и отказа.  
  
Чтобы получить список всех доступных подкатегорий аудита, просмотрите контейнера расширенной политики аудита в объект групповой политики, или введите следующую команду в командной строке на любом компьютере под управлением Windows Server 2012, Windows Server 2008 R2 или Windows Server 2008, Windows 8, Windows 7 или Windows Vista:  
  
`auditpol /list /subcategory:\*`
  
Чтобы получить список настроенных подкатегорий аудита на компьютере под управлением Windows Server 2012, Windows Server 2008 R2 или Windows 2008, введите следующее:  
  
`auditpol /get /category:\*`
  
На следующем рисунке показан пример auditpol.exe листинг текущую политику аудита.  
  
![мониторинг AD](media/Monitoring-Active-Directory-for-Signs-of-Compromise/SAD_5.gif)  
  
> [!NOTE]  
> Групповая политика не всегда точно уведомления о состоянии все включенные политики аудита, а поддерживает auditpol.exe. См. в разделе [получение действующей политики аудита в Windows 7 и 2008 R2](http://blogs.technet.com/b/askds/archive/2011/03/11/getting-the-effective-audit-policy-in-windows-7-and-2008-r2.aspx) для получения дополнительных сведений.  
  
Каждой основной категории есть несколько подкатегорий. Ниже приведен список категорий, их подкатегории и описание их функций.  
  
### <a name="auditing-subcategories-descriptions"></a>Описание подкатегории аудита  
Подкатегории политики аудита включите следующие типы сообщений журнала событий:  
  
#### <a name="account-logon"></a>Вход учетной записи  
  
##### <a name="credential-validation"></a>проверка учетных данных;  
Этой подкатегории выводит результаты проверочных тестов на учетные данные, отправлен запрос на вход учетной записи пользователя. Эти события происходят на доверенном компьютере для этих учетных данных. Для учетных записей домена контроллер домена является достоверным, тогда как для локальных учетных записей локального компьютера является полномочным.  
  
В доменных средах большую часть событий входа учетных записей регистрируются в журнале безопасности контроллеров домена, которые являются доверенными для учетных записей домена. Тем не менее эти события могут происходить на других компьютерах в организации, при использовании локальных учетных записей для входа.  
  
##### <a name="kerberos-service-ticket-operations"></a>Аудит операций с билетами службы Kerberos  
Этой подкатегории сообщает о событиях, создаваемых процессами запроса билета Kerberos на контроллере домена, являющегося доверенным для учетной записи домена.  
  
##### <a name="kerberos-authentication-service"></a>служба проверки подлинности Kerberos;  
Этой подкатегории сообщает о событиях, создаваемых службой проверки подлинности Kerberos. Эти события происходят на доверенном компьютере для этих учетных данных.  
  
##### <a name="other-account-logon-events"></a>другие события входа учетной записи.  
Этой подкатегории сообщает события, происходящие в ответ на учетные данные отправлен запрос на вход пользователя учетной записи, которые не связаны с проверки учетных данных или билеты Kerberos. Эти события происходят на доверенном компьютере для этих учетных данных. Для учетных записей домена контроллер домена является достоверным, тогда как для локальных учетных записей локального компьютера является полномочным.  
  
В доменных средах большинство событий входа в систему регистрируются в журнале безопасности контроллеров домена, которые являются доверенными для учетных записей домена. Тем не менее эти события могут происходить на других компьютерах в организации, при использовании локальных учетных записей для входа. Примеры могут быть следующих типов.  
  
* Отключений сеансов удаленного рабочего стола служб  
* Новые сеансы служб удаленных рабочих столов  
* Блокировка и разблокировка рабочей станции.  
* Вызов заставки.  
* Закрытие заставки.  
* Обнаружение Kerberos воспроизведения атаки, в котором Kerberos с идентичными сведения о получении запроса дважды  
* Доступ к беспроводной сети предоставлен учетной записи пользователя или компьютера.  
* Доступ к проводной сети стандарта 802.1x предоставлен учетной записи пользователя или компьютера.  
  
#### <a name="account-management"></a>Управление учетными записями  
  
##### <a name="user-account-management"></a>Управление учетными записями пользователей  
Этой подкатегории сообщает каждое событие управление учетными записями пользователей, например при создании, изменены или удалены; учетной записи пользователя переименован, отключен или включен; учетной записи пользователя или установке или изменении пароля. Если включен этот параметр политики аудита, администраторы могут отслеживать события, для обнаружения вредоносных случайного и авторизованным создания учетных записей пользователей.  
  
##### <a name="computer-account-management"></a>Управление учетными записями компьютера  
Этой подкатегории сообщает каждое событие управления учетными записями компьютеров, например при учетной записи компьютера создан, изменен, удален, переименован, отключен или включен.  
  
##### <a name="security-group-management"></a>Управление группами безопасности  
Этой подкатегории сообщает каждое событие управление группами безопасности, например при создании, изменить или удалить группу безопасности или при добавлении для члена или удалены из группы безопасности. Если включен этот параметр политики аудита, администраторы могут отслеживать события, для обнаружения вредоносных случайного и авторизованным создания учетных записей групп безопасности.  
  
##### <a name="distribution-group-management"></a>Управление группами рассылки  
Этой подкатегории сообщает каждое событие управления группами распространения, например при создании, изменить или удалить группы рассылки или при добавлении для члена или удалены из группы рассылки. Если включен этот параметр политики аудита, администраторы могут отслеживать события, для обнаружения вредоносных случайного и авторизованным создания учетных записей групп.  
  
##### <a name="application-group-management"></a>Управление группами приложений  
Этой подкатегории сообщает каждое событие из группы управления приложениями на компьютере, например при создании, изменении или удалении группу приложений или при добавлении для члена или удалены из группы приложений. Если включен этот параметр политики аудита, администраторы могут отслеживать события, для обнаружения вредоносных случайного и авторизованным создания учетных записей групп приложений.  
  
##### <a name="other-account-management-events"></a>Другие события управления учетными записями  
Этой подкатегории сообщает о других событий управления учетными записями.  
  
#### <a name="detailed-process-tracking"></a>Подробное описание процесса отслеживания  
  
##### <a name="process-creation"></a>Создание процесса  
Этой подкатегории отчеты, создание процесса и имя пользователя или программы, который его создал.  
  
##### <a name="process-termination"></a>Завершение процесса  
Сообщает о данной подкатегории, при завершении процесса.  
  
##### <a name="dpapi-activity"></a>Активности DPAPI  
Сообщает о данной подкатегории, шифрования или расшифровки вызывает интерфейс прикладного программирования (DPAPI) защиты данных. Чтобы защитить конфиденциальные сведения, такие как сохраненный пароль и сведения о ключе используется DPAPI.  
  
##### <a name="rpc-events"></a>События RPC  
Этот «Подкатегория» отчеты удаленного вызова процедур (RPC) события подключений.  
  
#### <a name="directory-service-access"></a>Доступ к службе каталогов  
  
##### <a name="directory-service-access"></a>Доступ к службе каталогов  
Сообщает о данной подкатегории, при обращении к объекту AD DS. Только объекты с настроенной SACL вызывают события аудита в созданный и только при обращении способом, который соответствует записи в системный список управления ДОСТУПОМ. Эти события похожи на события доступа к службе каталогов в более ранних версиях Windows Server. Этой подкатегории применяется только к контроллерам домена.  
  
##### <a name="directory-service-changes"></a>Изменения службы каталога  
Этой подкатегории сообщает об изменениях для объектов в AD DS. Типы изменений, которые выводятся при создании, изменить, переместить и отменить удаление операции, выполняемые на объект. Каталог службы аудит изменений, если это уместно, указывает старое и новое значения измененных свойств объектов, которые были изменены. Только объекты с SACL вызывают события аудита в созданный и только при обращении способом, который соответствует записи их системный список управления ДОСТУПОМ. Некоторые объекты и свойства не вызывают создание событий аудита из-за параметров класса объектов в схеме. Этой подкатегории применяется только к контроллерам домена.  
  
##### <a name="directory-service-replication"></a>Репликация службы каталогов  
Сообщает о данной подкатегории, при репликации между контроллерами домена начинается и заканчивается.  
  
##### <a name="detailed-directory-service-replication"></a>Детализированная репликация службы каталога  
Эта Подкатегория позволяет получить подробные сведения о репликации между контроллерами домена. Эти события могут быть очень высокой в томе.  
  
#### <a name="logonlogoff"></a>Вход/выход  
  
##### <a name="logon"></a>Вход в систему  
Этой подкатегории сообщает, когда пользователь пытается войти в систему. Эти события происходят на компьютере, к которому осуществляется доступ. Для интерактивного входа в систему создание этих событий происходит на компьютере, который вошел в систему. Если вход в сеть производится доступ к общей папке, эти события создания на компьютере, на котором размещена запрашиваемых ресурсов. Если этот параметр настраивается для **без аудита**, сложно или невозможно определить, кто из пользователей имеет доступ к или попытка доступа к компьютерам организации.  
  
##### <a name="network-policy-server"></a>Сервер политики сети  
Этой подкатегории сообщает события, создаваемые запросы на доступ пользователя RADIUS (IAS) и Network Access Protection (NAP). Эти запросы могут быть **Grant**, **Deny**, **отменить**, **карантина**, **блокировки**и **Разблокировать**. Этот параметр аудита приведет к среднего или высокого уровня тома записей на серверах политики сети и IAS.  
  
##### <a name="ipsec-main-mode"></a>Основного режима IPsec  
Этой подкатегории сообщает о результатах протокола Internet Key Exchange (IKE) и протокол IP с проверкой (подлинности AuthIP) во время согласования основного режима.  
  
##### <a name="ipsec-extended-mode"></a>Расширенного режима IPsec  
Этой подкатегории передает результаты AuthIP во время согласования расширенный режим.  
  
##### <a name="other-logonlogoff-events"></a>Другие события входа и выхода  
Этой подкатегории отчеты другим именем и события, связанные с выхода из системы, такие как службы удаленных рабочих столов сеанс отключается и выполняет повторное подключение, с помощью запуска от имени для запуска процессов с другой учетной записью и блокировании и разблокировании рабочей станции.  
  
##### <a name="logoff"></a>Выход  
Этой подкатегории выдает сообщение, если пользователь не выйдет из системы. Эти события происходят на компьютере, к которому осуществляется доступ. Для интерактивного входа в систему создание этих событий происходит на компьютере, который вошел в систему. Если вход в сеть производится доступ к общей папке, эти события создания на компьютере, на котором размещена запрашиваемых ресурсов. Если этот параметр настраивается для **без аудита**, сложно или невозможно определить, кто из пользователей имеет доступ к или попытка доступа к компьютерам организации.  
  
##### <a name="account-lockout"></a>Блокировка учетной записи  
Этой подкатегории выдает сообщение, если учетная запись пользователя будет заблокирован из-за слишком много неудачных попыток входа.  
  
##### <a name="ipsec-quick-mode"></a>Быстрого режима IPsec  
Этой подкатегории сообщает о результатах протокола IKE и AuthIP во время согласования быстрого режима.  
  
##### <a name="special-logon"></a>Специального входа  
Сообщает о данной подкатегории, при использовании специального входа. Специальные заключается в имени входа, эквивалентные правами администратора и может использоваться для повышения прав процесса до более высокого уровня.  
  
#### <a name="policy-change"></a>Изменение политики  
  
##### <a name="audit-policy-change"></a>Аудит изменения политики  
Этой подкатегории сообщает об изменениях политики аудита, включая изменения списка SACL.  
  
##### <a name="authentication-policy-change"></a>Изменение политики проверки подлинности  
Этой подкатегории сообщает об изменениях политика проверки подлинности.  
  
##### <a name="authorization-policy-change"></a>Изменение политики авторизации  
Этой подкатегории сообщает об изменениях политики авторизации, включая изменения разрешений (DACL).  
  
##### <a name="mpssvc-rule-level-policy-change"></a>Изменение политики на уровне правил MPSSVC  
Этой подкатегории сообщает об изменениях правила политики, используемые службой защиты Microsoft (MPSSVC.exe). Эта служба используется брандмауэр Windows.  
  
##### <a name="filtering-platform-policy-change"></a>Изменение политики платформы фильтрации  
Сообщает о данной подкатегории, добавление и удаление объектов из WFP, включая фильтры запуска. Эти события могут быть очень высокой в томе.  
  
##### <a name="other-policy-change-events"></a>Других событий изменения политики  
Этой подкатегории сообщает другие виды изменений политики безопасности, такие как конфигурация доверенного платформенного модуля (TPM) или поставщиков служб шифрования.  
  
#### <a name="privilege-use"></a>Использование привилегий  
  
##### <a name="sensitive-privilege-use"></a>Использование привилегий, затрагивающих конфиденциальные  
Этой подкатегории выдает сообщение, если учетной записи пользователя или служба использует привилегий, затрагивающих конфиденциальные. Привилегий, затрагивающих конфиденциальные включает в себя следующие пользовательские права: работа в качества части операционной системы, резервного копирования файлов и каталогов, Создание маркерного объекта, Отладка программ, включить учетные записи компьютеров и пользователей может быть доверенным для делегирования, Создание аудитов безопасности олицетворение клиента после проверки подлинности, загрузка и выгрузка драйверов устройств, управление аудитом и журналом безопасности, изменение параметров среды изготовителя, Замена маркера уровня процесса, восстановление файлов и каталогов и Смена владельца файлов или других объектов. Аудит этой подкатегории создаст большое число событий.  
  
##### <a name="nonsensitive-privilege-use"></a>Использование nonsensitive прав  
Этой подкатегории выдает сообщение, если учетной записи пользователя или служба использует nonsensitive привилегий. Nonsensitive привилегий включает в себя следующие пользовательские права: доступ к диспетчеру учетных данных имени доверенного вызывающего, доступ к этому компьютеру из сети, добавление рабочих станций к домену, Настройка квот памяти для процесса, локальный вход в систему, разрешить вход в систему через удаленный Рабочий стол служб, обход перекрестной проверки, изменение системного времени, создание файла подкачки, Создание глобальных объектов, создание постоянных общих объектов, Создание символических ссылок, DENY, запрет доступа к этому компьютеру из сети, Отказать во входе в качестве пакетного задания, Отказать во входе в качестве службы, Запретить локальный вход, запретить вход в систему через службу удаленных рабочих столов, принудительное завершение из удаленной системы, увеличение рабочего набора процесса, увеличение приоритета выполнения, блокировка страниц в памяти, вход в качестве пакетного задания, войдите в систему как услуга, изменение метки объекта, выполните тома задачи обслуживания, профилирование одного процесса, профилирование производительности системы, удаление компьютера из стыковочного узла, завершение работы системы и синхронизация данных службы каталогов. Аудит этой подкатегории создаст очень большое число событий.  
  
##### <a name="other-privilege-use-events"></a>Других событий использования привилегий  
Этот параметр политики безопасности в настоящее время не используется.  
  
#### <a name="object-access"></a>Доступ к объектам  
  
##### <a name="file-system"></a>Файловая система  
Этой подкатегории выдает сообщение, если осуществляется объектов файловой системы. Только объектов файловой системы с помощью системных списков управления доступом вызывают события аудита для созданного, а только когда они доступны в виде совпадающих записей их системный список управления ДОСТУПОМ. Сама по себе этот параметр политики не вызовет аудит всех событий. Он определяет, следует ли аудиту событие пользователя, который обращается к объект файловой системы, который имеет указанный системном списке управления доступом (SACL), обеспечивая проводить аудит.  
  
При настройке параметра аудита доступа к объектам **успех**, запись аудита создается каждый раз, что пользователь успешно обращается к объект с указанным системный список управления ДОСТУПОМ. Если этот параметр политики настроен на **сбоя**, запись аудита создается каждый раз, пользователю не удается при попытке доступа к объекту с помощью указанного системного списка управления ДОСТУПОМ.  
  
##### <a name="registry"></a>Реестр  
Этой подкатегории сообщает, когда происходит доступ к объектам реестра. Только объекты реестра с помощью системных списков управления доступом вызывают события аудита для созданного, а только когда они доступны в виде совпадающих записей их системный список управления ДОСТУПОМ. Сама по себе этот параметр политики не вызовет аудит всех событий.  
  
##### <a name="kernel-object"></a>Объект ядра  
Этой подкатегории выдает сообщение, если осуществляется объекты ядра, такие как мьютексы и процессы. Только объекты ядра с SACL вызывают события аудита для созданного, а только когда они доступны в виде совпадающих записей их системный список управления ДОСТУПОМ. Обычно объекты ядра, только получают системных списков управления доступом, если включены параметры аудита AuditBaseObjects или AuditBaseDirectories.  
  
##### <a name="sam"></a>Диспетчер учетных записей безопасности  
Этой подкатегории выдает сообщение, если осуществляется локальных объектов базы данных проверки подлинности диспетчера учетных записей безопасности (SAM).  
  
##### <a name="certification-services"></a>Службы сертификации  
Сообщает о данной подкатегории, при выполнении операций служб сертификации.  
  
##### <a name="application-generated"></a>Приложение, созданное  
Этой подкатегории выдает сообщение, если приложения пытаются создавать события аудита с помощью Windows, аудит прикладного программирования (API).  
  
##### <a name="handle-manipulation"></a>Обработка манипуляции  
Сообщает о данной подкатегории, при открытии или закрытии дескриптор для объекта. Только объекты с SACL вызвать эти события, созданного и только в том случае, если попытка дескриптор операции соответствует записи в системный список управления ДОСТУПОМ. Обработка манипуляции событий создаются только для типов объектов, включенной доступа соответствующего объекта «Подкатегория» (для, например файловой системы или реестра).  
  
##### <a name="file-share"></a>Файловый ресурс  
Сообщает о данной подкатегории, при доступе к общей папке. Сама по себе этот параметр политики не вызовет аудит всех событий. Он определяет, следует ли аудиту событие пользователя, который обращается к объект общей папки файла с указанным системном списке управления доступом (SACL), обеспечивая проводить аудит.  
  
##### <a name="filtering-platform-packet-drop"></a>Отбрасывания пакетов платформой фильтрации  
Этой подкатегории выдает сообщение, если пакеты удаляются с платформы фильтрации Windows (WFP). Эти события могут быть очень высокой в томе.  
  
##### <a name="filtering-platform-connection"></a>Подключения платформы фильтрации  
Этой подкатегории выдает сообщение, если разрешены или заблокированы WFP подключений. Эти события может привести к увеличению объема.  
  
##### <a name="other-object-access-events"></a>Другие события доступа к объектам  
Этой подкатегории сообщает другие объект связанных с доступом события, например планировщика заданий и объектов COM +.  
  
#### <a name="system"></a>Система  
  
##### <a name="security-state-change"></a>Изменение состояния безопасности  
Этой подкатегории сообщает об изменениях в состоянии безопасности системы, например когда подсистема безопасности начинается и останавливается.  
  
##### <a name="security-system-extension"></a>Расширение системы безопасности  
Этой подкатегории сообщает загрузку код расширения, таких как пакеты проверки подлинности подсистемой безопасности.  
  
##### <a name="system-integrity"></a>Целостность системы  
Этой подкатегории отчеты на нарушения целостности подсистемы безопасности.  
  
Драйвер IPsec  
  
Этой подкатегории сообщает о действиях с драйвера Internet Protocol security (IPsec).  
  
##### <a name="other-system-events"></a>Другие системные события  
Этой подкатегории отчеты на другие системные события.  
  
Дополнительные сведения об описании подкатегории см. [средство Microsoft Security Compliance Manager](https://technet.microsoft.com/library/cc677002.aspx).  
  
Каждой организации следует просмотреть предыдущих охватываемый категорий и подкатегорий и включить те, которые лучше всего соответствуют их среды. Изменения в политику аудита необходимо протестировать до развертывания в рабочей среде.  
  
## <a name="configuring-windows-audit-policy"></a>Настройка политики аудита Windows

Политика аудита Windows можно задать с помощью групповой политики, auditpol.exe, API-интерфейсы или реестра изменения. Рекомендуемые методы для настройки политики аудита для большинства компаний, групповую политику или auditpol.exe. Установка политики аудита системы требует разрешений уровня администратора учетной записи или делегированы соответствующие разрешения.  
  
> [!NOTE]  
> **Управление аудитом и журналом безопасности** субъекты безопасности должно предоставляться привилегий (Администраторы имеют его по умолчанию), чтобы разрешить изменение параметров отдельных ресурсов, таких как файлы, активный аудита доступа к объектам Объекты каталога и разделы реестра.  
  
### <a name="setting-windows-audit-policy-by-using-group-policy"></a>Настройка политики аудита Windows с помощью групповой политики

Чтобы настроить политику аудита с помощью групповых политик, настройте соответствующие аудита категорий, расположенный в **Конфигурация компьютера\Параметры Windows\Параметры безопасности\Локальные Политики\политика** (см. в статье приведен снимок экрана Пример из редактор групповой политики (gpedit.msc)). Для каждой категории политики аудита можно включить **успех**, **сбоя**, или **успех** и событий сбоев.  
  
![мониторинг AD](media/Monitoring-Active-Directory-for-Signs-of-Compromise/SAD_6.gif)  
  
Расширенная политика аудита можно задать с помощью Active Directory или локальных групповых политик. Чтобы настроить расширенной политики аудита, настройте соответствующие подкатегорий, расположенный в **компьютера Конфигурация компьютера\Параметры Windows\Параметры безопасности\расширенная аудита политика** (см. следующий снимок экрана с примером с локального компьютера Редактор групповой политики (gpedit.msc)). Каждую подкатегорию политики аудита можно включить для **успех**, **сбоя**, или **успех** и **сбоя** события.  
  
![мониторинг AD](media/Monitoring-Active-Directory-for-Signs-of-Compromise/SAD_7.gif)  
  
### <a name="setting-windows-audit-policy-using-auditpolexe"></a>Настройка политики аудита Windows с помощью Auditpol.exe

Auditpol.exe (для настройки политики аудита Windows) был введен в Windows Server 2008 и Windows Vista. Изначально только auditpol.exe может использоваться для задания расширенной политики аудита, но можно использовать групповую политику в Windows Server 2012, Windows Server 2008 R2 или Windows Server 2008, Windows 8 и Windows 7.  
  
Auditpol.exe — это служебная программа командной строки. Синтаксис выглядит следующим образом:  
  
`auditpol /set /<Category|Subcategory>:<audit category> /<success|failure:> /<enable|disable>`
  
Примеры синтаксиса Auditpol.exe.  
  
`auditpol /set /subcategory:"user account management" /success:enable /failure:enable`
  
`auditpol /set /subcategory:"logon" /success:enable /failure:enable`
  
`auditpol /set /subcategory:"IPSEC Main Mode" /failure:enable`
  
> [!NOTE]  
> Auditpol.exe локально задает расширенной политики аудита. Если локальная политика конфликтует с Active Directory или локальной групповой политики, параметры групповой политики обычно преобладают над параметрами auditpol.exe. Если имеется несколько групповой или локальной политики конфликтов, будут применяться только одна политика (который замените). Политики аудита не будут объединены.  
  
#### <a name="scripting-auditpol"></a>Создание сценариев Auditpol

Корпорация Майкрософт предоставляет [пример сценария](https://support.microsoft.com/kb/921469) для администраторов, которые хотят установить расширенной политики аудита с помощью сценария, вместо того чтобы вручную вводить в каждой команде auditpol.exe.  
  
**Примечание** групповой политики не сообщает всегда точно состояние все включенные политики аудита, а поддерживает auditpol.exe. См. в разделе [получение действующей политики аудита в Windows 7 и Windows 2008 R2](http://blogs.technet.com/b/askds/archive/2011/03/11/getting-the-effective-audit-policy-in-windows-7-and-2008-r2.aspx) для получения дополнительных сведений.  
  
#### <a name="other-auditpol-commands"></a>Другие команды Auditpol

Auditpol.exe можно использовать для сохранения и восстановления локальную политику аудита и для просмотра других аудита связанные команды. Вот другой **auditpol** команды.  
  
`auditpol /clear` -Используется для очистки и сброса локального аудита политики  
  
`auditpol /backup /file:<filename>` -Используется для резервного копирования текущей локальную политику аудита в двоичный файл  
  
`auditpol /restore /file:<filename>` -Используется для импорта файла политики аудита, сохраненного в локальную политику аудита  
  
`auditpol /<get/set> /option:<CrashOnAuditFail> /<enable/disable>` — Если включен этот параметр политики аудита, он заставляет систему сразу же прекращать (используя STOP: Сообщение C0000244 {сбой аудита}) Если аудита безопасности не могут входить по любой причине. Как правило, событие не удается войти в систему при переполнении журнала аудита безопасности и метод сохранения, указанное для журнала безопасности **не перезаписывать события** или **Затирать старые события по дням**. Обычно оно включается только в средах, требующих большую защищенность, данные которого регистрируются в журнале безопасности. Если параметр включен, администраторы должны точно посмотреть размер журнала безопасности и ротации журналов при необходимости. Его можно также задать с помощью групповой политики, изменив параметр безопасности **аудита: Завершение работы системы, если невозможно внести в журнал аудита безопасности** (по умолчанию — отключено).  
  
`auditpol /<get/set> /option:<AuditBaseObjects> /<enable/disable>` — Этот параметр политики аудита определяет, следует ли проводить аудит доступа к глобальным объектам системы. Если эта политика включена, то системные объекты, такие как мьютексы, события, семафоры и устройства DOS, создаваемых по умолчанию системная таблица управления доступом (SACL). Большинство администраторов рассмотрим аудит глобальных системных объектов быть слишком «шумный», и они будут только включить Если вредоносный взлома основания полагать, что. Только именованные объекты получают SACL. Если аудита объекта доступа аудита политика (или подкатегория аудита объекта ядра) включена, аудит доступа к таким системным объектам. Чтобы настроить этот параметр безопасности, изменения не вступят в силу после перезапуска Windows. Эту политику можно также задать с помощью групповой политики, изменив параметр безопасности Аудит доступа к глобальным объектам системы (по умолчанию — отключено).  
  
`auditpol /<get/set> /option:<AuditBaseDirectories> /<enable/disable>` — Этот параметр политики аудита указывает, что именованные объекты ядра (например, мьютексов и семафоров) должен быть предоставлен системных списков управления доступом, при их создании. AuditBaseDirectories влияет на объекты-контейнеры, при AuditBaseObjects влияет на объекты, которые не могут содержать другие объекты.  
  
`auditpol /<get/set> /option:<FullPrivilegeAuditing> /<enable/disable>` -Этот параметр политики аудита, указывает ли клиент создает событие, когда один или несколько из этих привилегий, назначенных маркер безопасности пользователя: AssignPrimaryTokenPrivilege, AuditPrivilege, BackupPrivilege, CreateTokenPrivilege, DebugPrivilege, EnableDelegationPrivilege, ImpersonatePrivilege, LoadDriverPrivilege, RestorePrivilege, SecurityPrivilege, SystemEnvironmentPrivilege, TakeOwnershipPrivilege и TcbPrivilege. Если этот параметр не включен (по умолчанию — отключено), BackupPrivilege и RestorePrivilege привилегии не записываются. Включение этого параметра можно сделать во время операции резервного копирования журнала безопасности очень шумных (иногда сотни событий в секунду). Эту политику можно также задать с помощью групповой политики, изменив параметр безопасности **аудита: Аудит использования привилегий резервного копирования и восстановления**.  
  
> [!NOTE]  
> Некоторые сведения, представленные в данном разделе взята из Microsoft [тип параметра аудита](https://msdn.microsoft.com/library/dd973862(prot.20).aspx) и средство Microsoft SCM.  
  
## <a name="enforcing-traditional-auditing-or-advanced-auditing"></a>Применение традиционных аудита или расширенных средств аудита

В Windows Server 2012, Windows Server 2008 R2, Windows Server 2008, Windows 8, Windows 7 и Windows Vista администраторы могут выбрать включение девять категорий традиционных или использовать подкатегории. Это двоичный выбор, необходимо принимать в каждой системе Windows. Основные категории можно включить либо subcategoriesit не может быть одновременно.  
  
Чтобы предотвратить перезапись подкатегории политики аудита устаревших традиционных категории политики, необходимо включить **параметрами подкатегории политики аудита Force (Windows Vista или более поздней версии) переопределяет параметры категории политики аудита** параметр политики, расположенный в **Конфигурация компьютера\Параметры Windows\Параметры безопасности\Локальные Политики\параметры безопасности**.  
  
Мы рекомендуем, что подкатегории включить и настроить вместо девять основных категорий. Это необходимо включить параметр групповой политики (чтобы подкатегориях, чтобы переопределить категорий аудита) и настройка различных подкатегории, которые поддерживают политики аудита.  
  
Подкатегорий аудита можно настроить с помощью нескольких методов, включая групповой политики и программы командной строки, auditpol.exe.  
  
## <a name="next-steps"></a>Следующие шаги
  
* [Повышенной безопасности, аудит в Windows 7 и Windows Server 2008 R2](https://social.technet.microsoft.com/wiki/contents/articles/advanced-security-auditing-in-windows-7-and-windows-server-2008-r2.aspx)  
  
* [Аудит и соответствие требованиям в Windows Server 2008](https://technet.microsoft.com/magazine/2008.03.auditing.aspx)  
  
* [Как использовать групповую политику для настройки подробные сведения о безопасности, параметры аудита для компьютеров под управлением Windows Vista и под управлением Windows Server 2008, в домене Windows Server 2008, в домене Windows Server 2003 или в домене Windows 2000](https://support.microsoft.com/kb/921469)  
  
* [Пошаговое руководство по политике аудита безопасности расширенной](https://technet.microsoft.com/library/dd408940(WS.10).aspx)  
