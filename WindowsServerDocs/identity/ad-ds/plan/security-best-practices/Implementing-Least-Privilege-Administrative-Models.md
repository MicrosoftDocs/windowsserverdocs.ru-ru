---
ms.assetid: 7a7ab95c-9cb3-4a7b-985a-3fc08334cf4f
title: Реализация административных моделей с наименьшим количеством прав
description: ''
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.date: 08/09/2018
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 01113b957c6b0be4e18955b5ddc78be3f463abe4
ms.sourcegitcommit: 236a8ae1da12cea1acfff3f306246db0f022354d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2019
ms.locfileid: "67412207"
---
# <a name="implementing-least-privilege-administrative-models"></a>Реализация административных моделей с наименьшим количеством прав

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Следующий фрагмент взят из [администратора учетных записей руководство по планированию безопасности](https://technet.microsoft.com/library/cc162797.aspx), сначала опубликованные на 1 апреля 1999 г.:

> «Наиболее безопасности обучающие курсы и документации подробно обсуждать реализацию принципа наименьших прав доступа, но редко организациям следовать ей. Принцип прост, и последствия применения правильно значительно повышает уровень безопасности и снижает риск. Принцип утверждает, что все пользователи должны войти в систему с учетной записью пользователя, абсолютный минимальными разрешениями, необходимыми для выполнения текущей задачи и ничего более. Это обеспечивает защиту от вредоносного кода, среди других атак. Этот принцип применим к компьютерам и пользователям этих компьютеров.   
> «Приходится делать некоторых внутренних исследований является одна из причин этого принципа работает надлежащим образом. Например необходимо определить права доступа, которые действительно нужны компьютеру или пользователю и для их реализации. Для многих организаций эта задача может показаться немало работы; Тем не менее это важный шаг, чтобы успешно защитить сетевой среды.
> «Следует предоставлять все пользователи домена администратор свои привилегии домена в разделе понятие наименьших прав доступа. Например если администратор входит в систему с привилегированной учетной записи и случайно выполняет программу от вирусов, вирусов имеет административный доступ к локальному компьютеру и ко всему домену. Если администратор вместо этого войти в систему с учетной записью непривилегированному (не являющихся администраторами), вирусов объем ущерба будет только локальный компьютер, так как он работает как пользователь локального компьютера.
> «Еще один пример: учетные записи, для которых вы можете предоставить права администратора на уровне домена требуется не более высокий уровень прав в другом лесу, даже если отсутствует отношение доверия между лесами. Это помогает предотвратить ущерб, если злоумышленнику удастся скомпрометировать управляемых лесов. Организациям следует регулярно выполняйте аудит сети для защиты от несанкционированного повышения привилегий с.»  

Следующий фрагмент взят из [Microsoft Windows Security Resource Kit](https://www.microsoftpressstore.com/store/microsoft-windows-security-resource-kit-9780735621749)первый опубликованных в 2005 г.:  

> «Всегда представляют себе безопасность с точки зрения предоставления наименьшим количеством полномочий, необходимых для выполнения задачи. Если приложение, которое имеет слишком много прав скомпрометирована, злоумышленник может возможность развернуть атаки за то, что если бы оно было под минимально возможные права. Например просмотрите последствия сетевого администратора, не подумав открытия вложения электронной почты, который запускает вирус. Если администратор вошел в систему с помощью учетной записи администратора домена, вирус будут иметь права администратора на всех компьютерах в домене и таким образом неограниченный доступ к практически все данные в сети. Если администратор вошел в систему с помощью учетной записи локального администратора, будут иметь права администратора на локальном компьютере вирусов и таким образом будут иметь доступ к данным на компьютере и установить вредоносные программы, такие как ведение журнала stroke ключ программного обеспечения на компьютер. Если администратор вошел в систему под учетной записью обычного пользователя, вирус будет иметь доступ только к данным администратора и не сможете установить вредоносные программы. С помощью минимальных привилегий, необходимых для читать электронную почту, в этом примере область потенциальные нарушения безопасности, значительно снижается.»  

## <a name="the-privilege-problem"></a>Проблеме предоставления прав

Принципы, описанные в предыдущем отрывки не изменились, но в оценке установок Active Directory, неизменно найти чрезмерное количество учетных записей, которые были предоставлены права и разрешения далеко за пределы необходимых для выполнения повседневных работа. Размер среды влияет на необработанные данные чрезмерно привилегированных учетных записей, но не в каталогах proportionmidsized может находиться десятки учетные записи в группы по самым высоким уровнем привилегий, а крупных сред возможно, сотен или даже тысяч. За некоторыми исключениями, независимо от того, все возможности, необходимые навыки и арсеналу, злоумышленнику злоумышленники обычно следуют самым простым путем. Они повышают сложность средств и подход только при простой fail механизмы или вы уполномоченной защитники.  

К сожалению самым простым во многих средах путем показала злоупотребление учетные записи с привилегией обширных и глубоких. Широкие права, права и разрешения на учетную запись для выполнения определенных действий между больших разрез среды – например, сотрудников службы поддержки могут быть предоставлены разрешения, позволяющие сбрасывать пароли для многих учетных записей пользователей.  

Привилегии, глубокое — мощный привилегии, которые применяются к сегменту узкий заполнения, например предоставления инженером прав администратора на сервере, чтобы они могли выполнять действия по восстановлению. Широкие привилегии ни глубокого привилегий обязательно опасен, но много учетных записей в домене без возможности восстановления предоставляются широкие и глубокие привилегий, если только один из счетов скомпрометирован, он быстро используется при для перенастройки среды в целях злоумышленника или даже уничтожить больших сегментов инфраструктуры.  

Атаки PASS--hash, в том — это тип атак путем кражи учетных данных, вездесущи в том случае, поскольку инструментарий для их выполнения, бесплатным, простой в использовании, а во многих средах уязвимы к атакам. Атаки PASS--hash, однако не настоящую проблему. Суть проблемы получается двойная:  

1. Это обычно легко злоумышленнику получить глубокое привилегий на одном компьютере, а затем распространите эту привилегию широко на другие компьютеры.  
2. Обычно слишком много постоянных учетные записи с высоким уровнем привилегий в вычислительной среде.

Даже если исключаются атак pass--hash, злоумышленники бы просто использовать другой тактики, не другую стратегию. Вместо того чтобы подмены вредоносных программ, содержащий средства кражи учетных данных, запланируйте вредоносных программ, который регистрирует нажатия клавиш, их может поддерживать любое количество других подходов, чтобы записать учетные данные, которые являются мощным средством в среде. Независимо от того, тактики, целевые объекты остаются неизменными: учетные записи с привилегией обширных и глубоких.  

Предоставление прав чрезмерное не только найти в Active Directory в скомпрометированных средах. Когда организация разработала привычку предоставления более высоким уровнем привилегий, чем требуется, обычно находится в инфраструктуре, как описано в следующих разделах.  

## <a name="in-active-directory"></a>В Active Directory

В Active Directory довольно часто для поиска, что в каждой группе EA, DA и BA быть чрезмерное количество учетных записей. Чаще всего организации EA группа содержит минимальное число членов группы DA обычно содержат множителя количество пользователей в группе EA и группы "Администраторы", обычно содержат больше элементов, чем заполнение других групп, которые в сочетании. Это часто происходит из-за убеждении, что администраторы могут каким-либо образом «меньше привилегий» чем DAs или EAs. Хотя права и разрешения, предоставленные каждой из этих групп отличаться, их следует эффективно рассматривать столь же мощных группы так, как можно сделать членом одной себе является членом двух других.  

## <a name="on-member-servers"></a>На рядовых серверах

Когда мы получаем членства локальной группы администраторов на рядовых серверах во многих средах, то обнаружим, членства, от небольшое число учетных записей локального компьютера или домена до десятков вложенных групп, когда она открыта, Показать сотен и даже тысяч из учетные записи с правами локального администратора на серверах. Во многих случаях группы домена с большой членства вложены в рядовые серверы локальную группу администраторов, без необходимо учитывать тот факт, что любой пользователь, который можно изменить членов этих групп в домене не может получить административный контроль над всем системам на котором группе были вложены в локальную группу администраторов.  

## <a name="on-workstations"></a>На рабочих станциях

Несмотря на то, что рабочие станции обычно имеют в их локальной группы администраторов значительно меньшим числом членов, чем рядовых серверах, во многих средах, пользователям предоставляется членство в группе локальных администраторов на своих персональных компьютерах. Когда это происходит, даже если включен контроль учетных Записей, этих пользователей представляют повышенный риск целостности своих рабочих станциях.  

> [!IMPORTANT]  
> Следует тщательно проанализировать ли пользователям требуются права администратора на своих рабочих станциях, а если это так, лучшим подходом, можно создать отдельную учетную запись локального компьютера, который является членом группы "Администраторы". При необходимости повышения прав, они могут предоставлять учетные данные этой локальной учетной записи для повышения прав, но так как учетная запись является локальной, она не может использоваться для компрометации других компьютеров или доступа к ресурсам домена. Как и все локальные учетные записи, однако учетные данные для локального привилегированной учетной записи должно быть уникальным. При создании локальной учетной записи с теми же учетными данными на нескольких рабочих станциях, либо предоставить компьютеры для атаки pass--hash.  

## <a name="in-applications"></a>В приложениях

Атаки, в которых целевым объектом является интеллектуальную собственность организации учетные записи, которые были предоставлены привилегии мощных приложений могут быть нацелены на Разрешить также фильтрации данных. Несмотря на то, что учетные записи, которые имеют доступ к конфиденциальным данным может не предоставлен без привилегий в домене или операционной системы, учетные записи, которые можно изменять конфигурацию приложения или предоставляет доступ к информации приложения существует риск.  

## <a name="in-data-repositories"></a>В репозитории данных

Как и в случае с другими целевыми объектами, злоумышленники, которому пытается получить доступ к интеллектуальной собственности в виде документов и других файлов можно целевые учетные записи, управление доступом к файлу хранятся, учетными записями, имеющими прямой доступ к файлам, или даже группы или роли, которые имеют доступ к файлам. Например если файловый сервер используется для хранения контрактная документация и доступа к документам с помощью группы Active Directory, злоумышленник может изменить членство в группе можно добавить в группу скомпрометированные учетные записи и доступ к контракта документы. В случаях, в которых предоставляется доступ к документам, приложения, например SharePoint злоумышленники могут выявить приложения, как описано выше.  

## <a name="reducing-privilege"></a>Уменьшение привилегий

Чем больше и сложнее среде, тем сложнее для защиты и управления ими. В небольших организациях проверка и уменьшение привилегий может быть сравнительно простой предложение, но каждый дополнительный сервер, рабочей станции, учетная запись пользователя и приложения, используемых в организации добавляет другой объект, который необходимо защитить. Так как он может быть трудно или даже невозможно должным образом защитить все аспекты организации ИТ-инфраструктуры, следует сосредоточить усилия сначала на учетные записи которых привилегий создайте наибольшей угрозе, которыми обычно являются встроенных привилегированных учетных записей и группы в Active Directory и привилегированный локальных учетных записей на рабочих станциях и серверах.  

### <a name="securing-local-administrator-accounts-on-workstations-and-member-servers"></a>Защита учетных записей локального администратора на рабочих станциях и серверах

Несмотря на то, что в этом документе нацелен на обеспечение безопасности Active Directory, как было ранее описано, как атаки, направленные на отдельных узлах начать большинство атак в каталоге. Не может быть указан полный рекомендации по обеспечению безопасности локальных групп на членов системы, но можно использовать следующие рекомендации помогут защитить локальные учетные записи администратора на рабочих станциях и серверах.  

#### <a name="securing-local-administrator-accounts"></a>Защита учетных записей локального администратора

Во всех версиях Windows в настоящее время в основную фазу поддержки учетной записи локального администратора отключена по умолчанию, поэтому нельзя использовать для pass--hash и других атак кражи учетных данных учетной записи. Тем не менее в домены, содержащие устаревших операционных систем или были включены какие локальные учетные записи администратора, эти учетные записи можно использовать как описано выше для распространения компрометации в рядовых серверах и рабочих станциях. По этой причине для всех локальных учетных записей администратора на компьютерах, присоединенных к домену рекомендуются следующие элементы управления.  

Подробные инструкции по реализации этих элементов управления предоставляются в [приложение H: Обеспечение безопасности в учетные записи локального администратора и группы](../../../ad-ds/plan/security-best-practices/Appendix-H--Securing-Local-Administrator-Accounts-and-Groups.md). Перед реализацией этих параметров, однако убедитесь, что локальные учетные записи администратора не используются в данный момент в среде для запуска служб на компьютерах или выполнять другие действия, для которых не следует использовать эти учетные записи. Тщательно протестируйте эти параметры перед их реализацией в рабочей среде.  

#### <a name="controls-for-local-administrator-accounts"></a>Элементы управления для учетных записей локального администратора

Встроенных учетных записей администраторов никогда не должны использоваться как учетные записи служб на рядовых серверах, и они должны нельзя использовать для входа на локальных компьютерах (за исключением в безопасном режиме, которые разрешено, даже если учетная запись отключена). Реализация описанным здесь параметрам предназначена для предотвращения локальной учетной записи администратора на каждом компьютере, можно использовать, если сначала отменяются средства защиты. Реализация этих элементов управления и мониторинга учетные записи администратора для изменения, можно значительно снизить вероятность успеха атаки, целевые объекты локальные учетные записи администратора.  

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-joined-systems"></a>Настройка объектов групповой политики, чтобы разрешить учетным записям администратора на компьютерах, присоединенных к домену

В один или несколько объектов групповой политики, создать и связать с рабочей станции или рядовом сервере подразделения в каждом домене, добавьте учетную запись администратора следующие пользовательские права в **компьютера компьютера\Политики\Параметры Settings\Security Settings\Local Policies\ Назначение прав пользователя**:  

- Отказ в доступе к компьютеру из сети
- Отказ во входе в качестве пакетного задания
- Отказать во входе в качестве службы
- Запретить вход в систему через службу удаленных рабочих столов

При добавлении учетных записей администратора в эти права пользователей указываются ли при добавлении учетной записи локального администратора или администратора домена учетной записи того, что метками учетной записи. Например, для добавления учетной записи администратора домена NWTRADERS к этим запретить правами, введите учетную запись как **NWTRADERS\Administrator**, или перейдите к учетной записи администратора для домена NWTRADERS. Чтобы ограничить учетной записи локального администратора, введите **администратора** в эти параметры в редакторе объектов групповой политики прав пользователей.  

> [!NOTE]  
> Даже если локальные учетные записи администратора переименовываются, политики, будут по-прежнему применяются.  

Эти параметры позволят учетной записи администратора компьютера, которые не может использоваться для подключения к другим компьютерам, даже если он случайно или злонамеренно включен. Локальные входы в систему с помощью учетной записи локального администратора нельзя отключить полностью, а также при попытке сделать это, так как учетной записи локального администратора компьютера предназначен для использования в сценариях аварийного восстановления.  

Следует на рядовой сервер или рабочую станцию становятся исключен из домена с нет других локальных учетных записей предоставляются права администратора, компьютер может загружаться в безопасном режиме, можно включить учетную запись администратора и учетной записи может затем использоваться для эффекта действия по восстановлению на компьютере. По завершении действия по восстановлению учетной записи администратора снова должны быть отключены.  

### <a name="securing-local-privileged-accounts-and-groups-in-active-directory"></a>Защита локальных привилегированных учетных записей и групп в Active Directory

*Закон цифра шесть: Компьютер защищен настолько, администратору trustworthy.* - [10 непреложных законов безопасности (версия 2.0)](https://technet.microsoft.com/security/hh278941.aspx)  

Сведения, представленные в данном разделе призван предоставить общие рекомендации по обеспечению безопасности наивысший привилегий встроенных учетных записей и групп в Active Directory. Подробные пошаговые инструкции также предоставляются в [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md), [приложение д. Защита групп корпоративных администраторов в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-E--Securing-Enterprise-Admins-Groups-in-Active-Directory.md), [приложение е. Защита групп администраторов домена в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md), а затем в [приложение ж Защита групп администраторов в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md).  

При реализации любой из этих параметров, следует также протестировать все параметры тщательно, чтобы определить, если они подходят для вашей среды. Не все организации будут иметь возможность реализовать эти параметры.  

#### <a name="securing-built-in-administrator-accounts-in-active-directory"></a>Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory

В каждом домене в Active Directory учетная запись администратора создается в процессе создания домена. Эта учетная запись является по умолчанию членом группы "Администраторы домена" и групп администраторов домена, а если домен корневого домена леса, учетная запись также является членом группы "Администраторы предприятия". Использование учетной записи локального администратора домена требуется зарезервировать только для действий начальной сборки и, возможно, сценариев аварийного восстановления. Чтобы убедиться, что встроенная учетная запись администратора может использоваться для действия по восстановлению в случае недоступности других учетных записей можно использовать, не изменяйте членства по умолчанию учетной записи администратора в любом домене в лесу. Вместо этого следует следуя рекомендациям, для защиты учетной записи администратора в каждом домене в лесу. Подробные инструкции по реализации этих элементов управления предоставляются в [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  

#### <a name="controls-for-built-in-administrator-accounts"></a>Элементы управления для встроенных учетных записей администраторов

Реализация описанным здесь параметрам призвано во избежание каждый домен учетной записи администратора (не группа) не может использоваться, если не изменено ряд элементов управления. Путем реализации этих элементов управления и мониторинга учетные записи администратора для изменения, можно значительно уменьшить вероятность успешных атак за счет использования учетной записи администратора домена. Для учетной записи администратора в каждом домене в лесу необходимо настроить следующие параметры.  

##### <a name="enable-the-account-is-sensitive-and-cannot-be-delegated-flag-on-the-account"></a>Включить флаг «Учетная запись важна и не может быть делегирована» для учетной записи

По умолчанию можно делегировать всех учетных записей в Active Directory. Делегирование позволяет компьютера или службы, чтобы представить учетные данные для учетной записи, которая свою подлинность на компьютере или службы на другие компьютеры, для получения служб от имени учетной записи. При включении **учетная запись важна и не может быть делегирована** атрибут на доменную учетную запись, не может предоставлять учетные данные учетной записи для других компьютеров или служб в сети, что ограничивает атак с использованием делегирование для использования учетных данных учетной записи в других системах.  

##### <a name="enable-the-smart-card-is-required-for-interactive-logon-flag-on-the-account"></a>Включить флаг «смарт-карты для интерактивного входа требуется» в учетной записи

При включении **смарт-карты для интерактивного входа в систему требуется** атрибут для учетной записи Windows сбрасывает пароль для учетной записи в случайное значение 120 символов. Этот параметр для встроенных учетных записей администратора, убедитесь, что не только длинный и сложный пароль для учетной записи, но неизвестен любому пользователю. Не является технически необходимым для создания смарт-карт для учетных записей, прежде чем включать этот атрибут, но если это возможно, смарт-карты должен быть создан для каждой учетной записи администратора, прежде чем настраивать ограничения учетной записи и смарт-карт, которые должны храниться в безопасных местах.  

Несмотря на то, что параметр **смарт-карты для интерактивного входа в систему требуется** флаг сбрасывает пароль для учетной записи, она не запрещает пользователь с правами, чтобы сбросить пароль учетной записи с помощью, а также настройка учетной записи известное значение Имя учетной записи и новый пароль для доступа к ресурсам в сети. По этой причине следует реализовать следующие дополнительные элементы управления в учетной записи.  

##### <a name="configuring-gpos-to-restrict-domains-administrator-accounts-on-domain-joined-systems"></a>Настройка объектов групповой политики для ограничения доменов учетные записи администратора на компьютерах, присоединенных к домену

Несмотря на то, что отключение учетной записи администратора домена делает эффективно непригодным для использования учетной записи, следует реализовать дополнительные ограничения для учетной записи в случае, если включена учетная запись случайно или злонамеренно. Несмотря на то, что в конечном счете, эти элементы управления может быть отменено с помощью учетной записи администратора, целью является создание элементов управления, которые медленно выполняется злоумышленника и ограничение повреждения учетной записи может причинить неудобства.  

В один или несколько объектов групповой политики, создать и связать с рабочей станции или рядовом сервере подразделения в каждом домене, добавьте следующие пользовательские права в учетной записи администратора для каждого домена **компьютера компьютера\Политики\Параметры Settings\Security Settings\Local Назначение прав политики\Назначение**:  

- Отказ в доступе к компьютеру из сети  
- Отказ во входе в качестве пакетного задания  
- Отказать во входе в качестве службы  
- Запретить вход в систему через службу удаленных рабочих столов  

> [!NOTE]  
> При добавлении локальных учетных записей администратора для этого параметра необходимо указать ли вы настраиваете локальные учетные записи администратора или учетные записи администратора домена. Например, для добавления запретить NWTRADERS домена учетной записи локального администратора на эти права, необходимо либо ввести той учетной записи **NWTRADERS\Administrator**, или перейдите к учетной записи локального администратора для домена NWTRADERS. При вводе **администратора** в эти параметры в редакторе объектов групповой политики прав пользователя будет ограничена учетной записи локального администратора на каждом компьютере, к которому применяется объект групповой Политики.  
>
> Мы советуем ограничивать локальные учетные записи администратора на рядовых серверах и рабочих станциях в так же, как доменные учетные записи администратора. Таким образом следует обычно Добавление учетной записи администратора для каждого домена в лесу и учетной записи администратора для локальных компьютеров для этих параметров прав пользователей. 

##### <a name="configuring-gpos-to-restrict-administrator-accounts-on-domain-controllers"></a>Настройка объектов групповой политики, чтобы разрешить учетным записям администратора на контроллерах домена

В каждом домене в лесу, политика контроллеров домена по умолчанию или политики, связанные с Подразделением контроллеров домена может изменяться, добавляемый в следующие пользовательские права учетной записи администратора для каждого домена **Конфигурация компьютера\Политики\Параметры компьютера Windows Windows\Параметры безопасности\Локальные политики\Назначение прав назначения**:  

- Отказ в доступе к компьютеру из сети  
- Отказ во входе в качестве пакетного задания  
- Отказать во входе в качестве службы  
- Запретить вход в систему через службу удаленных рабочих столов  

> [!NOTE]  
> Эти параметры гарантируют, что учетной записи локального администратора, не может использоваться для подключения к контроллеру домена, несмотря на то, что учетная запись, если параметр включен, можно локально войти в контроллерах домена. Так как только этой учетной записи следует включить и использовать в сценариях аварийного восстановления, предполагается, что физический доступ к по крайней мере один контроллер домена будет доступна, или что могут быть другие учетные записи с разрешениями на доступ к контроллерам домена удаленно использовать.  

##### <a name="configure-auditing-of-built-in-administrator-accounts"></a>Настройка аудита встроенной учетной записи администратора учетных записей

Если защита учетной записи администратора для каждого домена и она отключена, необходимо настроить аудит для отслеживания изменений в учетную запись. Если учетная запись включена, сбросить пароль или любые другие изменения вносятся в учетную запись, оповещения должно отправляться пользователям или группам, ответственный за управление AD DS, помимо групп реагирования на инциденты в вашей организации.  

### <a name="securing-administrators-domain-admins-and-enterprise-admins-groups"></a>Обеспечение безопасности администраторов, администраторов домена и групп корпоративных администраторов

#### <a name="securing-enterprise-admin-groups"></a>Защита групп администраторов предприятия

В группу "Администраторы предприятия", расположенной в корневом домене леса, должен содержать пользователи, не на ежедневной основе, с возможным исключением домена учетной записи локального администратора, если он защищен, как описано выше и в [ Приложение г. Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  

Если необходим доступ EA, пользователи, учетные записи которых требуют EA права и разрешения следует временно поместить в группу "Администраторы предприятия". Несмотря на то, что пользователи используют высокопривилегированные учетные записи, аудит их действия и они будут лучше всего выполнять с помощью одного пользователя, выполняющего изменения и изменения другого пользователя, чтобы свести к минимуму вероятность случайного неправильного использования или неправильной конфигурации . После завершения действий, учетные записи должны быть удалены из группы EA. Это можно сделать с помощью процедуры ручного и описаны процессы, программное обеспечение независимых производителей привилегированных удостоверениями и доступом management (PIM/PAM) или их сочетание. Рекомендации для создания учетных записей, который может использоваться для управления членство привилегированных групп в Active Directory приведены в [учетные записи, подверженные риску кражи учетных данных](../../../ad-ds/plan/security-best-practices/Attractive-Accounts-for-Credential-Theft.md) и подробные инструкции представлены в [Приложение и: Создание учетных записей управления защищенных учетных записей и групп в Active Directory](../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md).  

"Администраторы предприятия", по умолчанию являются членами встроенной группы администраторов в каждом домене в лесу. Удаление группы "Администраторы предприятия" из группы "Администраторы" в каждом домене является нежелательного изменения, так как в случае сценарии аварийного восстановления с лесом, EA права вероятно, потребуется. Если в группу "Администраторы предприятия" был удален из группы "Администраторы" в лесу, его следует добавить в группу администраторов в каждом домене и должны быть реализованы следующие дополнительные элементы управления:  

- Как уже упоминалось, в группу "Администраторы предприятия" должен содержать пользователи, не на ежедневной основе, с возможным исключением учетной записи администратора корневого домена леса, который должен быть защищен, как описано в разделе [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
- В объектах групповой политики, связанные с подразделениями, содержащую рядовые серверы и рабочие станции в каждом домене в группу EA добавляются следующие пользовательские права:  
   - Отказ в доступе к компьютеру из сети  
   - Отказ во входе в качестве пакетного задания  
   - Отказать во входе в качестве службы  
   - Запретить локальный вход  
   - Запретить вход в систему через службу удаленных рабочих столов.  

Это позволит членам группы EA входа на рядовых серверах и рабочих станциях. Если серверы перехода используются для администрирования контроллеров домена и Active Directory, убедитесь, что серверы перехода, находятся в Подразделении, к которому строгие GPO не связаны.  

- Аудит должен быть настроен для отправки оповещений в случае, если были внесены любые изменения свойств или членство в группе EA. Эти оповещения должно отправляться, как минимум, для пользователей или группы, ответственной за ответа инцидентов и администрирования Active Directory. Необходимо также определить процессы и процедуры временно внесения EA групп, включая процедуры уведомления, когда выполняется законным заполнение группы.  
  
#### <a name="securing-domain-admins-groups"></a>Защита групп администраторов домена

Как и в случае с в группу "Администраторы предприятия", членство в группах "Администраторы домена" должны только в сценариях сборки или аварийного восстановления. Должна существовать не обычных учетных записей пользователей в группе DA, за исключением учетной записи локального администратора для домена, если он защищен, как описано в разделе [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
  
Если требуется доступ к DA, необходимости этот уровень доступа учетных записей следует временно помещены в группу DA для рассматриваемого домена. Несмотря на то, что пользователи используют высокопривилегированные учетные записи, действия следует аудиту и лучше всего выполнять с помощью одного пользователя, выполняющего изменения и изменения другого пользователя, чтобы свести к минимуму вероятность случайного неправильного использования или неправильной конфигурации. После завершения действий, учетные записи должны удаляться из группы "Администраторы домена". Это можно сделать с помощью процедуры ручного и описаны процессы с помощью программного обеспечения сторонних привилегированных удостоверениями и доступом management (PIM/PAM), или их сочетание. Рекомендации для создания учетных записей, который может использоваться для управления членство привилегированных групп в Active Directory приведены в [приложении I: Создание учетных записей управления защищенных учетных записей и групп в Active Directory](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md).  
  
"Администраторы домена", по умолчанию являются членами локальных групп администраторов на всех рядовых серверах и рабочих станциях в соответствующих доменов. Такая вложенность по умолчанию не следует изменять, так как оно влияет на варианты поддержки и аварийного восстановления. Если группы "Администраторы домена" были удалены из локальной группы администраторов на рядовых серверах, они должны добавляться в группу администраторов на каждом сервере члена и рабочая станция в домене с помощью параметров специальную группу на связанных объектов групповой политики. Следующие общие элементы управления, которые будут подробно описаны в [приложение F: Защита групп администраторов домена в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-F--Securing-Domain-Admins-Groups-in-Active-Directory.md) также должен быть реализован.  

Для группы "Администраторы домена" в каждом домене в лесу:  

1. Удалить всех участников из группе DA возможным исключением встроенной учетной записи администратора для домена, если он защищен, как описано в разделе [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
2. В объектах групповой политики, связанные с подразделениями, содержащую рядовые серверы и рабочие станции в каждом домене DA группы добавляются следующие пользовательские права:  
   - Отказ в доступе к компьютеру из сети  
   - Отказ во входе в качестве пакетного задания  
   - Отказать во входе в качестве службы  
   - Запретить локальный вход  
   - Запретить вход в систему через службу удаленных рабочих столов  
  
   Это позволит членам группы DA входа на рядовых серверах и рабочих станциях. Если серверы перехода используются для администрирования контроллеров домена и Active Directory, убедитесь, что серверы перехода, находятся в Подразделении, к которому строгие GPO не связаны.  

3. Аудит должен быть настроен для отправки оповещений в случае, если были внесены любые изменения свойств или членство в группе DA. Эти оповещения должно отправляться, как минимум, для пользователей или группы, ответственной за ответа инцидентов и администрирования AD DS. Необходимо также определить процессы и процедуры временно внесения DA групп, включая процедуры уведомления, когда выполняется законным заполнение группы.  

#### <a name="securing-administrators-groups-in-active-directory"></a>Защита групп администраторов в Active Directory

Как и в случае с группами EA и DA, членство в группе администраторов (BA) должны только в сценариях сборки или аварийного восстановления. Должна существовать не обычных учетных записей пользователей в группы "Администраторы" за исключением учетной записи локального администратора для домена, если он защищен, как описано в разделе [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  

Если требуется доступ к администраторам, в группу администраторов домена в необходимости этот уровень доступа учетных записей должны размещаться временно. Несмотря на то, что пользователи используют высокопривилегированные учетные записи, действия должны быть аудиту и, желательно выполнять с помощью пользователь, вносящий изменения и изменения другого пользователя, чтобы свести к минимуму вероятность случайного неправильного использования или неправильной конфигурации. После завершения действий, учетные записи должны немедленно удалены из группы "Администраторы". Это можно сделать с помощью процедуры ручного и описаны процессы с помощью программного обеспечения сторонних привилегированных удостоверениями и доступом management (PIM/PAM), или их сочетание.  

Администраторы, по умолчанию являются владельцами большинство объектов в соответствующих доменов AD DS. Членство в этой группе может потребоваться в сборки сценарии и аварийного восстановления в которых необходим владения или возможность задавать принадлежность объекта. Кроме того DAs и EAs наследуют ряд своими правами и разрешениями в силу их членства в группе администраторов. По умолчанию группы вложенности для привилегированных групп в Active Directory не может изменяться и группы администраторов на каждом домене должен быть защищен, как описано в разделе [приложение G: Защита групп администраторов в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-G--Securing-Administrators-Groups-in-Active-Directory.md)и в общие приведенным ниже инструкциям.  

1. Удалить всех участников из группы администраторов, с возможным исключением учетной записи локального администратора для домена, если он защищен, как описано в разделе [приложение г Обеспечение безопасности встроенной учетной записи администратора учетных записей в Active Directory](../../../ad-ds/plan/security-best-practices/Appendix-D--Securing-Built-In-Administrator-Accounts-in-Active-Directory.md).  
2. Члены группы администраторов домена нет необходимости выполните вход на рядовых серверах или рабочих станциях. В один или несколько объектов групповой политики с рабочей станции или рядовом сервере подразделения в каждом домене группы "Администраторы" добавляются следующие пользовательские права:  
   - Отказ в доступе к компьютеру из сети  
   - Отказать во входе в качестве пакетного задания  
   - Отказать во входе в качестве службы  
   - Это не позволит членам группы "Администраторы" не могут использоваться для входа или подключиться к рядовых серверах или рабочих станциях, (если несколько элементов управления сначала уже нарушена), где учетных данных может кэшировать и тем самым скомпрометированы. Привилегированная учетная запись никогда не следует использовать для входа в систему с меньшими правами доступа и применение этих элементов управления предоставляет защиту от предпосылкой возникновения многих атак.  

3. AT контроллеров домена, Подразделения в каждом домене в лесу, в группу администраторов следует предоставить следующего пользователя прав (если они еще нет этих прав), который позволит участникам группы "Администраторы" для выполнения функции, необходимые для сценарий леса аварийного восстановления.  
   - Доступ к этому компьютеру из сети  
   - Локальный вход в систему  
   - Разрешить вход в систему через службу удаленных рабочих столов  

4. Аудит должен быть настроен для отправки оповещений в случае, если были внесены любые изменения свойств или членство в группе администраторов. Эти предупреждения должны отправляться, как минимум, члены группы отвечают за администрирование AD DS. Оповещения также будет отправляться члены группы безопасности и процедуры должны быть определены для изменить членство группы "Администраторы". В частности эти процессы должны содержат процедуры, по которому группа безопасности получает уведомление, когда планируется изменить таким образом, при отправке оповещения, они будут, и не возникает оповещение группы "Администраторы". Кроме того должны быть реализованы процессы для уведомления о группе безопасности после завершения работы группы "Администраторы" и учетных записей, используемых были удалены из группы.  

> [!NOTE]  
> При реализации ограничений в группе администраторов в объектах групповой политики, Windows применяет параметры к членами локальной группы администраторов на компьютере в дополнение к группе администраторов домена. Таким образом необходимо соблюдать осторожность при реализации ограничения на группы "Администраторы". Несмотря на то, что запрет входов сеть, пакетной службы и службы является членом группы "Администраторы" рекомендуется везде, где это можно реализовать, не ограничивают локальные входы в систему или вход в систему через службы удаленных рабочих столов. Эти типы входа можно блокированные законным администрирования компьютера членами локальной группы администраторов. На следующем рисунке показаны параметры конфигурации, которые блокируют несанкционированного использования встроенных локальных и домена учетной записи администратора, в дополнение к неправильное использование встроенных групп Администраторы локальные или доменные. Обратите внимание, что **запретить вход в систему через службу удаленных рабочих столов** право пользователя не включает группы администраторов, так как его включением в этот параметр также может блокировать эти входы в систему для учетных записей, которые являются членами локального компьютера Группы «Администраторы». Если службы на компьютерах настроены для запуска в контексте любого из привилегированных групп, описанные в этом разделе, для реализации этих параметров может привести к служб и приложений, переход на другой. Таким образом как и все рекомендации в этом разделе, должны тщательно проверить параметры для применимости в вашей среде.  
>
> ![как минимум права администратора модели](media/Implementing-Least-Privilege-Administrative-Models/SAD_3.gif)  

### <a name="role-based-access-controls-rbac-for-active-directory"></a>Элементы управления доступом на основе ролей (RBAC) для Active Directory

Вообще говоря элементы управления доступом на основе ролей (RBAC) — это механизм для группирования пользователей и предоставления доступа к ресурсам на основании бизнес-правила. В случае с Active Directory реализация RBAC для AD DS — это процесс создания ролей, к которым права и разрешения, делегируются позволяет членам роли повседневные административные задачи без предоставления им чрезмерное привилегий. RBAC для Active Directory можно разрабатывать и реализовать через собственными средствами и интерфейсы, за счет использования программного обеспечения, которые вы уже есть, путем приобретения продуктов независимых производителей, или любое сочетание этих подходов. В этом разделе не содержат пошаговые инструкции для реализации RBAC для Active Directory, но вместо этого рассматриваются факторы, которые следует учитывать при выборе подхода к реализации RBAC в вашей установке AD DS.  

#### <a name="native-approaches-to-rbac-for-active-directory"></a>Собственные подходы к RBAC для Active Directory

В простейшей реализации RBAC можно реализовать роли в качестве группы AD DS и делегировать права и разрешения группам, которые позволяют им для выполнения повседневных задач по администрированию в указанной области роли.  

В некоторых случаях существующих групп безопасности в Active Directory можно предоставить права и разрешения, соответствующие функции задания. К примеру Если конкретных сотрудников в ИТ-организации отвечают за управление и обслуживание зон и записей DNS, делегировать эти задачи может быть сложнее, чем создание учетной записи для каждого администратора DNS и его добавления в DNS Группы "Администраторы" в Active Directory. В группе администраторов DNS, в отличие от группы с более высоким уровнем привилегий, имеет несколько мощных права на Active Directory, несмотря на то, что члены этой группы были делегированные разрешения, которые дают возможность администрировать DNS и будет по-прежнему подвержены компрометации и о нарушении может привести к повышение прав доступа.

В других случаях может потребоваться создание групп безопасности и делегировать права и разрешения для объектов Active Directory, объектов файловой системы и объектов реестра, позволяющие членов групп, назначенный административных задач. Например если свои операторы службы технической поддержки отвечают за Сброс забытых паролей, помощь пользователям с проблем с подключением и устранение неполадок настройки приложения, может потребоваться объединить параметры делегирования в объектах user в Active Directory с правами, которые позволяют пользователям удаленное подключение на компьютеры пользователей, чтобы просмотреть или изменить параметры конфигурации для пользователей службы технической поддержки. Для каждой роли, которые можно определить необходимо определить:  

1. Членами роли, какие задачи выполните на повседневной основе и менее часто выполняются задачи.  
2. На какие системы и в которых приложениям членами роли следует предоставить права и разрешения.  
3. Какие пользователи должны предоставляться членство в роли.  
4. Как осуществляется управление членства в роли.  

Во многих средах вручную создавать элементы управления доступом на основе ролей для администрирования среды Active Directory может оказаться сложной задачей для внедрения и обслуживания. Если четко определены роли и обязанности для администрирования ИТ-инфраструктуры, вы можете использовать дополнительные средства помогут вам в создании управляемые развертывания в собственном RBAC. Например если в вашей среде Forefront Identity Manager (FIM), можно использовать FIM можно автоматизировать создание и заполнение административные роли, которые может упростить текущее администрирование. Если вы используете System Center Configuration Manager (SCCM) и System Center Operations Manager (SCOM), можно использовать роли конкретного приложения для делегирования управления и мониторинга и также обеспечивают согласованную конфигурацию и аудита во всех системах домен. При реализации инфраструктуры открытых ключей (PKI), может выдавать и требование смарт-карт для ИТ-персонала, отвечающего за администрирование среды. С помощью управления учетными данными FIM (FIM CM) можно даже комбинировать управление ролями и учетными данными для административному персоналу.  

В других случаях может быть более предпочтительным, чем для организации следует рассмотреть возможность развертывания RBAC стороннего программного обеспечения, который предоставляет функциональные возможности «out-of-box». Коммерческого использования, готовые решения (ГОТОВЫХ) для RBAC для Active Directory, Windows и каталоги, отличных от Windows и операционных систем, предлагаются несколько поставщиков. При выборе между собственного решения и продукты третьих лиц, учитывайте следующие факторы.  

1. Бюджет: Вкладывая средства в разработку с помощью программного обеспечения и средств, которые могут у вас уже есть RBAC, можно уменьшить затраты на программное обеспечение, участвующих в развертывании решения. Тем не менее если у вас нет сотрудников, которые имеют опыта в создании и развертывании собственного решения RBAC, может потребоваться привлечь консультирования ресурсы для разработки решения. Тщательно необходимо учитывать предполагаемые затраты для специально разработанного решения с затраты на развертывание решения «out-of-box», особенно в том случае, если ваш бюджет ограничено.  
2. Сочетание ИТ-среды: Если среда состоит главным образом из систем Windows, или если вы уже используете Active Directory для управления системами отличных от Windows и учетные записи, пользовательские собственного решения может предоставлять оптимальное решение для ваших потребностей. Если инфраструктуры содержит во многих системах, которые не находятся под управлением Windows и не находятся под управлением Active Directory, может потребоваться рассмотреть варианты управления системами не Windows отдельно от среды Active Directory.  
3. Модель привилегий в решении: Если, которые использует продукт размещение учетных записей служб в привилегированных групп в Active Directory и предоставить не параметры предложения, не требующие чрезмерное прав доступа к программному обеспечению RBAC, вы не Понизили действительно атаки в Active Directory область только изменены композиции наиболее привилегированных групп в каталоге. Если поставщик приложения можно предоставить элементы управления для учетных записей служб, которые минимизируют вероятность учетные записи скомпрометирована и намеренно используется, вы можете рассмотреть другие варианты.  

### <a name="privileged-identity-management"></a>Управление привилегированными пользователями

Управление привилегированными пользователями (PIM), иногда называется управления привилегированными учетными записями (PAM) или управление привилегированными учетными данными (PCM) — это проектирование, строительство и реализация подходы к управлению привилегированных учетных записей в вашей инфраструктура. Вообще говоря PIM предоставляет механизмы, по которым учетных записей, которым предоставляются права временные и исправить разрешения, необходимые для выполнения сборки или разрыва функции, а не правами, постоянно подключенные к учетным записям. Функциональные возможности управления привилегированными пользователями вручную создается или реализуется через развертывание независимых производителей программного обеспечения, один или несколько из следующих компонентов могут быть доступны:  
  
- Учетные данные «хранилищ», где пароли для привилегированных учетных записей «извлечь» и назначить начального пароля, а затем «возврата» Если действия были завершены, после чего снова сброс пароля для учетных записей.  
- Привязанный ко времени ограничения на использование привилегированных учетных данных  
- Использовать один раз учетные данные  
- Созданный рабочий процесс предоставления прав доступа с помощью мониторинга и отчетности действия, выполненные и автоматического удаления прав доступа при завершении действия или выделенное время истечения срока действия  
- Замена жестко учетные данные, такие как имена пользователей и пароли в сценариях с помощью прикладного программирования (API), позволяющие учетных данных, которое необходимо извлечь из хранилища при необходимости  
- Автоматическое управление учетные данные учетной записи службы  

### <a name="creating-unprivileged-accounts-to-manage-privileged-accounts"></a>Создание непривилегированных учетных записей для управления привилегированными учетными записями

Одна из сложностей в управлении привилегированным учетным записям том, что по умолчанию, учетные записи, управление привилегированными пользователями и защищенные учетные записи и группы имеют привилегий и защиты учетных записей. Если вы реализуете подходящих решений PIM и RBAC для установки Active Directory, решения могут включать подходов, которые позволяют эффективно depopulate членство наиболее привилегированных групп в каталоге, заполнение только группы временно и только при необходимости.  

Если вы реализуете собственный RBAC и управления персональными данными, тем не менее, следует Создание учетных записей, которые имеют привилегии не и с помощью только функции, заполнение и depopulating привилегированных групп в Active Directory, при необходимости. [Приложение И. Создание учетных записей управления для защищенных учетных записей и групп в Active Directory](../../../ad-ds/manage/component-updates/../../../ad-ds/manage/component-updates/Appendix-I--Creating-Management-Accounts-for-Protected-Accounts-and-Groups-in-Active-Directory.md) пошаговые инструкции, которые можно использовать для создания учетных записей для этой цели.  

### <a name="implementing-robust-authentication-controls"></a>Реализация элементов управления надежной проверки подлинности

*Закон цифра шесть: Действительно нахождении кого-либо out здесь пытаться угадать пароль.* - [10 непреложных законов безопасности администрирования](https://technet.microsoft.com/library/cc722488.aspx)  

PASS--hash и других атак кражи учетных данных не являются специфичными для операционных систем Windows, они не являются новые. Первый атаки pass--hash был создан в 1997 году. Исторически сложилось так, что тем не менее, эти атаки необходимые настраиваемые инструменты были непродуманной в их успехе и необходимые злоумышленники иметь относительно высокий уровень квалификации. Введение можно бесплатно, простой в использовании средства, которые изначально извлекает учетные данные помог экспоненциального роста числа и успешность атак кражи учетных данных в последние годы. Тем не менее атак кражи учетных данных являются далеко не единственным механизмы, по которым целевые и компрометации учетных данных.  

Несмотря на то, что следует реализовать элементы управления для защиты от атак кражи учетных данных, необходимо также определить учетные записи в вашей среде, скорее всего, стали целью злоумышленников и реализации элементов управления надежной проверки подлинности для тех учетные записи. Если наиболее привилегированные учетные записи при использовании одного фактора проверки подлинности, такие как имена пользователей и пароли (оба значения являются «вы знаете,» то, на чем один фактор проверки подлинности), эти учетные записи слабо защищены. Все, что злоумышленник потребностей является знания имени пользователя и пароль, связанный с учетной записью и не требуются атак pass--hash злоумышленник может проверять подлинность имени пользователя в любой системы, которые принимают учетные данные одного фактора.  

Несмотря на то, что реализации многофакторной проверки подлинности не защищает вас от атак типа pass--hash, реализации многофакторной проверки подлинности в сочетании с защищенных системах может. Дополнительные сведения о реализации защищенных систем приведены в [реализация безопасного администрирования узлов](../../../ad-ds/plan/security-best-practices/Implementing-Secure-Administrative-Hosts.md), и в следующих разделах рассматриваются параметры проверки подлинности.  

#### <a name="general-authentication-controls"></a>Общие элементы управления проверки подлинности

Если вы уже не реализовали многофакторной проверки подлинности, например смарт-карты, постарайтесь сделать это. Смарт-карты обеспечивают аппаратную защиту закрытых ключей в паре открытого и закрытого ключа, предотвращая закрытый ключ пользователя получить доступ и использовать, если он предоставит правильный ПИН-код, секретный код или Биометрический идентификатор смарт-карты. Даже если ПИН-код или секретный код пользователя перехватывается средство регистрации нажатия клавиш на взломанном компьютере, злоумышленник может повторно использовать ПИН-код или секретный код, карточке также должны физически присутствовать.

В случаях, в которых оказались трудно реализовать из-за пользователя сопротивление длинные сложные пароли, смарт-карты обеспечивают механизм, по которому пользователи могут реализовать относительно простой ПИН-коды или пароли без учетных данных, для подбора или атаки Rainbow таблицы. ПИН-коды смарт-карт не хранятся в Active Directory или в локальных базах данных SAM, несмотря на то, что хэши учетных данных по-прежнему могут храниться в памяти LSASS защищены на компьютерах, на которых использовались смарт-карты для проверки подлинности.  

#### <a name="additional-controls-for-vip-accounts"></a>Дополнительные элементы управления для учетных записей виртуальных IP-адресов

Еще одним преимуществом реализации смарт-карт или другие механизмы проверки подлинности на основе сертификатов является возможность использовать Контроль механизма проверки подлинности для защиты конфиденциальных данных, которые станут доступными для пользователей виртуальных IP-адресов. Контроль механизма проверки подлинности доступна в доменах, в которых выбран режим работы Windows Server 2012 или Windows Server 2008 R2. Если он включен, контроль механизма проверки подлинности добавляет принадлежность к глобальной группе, назначенному с помощью администратора маркере Kerberos пользователя при учетные данные пользователя проверяются во время входа в систему с помощью метода входа на основе сертификата.  

Это позволяет администраторам ресурсов для управления доступом к ресурсам, таким как файлы, папки и принтеры, в зависимости от того, является ли входе пользователя в систему с помощью метода входа в систему на основе сертификатов, помимо типа используемой сертификат, используемый. Например, при входе пользователя в систему с помощью смарт-карты, доступ пользователя к ресурсам в сети может быть указано как разные из какой доступ когда пользователь не использует смарт-карты (то есть при входе пользователя в систему, указав имя пользователя и пароль). Дополнительные сведения о Контроль механизма проверки подлинности, см. в разделе [Контроль механизма проверки подлинности для AD DS в Windows Server 2008 R2 Пошаговое руководство по](https://technet.microsoft.com/library/dd378897.aspx).  

#### <a name="configuring-privileged-account-authentication"></a>Настройка проверки подлинности с привилегированной учетной записи

В Active Directory для всех учетных записей администратора включить **требовать смарт-карту для интерактивного входа** атрибута и аудита для изменения (как минимум), атрибуты на **учетной записи** вкладке Учетная запись (например, cn, name, sAMAccountName, userPrincipalName и userAccountControl) объекты пользователя с правами администратора.  

Несмотря на то, что параметр **требовать смарт-карту для интерактивного входа** в учетных записях сбрасывает пароль для учетной записи, используя случайное значение 120 символов и требуется смарт-карт для интерактивный вход в систему, можно атрибут по-прежнему быть перезаписана при Затем пользователи с разрешениями, которые позволяют им изменять пароли на учетные записи и учетные записи можно использовать для установления неинтерактивной вход в систему с помощью только имя пользователя и пароль.  

В других случаях в зависимости от конфигурации учетных записей в Active Directory и параметры сертификата в службы сертификатов Active Directory (AD CS) или сторонних PKI, имя участника-пользователя (UPN) атрибуты для администратора или учетные записи виртуального IP-адреса могут быть нацелены для особого атак, как описано здесь.  

##### <a name="upn-hijacking-for-certificate-spoofing"></a>Захват имени участника-пользователя сертификата, делающей

Несмотря на то, что подробное обсуждение атак против инфраструктур открытого ключа (PKI) выходит за рамки данного документа, атаки на PKI общедоступных и частных экспоненциально увеличиться с момента 2008. Широко опубликован нарушений безопасности в общедоступный PKI, но атаки, направленные на внутренней PKI в организации может быть еще более продуктивный. Одна из таких атак использует Active Directory и сертификаты, чтобы позволить злоумышленнику подделать учетные данные других учетных записей таким образом, может быть трудно обнаружить.  

Когда сертификат предоставляется для проверки подлинности в систему, присоединенных к домену, содержимое субъекта или атрибут альтернативного имени субъекта (SAN) в сертификате используются для сопоставления сертификата с объектом пользователя в Active Directory. В зависимости от типа сертификата и как он построен атрибут субъекта в сертификате обычно содержит пользователя общее имя (CN), как показано на следующем снимке экрана.  

![как минимум права администратора модели](media/Implementing-Least-Privilege-Administrative-Models/SAD_4.gif)  

По умолчанию, Active Directory создает пользователя CN, объединяя имя учетной записи + "«+ фамилию. Однако компоненты CN объектов-пользователей в Active Directory не требуется и не обязательно должно быть уникальным и перемещение учетной записи пользователя в другое расположение в каталоге изменения учетной записи различающееся имя (DN), который является полный путь к объекту каталог, как показано в нижней части предыдущего снимка экрана.  

Так как имена субъектов сертификатов, не обязательно быть статическими или уникальным, содержимое в альтернативном имени субъекта часто используются для поиска объекта пользователя в Active Directory. Атрибут по сети SAN для сертификатов, выданных пользователям центры сертификации предприятия (Active Directory интегрированной CAs) обычно содержит адрес имени участника-пользователя или адрес электронной почты пользователя. Так как имена участников-пользователей, обязательно быть уникальным в лесу AD DS, поиск с объектом пользователя, имя участника-пользователя выполняется часто в ходе проверки подлинности, с или без сертификатов, участвующих в процессе проверки подлинности.  

Использование имен участников-пользователей в SAN-атрибуты сертификатов проверки подлинности могут использоваться злоумышленниками для получения мошеннических сертификатов. Если злоумышленник скомпрометирует учетную запись, имеет возможность чтения и записи объектов-пользователей имен участников-пользователей, атака реализуется следующим образом:  

Атрибут имени участника-пользователя объекта-пользователя (например, виртуальный IP-адрес пользователя), временно меняется на другое значение. Атрибут имени учетной записи SAM и CN можно также изменить в настоящее время, несмотря на то, что это обычно не является обязательным по причинам, описанным ранее.  

При изменении атрибута имени участника-пользователя в целевой учетной записи, учетной записи пользователя устаревших, включено или атрибут имени участника-пользователя учетной записи только что созданного пользователя меняется на значение, которое изначально был назначен целевой учетной записи. Устаревшие, поддержкой учетные записи — это учетные записи, не подключавшиеся к системе для длительных периодов времени, которые не были отключены. Они становятся целью злоумышленников, которые намереваются «скрыть сокрытое на» по следующим причинам:  

1. Так как учетная запись включена, но еще не были использованы недавно, используя учетную запись вряд активации оповещений то, что включение отключенные учетные записи могут.  
2. Использование существующей учетной записи не требуется создание учетной записи пользователя, могут заметить административного персонала.  
3. Устаревшие учетные записи, по-прежнему работают обычно являются участники различных групп безопасности и имеют доступ к ресурсам в сети, Упрощение доступа к и «наложения» для существующего пользователя заполнения.  

Учетная запись пользователя, на котором теперь настроен целевого имени участника-пользователя используется для запроса один или несколько сертификатов из службы сертификатов Active Directory.  

При получения сертификатов для учетной записи злоумышленника имена участников-пользователей в учетной записи «new» и целевой учетной записи возвращаются к исходным значениям.  

Теперь злоумышленник получил один или несколько сертификатов, которые могут быть представлены для проверки подлинности к ресурсам и приложениям, как, если пользователь является виртуальный IP-адрес пользователя, чья учетная запись временно был изменен. Несмотря на то, что полное описание всех способов, в котором сертификаты и PKI-сертификата может быть целью злоумышленников выходит за рамки данного документа, которые показывают, почему вы должны отслеживать привилегированных и ВАЖНЫХ учетных записей в Доменных службах Active Directory для изменения предоставляется этот механизм атаки , особенно для изменения с любым из атрибутов на **учетной записи** вкладку для учетной записи (например, cn, name, sAMAccountName, userPrincipalName и userAccountControl). Помимо мониторинга учетные записи, необходимо ограничить, кто может изменять учетные записи в качестве небольшого набора пользователей с правами администратора максимально. Аналогичным образом учетные записи пользователей с правами администратора защиты и контролируются на предмет несанкционированных изменений.  
