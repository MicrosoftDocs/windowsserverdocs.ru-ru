---
ms.assetid: ba28bd05-16e6-465f-982b-df49633cfde4
title: Защита контроллеров домена от атак
description: ''
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.date: 06/18/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 6be2899e85b68578518d9de1805c287367608163
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59863095"
---
# <a name="securing-domain-controllers-against-attack"></a>Защита контроллеров домена от атак

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

*Закон цифра три: Если у злоумышленника есть неограниченный физический доступ к компьютеру, он больше не ваш компьютер.* - [10 непреложных законов безопасности (версия 2.0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Контроллеры домена предоставляли физическое хранилище для базы данных AD DS, помимо предоставления служб и данных, которые позволяют предприятиям эффективно управлять их серверы, рабочие станции, пользователей и приложений. Если привилегированный доступ к контроллеру домена получается злонамеренным пользователем, можно изменить этого пользователя, повредить или уничтожить базы данных AD DS и, следовательно, все системы и учетных записей, управление которыми осуществляется с помощью Active Directory.  
  
Так как контроллеры домена можно чтение и запись для любого элемента в базе данных AD DS, компрометации контроллера домена означает, что ваш лес Active Directory можно никогда не считать trustworthy снова, если не удалось восстановить с помощью проверенной рабочей резервной копии и Закройте пропусков, которые разрешены нарушения системы безопасности в процесс.  
  
В зависимости от злоумышленника подготовки, средств и навыков, изменение или даже после неустранимого повреждения в AD DS базы данных можно выполнить в минутах для часов, а не дней или недель. Неподдерживаемые: вопросы и ответы сколько злоумышленник есть привилегированный доступ к Active Directory, но насколько злоумышленник запланирована на данный момент, когда привилегированного доступа получается. Компрометация контроллер домена можно предоставить короткому пути для распространения глобальных доступа или самый простой путь для уничтожения рядовые серверы, рабочие станции и Active Directory. В результате контроллеры домена должны быть защищены отдельно и более строгого, чем общие инфраструктуры Windows.  

## <a name="physical-security-for-domain-controllers"></a>Физическая безопасность для контроллеров домена

Этот раздел содержит сведения о физической защите контроллеров домена, контроллеров домена, являются ли физических или виртуальных машин в центрах обработки данных, филиалов и даже удаленно с помощью только элементы управления базовой инфраструктуры.  
  
### <a name="datacenter-domain-controllers"></a>Контроллеры домена в центре обработки данных  
  
#### <a name="physical-domain-controllers"></a>Физических контроллеров домена

В центрах обработки данных физических контроллеров домена должен быть установлен в выделенных безопасных стойкам и отсекам в, которые отделены от заполнения общего сервера. Если это возможно, контроллеры домена должны быть настроены микросхемы доверенного платформенного модуля (TPM), и все тома в серверы контроллера домена должны быть защищены с помощью шифрования диска BitLocker. BitLocker обычно перегрузке производительности в процентах однозначным числам, обозначающим, но обеспечивает защиту от компрометации каталога, даже если диски будут удалены с сервера. BitLocker можно также защитить системы от атак, например пакеты программ rootkit, так как изменение загрузочных файлов приведет к серверу для загрузки в режим восстановления, чтобы исходные двоичные файлы могут быть загружены. Если контроллер домена настроен на использование программного RAID-МАССИВА, SCSI с последовательным подключением, хранилище SAN/NAS или динамические тома, BitLocker не может быть реализован, поэтому локального хранилища (с или без аппаратную конфигурацию RAID) следует использовать контроллеры домена всякий раз, когда возможно.  
  
#### <a name="virtual-domain-controllers"></a>Виртуальные контроллеры домена 

Если вы реализуете виртуальных контроллеров домена, следует убедиться, что контроллеры домена работают на разных физических узлах, чем другие виртуальные машины в среде. Даже если вы используете платформу виртуализации для независимых производителей, рассмотрите возможность развертывания виртуальных контроллеров домена на сервере Hyper-V в Windows Server 2012 или Windows Server 2008 R2, которая предоставляет נאחלונמג ףחגטלמי и могут управляться с помощью контроллеров домена, размещенных в нем Вместо того, управляемых с остальной частью узлов виртуализации. Если вы реализуете System Center Virtual Machine Manager (SCVMM) для управления инфраструктурой виртуализации, то можете делегировать для физических узлов на находиться какие виртуальные машины контроллера домена и контроллерами домена сами авторизованным администраторам. Следует также учитывать, разделив объем виртуальных контроллеров домена для хранения администраторы не смогут обращаться к файлам виртуальной машины.  
  
### <a name="branch-locations"></a>Филиалах  
  
#### <a name="physical-domain-controllers-in-branches"></a>Физических контроллеров домена в ветвях

В местах, в которых находятся несколько серверов, но не защищены физически в степени, защищенные серверы центров обработки данных физических контроллеров домена должны быть настроены микросхемы доверенного платформенного МОДУЛЯ и шифрование диска BitLocker для всех томов на сервере. Если контроллер домена не может храниться в закрытом в филиалах, следует рассмотреть возможность развертывания RODC в этих расположениях.  
  
#### <a name="virtual-domain-controllers-in-branches"></a>Виртуальные контроллеры домена в ветвях

По возможности следует запускать виртуальные контроллеры домена в офисах филиалов на разных физических узлах, чем другие виртуальные машины на узле. В филиалах, в которых виртуальные контроллеры домена не может выполняться на разных физических узлах от остальной части заполнение виртуального сервера, следует реализовать микросхемы доверенного платформенного МОДУЛЯ и шифрование диска BitLocker на узлах, на которых виртуальных контроллеров домена выполняться как минимум, и все узлы, если это возможно. В зависимости от размера филиала и безопасности на физические узлы следует рассмотреть возможность развертывания RODC в филиалах.  
  
### <a name="remote-locations-with-limited-space-and-security"></a>Удаленные с ограниченной места и безопасность

Если инфраструктуры содержит расположения, в которых можно установить только один физический сервер, сервер, поддерживающий выполнение рабочих нагрузок виртуализации должен быть установлен в удаленном расположении, и необходимо настроить шифрование диска BitLocker для защиты всех тома на сервере. Одна виртуальная машина на сервере следует запускать RODC, с другими серверами, выполняющихся как отдельные виртуальные машины на узле. Сведения о планировании для развертывания RODC предоставляется в [планирования контроллера домена только для чтения и руководство по развертыванию](https://go.microsoft.com/fwlink/?LinkID=135993). Дополнительные сведения о развертывании и обеспечении безопасности виртуализированных контроллеров домена, см. в разделе [использование контроллеров домена в Hyper-V](https://technet.microsoft.com/library/dd363553(v=ws.10).aspx) на веб-сайте TechNet. Более подробные инструкции для усиления безопасности Hyper-V, делегирование управления виртуальными машинами и защиты виртуальных машин, см. в разделе [руководство по безопасности Hyper-V](https://www.microsoft.com/download/details.aspx?id=16650) Solution Accelerator на веб-сайте Майкрософт.  
  
## <a name="domain-controller-operating-systems"></a>Операционные системы контроллеров домена

Все контроллеры домена должны работать на последнюю версию Windows Server, который поддерживается в вашей организации и определения приоритетов списания устаревших операционных систем, в совокупности контроллера домена. Сохранение текущего, чтобы исключить устаревшие контроллерами домена и контроллеров домена, часто можно воспользоваться преимуществами новых функциональных возможностей и безопасности, могут оказаться недоступными в доменах или лесах с контроллерами домена под управлением предыдущих версий операционной системы. Контроллеры домена должны заново установлен и повышении уровня, а не обновлен из предыдущих операционных систем или ролей сервера; то есть не выполнять обновление на месте контроллеров домена и запустите мастер установки AD DS на серверах, на которых установлена операционная система не только что. Реализация контроллеров домена на вновь установленной, обеспечивает устаревшие файлы и параметры не остаются случайно на контроллерах домена, что позволяет упростить применение конфигурации контроллера домена, согласованную и безопасный.  
  
## <a name="secure-configuration-of-domain-controllers"></a>Безопасная настройка контроллеров домена

Ряд средств, некоторые из которых установлены по умолчанию в Windows, можно использовать для создания шаблона конфигурации начальной безопасности для контроллеров домена, которые может впоследствии применяться объекты групповой политики. Здесь описываются эти средства.  
  
### <a name="security-configuration-wizard"></a>Мастер настройки безопасности  

Все контроллеры домена должны предоставляться только при первоначальной сборки. Это можно сделать с помощью мастера настройки безопасности, который поставляется в собственном коде в Windows Server для настройки службы, реестра, системы и параметры WFAS на контроллере домена «Базовая сборка». Параметры можно сохранить и экспортировать в объект групповой Политики, который может быть связан с Подразделение контроллеров домена в каждом домене в лесу для принудительного применения Последовательная настройка контроллеров домена. Если домен содержит несколько версий операционных систем Windows, можно настроить фильтры инструментария управления Windows (WMI) для применения объектов групповой политики только к контроллерам домена под управлением соответствующей версии операционной системы.  
  
### <a name="microsoft-security-compliance-toolkit"></a>Набор средств Microsoft Security Compliance Toolkit

[Набор средств для соответствия требованиям безопасности Майкрософт](https://www.microsoft.com/download/details.aspx?id=55319) параметры контроллера домена могут быть объединены с параметрами мастер настройки безопасности для создания комплексное конфигурационных контроллеров домена, которые развертываются и применяет объекты групповой политики развернуть в Подразделение контроллеров домена в Active Directory.  
  
### <a name="rdp-restrictions"></a>Ограничения протокола удаленного рабочего СТОЛА

Объекты групповой политики, который связан на все контроллеры домена подразделения в лесу необходимо настроить для подключений по протоколу RDP только из авторизованных пользователей и систем (например, серверы перехода). Это делается с помощью сочетания параметров прав пользователей и конфигурации в режиме повышенной безопасности и должен быть реализован в объектах групповой политики, чтобы постоянно применяется данная политика. Если он пропускается, следующем обновлении групповой политики возвращает системы для его правильной конфигурации.  
  
### <a name="patch-and-configuration-management-for-domain-controllers"></a>Исправления и управления конфигурацией для контроллеров домена

Несмотря на то, что это может показаться нелогичным, рассмотрите возможность установки исправлений контроллеров домена и другие критически важные компоненты инфраструктуры отдельно от общей инфраструктуры Windows. При использовании программы управления конфигурацией предприятия для всех компьютеров в вашей инфраструктуре компрометация программное обеспечение для управления системами можно использовать для компрометации или уничтожения всех компонентов инфраструктуры, которыми управляет это по. Разделяя исправлений и управление системами для контроллеров домена из генеральной совокупности, можно уменьшить объем программное обеспечение, установленное на контроллерах домена, помимо тесно управления управление ими.
  
### <a name="blocking-internet-access-for-domain-controllers"></a>Блокировать доступ к Интернету для контроллеров домена  

Одна из проверок, которые выполнены как часть оценки безопасности Active Directory является использование и настройку Internet Explorer на контроллерах домена. Internet Explorer (или другой браузер) не следует использовать на контроллерах домена, однако проведенный анализ тысяч контроллеры домена показал множество случаев, в которых привилегированных пользователей используется Internet Explorer для просмотра внутренних сетей организации или Интернет.  
  
Как описано выше в разделе «Неправильной настройки» [способы решения](../../../ad-ds/plan/security-best-practices/Avenues-to-Compromise.md), Просмотр Интернет (или зараженные интрасети) из одного из самых мощных компьютеров в инфраструктуре Windows с помощью высоким уровнем привилегий Учетная запись (к которым относятся только те учетные записи, вход разрешен локально для контроллеров домена по умолчанию) предоставляет дополнительный риск для безопасности организации. С помощью диска, загрузки или загрузки инфицированные вредоносными программами «служебные программы», злоумышленники могут получить доступ к всем необходимым для полностью компрометации или уничтожения службы каталогов Active Directory.  
  
Несмотря на то, что Windows Server 2012, Windows Server 2008 R2, Windows Server 2008 и текущих версиях Internet Explorer обеспечивают ряд средства защиты от загрузки вредоносных программ, в большинстве случаев, в какой домен контроллеров и привилегированные учетные записи была использована для в Интернете, контроллеры домена под управлением Windows Server 2003 или защита, предлагаемая более новые операционные системы и браузеры намеренно отключен.  
  
Запуск веб-браузеров на контроллерах домена должен быть запрещен не только политикой, но и техническими средствами и контроллеры домена не должен быть разрешен доступ к Интернету. Если контроллеры домена требуется репликация между сайтами, следует реализовать безопасных соединений между сайтами. Несмотря на то, что подробных инструкций по настройке выходят за рамки данного документа, можно реализовать ряд элементов управления для ограничения возможности контроллеров домена до неправильного использования или настроен неправильно и впоследствии скомпрометированы.  
  
### <a name="perimeter-firewall-restrictions"></a>Ограничения брандмауэра периметра

Межсетевые экраны периметра должен заблокировать исходящие подключения к Интернету из контроллеров домена. Несмотря на то, что контроллеры домена может потребоваться взаимодействовать через границы узелов, межсетевые экраны периметра можно настроить для взаимодействия между сайтами, следуя инструкциям в [Настройка брандмауэра для домены и доверие](https://support.microsoft.com/kb/179442) на веб-сайте поддержки Майкрософт.  
  
### <a name="dc-firewall-configurations"></a>Параметры конфигурации брандмауэра контроллера домена  

Как уже упоминалось, следует использовать мастер настройки безопасности для записи параметров конфигурации для повышенной безопасности брандмауэра Windows на контроллерах домена. Изучите выходные данные мастер настройки безопасности, чтобы убедиться, что параметры конфигурации брандмауэра отвечает требованиям вашей организации и затем использовать объекты групповой политики для применения параметров конфигурации.  
  
### <a name="preventing-web-browsing-from-domain-controllers"></a>Предотвращение просмотра веб-страниц из контроллеров домена

Сочетание конфигурации AppLocker, конфигурацию прокси-сервера «черных дыр» и WFAS конфигурации можно использовать для предотвращения доступа к Интернету контроллеров домена и для предотвращения использования веб-браузеров на контроллерах домена.
