---
ms.assetid: 074e63e9-976c-49da-8cba-9ae0b3325e34
title: Введение в дополнительные возможности центра администрирования Active Directory (уровень 100)
description: ''
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.date: 08/07/2018
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 5b328db355810f8e3a33b28637f789e8c703d781
ms.sourcegitcommit: f3b61dcd8aa0aa744db4ea938aac633c19217b0a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/06/2019
ms.locfileid: "70746337"
---
# <a name="introduction-to-active-directory-administrative-center-enhancements-level-100"></a>Введение в дополнительные возможности центра администрирования Active Directory (уровень 100)

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Центр администрирования Active Directory в Windows Server включает функции управления для следующих компонентов:

- [Корзина Active Directory](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#ad_recycle_bin_mgmt)
- [Детализированная политика паролей](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#fine_grained_pswd_policy_mgmt)
- [Средство просмотра журнала Windows PowerShell](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#windows_powershell_history_viewer)

## <a name="ad_recycle_bin_mgmt"></a>Корзина Active Directory

Случайное удаление объектов Active Directory — это обычное дело при работе с доменными службами Active Directory (AD DS) и службами Active Directory облегченного доступа к каталогам (AD LDS). В прошлых версиях Windows Server, предшествующих Windows Server 2008 R2, можно было восстанавливать случайно удаленные объекты в Active Directory, но у решений имелись свои недостатки.

В Windows Server 2008 можно было использовать систему архивации данных Windows Server и команду принудительного восстановления **ntdsutil** , чтобы пометить объекты как заслуживающие доверия и обеспечить репликацию восстановленных данных по всему домену. Недостаток при использовании принудительного восстановления заключался в том, что его приходилось выполнять в режиме восстановления служб каталогов. В этом режиме контроллер домена, на котором выполнялось восстановление, необходимо было переводить в автономный режим. В связи с этим он не мог обрабатывать клиентские запросы.

В службе каталогов Active Directory Windows Server 2003 и доменных службах Active Directory в Windows Server 2008 можно было восстановить удаленные объекты Active Directory при помощи функции восстановления полностью удаленных объектов. Тем не менее ссылочные атрибуты восстановленных объектов (например, членство учетных записей пользователей в группах), удаленные физически, и очищенные нессылочные атрибуты не восстанавливались. Поэтому администраторы не могли полагаться на восстановление полностью удаленных объектов как на гарантированное решение при случайном удалении объектов. Дополнительные сведения о восстановлении полностью удаленных объектов см. в разделе [Восстановление полностью удаленных объектов Active Directory](https://go.microsoft.com/fwlink/?LinkID=125452).

Начиная с Windows Server 2008 R2 корзина Active Directory основана на существующей инфраструктуре восстановления полностью удаленных объектов и расширяет возможности сохранения и восстановления случайно удаленных объектов Active Directory.

Если корзина Active Directory включена, все ссылочные и нессылочные атрибуты удаленных объектов Active Directory сохраняются, а объекты полностью восстанавливаются в том же логически согласованном состоянии, в котором они находились непосредственно перед удалением. Например, восстановленные учетные записи пользователей автоматически восстанавливают все членства в группах и соответствующие права доступа, которыми они обладали внутри и вне доменов в момент перед удалением. Корзина Active Directory применяется для сред AD DS и AD LDS. Подробное описание Active Directory корзины см. в разделе [новые возможности AD DS. Active Directory корзина](https://technet.microsoft.com/library/dd391916(WS.10).aspx).

**Новые возможности** В Windows Server 2012 и более поздних версиях функция корзины Active Directory, дополненная новым графическим интерфейсом пользователя для управления и восстановления удаленных объектов. Теперь пользователи могут просмотреть список удаленных объектов и восстановить их в исходное или желаемое местоположение.

Если вы планируете включить Active Directory корзину в Windows Server, примите во внимание следующее.

- По умолчанию корзина Active Directory отключена. Чтобы включить его, необходимо сначала повысить режим работы леса AD DS или среды AD LDS до Windows Server 2008 R2 или более поздней версии. Это, в свою очередь, требует, чтобы все контроллеры домена в лесу или все серверы, на которых размещаются экземпляры AD LDS наборов конфигурации, выполнялись под Windows Server 2008 R2 или более поздней версии.
- Процесс включения корзины Active Directory необратим. После включения корзины Active Directory для конкретной среды отключить ее будет нельзя.
- Чтобы управлять функцией очистки корзины через пользовательский интерфейс, необходимо установить версию центр администрирования Active Directory в Windows Server 2012.

    > [!NOTE]
    > **Диспетчер сервера** можно использовать для установки средства удаленного администрирования сервера (RSAT), чтобы использовать правильную версию центр администрирования Active Directory для управления корзиной через пользовательский интерфейс.
    >
    > Дополнительные сведения об установке RSAT см. в статье [средства удаленного администрирования сервера](https://docs.microsoft.com/windows-server/remote/remote-server-administration-tools).

### <a name="active-directory-recycle-bin-step-by-step"></a>Пошаговое руководство по использованию корзины Active Directory

На следующих шагах вы будете использовать ADAC для выполнения следующих задач Active Directory корзины в Windows Server 2012:

- [Шаг 1. Повышение функционального уровня леса](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_raise_ffl)
- [Шаг 2. Включение корзины](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_enable_recycle_bin)
- [Шаг 3. Создание тестовых пользователей, групп и подразделений](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_test_env)
- [Шаг 4. Восстановление удаленных объектов](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_restore_del_obj)

> [!NOTE]
> Для выполнения следующих шагов требуется членство в группе администраторов предприятия или эквивалентные разрешения.

### <a name="bkmk_raise_ffl"></a>Шаг 1. Повышение режима работы леса

В этом шаге вы повысите режим работы леса. Перед включением Active Directory корзины необходимо сначала повысить функциональный уровень в целевом лесу до Windows Server 2008 R2.

#### <a name="to-raise-the-functional-level-on-the-target-forest"></a>Чтобы повысить режим работы целевого леса:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. Щелкните целевой домен в левой области навигации и на панели **Задачи** выберите **Повышение режима работы леса**. Выберите функциональный уровень леса не ниже Windows Server 2008 R2 или более поздней версии, а затем нажмите кнопку **ОК**.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Set-ADForestMode -Identity contoso.com -ForestMode Windows2008R2Forest -Confirm:$false
```

Для аргумента **-Identity** укажите полное доменное имя DNS.

### <a name="bkmk_enable_recycle_bin"></a>Шаг 2. Включить корзину

В этом шаге вы включите корзину для восстановления удаленных объектов в AD DS.

#### <a name="to-enable-active-directory-recycle-bin-in-adac-on-the-target-domain"></a>Чтобы включить корзину Active Directory в центре администрирования Active Directory в целевом домене:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. В области **задач** щелкните **Включить корзину...** , нажмите кнопку **ОК** в предупреждающем сообщении, а затем нажмите кнопку **ОК** для обновления сообщения центра администрирования Active Directory.

4. Нажмите клавишу F5, чтобы обновить центр администрирования Active Directory.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Enable-ADOptionalFeature -Identity 'CN=Recycle Bin Feature,CN=Optional Features,CN=Directory Service,CN=Windows NT,CN=Services,CN=Configuration,DC=contoso,DC=com' -Scope ForestOrConfigurationSet -Target 'contoso.com'
```

### <a name="bkmk_create_test_env"></a>Шаг 3. Создание тестовых пользователей, группы и подразделения

В следующих процедурах вы создадите двух тестовых пользователей. Затем вы создадите группу проверки и добавите в нее тестовых пользователей. Вы также создадите подразделение.

#### <a name="to-create-test-users"></a>Чтобы создать тестовых пользователей:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. На панели **Задачи** выберите **Создать** и щелкните **Пользователь**.

    ![Введение в центр администрирования AD](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/ADDS_ADACNewUser.gif)

4. Введите следующие сведения в раздел **Учетная запись** и нажмите кнопку "ОК":

   - Полное имя: test1
   - Вход пользователя (SamAccountName): test1
   - Парольp@ssword1
   - Подтверждение пароля:p@ssword1

5. Повторите предыдущие шаги, чтобы создать второго пользователя, test2.

#### <a name="to-create-a-test-group-and-add-users-to-the-group"></a>Чтобы создать группу проверки и добавить в нее пользователей:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.
2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.
3. На панели **Задачи** выберите **Создать** и щелкните **Группа**.
4. Введите следующие сведения в раздел **Группа** и нажмите кнопку **ОК**:

    -   **Имя группы: group1**

5. Щелкните **group1** и в области**задач** выберите **Свойства**.
6. Щелкните **Члены группы**, выберите команду **Добавить**, введите **test1;test2**и нажмите кнопку **ОК**.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Add-ADGroupMember -Identity group1 -Member test1
```

#### <a name="to-create-an-organizational-unit"></a>Чтобы создать подразделение:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.
2. Щелкните **Управление**, щелкните **Добавить узлы навигации** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов навигации** и нажмите кнопку * * ОК.
3. На панели **Задачи** выберите **Создать** и щелкните **Подразделение**.
4. Введите следующие сведения в раздел **Подразделение** и нажмите кнопку **ОК**:

   - **NameOU1**

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
1..2 | ForEach-Object {New-ADUser -SamAccountName test$_ -Name "test$_" -Path "DC=fabrikam,DC=com" -AccountPassword (ConvertTo-SecureString -AsPlainText "p@ssword1" -Force) -Enabled $true}
New-ADGroup -Name "group1" -SamAccountName group1 -GroupCategory Security -GroupScope Global -DisplayName "group1"
New-ADOrganizationalUnit -Name OU1 -Path "DC=fabrikam,DC=com"
```

### <a name="bkmk_restore_del_obj"></a>Шаг 4. Восстановление удаленных объектов

В следующих процедурах вы восстановите удаленные объекты из контейнера **Удаленные объекты** в их исходное расположение и в другое расположение.

#### <a name="to-restore-deleted-objects-to-their-original-location"></a>Чтобы восстановить удаленные объекты в их исходное расположение:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. Выберите пользователей **test1** и **test2**, щелкните **Удалить** в области **задач** и нажмите кнопку **Да** , чтобы подтвердить удаление.

    ![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

    Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

    ```powershell
    Get-ADUser -Filter 'Name -Like "*test*"'|Remove-ADUser -Confirm:$false
    ```

4. Перейдите в контейнер **Deleted Objects** , выберите **test2** и **test1** , а затем щелкните **Восстановить** на панели **Задачи** .

5. Чтобы убедиться, что объекты были восстановлены в их исходное расположение, перейдите в целевой домен и проверьте, указаны ли там учетные записи пользователей.

    > [!NOTE]
    > Если вы перейдете к разделу **Свойства** в учетных записях пользователей **test1** и **test2** , а затем щелкните **Член групп**, вы увидите, что их членство в группах также было восстановлено.

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

```powershell
Get-ADObject -Filter 'Name -Like "*test*"' -IncludeDeletedObjects | Restore-ADObject
```

#### <a name="to-restore-deleted-objects-to-a-different-location"></a>Чтобы восстановить удаленные объекты в другое расположение:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. Выберите пользователей **test1** и **test2**, щелкните **Удалить** в области **задач** и нажмите кнопку **Да** , чтобы подтвердить удаление.

4. Перейдите в контейнер **Deleted Objects**, выберите **test2** и **test1**, а затем щелкните **Восстановить в** на панели **Задачи**.

5. Выберите **OU1**, а затем нажмите кнопку **ОК**.

6. Чтобы убедиться, что объекты были восстановлены в расположение **OU1**, перейдите в целевой домен, дважды щелкните **OU1** и проверьте, указаны ли там учетные записи пользователей.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Get-ADObject -Filter 'Name -Like "*test*"' -IncludeDeletedObjects | Restore-ADObject -TargetPath "OU=OU1,DC=contoso,DC=com"
```

## <a name="fine_grained_pswd_policy_mgmt"></a>Детализированная политика паролей

Операционная система Windows Server 2008 предоставляет организациям возможность определить разные политики паролей и блокировки учетных записей для разных групп пользователей в домене. В доменах Active Directory до Windows Server 2008 ко всем пользователям в домене можно было применить только одну политику паролей и политику блокировки учетных записей. Эти политики устанавливались в политике домена по умолчанию. В результате организации, которые хотели установить разные параметры паролей и блокировки учетных записей для разных групп пользователей, были вынуждены либо создавать фильтр паролей, либо развертывать несколько доменов. Оба варианта требуют высоких затрат.

При помощи детально настроенных политик паролей можно задать несколько политик паролей в одном домене и применять различные ограничения в рамках политик паролей и блокировки учетных записей для разных групп пользователей в домене. Например, для учетных записей привилегированных пользователей можно установить более строгие параметры, а для остальных — менее строгие. В других случаях можно применять особую политику паролей для учетных записей, пароли которых синхронизируются с другими источниками данных. Подробное описание политик с детализированными паролями см. в разделе [AD DS: Детализированные политики паролей](https://technet.microsoft.com/library/cc770394(WS.10).aspx)

**Новые возможности**

В Windows Server 2012 и более поздних версиях более точное управление политиками паролей стало проще и более наглядным, предоставляя пользовательский интерфейс для AD DS администраторов для управления ими в ADAC. Теперь администраторы могут просматривать результирующую политику данного пользователя, просматривать и сортировать все политики паролей в пределах заданного домена и визуально управлять отдельными политиками паролей.

Если вы планируете использовать детальные политики паролей в Windows Server 2012, примите во внимание следующее.

- Детализированные политики паролей применяются только к глобальным группам безопасности и объектам-пользователям (или объектам inetOrgPerson, если они используются вместо пользовательских объектов). По умолчанию только члены группы администраторов домена могут устанавливать детально настроенные политики паролей. Однако вы также можете делегировать возможность настройки этих политик другим пользователям. Домен должен иметь режим работы Windows Server 2008 или выше.

- Для администрирования детальных политик паролей с помощью графического пользовательского интерфейса необходимо использовать Windows Server 2012 или более новую версию центр администрирования Active Directory.

    > [!NOTE]
    > **Диспетчер сервера** можно использовать для установки средства удаленного администрирования сервера (RSAT), чтобы использовать правильную версию центр администрирования Active Directory для управления корзиной через пользовательский интерфейс.
    >
    > Дополнительные сведения об установке RSAT см. в статье [средства удаленного администрирования сервера](https://docs.microsoft.com/windows-server/remote/remote-server-administration-tools).

### <a name="fine-grained-password-policy-step-by-step"></a>Пошаговое руководство по использованию детально настроенной политики паролей

В следующей пошаговой процедуре вы используете центр администрирования Active Directory для выполнения следующих задач, связанных с детально настроенной политикой паролей:

- [Шаг 1. Повышение режима работы домена](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_raise_dfl)
- [Шаг 2. Создание тестовых пользователей, групп и подразделений](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk2_test_fgpp)
- [Шаг 3. Создание новой детальной политики паролей](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_fgpp)
- [Шаг 4. Просмотр результирующего набора политик для пользователя](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_view_resultant_fgpp)
- [Шаг 5. Изменение детальной политики паролей](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_edit_fgpp)
- [Шаг 6. Удаление детальной политики паролей](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_delete_fgpp)

> [!NOTE]
> Для выполнения следующих шагов требуется членство в группе администраторов домена или эквивалентные разрешения.

#### <a name="bkmk_raise_dfl"></a>Шаг 1. Повышение режима работы домена

В следующей процедуре выполняется повышение режима работы домена целевого домена до Windows Server 2008 или более поздней версии. Для обеспечения детальных политик паролей требуется функциональный уровень домена Windows Server 2008 или более поздней версии.

##### <a name="to-raise-the-domain-functional-level"></a>Чтобы повысить режим работы домена:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. Щелкните целевой домен в левой области навигации и в области **Задачи** выберите **Повышение режима работы домена**. Выберите функциональный уровень леса не ниже Windows Server 2008 или более поздней версии, а затем нажмите кнопку **ОК**.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Set-ADDomainMode -Identity contoso.com -DomainMode 3
```

#### <a name="bkmk2_test_fgpp"></a>Шаг 2. Создание тестовых пользователей, группы и подразделения

Чтобы создать тестовых пользователей и группу, необходимые для этого шага, выполните процедуры, описанные здесь: [Шаг 3. Создание тестовых пользователей, групп и](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_test_env) подразделений (для демонстрации детальной политики паролей не нужно создавать подразделение).

#### <a name="bkmk_create_fgpp"></a>Шаг 3. Создание новой детально настроенной политики паролей

В следующей процедуре вы создадите новую детально настроенную политику паролей при помощи пользовательского интерфейса в центре администрирования Active Directory.

##### <a name="to-create-a-new-fine-grained-password-policy"></a>Чтобы создать новую детально настроенную политику паролей:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. В области навигации центра администрирования Active Directory откройте контейнер **System** и щелкните **Password Settings Container**.

4. В области **задач** выберите **Создать**и щелкните **Параметры паролей**.

    Заполните или измените содержимое полей на странице свойств, чтобы создать новый объект **Параметры паролей** . Требуются поля **Имя** и **Приоритет** .

    ![Введение в центр администрирования AD](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/ADDS_ADACNewFGPP.gif)

5. Рядом с пунктом **Применяется напрямую к**, **Добавить**, введите **group1**и нажмите кнопку **ОК**.

    В результате объект политики паролей будет связан с членами глобальной группы, которую вы создали для тестовой среды.

6. Нажмите кнопку **ОК** , чтобы подтвердить создание.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
New-ADFineGrainedPasswordPolicy TestPswd -ComplexityEnabled:$true -LockoutDuration:"00:30:00" -LockoutObservationWindow:"00:30:00" -LockoutThreshold:"0" -MaxPasswordAge:"42.00:00:00" -MinPasswordAge:"1.00:00:00" -MinPasswordLength:"7" -PasswordHistoryCount:"24" -Precedence:"1" -ReversibleEncryptionEnabled:$false -ProtectedFromAccidentalDeletion:$true
Add-ADFineGrainedPasswordPolicySubject TestPswd -Subjects group1
```

#### <a name="bkmk_view_resultant_fgpp"></a>Шаг 4. Просмотр результирующего набора политик для пользователя

В следующей процедуре вы увидите результирующие параметры пароля для пользователя, который является членом группы, которой назначена детальная политика паролей на [шаге 3. Создайте новую политику](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_fgpp)детализации паролей.

##### <a name="to-view-a-resultant-set-of-policies-for-a-user"></a>Чтобы просмотреть результирующую политику для пользователя:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. Выберите пользователя **test1** , принадлежащего группе, группа **group1** , в [которой вы сопоставлены детализированную политику паролей на шаге 3. Создайте новую политику](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_fgpp)детализации паролей.

4. Щелкните **Просмотреть итоговые параметры пароля** в области**задач**.

5. Изучите политику параметров паролей и нажмите кнопку **Отмена**.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Get-ADUserResultantPasswordPolicy test1
```

#### <a name="bkmk_edit_fgpp"></a>Шаг 5. Изменение детально настроенной политики паролей

В следующей процедуре будет изменена политика с детализированным изменением паролей, созданная на [шаге 3. Создание новой детальной политики паролей](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_fgpp)

##### <a name="to-edit-a-fine-grained-password-policy"></a>Чтобы изменить детально настроенную политику паролей:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. В **области навигации** центра администрирования Active Directory разверните узел **Система** и щелкните **Контейнер параметров пароля**.

4. Выберите политику детализированных паролей, созданную на [шаге 3. Создайте новую политику](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_fgpp) с детализированными паролями и щелкните **Свойства** в области **задачи** .

5. В разделе **Вести журнал паролей** измените значение параметра **Сохранено паролей** на **30**.

6. Нажмите кнопку **ОК**.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Set-ADFineGrainedPasswordPolicy TestPswd -PasswordHistoryCount:"30"
```

#### <a name="bkmk_delete_fgpp"></a>Шаг 6. Удаление детально настроенной политики паролей

##### <a name="to-delete-a-fine-grained-password-policy"></a>Чтобы удалить детально настроенную политику паролей:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. В области навигации центра администрирования Active Directory разверните контейнер **System** и щелкните **Password Settings Container**.

4. Выберите политику детализированных паролей, созданную на [шаге 3. Создайте новую политику](../../../ad-ds/get-started/adac/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-.md#bkmk_create_fgpp) детализации паролей и в области **задачи** щелкните **Свойства**.

5. Очистите чекбокс **Защитить от случайного удаления** и нажмите кнопку **ОК**.

6. Выберите детально настроенную политику паролей и нажмите **Удалить** на панели **Задачи**.

7. В диалоговом окне подтверждения нажмите кнопку **ОК**.

![Введение в центр администрирования AD.](media/Introduction-to-Active-Directory-Administrative-Center-Enhancements--Level-100-/PowerShellLogoSmall.gif)***<em>эквивалентные команды Windows PowerShell</em>***

Следующие командлеты Windows PowerShell выполняют ту же функцию, что и предыдущая процедура. Вводите каждый командлет в одной строке, несмотря на то, что здесь они могут отображаться разбитыми на несколько строк из-за ограничений форматирования.

```powershell
Set-ADFineGrainedPasswordPolicy -Identity TestPswd -ProtectedFromAccidentalDeletion $False
Remove-ADFineGrainedPasswordPolicy TestPswd -Confirm
```

## <a name="windows_powershell_history_viewer"></a>Средство просмотра журнала Windows PowerShell

Центр администрирования Active Directory — это инструмент пользовательского интерфейса, который представляет собой надстройку Windows PowerShell. В Windows Server 2012 и более поздних версиях ИТ – администраторы могут использовать ADAC для изучения командлетов Windows PowerShell для Active Directory с помощью средства просмотра журнала Windows PowerShell. При выполнении действий в пользовательском интерфейсе пользователь видит эквивалентную команду Windows PowerShell в средстве просмотра журнала Windows PowerShell. Это позволяет администраторам создавать автоматические сценарии и сокращать повторяющиеся задачи, тем самым повышая производительность ИТ-ресурсов. Кроме того, эта функция сокращает время на изучение Windows PowerShell для Active Directory и повышает уверенность пользователей в соответствии со своими сценариями автоматизации.

При использовании средства просмотра журнала Windows PowerShell в Windows Server 2012 или более поздней версии примите во внимание следующее.

- Чтобы использовать средство просмотра сценариев Windows PowerShell, необходимо использовать Windows Server 2012 или более поздней версии ADAC

    > [!NOTE]
    > **Диспетчер сервера** можно использовать для установки средства удаленного администрирования сервера (RSAT), чтобы использовать правильную версию центр администрирования Active Directory для управления корзиной через пользовательский интерфейс.
    >
    > Дополнительные сведения об установке RSAT см. в статье [средства удаленного администрирования сервера](https://docs.microsoft.com/windows-server/remote/remote-server-administration-tools).

- Получите базовое представление о Windows PowerShell. Например, вам нужно знать принципы конвейерной передачи в Windows PowerShell. Дополнительные сведения о конвейерной передаче в Windows PowerShell см. в разделе [Конвейерная передача и конвейер в Windows PowerShell](https://technet.microsoft.com/library/ee176927.aspx).

### <a name="windows-powershell-history-viewer-step-by-step"></a>Пошаговое руководство по использованию средства просмотра журнала Windows PowerShell

В следующей процедуре вы используете средство просмотра журнала Windows PowerShell в центре администрирования Active Directory для создания сценария Windows PowerShell.  Прежде чем приступить к этой процедуре, удалите пользователя **test1** из группы **group1**.

#### <a name="to-construct-a-script-using-powershell-history-viewer"></a>Чтобы создать сценарий с помощью средства просмотра журнала PowerShell:

1. Щелкните правой кнопкой мыши значок Windows PowerShell, выберите команду **Запуск от имени администратора** и введите **дсак. exe** , чтобы открыть ADAC.

2. Щелкните **Управление**, **Добавить узлы перехода** и выберите соответствующий целевой домен в диалоговом окне **Добавление узлов перехода** , а затем нажмите кнопку **ОК**.

3. Разверните область **Журнал Windows PowerShell** внизу окна центра администрирования Active Directory.

4. Выберите пользователя **test1**.

5. Нажмите кнопку **Добавить в группу...** в области **задачи** .

6. Перейдите в группу **group1** и нажмите кнопку **ОК** в диалоговом окне.

7. Перейдите в область **Журнал Windows PowerShell** и найдите только что созданную команду.

8. Скопируйте эту команду и вставьте ее в предпочтительный редактор для создания сценария.

    Например, вы можете изменить команду, чтобы добавить другого пользователя в группу **group1** или чтобы добавить пользователя **test1** в другую группу.

## <a name="see-also"></a>См. также

[Расширенное управление AD DS с &#40;использованием центр администрирования Active Directory уровня 200&#41;](Advanced-AD-DS-Management-Using-Active-Directory-Administrative-Center--Level-200-.md)
