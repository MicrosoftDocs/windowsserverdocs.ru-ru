---
ms.assetid: 4cc9c16c-1928-4dce-a3a8-6229be28eb65
title: Понятия репликации Active Directory
description: ''
author: MicrosoftGuyJFlo
ms.author: joflore
manager: mtillman
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 087dee7c914b81d97c6cf3a2ea985d809cb57fe6
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59812355"
---
# <a name="active-directory-replication-concepts"></a>Понятия репликации Active Directory

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Прежде чем проектирование топологии сайтов, ознакомиться с некоторые основные понятия репликации Active Directory.  
  
-   [Объект соединения](#BKMK_1)  
  
-   [KCC](#BKMK_2)  
  
-   [Функциональные возможности отработки отказа](#BKMK_3)  
  
-   [Подсети](#BKMK_4)  
  
-   [Сайт](#BKMK_5)  
  
-   [Связь сайтов](#BKMK_6)  
  
-   [Мост связей сайтов.](#BKMK_7)  
  
-   [Транзитивность сайта ссылку](#BKMK_8)  
  
-   [Сервер глобального каталога](#BKMK_9)  
  
-   [Кэширование членства в универсальных группах](#BKMK_10)  
  
## <a name="BKMK_1"></a>Объект соединения  
Объект подключения — это объект, представляющий подключение репликации с исходного контроллера домена на конечный контроллер домена Active Directory. Контроллер домена является членом одного сайта и представленного в узле объект сервера в доменных службах Active Directory (AD DS). Каждый объект сервера имеет дочерний объект параметров NTDS, представляющий репликацию контроллера домена на сайте.  
  
Объект соединения является потомком объекта параметров NTDS на целевом сервере. Для репликации между контроллерами домена один объект server должен иметь объект соединения, который представляет входящую репликацию от другого. Все подключения репликации для контроллера домена, хранятся как объекты соединения в объекте параметров NTDS. Объект соединения определяет исходного сервера репликации, содержит расписание репликации и указывает транспорт репликации.  
  
Проверки согласованности знаний (KCC) автоматически создает объекты соединения, но они также могут быть созданы вручную. Объекты подключения, созданные средством KCC отображаются в Active Directory — сайты и оснастка служб в качестве **<automatically generated>** и считаются достаточно при нормальных рабочих условиях. Объекты подключения, созданные администраторам созданные вручную объекты подключений. Объект подключения, созданные вручную определяется имя, назначенное администратором при его создании. При изменении **<automatically generated>** объектов подключения, преобразовать его в объект административно измененный подключения и объект отображается в виде идентификатора GUID. Средство проверки согласованности ЗНАНИЙ не вносит изменения в объекты соединения вручную или измененные.  
  
## <a name="BKMK_2"></a>ПРИ ПРОВЕРКЕ СОГЛАСОВАННОСТИ ЗНАНИЙ  
KCC — это встроенные процесс, который выполняется на всех контроллерах домена и создает топологию репликации для леса Active Directory. KCC создает отдельный топологий, в зависимости от того, выполняется ли репликация в пределах сайта (внутрисайтовая) или между сайтами (межсайтовых). KCC автоматически меняет топологии для реализации возможности добавления новых контроллеров домена, удаление существующих контроллеров домена, перемещение контроллеров домена и из узлов, изменив затраты и расписания и контроллерам домена временно недоступна или в состоянии ошибки.  
  
Внутри сайта соединения между контроллерами домена с возможностью записи, всегда расположены в двунаправленный кольцом, с помощью дополнительных прямые подключения, чтобы уменьшить задержки при передаче больших веб-узлов. С другой стороны межсайтовой топологии — это расположение связующего дерева, что означает одно межсайтовое подключение между любыми двумя сайтами, для каждого раздела каталога и обычно не содержит прямые подключения. Дополнительные сведения об охвате деревьев и топологию репликации Active Directory, см. в разделе Active Directory репликации технической справке по топологии ([https://go.microsoft.com/fwlink/?LinkID=93578](https://go.microsoft.com/fwlink/?LinkID=93578)).  
  
На каждом контроллере домена средство проверки согласованности ЗНАНИЙ создает маршруты репликации путем создания объектов одностороннее входящее подключение, которые определяют соединения с другими контроллерами домена. Для контроллеров домена на том же сайте KCC создает объекты соединения автоматически без вмешательства администратора. При наличии нескольких сайтов, настройте связи сайтов между сайтами и единый KCC на каждом сайте автоматически создает подключения между сайтами, а также.  
  
### <a name="kcc-improvements-for-windows-server-2008-rodcs"></a>При проверке согласованности ЗНАНИЙ улучшения для Windows Server 2008 RODC  

Существует ряд улучшений KCC в соответствии с контроллера домена с новым доступным только для чтения (RODC), в Windows Server 2008. Сценарий стандартного развертывания для RODC — филиала. Топологии репликации Active Directory, наиболее часто развертывается в этом сценарии основанное на структуре концентратор и спица, где контроллеров доменов филиалов в нескольких узлах репликации с небольшим числом серверов-плацдармов на концентраторе.  
  
Одним из преимуществ развертывания RODC в этом сценарии является однонаправленным репликации. Серверы-плацдармы не требуются для репликации с контроллеров RODC, что сокращает администрирования и использования сети.  
  
Тем не менее, административные трудность, выделенные с помощью Звездообразная топология в предыдущих версиях операционной системы Windows Server — после добавления нового контроллера домена узлового в концентраторе, это автоматический механизм для распространения отсутствует подключения репликации между контроллеров доменов филиалов и центральных контроллеров домена, чтобы воспользоваться преимуществами нового контроллера домена концентратора.  
  
Для контроллеров домена Windows Server 2003, можно повторно сбалансировать рабочую нагрузку с помощью такого средства, как Adlb.exe из Windows Server 2003 Branch Office руководстве по развертыванию ([https://go.microsoft.com/fwlink/?LinkID=28523](https://go.microsoft.com/fwlink/?LinkID=28523)).  
  
Для Windows Server 2008 RODC работать в нормальном режиме KCC предоставляет некоторые перераспределения, что устраняет необходимость использовать дополнительный инструмент вроде Adlb.exe. Новые функциональные возможности включены по умолчанию. Его можно отключить, добавив следующий раздел реестра на RODC:  
  
**HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NTDS\Parameters**  
  
**«Случайное BH Loadbalancing разрешено»**  
**1 = включено (по умолчанию), 0 = отключено**  
  
Дополнительные сведения о работе этих улучшений KCC см. в разделе Планирование и развертывание доменных служб Active Directory для филиалов ([https://go.microsoft.com/fwlink/?LinkId=107114](https://go.microsoft.com/fwlink/?LinkId=107114)).  
  
## <a name="BKMK_3"></a>Функциональные возможности отработки отказа  
Сайты убедитесь, что репликации направляется вокруг сбои сети и отключенные контроллеры домена. KCC работает с заданными интервалами, чтобы настроить топологию репликации для изменений, произошедших в AD DS, например при добавлении новых контроллеров домена и новые сайты создаются. KCC просматривает состояние репликации существующих соединений, чтобы определить, если все подключения не работают. Если подключение не работает из-за неисправного контроллера домена, KCC автоматически создает временные соединения с другими партнерами репликации (при наличии) чтобы убедиться, что репликации. Если все контроллеры домена в сайте недоступны, KCC автоматически создает подключения репликации между контроллерами домена, с другого сайта.  
  
## <a name="BKMK_4"></a>Подсети  
Подсеть — сегмент сети TCP/IP, которому назначены набор логических IP-адресов. Подсети группирования компьютеров способом, который определяет их физического местонахождения в сети. Объекты подсети в Доменных службах Active Directory определить сетевые адреса, которые используются для сопоставления компьютеров к сайтам.  
  
## <a name="BKMK_5"></a>Сайт  
Сайты, объектов Active Directory, которые представляют одну или несколько подсетей TCP/IP с надежной и быстрой сетевыми подключениями. Сведения о сайте позволяет администраторам настроить доступ к Active Directory и репликации, чтобы оптимизировать использование физической сети. Объекты сайтов связаны с набором подсетей и связан с сайтом Active Directory в соответствии с его IP-адрес каждого контроллера домена в лесу. Узлы можно разместить контроллеры домена из более чем одного домена и домена могут быть представлены в нескольких сайтах.  
  
## <a name="BKMK_6"></a>Связь сайтов  
Ссылки на сайты связываются объекты Active Directory, представляющие логические пути, используемые при проверке согласованности ЗНАНИЙ для установления соединения для репликации Active Directory. Объект связи сайтов представляет набор узлов, которые могут обмениваться данными через указанный межсайтовый транспорт унифицированными затратами.  
  
Все узлы, содержащиеся в этой связи сайтов, считаются должен быть подключен с помощью одного типа сети. Сайты должны быть вручную связаны с другими сайтами с помощью связей сайтов, чтобы контроллеры домена в одном сайте может репликация изменений каталога из контроллеров домена в другой сайт. Так как фактический путь, по сетевых пакетов в физической сети во время репликации не соответствуют связи сайтов, необязательно создавать ссылки избыточный веб-узел для повышения эффективности репликации Active Directory.  
  
Если двумя сайтами соединены посредством связи сайтов, система репликации автоматически создает подключений между контроллерами домена на каждом сайте, которые вызываются серверы-плацдармы. В Windows Server 2008 все контроллеры домена в сайте, на которых размещены одного раздела каталога являются кандидатами на выбранной как серверы-плацдармы. Подключения репликации, созданные средством KCC случайным образом распределены все серверы-плацдармы кандидатом на узле для совместного использования рабочей нагрузки репликации. По умолчанию случайного выбора процесса выполняется только один раз, когда объекты подключения сначала добавляются к сайту.  
  
## <a name="BKMK_7"></a>Мост связей сайтов.  
Мост связей сайтов является объект Active Directory, представляющий набор связей сайтов, сайты, для которых могут взаимодействовать, используя общий транспорт. Мосты связей сайтов включить контроллеры домена, которые не связаны напрямую с помощью канала связи, чтобы реплицировать друг с другом. Как правило мост связей сайтов соответствует маршрутизатор (или набор маршрутизаторы) на IP-сети.  
  
По умолчанию KCC может формировать транзитивное маршрут через связи всех сайтов, имеют некоторые сайты Общие. Если это поведение можно отключить, ссылки на каждый узел представляет собственную отдельную и изолированную сеть. Наборы связей сайтов, который может рассматриваться как один маршрут выражаются через мост связей сайтов. Каждому мосту представляет изолированную коммуникационную среду для сетевого трафика.  
  
Мосты связей сайтов представляют собой механизм для логического представления транзитивное физического подключения между сайтами. Мост связей сайтов позволяет при проверке согласованности ЗНАНИЙ использовать любое сочетание связей сайтов, включенные для определения самого дешевого маршрута для соединения разделов каталога, хранящиеся в этих сайтах. Мост связей сайтов не предоставляет возможности подключения к контроллерам домена. Если удаляется моста связей сайтов, репликация по связи объединенный сайтов будет продолжаться до KCC удаляет ссылки.  
  
Мосты связей сайтов необходимы только в случае, если на узле имеется контроллер домена, содержащий раздел каталога, который также не размещается на контроллере домена в соседнем узле, а контроллер домена, содержащий этот раздел каталога в один или несколько других сайтов в лес. Соседние узлы определяются как два или более узлов, включенных в связь один сайт.  
  
Мост связей сайтов создает логическое соединение между две связи сайтов, указав транзитивное путь между двумя сайтами отключенной, используя промежуточный сайт. В рамках генератор межсайтовой топологии (ISTG) мост подразумевает физическое подключение с помощью промежуточного узла. Мост не означает, что контроллер домена в промежуточный сайт будет предоставлять путь репликации. Тем не менее это может случиться, если промежуточный узел содержится контроллер домена, которая размещена реплицировать раздел каталога, в этом случае мост связей сайтов не требуется.  
  
Добавляется стоимость каждой связи сайтов, создании суммарные затраты для результирующий контур. Если промежуточный сайт не содержит контроллер домена, содержащий раздел каталога и ссылку ниже стоимость не существует, будет использоваться моста связей сайтов. Если промежуточный сайт содержит контроллер домена, на котором размещается данный раздел каталога, два отключенных сайта будет настройки репликации подключений к контроллеру домена, промежуточные и не использовать мост.  
  
## <a name="BKMK_8"></a>Транзитивность сайта ссылку  
По умолчанию все ссылки на сайты связываются транзитивное или через «мост». При связи сайтов соединены и расписаний перекрываются, KCC создает подключения репликации, которые определяют партнеров репликации контроллера домена между сайтами, где сайты не связаны напрямую связи сайтов, но подключены через транзитивно набор общих сайтов. Это означает, что можно соединиться с любого сайта другого сайта благодаря сочетанию связей сайтов.  
  
В общем случае для полноценной маршрутизацией сети, вы не обязательно для создания любого сайта мостов связей сайтов, если вы не хотите управлять потоком репликации изменений. Если сеть не маршрутизирована полностью, мосты связей сайтов должны создаваться во избежание попыток репликации невозможно. Все связи сайтов для определенного транспорта неявно принадлежат к одной связи сайтов для этого транспорта. Привязки по умолчанию для связи сайтов происходит автоматически, а не объект Active Directory представляет этого моста. **Мостами все ссылки на узел** параметра, в свойствах IP-адрес и передачи протокола SMTP (Simple Mail) контейнеры межсайтового транспорта, реализующий функцию.  
  
> [!NOTE]  
> SMTP-репликации не будут поддерживаться в будущих версиях AD DS; Таким образом создание узла ссылки объектов в контейнере SMTP не рекомендуется.  
  
## <a name="BKMK_9"></a>Сервер глобального каталога  
Сервер глобального каталога является контроллером домена, в которой хранятся сведения обо всех объектах в лесу, чтобы приложения можно найти AD DS без обращения к определенные контроллеры домена, которые хранят запрошенные данные. Как и все контроллеры домена сервер глобального каталога хранит полных, доступный для записи реплик разделов каталога схемы и конфигурации и полных, доступный для записи реплики раздела каталога домена для домена, на котором он размещен. Кроме того сервер глобального каталога хранится реплика разделяемый, только для чтения всех других доменов в лесу. Домена частичная, только для чтения реплики содержат каждый объект в домене, но только ограниченный набор атрибутов (атрибутов, которые чаще всего используются для поиска объекта).  
  
## <a name="BKMK_10"></a>Кэширование членства в универсальных группах  
Кэширование членства в универсальных группах позволяет контроллеру домена кэша о членстве универсальной группы для пользователей. Вы можете включить контроллеры домена под управлением Windows Server 2008 на членство в универсальной группе кэша с помощью Active Directory — сайты и службы.  
  
Включение кэширования членства в универсальных группах устраняет потребность в сервере глобального каталога на каждом сайте в домене, что сводит к минимуму использование пропускной способности сети, так как контроллер домена не нужно реплицировать все объекты, расположенные в лесу. Это также уменьшает время входа в систему так, как проверка подлинности контроллеров домена не всегда требуется доступ к глобального каталога для получения сведений о членстве универсальной группы. Дополнительные сведения о том, когда следует использовать кэширование членства в универсальных группах, см. в разделе [планирование размещения сервера глобального каталога](../../../ad-ds/plan/Planning-Global-Catalog-Server-Placement.md).  
  


