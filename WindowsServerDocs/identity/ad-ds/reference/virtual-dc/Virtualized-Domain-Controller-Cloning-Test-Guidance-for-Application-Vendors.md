---
ms.assetid: fde99b44-cb9f-49bf-b888-edaeabe6b88d
title: "Руководство по тестированию для поставщиков приложений клонирования виртуализированного контроллера домена"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 72c4e818f82d3252c45776b26fb59e095893f2c7
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="virtualized-domain-controller-cloning-test-guidance-for-application-vendors"></a>Руководство по тестированию для поставщиков приложений клонирования виртуализированного контроллера домена

>Область применения: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе объясняется поставщиков приложений следует учитывать для обеспечения доступности свое приложение продолжает работать корректно после завершения Виртуализированный контроллер домена (DC) процесса клонирования. Рассматриваются аспекты процесса клонирования, интерес поставщиков приложений и сценариев, которые может потребовать дополнительного тестирования. Разработчики приложений, специально проверенными что свое приложение работает в виртуализированных контроллеров домена, созданы, рекомендуется имя приложения, в содержимое сообщества в нижней части этого раздела, а также ссылку на веб-сайт вашей организации, где пользователям можно получить дополнительные сведения о проверке списка.  
  
## <a name="overview-of-virtualized-dc-cloning"></a>Общие сведения о виртуализированных клонирование контроллера домена  
Виртуализированный контроллер домена процесса клонирования подробно описана в [Знакомство с виртуализацией доменных служб Active Directory (AD DS) (уровень 100)](https://technet.microsoft.com/library/hh831734.aspx) и [домена контроллера технического справочника по виртуализированным (уровень 300)](https://technet.microsoft.com/library/jj574214.aspx). С точки зрения поставщика приложения существуют некоторые аспекты, которые потребуется учитывать при оценке влияние клонирования, чтобы приложение:  
  
-   Исходный компьютер не удаляется. Он остается в сети, взаимодействие с клиентами. В отличие от rename, где будут удалены записи DNS на исходном компьютере остаются исходные записи для исходного контроллера домена.  
  
-   Во время процесса клонирования новый изначально компьютер является короткий промежуток времени удостоверением старого компьютера до инициируется процесс клонирования и делает необходимые изменения. Приложения, создающие записей об узле следует убедиться, что клонированный компьютер не перезапишет записей о исходный узел во время процесса клонирования.  
  
-   Клонирование — это особый вид развертывания возможность только для виртуализированных контроллеров домена, не расширение общего назначения для клонирования других ролей сервера. Некоторые роли сервера, в частности не поддерживаются для клонирования:  
  
    -   Протокол DHCP (DHCP)  
  
    -   Службы сертификатов Active Directory (AD CS)  
  
    -   Службы Active Directory облегченного доступа к каталогам (AD LDS)  
  
-   В рамках процесса клонирования копируется всю виртуальную Машину, представляющий исходного контроллера домена, поэтому любое состояние приложения в этой виртуальной Машине также копируются. Проверьте, что приложение адаптируется к этого изменения в состоянии локального узла для клонированного контроллера домена, или если вмешательства не требуется, например перезапуск службы.  
  
-   В ходе клонирования новый контроллер домена получает новый идентификатор машины и положения себя как реплики контроллера домена в топологии. Проверьте, является ли приложение зависит от идентификатор машины, например его имя, учетная запись, ИД безопасности и т. д. Его автоматически адаптируются к изменению удостоверения компьютера на клоне? Если это приложение кэширует данные, убедитесь, что он не полагается на компьютере учетных данных, которые могут быть помещены.  
  
## <a name="what-is-interesting-for-application-vendors"></a>Что такое интересных для поставщиков приложений?  
  
### <a name="customdccloneallowlistxml"></a>CustomDCCloneAllowList.xml  
Контроллер домена под управлением, ваше приложение или служба не клонировать до приложения или службы является либо:  
  
-   Добавить в файл CustomDCCloneAllowList.xml, с помощью командлета Get-ADDCCloningExcludedApplicationList Windows PowerShell  
  
- Или -  
  
-   Удалены с контроллера домена  
  
Первый раз, когда пользователь запускает командлет Get-ADDCCloningExcludedApplicationList, он возвращает список служб и приложений, работающих на контроллере домена, но не в списке по умолчанию, служб и приложений, которые поддерживаются для клонирования. По умолчанию служба или приложение не отображается. Чтобы добавить службу или приложение в список приложений и служб, которые могут быть безопасно клонировать, командлет Get-ADDCCloningExcludedApplicationList снова с параметром - GenerateXML, чтобы добавить его в файл CustomDCCloneAllowList.xml файла после выполнения пользователем. Дополнительные сведения см. в разделе [шаг 2: командлет Get-ADDCCloningExcludedApplicationList, запустите](https://technet.microsoft.com/library/hh831734.aspx#bkmk6_run_get_addccloningexcludedapplicationlist_cmdlet).  
  
### <a name="distributed-system-interactions"></a>Взаимодействие с помощью распределенной системы  
Обычно службы изолирования на локальном компьютере пройден или завершиться ошибкой, если участвующий в клонировании. Распределенные службы должны быть беспокоиться о двух экземпляров на главном компьютере в сети одновременно короткий промежуток времени. Это может манифеста как экземпляр службы, при попытке извлечь данные из системы партнеров где копия зарегистрирован как нового поставщика удостоверений. Или оба экземпляры службы может push сведения в базу данных AD DS одновременно с разные результаты. Например не детерминирована компьютера, с которого будут публиковаться с двух компьютеров, для которых служба тестирования технологии Windows (WTT), находясь в сети с контроллером домена.  
  
Распределенные службы DNS-сервер процесс клонирования тщательно избежать перезаписи записи DNS исходного контроллера домена при запуске клонированного контроллера домена новый IP-адрес.  
  
Не следует полагаться на компьютере, чтобы удалить все старый идентификатор до завершения процесса клонирования. После выдвижения роль нового контроллера домена в новый контекст, выберите Sysprep поставщиков выполняются для очистки дополнительные состояния компьютера. Например именно на этом этапе удаления старых сертификатов компьютера и изменяются секреты шифрования, которые компьютер может получить доступ.  
  
Основным фактором, зависит от времени, клонирование представляет, сколько объектов для репликации с основного контроллера домена. Старые мультимедиа увеличивает время, необходимое для завершения клонирования.  
  
Так как служба или приложение неизвестно, она останется под управлением. Процесс клонирования не изменяет состояние служб, отличных от Windows.  
  
Кроме того новый компьютер имеет другой IP-адрес исходного компьютера. Это поведение может привести к побочные эффекты для вашей службы или приложения в зависимости от того, как ведет службы или приложения в этой среде.  
  
## <a name="additional-scenarios-suggested-for-testing"></a>Дополнительные сценарии, рекомендуется использовать для тестирования  
  
### <a name="cloning-failure"></a>Сбой клонирования  
Службы поставщиков следует протестировать этот сценарий, так как после сбоя клонирования компьютер загружается в служб каталогов восстановления режим (DSRM), форме безопасного режима. В этот момент компьютер не завершил клонирования. Изменились некоторые состояния, и некоторые состояния могут оставаться с исходного контроллера домена. Протестируйте этот сценарий, чтобы понять, какое влияние у вашего приложения.  
  
Инициирование сбоя клонирования, попробуйте клонирования контроллера домена без предоставления прав его клонирование. В этом случае компьютер будет только изменились IP-адреса, но большинство свое состояние из исходного контроллера домена. Дополнительные сведения о предоставлении разрешение контроллера домена, клонирование см [шаг 1: предоставление исходному виртуализованному контроллеру домена разрешения на клонировать](https://technet.microsoft.com/library/hh831734.aspx#bkmk4_grant_source).  
  
### <a name="pdc-emulator-cloning"></a>Клонирование эмулятор основного контроллера домена  
Поставщики служб и приложений следует протестировать этот сценарий из-за дополнительной перезагрузки при клонировании эмулятор основного контроллера домена. Кроме того большинство клонирования выполняется временные удостоверением, чтобы разрешить у нового клона для взаимодействия с эмулятором основного контроллера домена во время процесса клонирования.  
  
### <a name="writable-versus-read-only-domain-controllers"></a>Для записи и контроллеры домена только для чтения  
Поставщики служб и приложений следует проверить клонирования с использованием того же типа контроллера домена (то есть на контроллере домена, доступный для записи или только для чтения) запланированную службы для запуска на.  
  


