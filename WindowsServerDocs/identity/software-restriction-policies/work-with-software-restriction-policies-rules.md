---
title: Работа с правилами политик ограниченного использования программ
description: Безопасность Windows Server
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-software-restriction-policies
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 4a8047d5-9bb9-4bed-bc8f-583a237731e2
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: 2dd1810b50f4f02be99eb2e2c0893501f99d1e93
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59844955"
---
# <a name="work-with-software-restriction-policies-rules"></a>Работа с правилами политик ограниченного использования программ

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе описаны процедуры, работа с сертификатом, путь, центр Интернета зоны и хэш правила политики ограниченного использования программ.

## <a name="introduction"></a>Введение
С помощью политик ограниченного использования программ можно защитить вычислительную среду от ненадежного программного обеспечения, определив и указав, какие программы разрешено запускать. Можно определить уровень безопасности по умолчанию **Unrestricted** или **не разрешено** для объекта групповой политики (GPO), чтобы программное обеспечение либо разрешено или не может выполняться по умолчанию. Исключения для этого уровня безопасности по умолчанию можно сделать путем создания правила политики для конкретного программного обеспечения ограниченного использования программ. Например, если уровень безопасности по умолчанию имеет значение **Запрещено**, можно создавать правила, которые разрешают выполнение отдельных программ. Ниже приведены типы правил:

-   **Правила для сертификатов**

    Процедуры см. в разделе о [работе с правилами для сертификатов](#BKMK_Cert_Rules).

-   **Правила хэширования**

    Процедуры см. в разделе о [работе с правилами хэширования](#BKMK_Hash_Rules).

-   **Правила для зон Интернета**

    Процедуры, см. в разделе [работа с правилами для зон Интернета](#BKMK_Internet_Zone_Rules).

-   **Правила для путей**

    Процедуры см. в разделе о [работе с правилами для путей](#BKMK_Path_Rules).

Сведения о других задачах для управления политиками ограниченного использования программ см. в разделе [администрирование политик ограниченного использования программ](administer-software-restriction-policies.md).

## <a name="BKMK_Cert_Rules"></a>Работа с правилами для сертификатов
Политики ограниченного использования программ также можно определить программного обеспечения, ее сертификат для подписи. Можно создать правило для сертификата, которое определяет программу, а потом разрешает или запрещает ее запуск в зависимости от уровня безопасности. Например, с помощью правил для сертификатов можно автоматически считать доверенным программное обеспечение из доверенного источника в домене, не запрашивая пользователя. С помощью правил для сертификатов также можно запускать файлы в запрещенных областях операционной системы. По умолчанию правила для сертификатов не включены.

При создании правил для домена, с помощью групповой политики, необходимо иметь разрешения для создания или изменения объекта групповой политики. При создании правил для локального компьютера необходимы административные учетные данные на этом компьютере.

#### <a name="to-create-a-certificate-rule"></a>Создание правила для сертификатов

1.  Откройте окно "Политики ограниченного использования программ".

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для сертификата**.

3.  Нажмите кнопку **Обзор** и выберите сертификат или подписанный файл.

4.  В **уровень безопасности**, нажать **не разрешено** или **Unrestricted**.

5.  В поле **Описание** введите описание данного правила и нажмите кнопку **ОК**.

> [!NOTE]
> -   Может понадобиться создать новый параметр политики ограниченного использования программ для объекта групповой политики, если это еще не сделано.
> -   По умолчанию правила для сертификатов не включены.
> -   Правила для сертификатов действуют только на те типы файлов, которые включены в список **Назначенные типы файлов** в области сведений для политик ограниченного использования программ. Все правила используют общий список назначенных типов файлов.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   При применении нескольких правил политик ограниченного использования программного обеспечения к параметрам политики есть приоритет правил для обработки конфликтов.

### <a name="enabling-certificate-rules"></a>Включение правил для сертификатов
Правила для сертификатов включаются различными процедурами в зависимости от среды.

-   [Для локального компьютера](#BKMK_1)

-   [Для объекта групповой политики, — на сервере, который присоединен к домену](#BKMK_2)

-   [Для объекта групповой политики вы находитесь на контроллере домена или на рабочей станции, где установлены средства удаленного администрирования сервера](#BKMK_3)

-   [Только домена контроллеры: вы находитесь на контроллере домена или на рабочей станции с удаленного сервера пакетом средств администрирования](#BKMK_4)

#### <a name="BKMK_1"></a>Чтобы включить правила сертификатов для локального компьютера

1.  Откройте окно "Локальные параметры безопасности".

2.  В дереве консоли щелкните **параметры безопасности** расположен в разделе параметров/локальные политики безопасности.

3.  В области сведений дважды щелкните **параметры системы: Использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

4.  Выполните одно из следующих действий, а затем нажмите **ОК**.

    -   Чтобы включить правила для сертификатов, выберите вариант **Включено**.

    -   Чтобы отключить правила для сертификатов, выберите вариант **Отключено**.

#### <a name="BKMK_2"></a>Чтобы включить правила сертификатов для объекта групповой политики вы находитесь на сервере, который присоединен к домену

1.  Откройте консоль управления (MMC).

2.  В меню **Файл** выберите команду **Добавить или удалить оснастку** и нажмите кнопку **Добавить**.

3.  Щелкните элемент **Редактор объектов групповой политики** и затем нажмите кнопку **Добавить**.

4.  В окне **Выбор объекта групповой политики** нажмите кнопку **Обзор**.

5.  В **поиск объекта групповой политики**, выберите объект групповой политики (GPO) в нужном домене, сайта или подразделения- или создайте новую и нажмите кнопку **Готово**.

6.  Щелкните **Закрыть**, а затем нажмите кнопку **ОК**.

7.  В дереве консоли щелкните **параметры безопасности** каталоге *Объект_групповой_политики* [*ComputerName*] Policy/Computer Configuration/Windows Settings/Security Параметры/локальные политики /.

8.  В области сведений дважды щелкните **параметры системы: Использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

9. Если этот параметр политики еще не определен, установите флажок **Определить параметры политики**.

10. Выполните одно из следующих действий, а затем нажмите **ОК**.

    -   Чтобы включить правила для сертификатов, выберите вариант **Включено**.

    -   Чтобы отключить правила для сертификатов, выберите вариант **Отключено**.

#### <a name="BKMK_3"></a>Включение сертификата правил для объекта групповой политики и контроллер домена или на рабочей станции, где установлены средства удаленного администрирования сервера

1.  Откройте оснастку "Пользователи и компьютеры Active Directory".

2.  В дереве консоли щелкните правой кнопкой мыши объект групповой политики, для которого следует включить правила для сертификатов.

3.  Выберите пункт **Свойства** и перейдите на вкладку **Групповая политика**.

4.  Нажмите кнопку **Изменить**, чтобы открыть объект групповой политики для правки. Также можно нажать кнопку **Создать**, чтобы создать новый объект групповой политики, а затем нажать кнопку **Изменить**.

5.  В дереве консоли щелкните **параметры безопасности** каталоге *Объект_групповой_политики*[*ComputerName*] Policy/Computer Configuration/Windows Settings/Security Параметры/локальные политики.

6.  В области сведений дважды щелкните **параметры системы: Использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

7.  Если этот параметр политики еще не определен, установите флажок **Определить параметры политики**.

8.  Выполните одно из следующих действий, а затем нажмите **ОК**.

    -   Чтобы включить правила для сертификатов, выберите вариант **Включено**.

    -   Чтобы отключить правила для сертификатов, выберите вариант **Отключено**.

#### <a name="BKMK_4"></a>Чтобы включить правила для сертификатов только контроллеры домена, а также являются на контроллере домена или на рабочей станции, где установлены средства удаленного администрирования сервера

1.  Откройте консоль параметров безопасности контроллера домена.

2.  В дереве консоли щелкните элемент **Параметры безопасности**, расположенный в узле "Политика *объект_групповой_политики**[имя_компьютера]*/Конфигурация компьютера/Конфигурация Windows/Параметры безопасности/Локальные политики".

3.  В области сведений дважды щелкните **параметры системы: Использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

4.  Если этот параметр политики еще не определен, установите флажок **Определить параметры политики**.

5.  Выполните одно из следующих действий, а затем нажмите **ОК**.

    -   Чтобы включить правила для сертификатов, выберите вариант **Включено**.

    -   Чтобы отключить правила для сертификатов, выберите вариант **Отключено**.

> [!NOTE]
> Эту процедуру необходимо выполнить, чтобы правила для сертификатов вступили в силу.

### <a name="set-trusted-publisher-options"></a>Задать параметры доверенного издателя
Все большее число издателей программного обеспечения и разработчиков приложений используют подписи для программного обеспечения, чтобы подтвердить, что их приложения поступают из надежного источника. Однако многие пользователи не понимают назначение сертификатов подписей, связанных с устанавливаемыми приложениями, или уделяют им мало внимания.

Параметры политики на вкладке **Доверенные издатели** в окне политики проверки пути сертификации позволяют администраторам контролировать, какие сертификаты могут приниматься как поступающие от доверенного издателя.

##### <a name="to-configure-the-trusted-publishers-policy-settings-for-a-local-computer"></a>Настройка параметров политики доверенных издателей для локального компьютера

1.  На **запустить** введите**gpedit.msc** и нажмите клавишу ВВОД.

2.  В дереве консоли в разделе **Политика "Локальный компьютер"\Конфигурация компьютера\Конфигурация Windows\Параметры безопасности** щелкните пункт **Политики открытого ключа**.

3.  Дважды щелкните элемент **Параметры подтверждения пути сертификата**, а затем перейдите на вкладку **Доверенные издатели**.

4.  Установите флажок **Определить следующие параметры политики**, выберите параметры политики, которые нужно применить, затем нажмите кнопку **ОК**, чтобы применить новые параметры.

##### <a name="to-configure-the-trusted-publishers-policy-settings-for-a-domain"></a>Настройка параметров политики доверенных издателей для домена

1.  Откройте **Управление групповой политикой**.

2.  В дереве консоли дважды щелкните **объектов групповой политики** в лесу и домен, содержащий **политика домена по умолчанию** политики объекта Групповой политики, которую требуется изменить.

3.  Щелкните объект **Политика домена по умолчанию** правой кнопкой мыши и выберите команду **Изменить**.

4.  В дереве консоли в разделе **Конфигурация компьютера\Параметры Windows\Параметры безопасности** щелкните пункт **Политики открытого ключа**.

5.  Дважды щелкните элемент **Параметры подтверждения пути сертификата**, а затем перейдите на вкладку **Доверенные издатели**.

6.  Установите флажок **Определить следующие параметры политики**, выберите параметры политики, которые нужно применить, затем нажмите кнопку **ОК**, чтобы применить новые параметры.

##### <a name="to-allow-only-administrators-to-manage-certificates-used-for-code-signing-for-a-local-computer"></a>Чтобы разрешить только администраторам управление сертификатами, используемыми для подписи кода на локальном компьютере, выполните следующие действия.

1.  На **запустить** экрана, тип, **gpedit.msc** в **найти программы и файлы** или в Windows 8, на рабочем столе и нажмите клавишу ВВОД.

2.  В дереве консоли в узле **политика домена по умолчанию** или **политика локального компьютера**, дважды щелкните **Конфигурация компьютера**, **параметры Windows**, и **параметры безопасности**, а затем нажмите кнопку **политики открытого ключа**.

3.  Дважды щелкните элемент **Параметры подтверждения пути сертификата**, а затем перейдите на вкладку **Доверенные издатели**.

4.  Установите флажок **Определить параметры политики**.

5.  В группе **Управление доверенными издателями** щелкните **Разрешать всем администраторам управлять доверенными издателями**, а затем нажмите кнопку **ОК**, чтобы применить новые параметры.

##### <a name="to-allow-only-administrators-to-manage-certificates-used-for-code-signing-for-a-domain"></a>Чтобы разрешить только администраторам управление сертификатами, используемыми для подписи кода в домене, выполните следующие действия.

1.  Откройте **Управление групповой политикой**.

2.  В дереве консоли дважды щелкните **объектов групповой политики** в лесу и домен, содержащий **политика домена по умолчанию** групповой Политики, который требуется изменить.

3.  Щелкните объект **Политика домена по умолчанию** правой кнопкой мыши и выберите команду **Изменить**.

4.  В дереве консоли в разделе **Конфигурация компьютера\Параметры Windows\Параметры безопасности** щелкните пункт **Политики открытого ключа**.

5.  Дважды щелкните элемент **Параметры подтверждения пути сертификата**, а затем перейдите на вкладку **Доверенные издатели**.

6.  Установите флажок **Определить следующие параметры политики**, внесите нужные изменения, а затем нажмите кнопку **ОК**, чтобы применить новые параметры.

## <a name="BKMK_Hash_Rules"></a>Работа с правилами хэширования
Хэш — это последовательность байтов фиксированной длины, уникальным образом определяющая программу или файл. Хэш вычисляется по хэш-алгоритму. Когда для программы создается правило хэширования, политики ограниченного использования программ вычисляют хэш программы. Когда пользователь пытается открыть программу, ее хэш сравнивается с существующими правилами хэширования для политик ограниченного использования программ. Хэш программы остается неизменным независимо от ее расположения на компьютере. Однако если программа каким-либо образом меняется, то ее хэш также меняется и перестает совпадать с хэшем в правиле хэширования для политик ограниченного использования программ.

Например, можно создать правило хэширования и задать уровень безопасности **Запрещено**, чтобы запретить пользователям запускать определенный файл. Этот файл можно переименовать или переместить в другую папку, однако он будет иметь тот же хэш. Однако при изменении содержимого файла его хэш-значение также изменится, и файл сможет обойти ограничения.

#### <a name="to-create-a-hash-rule"></a>Создание правила хэширования

1.  Откройте окно "Политики ограниченного использования программ".

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для хэша**.

3.  Нажмите кнопку **Обзор** для поиска файла.

    > [!NOTE]
    > В Windows XP имеется возможность вставить предварительно вычисленной хэш в **хэш файла**. В Windows Server 2008 R2, Windows 7 и более поздних версий этот параметр недоступен.

4.  В **уровень безопасности**, нажать **не разрешено** или **Unrestricted**.

5.  В поле **Описание** введите описание данного правила и нажмите кнопку **ОК**.

> [!NOTE]
> -   Может понадобиться создать новый параметр политики ограниченного использования программ для объекта групповой политики, если это еще не сделано.
> -   Правило хэширования можно создать для вируса или вредоносной программы типа "троянский конь", чтобы предотвратить их запуск.
> -   Если вы хотите, чтобы другим пользователям использовать правило хэширования для предотвращения запуска вируса, вычислите хэш вируса с помощью политик ограниченного использования программ и по электронной почте другим сотрудникам хэш-значение. Никогда не по электронной почте сам вирус.
> -   Если вирус отправлен по электронной почте, можно также создать правило для пути для предотвращения выполнения вложений электронной почты.
> -   После переименования или перемещения в другую папку файл будет иметь тот же хэш. Любые изменения в сам файл приводят особый хэш-код.
> -   Правила хэширования действуют только на те типы файлов, которые включены в список **Назначенные типы файлов** в области сведений для политик ограниченного использования программ. Все правила используют общий список назначенных типов файлов.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   При применении нескольких правил политик ограниченного использования программного обеспечения к параметрам политики есть приоритет правил для обработки конфликтов.

## <a name="BKMK_Internet_Zone_Rules"></a>Работа с правилами для зон Интернета
Правила для зон Интернета применяются только к пакетам установщика Windows. Правило для зоны может определять программу из зоны, заданной в Internet Explorer. Это зоны "Интернет", "Локальная интрасеть", "Опасные сайты", "Надежные сайты" и "Мой компьютер". Правило для зоны Интернета предназначен для предотвращения пользователей от загрузки и установки программного обеспечения.

#### <a name="to-create-an-internet-zone-rule"></a>Создание правила для зоны Интернета

1.  Откройте окно "Политики ограниченного использования программ".

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для зоны Интернета**.

3.  В поле **Зона Интернета** выберите зону Интернета.

4.  В **уровень безопасности**, нажать **не разрешено** или **Unrestricted**, а затем нажмите кнопку **ОК**.

> [!NOTE]
> -   Может понадобиться создать новый параметр политики ограниченного использования программ для объекта групповой политики, если это еще не сделано.
> -   Правила для зон применяются только к файлам типа MSI, то есть к пакетам установщика Windows.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   При применении нескольких правил политик ограниченного использования программного обеспечения к параметрам политики есть приоритет правил для обработки конфликтов.

## <a name="BKMK_Path_Rules"></a>Работа с правилами для путей
Правило для пути определяет программу по пути к ее файлу. Например, даже если для компьютера задан уровень безопасности по умолчанию **Запрещено**, можно предоставить каждому пользователю неограниченный доступ к определенной папке. Можно создать правило для пути с помощью пути к файлу и задать в правиле для пути уровень безопасности **Не ограничено**. Для этого типа правила часто используются пути %userprofile%, %windir%, %appdata%, %programfiles% и %temp%. Также можно создавать правила для пути в реестре, где путем служит раздел реестра для программы.

Поскольку такие правила задаются для пути, при перемещении программы правило для пути перестает действовать.

#### <a name="to-create-a-path-rule"></a>Создание правила для пути

1.  Откройте окно "Политики ограниченного использования программ".

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для пути**.

3.  В поле **Путь** введите путь или нажмите кнопку **Обзор**, чтобы найти файл или папку.

4.  В **уровень безопасности**, нажать **не разрешено** или **Unrestricted**.

5.  В поле **Описание** введите описание данного правила и нажмите кнопку **ОК**.

> [!CAUTION]
> -   В некоторых папках, например в папке Windows, задание уровня безопасности для **не разрешено** может нарушить работу операционной системы. Убедитесь, что не запрещается доступ к важному компоненту операционной системы или какой-либо из ее зависимых программ.

> [!NOTE]
> -   Может понадобиться создать новые политики ограниченного использования программ для объекта групповой политики, если это еще не сделано.
> -   Если создать правило для пути для программы с уровнем безопасности **Запрещено**, пользователи смогут запустить эту программу, скопировав ее в другое место.
> -   В правиле для пути поддерживаются подстановочные знаки звездочки (*) и вопроса (?).
> -   В правиле для пути можно использовать переменные среды, например %programfiles% и %systemroot%.
> -   Если нужно создать правило для программы, когда неизвестно ее расположение на компьютере, но имеется ее раздел реестра, то можно создать правило для пути в реестре.
> -   Чтобы запретить пользователям выполнять вложения электронной почты, можно создать правило для пути для каталога вложений почтовой программы запрещает пользователям выполнять вложения электронной почты.
> -   Правила для путей действуют только на те типы файлов, которые включены в список **Назначенные типы файлов** в области сведений для политик ограниченного использования программ. Все правила используют общий список назначенных типов файлов.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   При применении нескольких правил политик ограниченного использования программного обеспечения к параметрам политики есть приоритет правил для обработки конфликтов.

#### <a name="to-create-a-registry-path-rule"></a>Создание правила для пути в реестре

1.  На **запустить** введите regedit.

2.  В дереве консоли щелкните правой кнопкой мыши раздел реестра, для которого нужно создать правило, и выберите команду **Копировать имя раздела**. Найдите параметр в области сведений.

3.  Откройте окно "Политики ограниченного использования программ".

4.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для пути**.

5.  В **путь**, вставьте имя раздела реестра, за которым следует имя значения.

6.  Заключите путь в реестре в знаки процента (%), например, % HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PlatformSDK\Directories\InstallDir%.

7.  В **уровень безопасности**, нажать **не разрешено** или **Unrestricted**.

8.  В поле **Описание** введите описание данного правила и нажмите кнопку **ОК**.


