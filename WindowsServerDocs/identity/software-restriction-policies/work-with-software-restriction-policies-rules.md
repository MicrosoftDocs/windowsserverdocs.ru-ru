---
title: "Работа с правилами политик ограниченного использования программ"
description: "Безопасность Windows Server"
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: security-software-restriction-policies
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 4a8047d5-9bb9-4bed-bc8f-583a237731e2
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/12/2016
ms.openlocfilehash: 2dd1810b50f4f02be99eb2e2c0893501f99d1e93
ms.sourcegitcommit: 70c1b6cedad55b9c7d2068c9aa4891c6c533ee4c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2017
---
# <a name="work-with-software-restriction-policies-rules"></a>Работа с правилами политик ограниченного использования программ

>Область применения: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В этом разделе описаны процедуры, работа с сертификатом, путь, Интернет зоны и хэш-правила политики ограниченного использования программ.

## <a name="introduction"></a>Введение
С помощью политик ограниченного использования программ можно защитить вычислительную среду от ненадежного программного обеспечения, определив и указав, какие программы разрешено запускать. Можно определить уровень безопасности по умолчанию **Unrestricted** или **запрещено** для объекта групповой политики (GPO), чтобы программное обеспечение либо разрешено, либо не разрешено использовать по умолчанию. Создавая правила политики для конкретного программного обеспечения ограниченного использования программ можно делать исключения из уровня безопасности по умолчанию. Например, если уровень безопасности по умолчанию имеет значение **запрещено**, можно создать правила, которые разрешают выполнение отдельных программ. Ниже приведены типы правил.

-   **Правила для сертификатов**

    Процедуры см. в разделе [работа с правилами для сертификатов](#BKMK_Cert_Rules).

-   **Правила хэширования**

    Процедуры см. в разделе [работа с правилами хэширования](#BKMK_Hash_Rules).

-   **Правила для зон Интернета**

    Процедуры см. в разделе [работа с правилами для зон Интернета](#BKMK_Internet_Zone_Rules).

-   **Правила для путей**

    Процедуры см. в разделе [работа с правилами для путей](#BKMK_Path_Rules).

Сведения о других задачах для управления политиками ограниченного использования программ см. в разделе [администрирование политик ограниченного использования программ](administer-software-restriction-policies.md).

## <a name="BKMK_Cert_Rules"></a>Работа с правилами для сертификатов
Также политик ограниченного использования программ могут определять программы по сертификату подписи. Можно создать правило сертификата, которое определяет программу, а затем разрешает или запрещает ее запуск в зависимости от уровня безопасности. Например можно использовать правила для сертификатов, автоматически доверять программное обеспечение из доверенного источника в домене без запроса пользователя. Также можно использовать правила для сертификатов, чтобы запускать файлы в запрещенных областях операционной системы. Правила для сертификатов не включены по умолчанию.

Когда правила создаются для домена, с помощью групповой политики, необходимо иметь разрешения на создание или изменение объекта групповой политики. При создании правил для локального компьютера, необходимо иметь учетные данные администратора на этом компьютере.

#### <a name="to-create-a-certificate-rule"></a>Чтобы создать правило для сертификата

1.  Открыть политики ограниченного использования программ.

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для сертификата**.

3.  Нажмите кнопку **Обзор**, а затем выберите сертификат или подписанный файл.

4.  В **уровень безопасности**, выбрать пункт **запрещено** или **Unrestricted**.

5.  В **описание**, введите описание для этого правила и нажмите кнопку **ОК**.

> [!NOTE]
> -   Может потребоваться создать новый параметр политики ограниченного использования программ для объекта групповой политики (GPO), если вы еще не выполнена.
> -   Правила для сертификатов не включены по умолчанию.
> -   Только типы файлов, которые были затронуты правила для сертификатов являются те, которые перечислены в **назначенных типов файлов** в области сведений для политик ограниченного использования программ. Существует один список назначенных типов файлов, общих для всех правил.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   Если к параметрам политики применяется несколько правил политики ограниченного использования программ для программного обеспечения, существует приоритет правил, для разрешения конфликтов.

### <a name="enabling-certificate-rules"></a>Включение правил для сертификатов
Существует несколько процедур Включение правил для сертификатов в зависимости от среды.

-   [Для локального компьютера](#BKMK_1)

-   [Для объекта групповой политики, вы находитесь на сервере, который присоединен к домену](#BKMK_2)

-   [Для объекта групповой политики, вы находитесь на контроллере домена или на рабочей станции с установленными средствами удаленного администрирования сервера](#BKMK_3)

-   [Только домена контроллеров, вы находитесь на контроллере домена или на рабочей станции, с удаленного сервера пакетом средств администрирования](#BKMK_4)

#### <a name="BKMK_1"></a>Чтобы включить правила для сертификатов для локального компьютера

1.  Откройте локальные параметры безопасности.

2.  В дереве консоли щелкните **параметры безопасности** находятся в разделе Параметры/локальные политики безопасности.

3.  В области сведений дважды щелкните **параметры системы: использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

4.  Выполните одно из следующих действий, а затем нажмите кнопку **ОК**:

    -   Чтобы включить правила для сертификатов, щелкните **включено**.

    -   Чтобы отключить правила для сертификатов, нажмите кнопку **отключено**.

#### <a name="BKMK_2"></a>Чтобы включить правила для сертификатов для объекта групповой политики, вы находитесь на сервере, который присоединен к домену

1.  Откройте консоль управления (MMC).

2.  На **файл** меню, нажмите кнопку **добавить или удалить оснастку**, а затем нажмите кнопку **добавить**.

3.  Нажмите кнопку **редактор объектов групповой политики**, а затем нажмите кнопку **добавить**.

4.  В **Выбор объекта групповой политики**, нажмите кнопку **Обзор**.

5.  В **поиск объекта групповой политики**, выберите объект групповой политики (GPO) в соответствующем домене, сайта или подразделения- или создать новый и нажмите кнопку **Готово**.

6.  Нажмите кнопку **закрыть**, а затем нажмите кнопку **ОК**.

7.  В дереве консоли щелкните **параметры безопасности** , расположенные в папке *Объект_групповой_политики* [*ComputerName*] Policy/Computer Конфигурация Windows Параметры безопасности в параметры/локальные политики /.

8.  В области сведений дважды щелкните **параметры системы: использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

9. Если этот параметр политики еще не определен, установите **определить следующие параметры политики** флажок.

10. Выполните одно из следующих действий, а затем нажмите кнопку **ОК**:

    -   Чтобы включить правила для сертификатов, щелкните **включено**.

    -   Чтобы отключить правила для сертификатов, нажмите кнопку **отключено**.

#### <a name="BKMK_3"></a>Включение сертификата правил для объекта групповой политики, и вы работаете на контроллере домена или на рабочей станции с установленными средствами удаленного администрирования сервера

1.  Откройте Active Directory-пользователи и компьютеры.

2.  В дереве консоли щелкните правой кнопкой мыши объект политики группы (GPO), для которого требуется включить правила для сертификатов.

3.  Нажмите кнопку **свойства**, а затем нажмите кнопку **групповой политики** вкладку.

4.  Нажмите кнопку **изменить** открыть объект групповой Политики, который требуется изменить. Можно также щелкнуть **New** создать новый объект групповой Политики, а затем нажмите кнопку **изменить**.

5.  В дереве консоли щелкните **параметры безопасности** , расположенные в папке *Объект_групповой_политики*[*ComputerName*] Policy/Computer Конфигурация Windows Параметры или параметры или локального политик безопасности.

6.  В области сведений дважды щелкните **параметры системы: использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

7.  Если этот параметр политики еще не определен, установите **определить следующие параметры политики** флажок.

8.  Выполните одно из следующих действий, а затем нажмите кнопку **ОК**:

    -   Чтобы включить правила для сертификатов, щелкните **включено**.

    -   Чтобы отключить правила для сертификатов, нажмите кнопку **отключено**.

#### <a name="BKMK_4"></a>Чтобы включить правила для сертификатов только контроллеры домена, а также являются на контроллере домена или на рабочей станции с установленными средствами удаленного администрирования сервера

1.  Откройте консоль параметров безопасности контроллера домена.

2.  В дереве консоли щелкните **параметры безопасности** , расположенные в папке *Объект_групповой_политики* [*ComputerName*] Policy/Computer Конфигурация Windows Параметры или параметры или локального политик безопасности.

3.  В области сведений дважды щелкните **параметры системы: использовать правила сертификатов для исполняемых файлов Windows для политик ограниченного использования программ**.

4.  Если этот параметр политики еще не определен, установите **определить следующие параметры политики** флажок.

5.  Выполните одно из следующих действий, а затем нажмите кнопку **ОК**:

    -   Чтобы включить правила для сертификатов, щелкните **включено**.

    -   Чтобы отключить правила для сертификатов, нажмите кнопку **отключено**.

> [!NOTE]
> Правила для сертификатов вступили в силу, необходимо выполнить эту процедуру.

### <a name="set-trusted-publisher-options"></a>Задать параметры доверенного издателя
Подписи для программного обеспечения используется все большее число издателей программного обеспечения и разработчиков приложений для проверки того, что их приложения поступают из надежного источника. Однако многие пользователи не понять или оплаты сертификатов подписей, связанных с устанавливаемыми приложениями, им мало внимания.

Параметры политики в **доверенных издателей** окне политики подтверждения пути сертификата позволяют администраторам контролировать, какие сертификаты могут приниматься как поступающие от доверенного издателя.

##### <a name="to-configure-the-trusted-publishers-policy-settings-for-a-local-computer"></a>Настройка параметров политики доверенных издателей для локального компьютера

1.  На **запустить** введите**gpedit.msc** и нажмите клавишу ВВОД.

2.  В дереве консоли в разделе **локального компьютера\Конфигурация Конфигурация компьютера\Параметры Windows\параметры**, нажмите кнопку **политики открытого ключа**.

3.  Дважды щелкните **параметры подтверждения пути сертификата**, а затем нажмите кнопку **доверенных издателей** вкладку.

4.  Выберите **определить следующие параметры политики** флажок, выберите параметры политики, которые вы хотите применить, а затем выберите **ОК** для применения новых параметров.

##### <a name="to-configure-the-trusted-publishers-policy-settings-for-a-domain"></a>Настройка параметров политики доверенных издателей для домена

1.  Откройте **Управление групповыми политиками**.

2.  В дереве консоли дважды щелкните **объектов групповой политики** в лесу и домене содержащий **политика домена по умолчанию** групповой политики объект (GPO), который нужно изменить.

3.  Щелкните правой кнопкой мыши **политика домена по умолчанию** GPO, а затем нажмите кнопку **изменить**.

4.  В дереве консоли в разделе **Конфигурация компьютера\Параметры Windows\параметры**, нажмите кнопку **политики открытого ключа**.

5.  Дважды щелкните **параметры подтверждения пути сертификата**, а затем нажмите кнопку **доверенных издателей** вкладку.

6.  Выберите **определить следующие параметры политики** флажок, выберите параметры политики, которые вы хотите применить, а затем выберите **ОК** для применения новых параметров.

##### <a name="to-allow-only-administrators-to-manage-certificates-used-for-code-signing-for-a-local-computer"></a>Чтобы разрешить только администраторам управление сертификатами, используемыми для подписи кода локальном компьютере

1.  На **запустить** экрана, введите **gpedit.msc** в **поиск программ и файлов** или в Windows 8, на рабочем столе и нажмите клавишу ВВОД.

2.  В дереве консоли в разделе **политика домена по умолчанию** или **политика локального компьютера**, дважды щелкните **Конфигурация компьютера**, **параметры Windows**, и **параметры безопасности**, а затем нажмите кнопку **политики открытого ключа**.

3.  Дважды щелкните **параметры подтверждения пути сертификата**, а затем нажмите кнопку **доверенных издателей** вкладку.

4.  Выберите **определить следующие параметры политики** флажок.

5.  В разделе **доверенного издателя управления**, нажмите кнопку **разрешать всем администраторам управлять доверенными издателями**, а затем нажмите кнопку **ОК** для применения новых параметров.

##### <a name="to-allow-only-administrators-to-manage-certificates-used-for-code-signing-for-a-domain"></a>Чтобы разрешить только администраторам управление сертификатами, используемыми для подписи кода в домене

1.  Откройте **Управление групповыми политиками**.

2.  В дереве консоли дважды щелкните **объектов групповой политики** в лесу и домене содержащий **политика домена по умолчанию** групповой Политики, который требуется изменить.

3.  Щелкните правой кнопкой мыши **политика домена по умолчанию** GPO, а затем нажмите кнопку **изменить**.

4.  В дереве консоли в разделе **Конфигурация компьютера\Параметры Windows\параметры**, нажмите кнопку **политики открытого ключа**.

5.  Дважды щелкните **параметры подтверждения пути сертификата**, а затем нажмите кнопку **доверенных издателей** вкладку.

6.  Выберите **определить следующие параметры политики** флажок, внесите нужные изменения и нажмите кнопку **ОК** для применения новых параметров.

## <a name="BKMK_Hash_Rules"></a>Работа с правилами хэширования
Хэш — это последовательность байтов фиксированной длины, уникальным образом определяющая программу или файл. Хэш вычисляется по хэш-алгоритм. Когда для программы создается правило хэширования, политики ограниченного использования программ вычисляют хэш программы. Когда пользователь пытается открыть программу, хеш программы сравнивается с существующими правилами хэширования для политик ограниченного использования программ. Хэш программы остается неизменным независимо от расположения программы на компьютере. Тем не менее если программа каким-либо образом, ее хэш также меняется и перестает совпадать с хэшем в правиле хэширования для политик ограниченного использования программ.

Например, можно создать правило хэширования и задать уровень безопасности **запрещено** запретить пользователям запускать определенный файл. Файл можно переименовать или переместить в другую папку и будет иметь тот же хэш. Однако любые изменения самого файла также изменить его хэш-значение и файл сможет обойти ограничения.

#### <a name="to-create-a-hash-rule"></a>Чтобы создать правило хэширования

1.  Открыть политики ограниченного использования программ.

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **новое правило хэша**.

3.  Нажмите кнопку **Обзор** чтобы найти файл.

    > [!NOTE]
    > В Windows XP возможна вставьте заранее вычисленный хэш в **хэш файла**. В Windows Server 2008 R2, Windows 7 и более поздних версий этот параметр недоступен.

4.  В **уровень безопасности**, выбрать пункт **запрещено** или **Unrestricted**.

5.  В **описание**, введите описание для этого правила и нажмите кнопку **ОК**.

> [!NOTE]
> -   Может потребоваться создать новый параметр политики ограниченного использования программ для объекта групповой политики (GPO), если вы еще не выполнена.
> -   Правило хэширования можно создать для вируса или троянский конь, чтобы предотвратить их запуск.
> -   Если требуется, чтобы другие пользователи могли использовать правило хэширования для запуска вируса, вычислите хэш вируса с помощью политик ограниченного использования программ и затем электронной почты хэш-значения для других пользователей. Никогда не по электронной почте сам вирус.
> -   Если вирус отправлен по электронной почте, также можно создать правило для пути для предотвращения выполнения вложений электронной почты.
> -   Файл, переименовании или перемещении в другую папку в тот же хэш. Любые изменения самого файла приведет к другой хэш.
> -   Файл, затрагиваемые правила хэширования действуют только те типы, перечисленных в **назначенные типы файлов** в области сведений для политик ограниченного использования программ. Существует один список назначенных типов файлов, общих для всех правил.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   Если к параметрам политики применяется несколько правил политики ограниченного использования программ для программного обеспечения, существует приоритет правил, для разрешения конфликтов.

## <a name="BKMK_Internet_Zone_Rules"></a>Работа с правилами для зон Интернета
Правила для зон Интернета применяются только к пакетам установщика Windows. Правило для зоны может определять программу из зоны, заданной в Internet Explorer. Эти зоны, Интернет, местной интрасети, ограниченных узлов, надежные сайты и Мой компьютер. Правило для зоны Интернета предназначен запрещает пользователям загрузку и установку программ.

#### <a name="to-create-an-internet-zone-rule"></a>Чтобы создать правило для зоны Интернета

1.  Открыть политики ограниченного использования программ.

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для зоны Интернета**.

3.  В **зона Интернета**, выберите зону Интернета.

4.  В **уровень безопасности**, выбрать пункт **запрещено** или **Неограниченный**, а затем нажмите кнопку **ОК**.

> [!NOTE]
> -   Может потребоваться создать новый параметр политики ограниченного использования программ для объекта групповой политики (GPO), если вы еще не выполнена.
> -   Правила для зон применяются только к файлам типа MSI, то есть к пакетам установщика Windows.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   Если к параметрам политики применяется несколько правил политики ограниченного использования программ для программного обеспечения, существует приоритет правил, для разрешения конфликтов.

## <a name="BKMK_Path_Rules"></a>Работа с правилами для путей
Правило для пути определяет программу по пути к файлу. Например, если у вас есть компьютер с уровень безопасности по умолчанию **запрещено**, можно предоставить неограниченный доступ к определенной папке для каждого пользователя. Можно создать правило для пути с помощью пути к файлу и задать уровень безопасности в правиле для пути **Unrestricted**. Часто для данного типа правил используются пути % userprofile %, % windir %, % appdata %, % programfiles % и % temp %. Можно также создать реестра правила для пути, как путь к нему с помощью раздела реестра программного обеспечения.

Поскольку такие правила задаются пути, при перемещении программы, правило для пути перестает действовать.

#### <a name="to-create-a-path-rule"></a>Чтобы создать правило для пути

1.  Открыть политики ограниченного использования программ.

2.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для пути**.

3.  В **путь**, введите путь или нажмите кнопку **Обзор** поиск файла или папки.

4.  В **уровень безопасности**, выбрать пункт **запрещено** или **Unrestricted**.

5.  В **описание**, введите описание для этого правила и нажмите кнопку **ОК**.

> [!CAUTION]
> -   В некоторых папках, например в папке Windows, задание уровня безопасности для **запрещено** может отрицательно сказаться на работе операционной системы. Убедитесь, что не запрещается доступ к важному компоненту операционной системы или одну из ее зависимых программ.

> [!NOTE]
> -   Может потребоваться создать новые политики ограниченного использования программ для объекта групповой политики (GPO), если вы еще не выполнена.
> -   Если создать правило для пути для программного обеспечения с безопасности уровнем **запрещено**, пользователи по-прежнему можно запустить эту программу, скопировав ее в другое расположение.
> -   Подстановочные знаки, которые поддерживаются в правиле для пути * и?.
> -   В правиле для пути можно использовать переменные среды, например % programfiles % или % systemroot %.
> -   Если вы хотите создать правило для пути для программного обеспечения, если вы не знаете, где он хранится на компьютере, но имеется ее раздел реестра, можно создать правило для пути реестра.
> -   Чтобы запретить пользователям выполнять вложения электронной почты, можно создать правило для пути для каталога вложений почтовой программы, запрещает пользователям выполнять вложения электронной почты.
> -   Файл, затрагиваемые правила для путей действуют только те типы, перечисленных в **назначенные типы файлов** в области сведений для политик ограниченного использования программ. Существует один список назначенных типов файлов, общих для всех правил.
> -   Для политик ограниченного использования программ вступили в силу пользователи должны обновить параметры политики, выйти и войти в систему.
> -   Если к параметрам политики применяется несколько правил политики ограниченного использования программ для программного обеспечения, существует приоритет правил, для разрешения конфликтов.

#### <a name="to-create-a-registry-path-rule"></a>Чтобы создать правило для пути реестра

1.  На **запустить** экрана, введите regedit.

2.  В дереве консоли щелкните правой кнопкой мыши раздел реестра, который вы хотите создать правило для, а затем нажмите кнопку **Копировать имя раздела**. Обратите внимание на параметр в области сведений.

3.  Открыть политики ограниченного использования программ.

4.  В дереве консоли или в области сведений щелкните правой кнопкой мыши **Дополнительные правила**, а затем нажмите кнопку **создать правило для пути**.

5.  В **путь**, вставьте имя раздела реестра, за которым следует имя значения.

6.  Заключите путь в реестре в знаки процента (%), например, % HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PlatformSDK\Directories\InstallDir%.

7.  В **уровень безопасности**, выбрать пункт **запрещено** или **Unrestricted**.

8.  В **описание**, введите описание для этого правила и нажмите кнопку **ОК**.


