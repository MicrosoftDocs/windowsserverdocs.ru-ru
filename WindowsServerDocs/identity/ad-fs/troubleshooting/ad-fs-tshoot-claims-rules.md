---
title: AD FS устранение неполадок — правила утверждений
description: В этом документе описывается, как устранять неполадки синтаксиса правил утверждений с помощью AD FS
author: billmath
ms.author: billmath
manager: mtillman
ms.date: 03/01/2018
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 94e841282963e2b2b6ada552b54c7732d965b6b6
ms.sourcegitcommit: d5e27c1f2f168a71ae272bebf8f50e1b3ccbcca3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "86955976"
---
# <a name="ad-fs-troubleshooting---claims-rules-syntax"></a>AD FS устранение неполадок — синтаксис правил утверждений
Утверждение — это оператор, который один субъект делает о себе или другой теме.  Утверждения выдаются проверяющей стороной и получают одно или несколько значений, а затем упаковываются в маркеры безопасности, выданные сервером AD FS.  В этой статье рассматривается синтаксис и создание заявок.  Сведения о выдаче утверждений см. в [статье AD FS устранение неполадок — выдача утверждений](ad-fs-tshoot-claims-issuance.md).

>[!NOTE]  
>[Клаимсксрай](https://adfshelp.microsoft.com/ClaimsXray/TokenRequest) можно использовать на [справочном сайте ADFS](https://adfshelp.microsoft.com) для помощи в устранении проблем с утверждениями.   

## <a name="how-claim-rules-are-processed"></a>Порядок обработки правил утверждений
Правила утверждений обрабатываются через [конвейер утверждений](../../ad-fs/technical-reference/The-Role-of-the-Claims-Pipeline.md) с помощью [подсистемы утверждений](../../ad-fs/technical-reference/The-Role-of-the-Claims-Engine.md). Модуль утверждений — это логический компонент службы федерации, который проверяет набор входящих утверждений, представленный пользователем, и в соответствии с логикой каждого правила создает выходной набор утверждений.

## <a name="how-to-create-a-claim-rule"></a>Создание правила утверждения
Правила утверждений создаются отдельно для каждого федеративного отношения доверия в службе федерации и не используются совместно несколькими отношениями. Вы можете создать правило на основе [шаблона правила утверждений](../../ad-fs/technical-reference/determine-the-type-of-claim-rule-template-to-use.md), начать с нуля, разработав правило с помощью [языка правил утверждений](../../ad-fs/technical-reference/when-to-use-a-custom-claim-rule.md) , или настроить правило с помощью Windows PowerShell.

## <a name="understanding-the-components-of-the-claim-rule-language"></a>Основные сведения о компонентах языка правил утверждений
Язык правил утверждений состоит из следующих компонентов, разделенных оператором "=>":

- Условие — используется для проверки входных утверждений и определения того, следует ли выполнять инструкцию выдачи правила.  Он представляет логическое выражение, которое должно быть оценено как истинное для выполнения части тела правила.

- Оператор выдачи

Пример.

```c:[type == "Name", value == "domain user"] => issue(type = "Role", value = "employee");``` 

Следующее утверждение имеет следующие требования:
- условие — `c:[type == "Name", value == "domain user"] ` оценивает входное утверждение того, является ли имя учетной записи Windows пользователь домена.
- выдача — `issue(type = "Role", value = "employee")` Если условие истинно, добавляет новое утверждение в входящее утверждение с ролью Employee.

Дополнительные сведения об утверждениях и синтаксисе см. в разделе [роль языка правил утверждений](../../ad-fs/technical-reference/the-role-of-the-claim-rule-language.md).

## <a name="claims-rule-editor"></a>Редактор правил утверждений
Проверка синтаксиса выполняется редактором правил утверждений после завершения утверждения и нажатия кнопки **ОК**.  Поэтому при наличии неправильного синтаксиса редактор предоставит вам информацию.

![claims](media/ad-fs-tshoot-claims/claims1.png)

## <a name="event-logs"></a>Журналы событий
При попытке устранения неполадок с утверждением с помощью журналов лучшим подходом является поиск выходных данных утверждений.  События 1000 и 1001 можно найти в журнале событий.

![claims](media/ad-fs-tshoot-claims/claims2.png)

## <a name="creating-a-sample-application"></a>Создание примера приложения
Вы также можете создать пример приложения, который выводит на экран ваши заявки.  Например, можно использовать пример приложения и создать проверяющую сторону с тем же утверждением, которое вы пытаетесь устранить, и узнать, есть ли у приложения проблемы с этим утверждением.

![claims](media/ad-fs-tshoot-claims/claim4.png)

Хороший пример веб-приложения доступен здесь.  Это простое веб-приложение, которое возвращает заявки, получаемые от проверяющей стороны.  Чтобы использовать его, необходимо изменить приложение web.config следующим образом:
- переход https://app1.contoso.com/sampapp на URL-адрес, который будет использоваться для размещения сампапп
- изменение всех экземпляров sts.contoso.com для указания AD FS сервера федерации
- Замена отпечатка отпечатком

![claims](media/ad-fs-tshoot-claims/claims3.png)

В следующей [статье блога](/archive/blogs/tangent_thoughts/install-and-configure-a-simple-net-4-5-sample-federated-application-samapp) приводятся подробные инструкции по ее настройке.

## <a name="next-steps"></a>Дальнейшие шаги

- [Устранение неполадок в AD FS](ad-fs-tshoot-overview.md)
