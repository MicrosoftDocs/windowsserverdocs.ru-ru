---
title: Средство анализа данных диагностики AD FS
description: В этом документе описывается анализатор помочь диагностики AD FS и как выполнять основные проверяет с помощью системы диагностики AD FS модуля PowerShell.
author: billmath
ms.author: billmath
manager: mtillman
ms.reviewer: anandyadavMSFT
ms.date: 03/29/2019
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 8d9acd1adcb8d9566b154abfef940e21609a6684
ms.sourcegitcommit: 4ff3d00df3148e4bea08056cea9f1c3b52086e5d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64773372"
---
# <a name="ad-fs-help-diagnostics-analyzer"></a>Средство анализа данных диагностики AD FS

AD FS имеет множество параметров, которые поддерживают большое количество различных функций, которые он предоставляет для разработки приложений и проверкой подлинности. Во время устранения неполадок, рекомендуется убедиться, что все параметры AD FS настроены правильно. Выполнив проверку вручную из этих параметров иногда может занять много времени. Анализатор помочь диагностики AD FS может помочь выполнить основные проверки, с помощью модуля ADFSToolbox PowerShell. После выполнения проверки, Справка по AD FS предоставляет [анализатора диагностики](https://aka.ms/adfsdiagnosticsanalyzer) помогут вам легко визуализировать результаты и предлагают действия по устранению проблемы.

Завершения операции принимает 3 простых шага:

1. Программа установки модуля ADFSToolbox на основной сервер AD FS или WAP-сервера
2. Выполнение диагностики и отправьте файл раздела справки AD FS
3. Просмотр диагностики анализа и устранения проблем

Перейдите к [анализатор помочь диагностики AD FS (https://aka.ms/adfsdiagnosticsanalyzer) ](https://aka.ms/adfsdiagnosticsanalyzer) для устранения неполадок прежде.

![Средство диагностики анализатора AD FS на Справка по AD FS](media/ad-fs-diagonostics-analyzer/home.png)

## <a name="step-1-setup-the-adfstoolbox-module-on-ad-fs-server"></a>Шаг 1. Программа установки модуля ADFSToolbox на сервере AD FS

Для запуска [анализатора диагностики](https://aka.ms/adfsdiagnosticsanalyzer), необходимо установить модуль ADFSToolbox PowerShell. Если на сервере AD FS есть подключение к Интернету, можно установить модуль ADFSToolbox непосредственно из коллекции PowerShell. В случае отсутствует подключение к Интернету клонируйте репозиторий GitHub для установки вручную.

![Анализатор диагностики AD FS - установки](media/ad-fs-diagonostics-analyzer/step1.png)

### <a name="setup-using-powershell-gallery"></a>Настройка с помощью коллекции PowerShell

Если на сервере AD FS есть подключение к Интернету, рекомендуется, чтобы установить модуль ADFSToolbox непосредственно из коллекции PowerShell, используя приведенные ниже команды PowerShell.

   ```powershell
    Install-Module -Name ADFSToolbox -force
    Import-Module ADFSToolbox -force
   ```
### <a name="setup-manually-by-cloning-the-repository"></a>Настройка вручную путем клонирования репозитория

Модуль ADFSToolbox можно установить вручную с сайта GitHub напрямую. Следуйте инструкциям ниже для клонирования репозитория и установке модуля ADFSToolbox на сервере AD FS.

1. Скачайте [репозитория](https://github.com/Microsoft/adfsToolbox/archive/master.zip)
2. Распакуйте скачанный файл и скопируйте папку adfsToolbox-master на % SYSTEMDRIVE %\\Program Files\\WindowsPowerShell\\модули\\.
3. Импортируйте модуль PowerShell. В окне PowerShell с повышенными правами используйте следующую команду:

   ```powershell
    Import-Module ADFSToolbox -Force
   ```

## <a name="step-2-execute-the-diagnostics-and-upload-the-file-to-ad-fs-help"></a>Шаг 2. Выполнение диагностики и отправьте файл раздела справки AD FS

Можно использовать одну команду удобно выполнить диагностические тесты на всех серверах AD FS в ферме. Модуль PowerShell будет использовать удаленные сеансы PS для выполнения диагностических тестов по разным серверам в ферме.

```powershell
    Export-AdfsDiagnosticsFile [-adfsServers <list of servers>]
```

В ферме Server 2016 AD FS команда будет считывать список серверов AD FS из конфигурации AD FS. Диагностические тесты затем применяются на каждом из серверов в списке. Если список серверов AD FS не доступен (пример 2012 R2), а затем тесты выполняются на локальном компьютере. Чтобы указать список серверов, для которых должны выполняться тесты, используйте **adfsServers** аргумент для предоставления списка серверов. Ниже приведен пример

```powershell
    Export-AdfsDiagnosticsFile -adfsServers @("sts1.contoso.com", "sts2.contoso.com", "sts3.contoso.com")
```

Результатом является файл JSON, который создается в том же каталоге где была запущена команда. Имя файла — ADFSDiagnosticsFile -\<timestamp\>. Пример имени файла — ADFSDiagnosticsFile 20180716124030.

На шаге 2 на [ https://aka.ms/adfsdiagnosticsanalyzer ](https://aka.ms/adfsdiagnosticsanalyzer) использование обозревателя файлов для выбора файла для отправки результатов.

![AD FS диагностики анализатор - выполнение и загрузить результаты](media/ad-fs-diagonostics-analyzer/step2.png)

Щелкните **отправить** закончить передачу и перейти к следующему шагу.


Выполнив вход с учетной записью Майкрософт, поддерживают диагностику результаты можно сохранить для более позднем этапе просмотра и могут отправляться в корпорацию Майкрософт. Если в любой момент, можно обратиться в службу поддержки Microsoft смогут просматривать результаты диагностического анализатора и помочь устранить проблему быстрее.

![AD FS диагностики анализатор - входа](media/ad-fs-diagonostics-analyzer/sign_in_step.png)

## <a name="step-3-view-diagnostics-analysis-and-resolve-any-issues"></a>Шаг 3. Просмотр диагностики анализа и устранения проблем

Существует четыре раздела результатов:

1. Не удалось выполнить: Этот раздел содержит список тестов, которые не удалось. Каждый результат состоит из:
2. Предупреждение: Этот раздел содержит список тестов, которые привели к появлению предупреждения. Эти проблемы не может привести проблемы проверки подлинности в широком масштабе, но должны быть решены как можно скорее.
3. Неприменимо: Этот раздел содержит список тестов, которые не были выполнены, поскольку они неприменимы для конкретного сервера, на котором выполнялась команда.
4. Передано: Этот раздел содержит список тестов, которые передаются и иметь никакие действия пользователя.

![AD FS диагностики анализатор - список результатов тестов](media/ad-fs-diagonostics-analyzer/step3a_v2.png) каждого результата теста отображаются сведения, которые описывают шаги теста и разрешение:

1. Имя теста: Имя теста, который был выполнен
2. Подробные сведения: Описание общую операцию, выполненную во время теста
3. Действия по разрешению: Предложенные действия, чтобы устранить проблему, очерченную теста

![AD FS диагностики анализатор - Устранение ошибок](media/ad-fs-diagonostics-analyzer/step3b_v2.png)

## <a name="next"></a>Далее

- [Используйте руководства troublehshooting Справка по AD FS](https://aka.ms/adfshelp/troubleshooting )
- [Устранение неполадок в AD FS](ad-fs-tshoot-overview.md)
