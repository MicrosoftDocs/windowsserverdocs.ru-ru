---
ms.assetid: 208928eb-bb17-4984-a312-23fff43133e3
title: Усовершенствования аудита в AD FS под управлением Windows Server 2016
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 10/25/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 4eb93513d12b2bba2620ff16be24f62ace5dee85
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71407259"
---
# <a name="auditing-enhancements-to-ad-fs-in-windows-server-2016"></a>Усовершенствования аудита в AD FS под управлением Windows Server 2016


В настоящее время в AD FS для Windows Server 2012 R2 существует множество событий аудита, созданных для одного запроса, и соответствующие сведения о действиях входа или выдачи маркера либо отсутствуют (в некоторых версиях AD FS), либо распределены по нескольким событиям аудита. По умолчанию события аудита AD FS отключены из-за их подробной природы.  
    В выпуске AD FS в Windows Server 2016 аудит стал более оптимизированным и менее подробным.  
  
## <a name="auditing-levels-in-ad-fs-for-windows-server-2016"></a>Уровни аудита в AD FS для Windows Server 2016  
По умолчанию для AD FS в Windows Server 2016 включен базовый аудит.  При базовом аудите администраторы увидят 5 или менее событий для одного запроса.  Это означает значительное уменьшение количества событий, которые администраторы должны просматривать, чтобы увидеть один запрос.   Уровень аудита может быть повышен или снижен с помощью PowerShell командлет:  Set-AdfsProperties-AuditLevel.  В таблице ниже описываются доступные уровни аудита.  
  
||||  
|-|-|-|  
|Уровень аудита|Синтаксис PowerShell|Описание|  
|Нет|Set-AdfsProperties-AuditLevel None|Аудит отключен, и никакие события не регистрируются.|  
|Базовый (по умолчанию)|Set-AdfsProperties-AuditLevel Basic|Для одного запроса будет зарегистрировано не более 5 событий.|  
|Verbose|Set-AdfsProperties-AuditLevel verbose|Будут регистрироваться все события.  При этом будет записываться значительный объем информации по запросу.|  
  
Чтобы просмотреть текущий уровень аудита, можно использовать командлет PowerShell:  Get-AdfsProperties.  
  
![усовершенствования аудита](media/Auditing-Enhancements-to-AD-FS-in-Windows-Server-2016/ADFS_Audit_1.PNG)  
  
Уровень аудита может быть повышен или снижен с помощью PowerShell командлет:  Set-AdfsProperties-AuditLevel.  
  
![усовершенствования аудита](media/Auditing-Enhancements-to-AD-FS-in-Windows-Server-2016/ADFS_Audit_2.png)  
  
## <a name="types-of-audit-events"></a>Типы событий аудита  
AD FS события аудита могут принадлежать различным типам, основанным на разных типах запросов, обрабатываемых AD FS. Каждый тип события аудита связан с конкретными данными.  Типы событий аудита могут различаться между запросами на вход (т. е. запросами маркера) и системными запросами (вызовы сервера, включая получение сведений о конфигурации).    
  В следующей таблице описаны основные типы событий аудита.  
  
||||  
|-|-|-|  
|Тип события аудита|Идентификатор события|Описание|  
|Успешная проверка учетных данных|1202|Запрос, в котором успешно проверяются новые учетные данные служба федерации. Сюда входят WS-Trust, WS-Federation, SAML-P (первый этап для создания единого входа) и службы авторизации OAuth.|  
|Новая ошибка проверки учетных данных|1203|Запрос, в котором не пройдена новая проверка учетных данных служба федерации. К ним относятся WS-Trust, WS-подача, SAML-P (первый этап для создания единого входа) и службы авторизации OAuth.|  
|Маркер приложения успешно выполнен|1200|Запрос, в котором служба федерации успешно выдается маркер безопасности. Для WS-Federation SAML-P это регистрируется, когда запрос обрабатывается с помощью артефакта единого входа. (например, файл cookie единого входа).|  
|Сбой маркера приложения|1201|Запрос, в котором произошел сбой выдачи маркера безопасности служба федерации. Для WS-Federation SAML-P регистрируется при обработке запроса с помощью артефакта единого входа. (например, файл cookie единого входа).|  
|Запрос на смену пароля успешно выполнен|1204|Транзакция, в которой запрос на изменение пароля был успешно обработан служба федерации.|  
|Ошибка запроса на смену пароля|1205|Транзакция, в которой не удалось обработать запрос на изменение пароля служба федерации.| 
|Выход успешно выполнен|1206|Описывает успешный запрос на выход.|  
|Сбой выхода|1207|Описывает неудачный запрос на выход.|  

  


