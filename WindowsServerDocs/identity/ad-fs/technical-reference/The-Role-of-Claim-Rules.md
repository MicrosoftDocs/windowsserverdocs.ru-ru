---
ms.assetid: 65e474b5-3076-4ba3-809d-a09160f7c2bd
title: "Роль правил утверждений"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: e47dbecdeee620d3a237ad8d8c41a550d3ef069c
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
>Область применения: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

# <a name="the-role-of-claim-rules"></a>Роль правил утверждений
Основное назначение службы федерации в службах федерации Active Directory \(AD FS\) — предоставление токена, содержащего набор утверждений. Решение относительно того, какие утверждения AD FS принимает, а затем выдает, принимается в соответствии с правилами утверждений.  
  
## <a name="what-are-claim-rules"></a>Что такое правила утверждений?  
Правило утверждения представляет экземпляр бизнес-логики, который будет принимает один или несколько входящих утверждений, применяет к ним условия \ (если x затем y\) и создает один или несколько исходящих утверждений на основе параметров условия. Дополнительные сведения о входящих и исходящих утверждениях см. в разделе [The Role of Claims ](The-Role-of-Claims.md).  
  
Правила утверждений используются, когда необходимо реализовать бизнес-логику, контролирующую поток утверждений через конвейер утверждений. Когда конвейер утверждений — это скорее логическая сущность из end\ заполнением части процесса передачи утверждений, правила утверждений являются реальным административным элементом, который можно использовать для настройки потока утверждений в процессе выдачи утверждений.  
  
Дополнительные сведения о конвейере утверждений см. в разделе [The Role of the Claims Engine ](The-Role-of-the-Claims-Engine.md).  
  
Правила утверждений обеспечивают следующие преимущества:  
  
-   Предоставляет механизм для администраторов, применять время отладка бизнес-логику для обеспечения доверия к утверждениям от поставщиков утверждений  
  
-   Предоставляет механизм для администраторов определить, какие утверждения будут предоставляться проверяющим сторонам  
  
-   Предоставляют возможности авторизации на основе claims\, широкие для администраторов, которым нужно разрешить или запретить доступ определенным пользователям  
  
### <a name="how-claim-rules-are-processed"></a>Порядок обработки правил утверждений  
Правила утверждений обрабатываются посредством конвейера утверждений с помощью *модуль утверждений *. Модуль утверждений — это логический компонент службы федерации, который проверяет набор входящих утверждений, представленный пользователем и будет затем, в соответствии с логикой каждого правила создает выходной набор утверждений.  
  
Вместе утверждения правило обработчика и набор правил утверждений, связанный с данным федеративным отношением доверия определяют ли входящие утверждения следует передать их, фильтруются в соответствии с определенным условием или преобразовать в совершенно новый набор утверждений, прежде чем они будут выпущены как исходящие утверждения с вашей службы федерации.  
  
Дополнительные сведения об этом процессе см. в разделе [The Role of the Claims Engine ](The-Role-of-the-Claims-Engine.md).  
  
## <a name="what-are-claim-rule-templates"></a>Что такое шаблоны правил утверждений  
AD FS включает предварительно определенный набор правил утверждений шаблонов, которые призваны упростить выбор и создание наиболее подходящих правил утверждений для вашей определенных бизнес-потребностей. Правило, шаблоны используются только в процессе создания правил утверждений для утверждения.  
  
В оснастка управления AD FS правила можно создавать только с помощью шаблонов правил для утверждений. Когда используется оснастка выберите шаблон правила утверждения, введите необходимые данные для логики правила и сохранить его в базе данных конфигурации, оно будет \ (из этой точки forward\) указывается в пользовательском Интерфейсе правилом утверждения.  
  
### <a name="how-claim-rule-templates-work"></a>Как работают шаблоны правил утверждений  
На первый взгляд шаблоны правил утверждений видимому обычными формами ввода, предоставляемые оснастка сбора данных и применения логики ко входящим утверждениям. Тем не менее гораздо более детально шаблонах правил утверждений хранятся языковые структуры правил, которые образуют базовую логику, необходимую для быстрого создания правила без необходимости тесно знакомства с языком утверждений.  
  
Каждый шаблон, предоставляемый в пользовательском интерфейсе \(UI\) представляет предварительно синтаксиса языка правил утверждений, в зависимости от наиболее распространенных задач администрирования. Однако есть один шаблон правил, то есть исключение. Этот шаблон называется настраиваемым шаблонов правил. В этом шаблоне синтаксис не заполнен. Вместо этого вам надо самостоятельно составить синтаксиса языка правил утверждений в теле формы шаблона правила утверждения, с помощью синтаксиса языка правил утверждений.  
  
Дополнительные сведения об использовании синтаксиса языка правил утверждений см. в разделе [роль языка правил утверждений](The-Role-of-the-Claim-Rule-Language.md) в руководстве по развертыванию AD FS.  
  
> [!TIP]  
> Можно просмотреть язык правила утверждения, связанный с правилом в любое время, нажав **Просмотр языка правила** кнопки в свойствах правила утверждения.  
  
### <a name="how-to-create-a-claim-rule"></a>Создание правила утверждения  
Правила утверждений создаются отдельно для каждого федеративного отношения доверия в службе федерации и не используются совместно несколькими отношениями. Можно создать правило на основе шаблона правил утверждений, начать с нуля с помощью языка правил утверждений или настроить правило с помощью Windows PowerShell.  
  
Все эти варианты доступны одновременно, обеспечивает гибкость при выборе подходящего способа для конкретного сценария. Дополнительные сведения о создании правил утверждений см. в разделе [Настройка правил для утверждений](https://technet.microsoft.com/library/ee913571.aspx) FSDeployment руководства по AD.  
  
#### <a name="using-claim-rule-templates"></a>С помощью шаблонов правил для утверждений  
Правило, шаблоны используются только в процессе создания правил утверждений для утверждения. Для создания правила утверждения можно использовать любой из следующих шаблонов:  
  
-   Пропуск или Фильтрация входящего утверждения  
  
-   Преобразование входящего утверждения  
  
-   Отправка атрибутов LDAP как утверждений  
  
-   Отправка членства в группах как утверждения  
  
-   Отправка утверждений с помощью настраиваемого правила  
  
-   Разрешать или запрещать пользователям на основании входящего утверждения  
  
-   Разрешить всем пользователям  
  
Более подробное описание каждого из этих шаблонов правил для утверждений см. в разделе [определить тип из утверждений шаблон правила для использования](Determine-the-Type-of-Claim-Rule-Template-to-Use.md).  
  
#### <a name="using-the-claim-rule-language"></a>С помощью языка правил утверждений  
Для бизнес-правил, не охватываемых стандартными шаблонами правил утверждений можно использовать настраиваемый шаблон правила для выражения сложных условий логики с помощью языка правил утверждений. Дополнительные сведения об использовании настраиваемого правила см. в разделе [когда следует использовать настраиваемое правило утверждения](When-to-Use-a-Custom-Claim-Rule.md).  
  
#### <a name="using-windows-powershell"></a>С помощью Windows PowerShell  
Также можно использовать объект командлета ADFSClaimRuleSet в Windows PowerShell для создания или администрирования правила в AD FS. Дополнительные сведения об использовании Windows PowerShell с помощью этого командлета см. в разделе [Администрирование AD FS с помощью Windows PowerShell](https://go.microsoft.com/fwlink/?LinkID=179634).  
  
## <a name="what-is-a-claim-rule-set"></a>Что такое набор правил утверждений  
Как показано на рисунке ниже, набор правил утверждений — это группа из одного или нескольких правил для определенного федеративного отношения доверия, которая определяет способ обработки утверждений модулем правил утверждений. Когда служба федерации получает входящее утверждение модуль утверждений применяет логику, заданную в соответствующем наборе правил утверждений. Является общим результатом применения логики из каждого правила в наборе, которое будет определять, как будут выданы утверждения для всего отношения доверия в полном объеме.  
  
![Роли AD FS](media/adfs2_claimruleset.gif)  
  
Правила утверждений обрабатываются подсистемой утверждений в хронологическом порядке в пределах заданного набора правил. Этот порядок важен, так как выходные данные одного правила могут служить входными данными для следующего правила в наборе.  
  
## <a name="what-are-claim-rule-set-types"></a>Типы наборов правил утверждений?  
Тип набора правил утверждений — логическая часть федеративного отношения доверия, которая категорически определяет, будет ли набор правил утверждений, связанный с отношением доверия, использоваться для выдачи, авторизации или принятия утверждений. Каждым федеративным отношением доверия может иметь один или несколько наборов правил утверждений типы, связанные с ней, в зависимости от типа создаваемого доверия используется.  
  
В следующей таблице описываются различные типы наборов правил утверждений и объясняется их связь с отношением доверия с поставщиком утверждений или с доверия с проверяющей стороной.  
  
|Тип набора правил утверждений|Описание|Использовать на|  
|-----------------------|---------------|-----------|  
|Набор правил преобразования принятия|Набор правил утверждений, применяющийся к определенному доверия поставщика утверждений для указания входящих утверждений, которые будут приняты от организации поставщика утверждений и исходящих утверждений, которые будут отправляться доверия с проверяющей стороной.<br /><br />Входящие утверждения, служащие источником для этого набора правил, будут выходными утверждениями правил преобразования выдачи значение, указанное в организации поставщика утверждений.<br /><br />По умолчанию узел отношений доверия с поставщиком утверждений содержит отношения доверия с поставщиком утверждений с именем **Active Directory** которого используется для представления исходное хранилище атрибутов для набора правил преобразования принятия. Этот объект отношения доверия представляет связь службы федерации к базе данных Active Directory в вашей сети. Это отношение доверия по умолчанию именно обрабатывает утверждения для пользователей, прошедших аутентификацию в Active Directory и его нельзя удалить.|Отношения доверия с поставщиком утверждений|  
|Набор правил преобразования выдачи|Набор правил утверждений, применяется к отношению доверия с проверяющей стороной для указания утверждений, которые будут выданы проверяющей стороне.<br /><br />Входящих утверждений, которые будут использоваться для получения этого набора правил, изначально будут выходными утверждениями правил преобразования приемки.|Отношения доверия проверяющей стороны|  
|Набор правил авторизации выдачи|Набор правил утверждений, применяется к отношению доверия с проверяющей стороной для указания пользователей, которым будет разрешено получить токен для проверяющей стороны.<br /><br />Эти правила определяют, может ли пользователь получать утверждения для проверяющей стороны и, следовательно, доступ к проверяющей стороне.<br /><br />Если не указать правило авторизации выдачи, всем пользователям будет запрещен по умолчанию доступ.|Отношения доверия проверяющей стороны|  
|Набор правил авторизации делегирования|Набор правил утверждений, применяется к отношению доверия с проверяющей стороной для указания пользователей, которым будет разрешено выступать в роли делегатов других пользователей для проверяющей стороны.<br /><br />Эти правила определяют, разрешено ли инициатору запроса олицетворять пользователя при этом инициатор запроса в токене, отправляемом проверяющей стороне.<br /><br />Если указать правило авторизации выдачи, пользователи не могут выступать в роли делегатов по умолчанию.|Отношения доверия проверяющей стороны|  
|Набор правил авторизации олицетворения|Набор правил утверждений, настроенные с помощью Windows PowerShell, чтобы определить, может ли пользователь полностью олицетворять другого пользователя для проверяющей стороны.<br /><br />Эти правила определяют, разрешено ли инициатору запроса олицетворять пользователя без указания инициатора в токене, отправляемом проверяющей стороне.<br /><br />Олицетворение другого пользователя, таким образом — очень мощная возможность, поскольку проверяющая сторона не знает, что пользователь олицетворяется.|Проверяющей стороной доверия|  
  
Дополнительные сведения о выборе подходящих правил утверждений для использования в вашей организации. в разделе [определить тип из утверждений шаблон правила для использования](Determine-the-Type-of-Claim-Rule-Template-to-Use.md).  
  

