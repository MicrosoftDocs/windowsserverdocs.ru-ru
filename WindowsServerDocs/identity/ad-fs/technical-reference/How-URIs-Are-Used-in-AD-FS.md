---
ms.assetid: 53ee93e2-09ea-4f8b-adb7-c24c59f055ea
title: Использование уникальных идентификаторов ресурса (URI) в AD FS
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: d42be6d8716bfd90c7a2cf32acf6ddd4ce94061f
ms.sourcegitcommit: 2cc251eb5bc3069bf09bc08e06c3478fcbe1f321
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "84333885"
---
# <a name="how-uris-are-used-in-ad-fs"></a>Использование уникальных идентификаторов ресурса (URI) в AD FS
URI универсального идентификатора \( ресурса \) — это строка символов, которая используется в качестве уникального идентификатора.  В службах AD FS коды URI используются для обозначения сетевых адресов партнеров и объектов конфигурации.  При использовании для обозначения сетевых адресов партнеров URI всегда является URL-адресом.  При использовании для обозначения объектов конфигурации URI может быть URN или URL-адресом.  Общие сведения о кодах URI см. в стандартах [RFC 2396](https://go.microsoft.com/fwlink/?LinkId=48289) и [RFC 3986](https://go.microsoft.com/fwlink/?LinkId=90453).  
  
## <a name="uris-as-partner-network-addresses"></a>Коды URI в качестве сетевых адресов партнеров  
Ниже приведены сетевые URL-адреса, с которыми чаще всего сталкиваются администраторы в AD FS.  
  
-   URL-адреса служба федерации, включая WS \- Federation, SAML, WS \- Trust, метаданные федерации, WS \- MetadataExchange, конфиденциальность и URL-адреса Организации.  
  
-   URL-адреса отношений доверия с проверяющей стороной, включая \- URL-адреса МЕТАДАННЫХ WS Federation, SAML и Federation.  
  
-   URL-адреса отношений доверия поставщиков утверждений, включая \- URL-адреса МЕТАДАННЫХ WS Federation, SAML и Federation.  
  
## <a name="uris-as-object-identifiers"></a>Коды URI в качестве идентификаторов объектов  
Ниже приведены идентификаторы, с которыми чаще всего сталкиваются администраторы в AD FS.  
  
|Идентификатор|Описание|Сравнения|  
|-------------------|---------------|---------------|  
|Идентификатор службы федерации|Этот идентификатор используется для обозначения службы федерации.  Он используется проверяющими сторонами, использующими утверждения от этой службы федерации, а также поставщиками утверждений, выдающими утверждения для службы федерации.|Когда пользователь запрашивает у поставщика утверждений утверждения для службы федерации, идентификатор этой службы федерации будет использоваться для обозначения целевого объекта утверждений.<p>Когда служба федерации получает утверждения от поставщика утверждений, она проверяет, что утверждения относятся именно к ней, выполняя поиск своего идентификатора.<p>Когда проверяющая сторона получает утверждения из этой службы федерации, проверяющая сторона проверяет, что издатель утверждения соответствует идентификатору службы федерации.|  
|Идентификатор проверяющей стороны|Этот идентификатор используется для обозначения проверяющей стороны в службе федерации.  Он используется при выдаче утверждений для проверяющей стороны.|Когда пользователь запрашивает утверждения от службы федерации для проверяющей стороны, идентификатор этой проверяющей стороны будет использоваться для обозначения проверяющей стороны, для которой предназначены утверждения.  Это сравнение выполняется с помощью сопоставления префиксов \( см \) . ниже.<p>Когда проверяющая сторона получает утверждения, она проверяет идентификатор в токене безопасности, чтобы гарантировать, что утверждения предназначены для нее.|  
|Идентификатор поставщика утверждений|Этот идентификатор используется для обозначения поставщика утверждений в службе федерации.  Он используется при получении утверждений от поставщика утверждений.|Когда служба федерации получает утверждения от поставщика утверждений, служба федерации проверяет, что издатель утверждений соответствует идентификатору поставщика утверждений.|  
|Тип утверждения|Этот идентификатор используется для определения типа утверждения.  Он используется этой службой федерации, поставщиками утверждений и проверяющими сторонами при отправке и получении утверждений.|Когда служба федерации получает утверждения от поставщика утверждений, правила утверждений, связанные с соответствующим отношением доверия поставщика утверждений позволяют администратору сравнивать типы утверждений и обрабатывать утверждения.  Правила утверждения, связанные с отношением доверия с проверяющей стороной, также позволяют администратору сравнивать типы утверждений на основе утверждений, поступающих из правил отношения доверия с поставщиком утверждений, а также решать, какие утверждения выдавать.|  
  
## <a name="uri-prefix-matching-for-relying-party-identifiers"></a>Сопоставление префиксов URI для идентификаторов проверяющей стороны  
Синтаксис пути универсального кода ресурса (URI) организован иерархически и разделяются либо символами « \/ », либо всеми символами «:».Таким образом, путь может быть разбит на участки пути в зависимости от символа-разделителя.При сопоставлении префиксов каждый раздел должен быть полным совпадением в соответствии с правилами сопоставления \( , которые управляют регистром совпадений \) . Дополнительные сведения о правилах сопоставления см. в документе RFC, упомянутом выше.  
  
Когда проверяющая сторона определяется в запросе к службе федерации, службы AD FS используют логику сопоставления префиксов, чтобы определить наличие соответствующего отношения доверия с проверяющей стороной в базе данных конфигурации AD FS.  
  
Например, если идентификатор проверяющей стороны в базе данных конфигурации AD FS \( URI1 \) является префиксом идентификатора проверяющей стороны во входящем запросе \( URI2 \) , то должны выполняться следующие условия.  
  
-   Замыкающие разделители \( — косые черты и двоеточия \) для разделов пути или центров должны игнорироваться.  
  
-   Регистр частей схем и данных о пользователе и узле идентификаторов URI1 и URI2 должен строго совпадать.  
  
-   Каждый раздел пути URI1 должен быть точным совпадением в \( зависимости от регистра, выбранного \) для соответствующего раздела пути в URI2  
  
-   URI2 может иметь больше участков пути, чем URI1, однако URI1 не должен иметь больше участков пути, чем URI2.  
  
-   URI1 не может иметь больше участков пути, чем URI2.  
  
-   Если URI1 включает фрагмент, он должен строго соответствовать фрагменту URI2.  
  
 >[!NOTE]
 > Параметры строки запроса не поддерживаются и будут игнорироваться в идентификаторах проверяющей стороны.
  
Дополнительные примеры приводятся в таблице ниже. 

|Идентификатор проверяющей стороны в базе данных конфигурации AD FS|Идентификатор проверяющей стороны в сообщении запроса|Идентификатор запроса совпадает с идентификатором конфигурации?|Причина|  
|------------------------------------------------------------|-----------------------------------------------|------------------------------------------------------------|----------|  
|http: \/ \/ contoso.com|http: \/ \/ contoso.com|TRUE|Точное соответствие|  
|http: \/ \/ contoso.com\/|http: \/ \/ contoso.com|TRUE|Конечные символы косой черты игнорируются.|  
|http: \/ \/ contoso.com|http: \/ \/ contoso.com\/|TRUE|Конечные символы косой черты игнорируются.|  
|http: \/ \/ contoso.com|http: \/ \/ contoso.com \/ HR|TRUE|URI1 не включает путь и соответствует схеме и данным о пользователе и узле для URI2.|  
|http: \/ \/ contoso.com \/ HR|http: \/ \/ contoso.com \/ HR \/ Web|TRUE|Первые участки пути совпадают, в URI1 нет второго участка пути.|  
|http: \/ \/ contoso.com \/ HR\/|http: \/ \/ contoso.com \/ роли Runbook \/ Main|FALSE|Участок пути 1 идентификатора URI1 не соответствует участку пути 1 идентификатора URI2.|  
|http: \/ \/ contoso.com \/ HR|http: \/ \/ contoso.com|FALSE|URI1 имеет больше участков пути, чем URI2.|  
|http: \/ \/ contoso.com \/ HR|http: \/ \/ contoso.com \/ HRweb|FALSE|Первые участки пути не совпадают.|  
|HTTPS: \/ \/ contoso.com|http: \/ \/ contoso.com|FALSE|Части схемы не совпадают.|  
|http: \/ \/ STS.contoso.com|http: \/ \/ contoso.com|FALSE|Части данных о пользователе и узле не совпадают.|  
|http: \/ \/ contoso.com|http: \/ \/ STS.contoso.com|FALSE|Части данных о пользователе и узле не совпадают.|  
  

