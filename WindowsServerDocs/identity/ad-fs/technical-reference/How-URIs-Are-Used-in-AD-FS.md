---
ms.assetid: 53ee93e2-09ea-4f8b-adb7-c24c59f055ea
title: Использование уникальных идентификаторов ресурса (URI) в AD FS
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 677d3136305cbddd29f2fd782be33ae1e824d096
ms.sourcegitcommit: 0b5fd4dc4148b92480db04e4dc22e139dcff8582
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/24/2019
ms.locfileid: "66188553"
---
# <a name="how-uris-are-used-in-ad-fs"></a>Использование уникальных идентификаторов ресурса (URI) в AD FS
Универсальный код ресурса \(URI\) представляет строку символов, которая используется в качестве уникального идентификатора.  В службах AD FS коды URI используются для обозначения сетевых адресов партнеров и объектов конфигурации.  При использовании для обозначения сетевых адресов партнеров URI всегда является URL-адресом.  При использовании для обозначения объектов конфигурации URI может быть URN или URL-адресом.  Общие сведения о кодах URI см. в стандартах [RFC 2396](https://go.microsoft.com/fwlink/?LinkId=48289) и [RFC 3986](https://go.microsoft.com/fwlink/?LinkId=90453).  
  
## <a name="uris-as-partner-network-addresses"></a>Коды URI в качестве сетевых адресов партнеров  
Ниже приведены сетевые URL-адреса, с которыми чаще всего сталкиваются администраторы в AD FS.  
  
-   URL-адреса службы федерации, в том числе WS\-WS Federation, SAML,\-доверия, метаданные федерации WS\-MetadataExchange, конфиденциальности и URL-адреса организации  
  
-   URL-адреса с проверяющей стороной, включая WS\-Federation, SAML и URL-адреса метаданных федерации  
  
-   URL-адреса отношения доверия поставщика утверждений, включая WS\-Federation, SAML и URL-адреса метаданных федерации  
  
## <a name="uris-as-object-identifiers"></a>Коды URI в качестве идентификаторов объектов  
Ниже приведены идентификаторы, с которыми чаще всего сталкиваются администраторы в AD FS.  
  
|Идентификатор|Описание|Сравнение|  
|-------------------|---------------|---------------|  
|Идентификатор службы федерации|Этот идентификатор используется для обозначения службы федерации.  Он используется проверяющими сторонами, использующими утверждения от этой службы федерации, а также поставщиками утверждений, выдающими утверждения для службы федерации.|Когда пользователь запрашивает у поставщика утверждений утверждения для службы федерации, идентификатор этой службы федерации будет использоваться для обозначения целевого объекта утверждений.<br /><br />Когда служба федерации получает утверждения от поставщика утверждений, она проверяет, что утверждения относятся именно к ней, выполняя поиск своего идентификатора.<br /><br />Когда проверяющая сторона получает утверждения из этой службы федерации, проверяющая сторона проверяет, что издатель утверждения соответствует идентификатору службы федерации.|  
|Идентификатор проверяющей стороны|Этот идентификатор используется для обозначения проверяющей стороны в службе федерации.  Он используется при выдаче утверждений для проверяющей стороны.|Когда пользователь запрашивает утверждения от службы федерации для проверяющей стороны, идентификатор этой проверяющей стороны будет использоваться для обозначения проверяющей стороны, для которой предназначены утверждения.  Это сравнение выполняется с помощью сопоставления префикса \(см. ниже\).<br /><br />Когда проверяющая сторона получает утверждения, она проверяет идентификатор в токене безопасности, чтобы гарантировать, что утверждения предназначены для нее.|  
|Идентификатор поставщика утверждений|Этот идентификатор используется для обозначения поставщика утверждений в службе федерации.  Оно используется при получении утверждений от поставщика утверждений.|Когда служба федерации получает утверждения от поставщика утверждений, служба федерации проверяет, что издатель утверждений соответствует идентификатору поставщика утверждений.|  
|Тип утверждения|Этот идентификатор используется для определения типа утверждения.  Он используется этой службой федерации, поставщиками утверждений и проверяющими сторонами при отправке и получении утверждений.|Когда служба федерации получает утверждения от поставщика утверждений, правила утверждений, связанные с соответствующим отношением доверия поставщика утверждений позволяют администратору сравнивать типы утверждений и обрабатывать утверждения.  Правила утверждения, связанные с отношением доверия с проверяющей стороной, также позволяют администратору сравнивать типы утверждений на основе утверждений, поступающих из правил отношения доверия с поставщиком утверждений, а также решать, какие утверждения выдавать.|  
  
## <a name="uri-prefix-matching-for-relying-party-identifiers"></a>Сопоставление префиксов URI для идентификаторов проверяющей стороны  
Синтаксис пути URI организован иерархически и отделяется всех "\/«символов или все»:" символов.  Таким образом, путь может быть разбит на участки пути в зависимости от символа-разделителя.  При выполнении сопоставления префиксов, каждый участок должен являться полным совпадением согласно правилам сопоставления \(эти правила определяют регистр совпадений\). Дополнительные сведения о правилах сопоставления см. в стандартах RFC, упомянутых выше.  
  
Когда проверяющая сторона определяется в запросе к службе федерации, службы AD FS используют логику сопоставления префиксов, чтобы определить наличие соответствующего отношения доверия с проверяющей стороной в базе данных конфигурации AD FS.  
  
Например если идентификатор проверяющей стороны в базе данных конфигурации AD FS \(URI1\) является префиксом для идентификатор проверяющей стороны во входящем запросе \(URI2\), а затем должны выполняться следующие условия:  
  
-   Конечные разделители \(символы косой черты и двоеточия\) пути разделы или ссылок должны игнорироваться  
  
-   Регистр частей схем и данных о пользователе и узле идентификаторов URI1 и URI2 должен строго совпадать.  
  
-   Каждый участок пути идентификатора uri1 должен точно совпадать \(основании учета регистра\) в соответствующий раздел пути URI2.  
  
-   URI2 может иметь больше участков пути, чем URI1, однако URI1 не должен иметь больше участков пути, чем URI2.  
  
-   URI1 не может иметь больше участков пути, чем URI2.  
  
-   Если URI1 включает строку запроса, она должна строго соответствовать строке запроса URI2.  
  
-   Если URI1 включает фрагмент, он должен строго соответствовать фрагменту URI2.  
  
Дополнительные примеры приводятся в таблице ниже.  
  
|Идентификатор проверяющей стороны в базе данных конфигурации AD FS|Идентификатор проверяющей стороны в сообщении запроса|Идентификатор запроса совпадает с идентификатором конфигурации?|`Reason`|  
|------------------------------------------------------------|-----------------------------------------------|------------------------------------------------------------|----------|  
|http:\/\/contoso.com|http:\/\/contoso.com|TRUE|Точно соответствует|  
|http:\/\/contoso.com\/|http:\/\/contoso.com|TRUE|Конечные символы косой черты игнорируются.|  
|http:\/\/contoso.com|http:\/\/contoso.com\/|TRUE|Конечные символы косой черты игнорируются.|  
|http:\/\/contoso.com|http:\/\/contoso.com\/hr|TRUE|URI1 не включает путь и соответствует схеме и данным о пользователе и узле для URI2.|  
|http:\/\/contoso.com\/hr|http:\/\/contoso.com\/hr\/web|TRUE|Первые участки пути совпадают, в URI1 нет второго участка пути.|  
|http:\/\/contoso.com\/hr|http:\/\/contoso.com\/hr\/web\/? m\=t|TRUE|Те же причины, что и выше; строка запроса ни на что не влияет.|  
|http:\/\/contoso.com\/hr\/|http:\/\/contoso.com\/гибридной рабочей роли Runbook\/основной|FALSE|Участок пути 1 идентификатора URI1 не соответствует участку пути 1 идентификатора URI2.|  
|http:\/\/contoso.com\/hr|http:\/\/contoso.com|FALSE|URI1 имеет больше участков пути, чем URI2.|  
|http:\/\/contoso.com\/hr|http:\/\/contoso.com\/hrweb|FALSE|Первые участки пути не совпадают.|  
|http:\/\/contoso.com\/? m\=t|http:\/\/contoso.com\/? m\=f|FALSE|Части строки запроса не совпадают.|  
|https:\/\/contoso.com|http:\/\/contoso.com|FALSE|Части схемы не совпадают.|  
|http:\/\/sts.contoso.com|http:\/\/contoso.com|FALSE|Части данных о пользователе и узле не совпадают.|  
|http:\/\/contoso.com|http:\/\/sts.contoso.com|FALSE|Части данных о пользователе и узле не совпадают.|  
  

