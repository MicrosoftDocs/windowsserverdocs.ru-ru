---
ms.assetid: 8ce6e7c4-cf8e-4b55-980c-048fea28d50f
title: "Ферма серверов федерации с использованием SQL Server"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: e23154b20dfcd642178a5ac0de17f1b6a490f91f
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="ad-fs-requirements"></a>Требования AD FS

>Область применения: Windows Server 2012 R2

Ниже приведены различные требования, которые необходимо учитывать при развертывании Служб федерации Active Directory.  
  
-   [Требования к сертификатам](AD-FS-Requirements.md#BKMK_1)  
  
-   [Требования к оборудованию](AD-FS-Requirements.md#BKMK_2)  
  
-   [Требования к программному обеспечению](AD-FS-Requirements.md#BKMK_3)  
  
-   [Требования служб AD DS](AD-FS-Requirements.md#BKMK_4)  
  
-   [Требования к базе данных конфигурации](AD-FS-Requirements.md#BKMK_5)  
  
-   [Требования к браузерам](AD-FS-Requirements.md#BKMK_6)  
  
-   [Требования к экстрасети](AD-FS-Requirements.md#BKMK_extranet)  
  
-   [Требования к сети](AD-FS-Requirements.md#BKMK_7)  
  
-   [Требования к хранилищу атрибутов](AD-FS-Requirements.md#BKMK_8)  
  
-   [Требования к приложениям](AD-FS-Requirements.md#BKMK_9)  
  
-   [Требования к проверке подлинности](AD-FS-Requirements.md#BKMK_10)  
  
-   [Требования к присоединение к рабочему месту](AD-FS-Requirements.md#BKMK_11)  
  
-   [Требования шифрования](AD-FS-Requirements.md#BKMK_12)  
  
-   [Требования к разрешениям](AD-FS-Requirements.md#BKMK_13)  
  
## <a name="BKMK_1"></a>Требования к сертификатам  
Сертификаты играют ключевую роль в обеспечении безопасности связи между серверами федерации, прокси веб-приложений, приложений, поддерживающих claims\ и веб-клиентами. Требования к сертификатам различаются в зависимости от того, было ли настройке сервера федерации или прокси-компьютере как описано в этом разделе.  
  
**Сертификаты сервера федерации**  
  
|||  
|-|-|  
|**Тип сертификата**|**Требования, поддержка и что нужно знать**|  
|**Сертификат безопасного \(SSL\) Sockets Layer:** это стандартный SSL-сертификат, который используется для защиты обмена данными между серверами федерации и клиентами.|— Этот сертификат должен быть публично trusted\ * X509 сертификата v3.<br />-Все клиенты, доступ к любой конечной точке службы федерации Active Directory должны доверять этому сертификату. Настоятельно рекомендуется использовать сертификаты, выпущенные центром сертификации, открытый \(third\-party\) \(CA\). На серверах федерации в тестовой среде, можно использовать SSL-сертификат, подписанный многоразовый успешно. Тем не менее для рабочей среды, рекомендуется получить сертификат из общедоступного центра сертификации.<br />-Поддерживает любой размер ключа, поддерживаемые Windows Server 2012 R2 для SSL-сертификатов.<br />— Не не поддержки сертификаты на основе ключей CNG.<br />-Если используется вместе с рабочему месту Join\ и Device Registration Service альтернативное имя субъекта сертификата SSL для службы AD FS должен содержать enterpriseregistration значение, за которым следуют суффикс имени участника-пользователя \(UPN\) вашей организации, например, enterpriseregistration.contoso.com.<br />-Поддерживаются подстановочные знаки сертификаты. При создании фермы AD FS, вам будет предложено указать имя службы для службы AD FS \ (например, **adfs.contoso.com**.<br />-Настоятельно рекомендуется использовать один и тот же сертификат SSL для прокси веб-приложения. Однако это **необходимые** будет таким же, по достижении конечные точки встроенную проверку подлинности Windows через прокси веб-приложения, и при включении \(default setting\) расширенной защиты проверки подлинности.<br />-Имя субъекта этого сертификата используется для представления имя службы федерации для каждого экземпляра AD FS, которая развертывается. По этой причине может потребоваться смысл выбрать имя субъекта на вновь изданных CA\ сертификатах, наиболее полно отражающее имя компании или организации для партнеров.<br />    Удостоверение сертификата должно совпадать с именем службы федерации \ (например, fs.contoso.com\). Удостоверение является либо субъекта альтернативное имя расширением dNSName типа или в случае операций альтернативное имя субъекта имени субъекта, указанный в качестве общего имени. Несколько записей альтернативное имя субъекта могут присутствовать в сертификате, если один из них соответствует имени службы федерации.<br />-   **Важно:** настоятельно рекомендуется использовать один и тот же сертификат SSL на всех узлах фермы AD FS, а также всех веб-приложения прокси-серверов в ферме AD FS.|  
|**Сертификат взаимодействия служб:** этот сертификат обеспечивает безопасность сообщений WCF для обеспечения безопасности связи между серверами федерации.|-По умолчанию SSL-сертификат используется в качестве сертификата взаимодействия служб.  Но вы также можете настроить другой сертификат как сертификат взаимодействия служб.<br />-   **Важно:** при использовании SSL-сертификат как сертификат взаимодействия служб, когда истекает срок действия сертификата SSL, убедитесь, что для настройки обновленного сертификата SSL в качестве вашего сертификат взаимодействия служб. Это не происходит автоматически.<br />— Это сертификату должны доверять клиенты AD FS, используйте безопасность сообщений WCF.<br />-Мы рекомендуем использовать сертификат проверки подлинности сервера, выданный центром сертификации, открытый \(third\-party\) \(CA\).<br />-Сертификату взаимодействия служб не может быть сертификат, который использует ключей CNG.<br />— Этот сертификат можно управлять с помощью консоли управления AD FS.|  
|**Сертификат подписи Token\:** это стандартная X509 сертификат, используемый для безопасного подписания всех токенов, издаваемых сервером федерации.|-По умолчанию AD FS создает сертификат, подписанный многоразовый с ключами 2048 бит.<br />-Выданного ЦС, также поддерживаются и может быть изменено с помощью управления AD FS оснастка<br />-ЦС, выдавший сертификаты должны хранятся & доступе через поставщик службы шифрования CSP.<br />-Сертификат для подписи маркера, не может быть сертификат, который использует ключей CNG.<br />-Служб федерации Active Directory не требуется извне зарегистрированных сертификатов для подписи маркера.<br />    Службы федерации Active Directory автоматически обновляет эти сертификаты подписи многоразовый до истечения срока действия, сначала настройки новых сертификатов в качестве дополнительного сертификаты для партнеров использовать их, а затем щелчок на основной в процессе с именем смены автоматического сертификатов. Мы рекомендуем использовать по умолчанию, автоматически создаваемых сертификаты для подписи маркера.<br />    Если в организации есть политики, для которых требуются разные сертификаты, чтобы настроить сертификат для подписи маркера, можно указать сертификаты во время установки, с помощью Powershell \ (используйте параметр – SigningCertificateThumbprint cmdlet\ Install\ AdfsFarm).  После установки можно просматривать и управлять сертификат для подписи маркера с помощью консоли управления AD FS или командлеты Powershell Set\-AdfsCertificate и Get\-AdfsCertificate.<br />    При использовании внешнего зарегистрированных сертификатов для подписи маркеров Служб федерации Active Directory не выполняет автоматическое Продление сертификата или смены.  Этот процесс должны выполняться с правами администратора.<br />    Чтобы обеспечить замену сертификата подходит к концу, можно настроить дополнительный сертификат для подписи маркера в Службах федерации Active Directory. По умолчанию все сертификат для подписи маркера, опубликованных в метаданных федерации, но только основной token\ сертификат подписи используется службами AD FS для подписи токенов.|  
|**Сертификат Token\ decryption\ шифрования или:** это стандартное X509 сертификат, используемый для шифрования и decrypt\ входящих токенов. Он также публикуется в метаданных федерации.|-По умолчанию AD FS создает сертификат, подписанный многоразовый с ключами 2048 бит.<br />-Выданного ЦС, также поддерживаются и может быть изменено с помощью управления AD FS оснастка<br />-ЦС, выдавший сертификаты должны хранятся & доступе через поставщик службы шифрования CSP.<br />-Token\ decryption\ шифрования или сертификат не может быть сертификат, который использует ключей CNG.<br />-По умолчанию AD FS создает и использует свое собственное внутренне создаваемый и многоразовый подписанные сертификаты для расшифровки маркера.  Службы федерации Active Directory не требуется извне зарегистрированных сертификатов для этой цели.<br />    Кроме того службы федерации Active Directory автоматически обновляет эти сертификаты подписи многоразовый до истечения срока действия.<br />    **Мы рекомендуем использовать по умолчанию, автоматически создаваемых сертификатов для расшифровки маркера.**<br />    Если в организации есть политик, которые требуются разные сертификаты настраивается для расшифровки маркера, можно указать сертификаты во время установки, с помощью Powershell \ (используйте параметр – DecryptionCertificateThumbprint cmdlet\ Install\ AdfsFarm).  После установки можно просматривать и управлять с помощью консоли управления AD FS или командлеты Powershell Set\-AdfsCertificate и Get\-AdfsCertificate сертификатов расшифровки маркера.<br />    **При использовании внешнего зарегистрированных сертификатов для расшифровки маркера AD FS не выполняет автоматическое Продление сертификата. Этот процесс должен выполнить администратор**.<br />-Учетная запись службы AD FS, должна иметь доступ к закрытому ключу сертификата подписи token\ в личном хранилище на локальном компьютере. Это является оказать помощь программой установки. Можно также использовать управления AD FS оснастка для обеспечения такой доступ, при изменении сертификата подписи token\.|  
  
> [!CAUTION]  
> Сертификаты, используемые для подписывания token\ и token\-decrypting\ или шифрование крайне важную роль для стабильности службы федерации. Клиенты, управление собственные сертификаты подписи token\ & token\-decrypting\ или шифрование убедитесь, что эти сертификаты резервного копирования и доступны в независимо друг от друга во время события восстановления.  
  
> [!NOTE]  
> В AD FS можно изменить уровень \(SHA\) безопасной хэш-алгоритм, используемый для цифровых подписей для \(more secure\) SHA\-1 или SHA\-256. Службы федерации Active Directory не поддерживает использование сертификатов с другими хэш-методами, такими как MD5 \ (по умолчанию алгоритм хеширования, используемый с tool\ командной строки Makecert.exe). По соображениям безопасности рекомендуется использовать SHA\ 256 \ (который задается default\) для всех подписей. SHA\-1 рекомендуется использовать только в сценариях, в которых требуется взаимодействие с продуктом, не поддерживает обмен данными по алгоритму SHA\-256, например Microsoft отличных продукта или устаревших версии Служб федерации Active Directory.  
  
> [!NOTE]  
> После получения сертификата из ЦС, убедитесь, что все сертификаты импортированы в хранилище личных сертификатов на локальном компьютере. Можно импортировать сертификаты в личное хранилище с помощью консоли MMC "Сертификаты" оснастка.  
  
## <a name="BKMK_2"></a>Требования к оборудованию  
Применяются следующие минимальные и рекомендуемые аппаратные требования для серверов федерации AD FS в Windows Server 2012 R2:  
  
||||  
|-|-|-|  
|**Требования к оборудованию**|**Минимальные требования**|**Рекомендуемое требование**|  
|Скорость ЦП|64 разрядный процессор с 1,4 ГГц|Quad\ процессор, 2 ГГц|  
|ОЗУ|512 МБ|4 ГБ|  
|На диске|32 ГБ|100 ГБ|  
  
## <a name="BKMK_3"></a>Требования к программному обеспечению  
Для функции сервера, которая встроена в операционную систему Windows Server® 2012 R2 предъявляются следующие требования AD FS:  
  
-   Для доступа через экстрасеть, необходимо развернуть службы роли прокси веб-приложения \ — частью роли сервера удаленного доступа Windows Server® 2012 R2. Предыдущие версии прокси-сервера федерации AD FS в Windows Server® 2012 R2 не поддерживаются.  
  
-   Сервер федерации и службы роли прокси веб-приложения не удается установить на том же компьютере.  
  
## <a name="BKMK_4"></a>Требования служб AD DS  
**Требования к контроллеру домена**  
  
Контроллеры домена в доменах всех пользователей и домен, к которому присоединены серверов AD FS должен работать под управлением Windows Server 2008 или более поздней версии.  
  
> [!NOTE]  
> Вся поддержка средах с контроллерами домена Windows Server 2003 завершится после расширенной поддержки конечных дату для Windows Server 2003. Пользователям настоятельно рекомендуется как можно быстрее обновлении своих контроллеров домена. Посетите [на этой странице](https://support.microsoft.com/lifecycle/search/default.aspx?sort=PN&alpha=Windows+Server+2003&Filter=FilterNO) Дополнительные сведения о жизненного цикла поддержки Майкрософт. Проблемы, обнаруженные, которые связаны с средах контроллера домена Windows Server 2003, исправления будут выдаваться только для обеспечения безопасности и если исправление могут выдаваться до истечения срока действия расширенной поддержки для Windows Server 2003.  
  
**Требования к functional\ уровня домена**  
  
Все домены учетной записи пользователя и домен, к которому присоединены серверов AD FS должен работать в режиме работы домена Windows Server 2003 или более поздней версии.  
  
Большинства функций AD FS не требуются модификации уровня functional\ AD DS для успешной работы. Тем не менее, режим работы домена Windows Server 2008 уровне или выше, не требуется для проверки подлинности сертификата клиента для успешной работы, если сертификат явно сопоставлен учетной записи пользователя в Доменных службах Active Directory.  
  
**Требования к схеме**  
  
-   Службы федерации Active Directory не требуется вносить изменения в схему или модификации functional\ уровня в AD DS.  
  
-   Для использования функции присоединения к рабочему месту схемы леса, серверы Служб федерации Active Directory, присоединены к должно быть присвоено Windows Server 2012 R2.  
  
**Требования к учетной записи службы**  
  
-   Любую учетную запись службы стандартных используется как учетная запись службы для служб AD FS. Группа управляемых учетных записей также поддерживаются. Это требуется по крайней мере один контроллер домена \ (рекомендуется развернуть два или more\), на котором выполняется Windows Server 2012 или более поздней версии.  
  
-   Для проверки подлинности Kerberos функции между клиентами, присоединенных к domain\ и AD FS "HOST\ / < adfs\_service\_name >" должен быть зарегистрирован как имя участника-службы для учетной записи службы. По умолчанию AD FS настроит это при создании новой ферме AD FS, если он имеет достаточные разрешения для выполнения этой операции.  
  
-   Учетная запись службы AD FS должен быть доверенным в каждом домене пользователя, содержащую пользователей проверку подлинности в службе AD FS.  
  
**Требования к домену**  
  
-   Все серверы Служб федерации Active Directory должен быть присоединен к домену AD DS.  
  
-   Все серверы Служб федерации Active Directory в ферме должны быть развернуты в одном домене.  
  
-   Домен, серверы Служб федерации Active Directory, присоединены к должны доверять каждый домен учетной записи пользователя, которая содержит пользователей, проверку подлинности в службе AD FS.  
  
**Требования к нескольких лесов**  
  
-   Домен, серверы Служб федерации Active Directory, присоединены к должны доверять каждый домен учетной записи пользователя или лесу, которое содержит пользователей, проверку подлинности в службе AD FS.  
  
-   Учетная запись службы AD FS должен быть доверенным в каждом домене пользователя, содержащую пользователей проверку подлинности в службе AD FS.  
  
## <a name="BKMK_5"></a>Требования к базе данных конфигурации  
Ниже перечислены требования и ограничения, которые применяются в зависимости от типа конфигурации хранилища.  
  
**ВНУТРЕННЕЙ БАЗЫ ДАННЫХ WINDOWS**  
  
-   На ферме внутренней базы данных Windows с ограничением 30 серверов федерации, при наличии 100 доверия с проверяющей стороной.  
  
-   Профиль разрешения артефактов SAML 2.0 не поддерживается в базе данных конфигурации внутренней базы данных Windows.  Маркер обнаружение воспроизведения в базе данных WID конфигурации не поддерживается. Эта функция только используется только в сценариях, где выступает в качестве поставщика федерации и использует токены безопасности от поставщиков утверждений внешних Служб федерации Active Directory.  
  
-   Балансировка нагрузки географического поддерживается до тех пор, пока число серверов не превышает 30 или развертывания серверов AD FS в отдельные центров для отработки отказа.  
  
Следующая таблица содержит сводные с использованием фермы внутренней базы данных Windows.  Используйте его для планирования вашей реализации.  
  
||||  
|-|-|-|  
||1 \-100 отношений доверия RP|Больше 100 отношений доверия RP|  
|1 \-30 AD FS узлов|Поддерживается внутренней базы данных Windows|Не поддерживается с использованием WID \-необходимые SQL|  
|Узлы более чем 30 AD FS|Не поддерживается с использованием WID \-необходимые SQL|Не поддерживается с использованием WID \-необходимые SQL|  
  
**SQL Server**  
  
AD FS в Windows Server 2012 R2 можно использовать SQL Server 2008 и выше  
  
## <a name="BKMK_6"></a>Требования к браузерам  
При проверке подлинности AD FS через браузер или управления браузера, браузер, должны соответствовать следующим требованиям:  
  
-   Необходимо включить JavaScript  
  
-   Файлы cookie должен быть включен  
  
-   \(SNI\) Указание имени сервера должен поддерживаться  
  
-   Для сертификатов и устройств сертификата проверки подлинности пользователя \ (functionality\ присоединение к рабочему месту), браузер должен поддерживать SSL-проверки подлинности сертификата клиента  
  
Несколько ключей браузеров и платформ, подверженные проверки для отрисовки и функциональные возможности, сведения о которых перечислены ниже. Браузерах и устройствах, не рассматриваемые в этой таблице по-прежнему поддерживается, если они отвечают требованиям, перечисленным выше:  
  
|||  
|-|-|  
|**Браузеры**|**Платформы**|  
|IE 10.0|Windows 7, Windows 8.1, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2|  
|IE 11.0|Windows 7, Windows 8.1, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2|  
|Windows Web Authentication Broker|Windows 8.1|  
|Firefox \[v21\]|Windows 7, Windows 8.1|  
|Safari \[v7\]|iOS 6, 10,7 OS\ X Mac|  
|Chrome \[v27\]|Windows 7, Windows 8.1, Windows Server 2012, Windows Server 2012 R2, 10,7 OS\ Mac-X|  
  
> [!IMPORTANT]  
> Известная проблема \-Firefox: функции присоединения к рабочему месту, идентифицирующее устройство, с помощью сертификата устройство не работает на платформах Windows. В настоящее время Firefox не поддерживает выполнение SSL сертификат проверки подлинности клиента с помощью сертификатов, подготовленных в хранилище сертификатов пользователя на клиентах Windows.  
  
**Файлы cookie**  
  
AD FS создает session\ и сохраняемые файлы cookie, которые должны храниться на клиентских компьютерах для обеспечения входа, одной out, единого \(SSO\) на одной и другие функциональные возможности. Таким образом необходимо настроить клиентский браузер для приема файлов cookie. Файлы cookie, используемые для проверки подлинности всегда являются безопасной протокол \(HTTPS\) файлы cookie сеансов, которые записываются для исходного сервера. Если клиентский браузер не настроен для поддержки этих файлов cookie, AD FS не сможет функционировать правильно. Сохраняемые файлы cookie используются для сохранения выбранного пользователем поставщика утверждений. Их можно отключить, воспользовавшись параметром конфигурации в файл конфигурации для страниц входа AD FS. По соображениям безопасности требуется поддержка TLS\ и SSL.  
  
## <a name="BKMK_extranet"></a>Требования к экстрасети  
Для предоставления доступа к экстрасети для службы AD FS, необходимо развернуть службы роли прокси веб-приложения в экстрасети подключенных роли, запросы проверки подлинности прокси-серверов в безопасном режиме для службы AD FS. Это обеспечивает изоляцию конечные точки службы AD FS, а также изоляции всех ключей безопасности \ (например, токена подписи certificates\) от запросов, приходящих из Интернета. Кроме того функции, такие как мягкой экстрасети блокировку учетных записей используют прокси веб-приложения. Дополнительные сведения о прокси веб-приложения см. в разделе [прокси веб-приложения](https://technet.microsoft.com/library/dn584107.aspx).  
  
Если вы хотите использовать прокси-производителей third\ для доступа через экстрасеть, этот third\ стороной прокси-сервер должен поддерживать протокол, определенные в [http:///\/download.microsoft.com\/download\/9\/5\/E\/95EF66AF\-9026\-4BB0\-A41D\-A4F81802D92C\/%5bMS\-ADFSPIP%5d.pdf](https://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5bMS-ADFSPIP%5d.pdf).  
  
## <a name="BKMK_7"></a>Требования к сети  
Правильная настройка следующих сетевых служб имеет критическое значение для успешного развертывания AD FS в вашей организации:  
  
**Настройка корпоративного брандмауэра**  
  
Брандмауэр, расположенный между прокси веб-приложения и фермы серверов федерации и брандмауэра между клиентами и прокси веб-приложения необходимо иметь TCP-порт 443 включена входящего трафика.  
  
Кроме того, если пользователь клиентских сертификатов проверки подлинности \ (clientTLS проверки подлинности с помощью X509 пользователя certificates\) — требуется, AD FS в Windows Server 2012 R2 требует включения TCP-порт 49443 входящих на брандмауэре между клиентами и прокси веб-приложения. Это не требуется на брандмауэре между прокси веб-приложения и servers\ федерации).  
  
**Настройка DNS**  
  
-   Для доступа к интрасети, все клиенты, доступ к службе AD FS в \(intranet\) внутренней корпоративной сети должен иметь возможность разрешать имя службы AD FS \ (имя, предоставляемые SSL certificate\) для балансировки нагрузки для серверов Служб федерации Active Directory или сервера Служб федерации Active Directory.  
  
-   Для доступа через экстрасеть, все клиенты, доступ к службе AD FS из за пределами корпоративной сети \(extranet\/internet\) должен быть способен разрешить имя службы AD FS \ (имя, предоставляемые SSL certificate\) для балансировки нагрузки для серверов прокси веб-приложения или веб-приложения прокси-сервера.  
  
-   Для доступа к экстрасети для правильной, должен быть способен разрешить имя службы AD FS каждого сервера прокси веб-приложения в сети Периметра \ (имя, предоставляемые SSL certificate\) для балансировки нагрузки для серверов Служб федерации Active Directory или сервера Служб федерации Active Directory. Это можно сделать с помощью Альтернативный DNS-сервер в сети Периметра сети или изменив разрешение на локальный сервер, используя файл HOSTS.  
  
-   Для встроенной проверки подлинности Windows для работы в сети и вне сети для подмножества конечные точки, предоставляемые через прокси веб-приложения необходимо использовать записи A \(not CNAME\) для указания подсистем балансировки нагрузки.  
  
Сведения о настройке корпоративной DNS для службы федерации и службы регистрации устройств см. в разделе [Настройка корпоративной DNS для службы федерации и DRS](https://technet.microsoft.com/library/dn486786.aspx).  
  
Дополнительные сведения о настройке корпоративной DNS для прокси-веб-приложения см. в разделе «Настройка DNS-сервера» [шаг 1: Настройка инфраструктуры прокси-сервера веб-приложений](https://technet.microsoft.com/library/dn383644.aspx).  
  
Сведения о настройке IP-адрес кластера или полного доменного ИМЕНИ с помощью балансировки сетевой Нагрузки кластера см. в разделе Указание параметров кластера в [http:///\/go.microsoft.com\/fwlink\/? LinkId\ = 75282](https://go.microsoft.com/fwlink/?LinkId=75282).  
  
## <a name="BKMK_8"></a>Требования к хранилищу атрибутов  
Службы федерации Active Directory требуется по крайней мере одного хранилища атрибутов, используемый для проверки подлинности пользователей и извлечения утверждений безопасности для этих пользователей. Список атрибутов хранилищ, поддерживаемых AD FS см. в разделе [роль хранилищ атрибутов](../../ad-fs/technical-reference/The-Role-of-Attribute-Stores.md).  
  
> [!NOTE]  
> AD FS автоматически создает хранилище атрибутов «Active Directory» по умолчанию. Требования к хранилищу атрибутов зависят от того, является ли ваша организация выступает в качестве партнера по учетным записям \ (где размещены федеративные папке users\) или партнер по ресурсам \ (где размещены федеративные включать).  
  
**Хранилища атрибутов LDAP**  
  
При работе с другими протокола LDAP \ хранилищ атрибутов \-based (LDAP\), необходимо подключиться к серверу LDAP, поддерживающему интегрированную аутентификацию Windows. Строка подключения LDAP должна записываться в формате URL-адреса LDAP, как описано в стандарте RFC 2255.  
  
Кроме того, он требуется, что учетная запись службы для службы AD FS имеет право для получения сведений о пользователе из хранилища атрибутов LDAP.  
  
**Хранилища атрибутов SQL Server**  
  
AD FS в Windows Server 2012 R2 для успешной работы компьютеры, на которых размещено хранилище атрибутов SQL Server должен работать под управлением либо Microsoft SQL Server 2008 или более поздней версии. При работе с хранилищами атрибутов на базе SQL\, необходимо также настроить строку подключения.  
  
**Пользовательские хранилища атрибутов.**  
  
Можно разработать пользовательские хранилища атрибутов для включения расширенных сценариев.  
  
-   Язык политик, интегрированный в AD FS может ссылаться на хранилища настраиваемых атрибутов, так что любой из следующих сценариев могут быть усовершенствованы:  
  
    -   Создание утверждений для прошедшего локальную аутентификацию пользователя  
  
    -   Добавление утверждений для прошедшего внешнюю аутентификацию пользователя  
  
    -   Авторизация пользователя на получение токена  
  
    -   Авторизация службы на получение токена для поведения пользователя  
  
    -   Выдача дополнительных данных в токены безопасности, выданные AD FS для проверяющих сторон.  
  
-   Все пользовательские хранилища атрибутов должны быть построены на базе .NET 4.0 или более поздней версии.  
  
При работе с хранилищем настраиваемых атрибутов может также потребоваться настроить строку подключения. В этом случае можно ввести пользовательский код, по вашему выбору, обеспечивающий подключение к хранилищу настраиваемых атрибутов. Строки подключения в этом случае — это набор пар имя значение, которые интерпретируются как реализованные разработчиком хранилища настраиваемых атрибутов. Дополнительные сведения о разработке и использовании хранилищ настраиваемых атрибутов см. в разделе [Общие сведения о хранилище атрибутов](https://go.microsoft.com/fwlink/?LinkId=190782).  
  
## <a name="BKMK_9"></a>Требования к приложениям  
Службы федерации Active Directory поддерживает claims\ совместимых приложений, с помощью следующих протоколов:  
  
-   Наличия WS Federation  
  
-   Наличия WS Trust  
  
-   Использование профилей IDPLite, SPLite и eGov1.5 протокола SAML 2.0.  
  
-   Профиль предоставления авторизации OAuth 2.0  
  
Службы федерации Active Directory также поддерживает проверку подлинности и авторизации для любых отличных claims\ поддерживающей приложений, которые поддерживаются в прокси веб-приложения.  
  
## <a name="BKMK_10"></a>Требования к проверке подлинности  
**AD DS \(Primary Authentication\) проверки подлинности**  
  
Для доступа к интрасети поддерживаются следующие стандартные механизмы проверки подлинности для AD DS:  
  
-   Встроенная проверка подлинности Windows с помощью Negotiate для Kerberos и NTLM  
  
-   Формы проверки подлинности, с помощью username\ и паролей  
  
-   Сертификат проверки подлинности с использованием сертификатов, сопоставление с учетными записями пользователей в Доменных службах Active Directory  
  
Для доступа через экстрасеть поддерживаются следующие способы проверки подлинности:  
  
-   Формы проверки подлинности, с помощью username\ и паролей  
  
-   Сертификат проверки подлинности с использованием сертификатов, которые сопоставляются с учетными записями пользователей в Доменных службах Active Directory  
  
-   Встроенная проверка подлинности Windows с помощью Negotiate \(NTLM only\) для конечных точек наличия WS-Trust, которые принимают встроенную проверку подлинности Windows.  
  
Для проверки подлинности сертификата:  
  
-   Расширяет смарт-карт, которые могут быть защищены ПИН-код.  
  
-   Графический Интерфейс для пользователю ввести свой ПИН-код не указан с помощью AD FS и необходимо входить в состав клиентской операционной системы, который отображается при использовании клиента TLS.  
  
-   Считывающий механизм и поставщик служб шифрования \(CSP\) смарт-карты должен работать на компьютере, где расположен браузер.  
  
-   Сертификата смарт-карты должен связываться по цепочке с доверенным корневым расположением на всех серверов AD FS и веб-приложения прокси-серверов.  
  
-   Сертификат должен сопоставляться с записью пользователя в AD DS одним из следующих методов:  
  
    -   Имя субъекта сертификата соответствует различающемуся имени LDAP учетной записи пользователя в Доменных службах Active Directory.  
  
    -   Расширение altname субъекта сертификата имеет участника-пользователя имя \(UPN\) учетной записи пользователя в Доменных службах Active Directory.  
  
Для эффективной встроенную проверку подлинности Windows с помощью Kerberos в интрасети  
  
-   Это требуется для имени службы, быть частью надежных сайтов или локальным узлам интрасети.  
  
-   Кроме того, HOST\ / < adfs\_service\_name > необходимо присвоить имя участника-службы учетной записи службы, выполняемый на ферме серверов AD FS.  
  
**Параметр двухфакторной проверки подлинности**  
  
Службы федерации Active Directory поддерживает дополнительную проверку подлинности \ (помимо основной проверки подлинности, поддерживаемых AD DS\) с помощью поставщика модели посредством vendors\ и клиентов можно создать собственный адаптер проверки подлинности используется коэффициент, администратор может регистрировать и использовать во время входа в систему.  
  
Каждый адаптер многофакторной проверки Подлинности необходимо надстраивается над .NET 4.5.  
  
Дополнительные сведения о многофакторной проверки Подлинности см. в разделе [управление рисками с помощью дополнительной многофакторной проверки подлинности для уязвимых приложений](../../ad-fs/operations/Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md).  
  
**Отключение проверки подлинности**  
  
Службы федерации Active Directory поддерживает проверку подлинности устройства с помощью сертификатов, подготовленных службой регистрации устройств в течение act места конечного пользователя, присоединение свое устройство.  
  
## <a name="BKMK_11"></a>Требования к присоединение к рабочему месту  
Конечные пользователи могут присоединение к рабочему месту свои устройства в организации с помощью Служб федерации Active Directory. Поддерживается службой регистрации устройств в AD FS. В результате конечные пользователи получить дополнительное преимущество в виде единого входа для приложений, поддерживаемых AD FS. Кроме того администраторы могут управлять риском, ограничив доступ к приложениям только к устройствам, которые были в организации к рабочему месту. Ниже приведены следующие требования для реализации такого сценария.  
  
-   Присоединение к рабочему месту для Windows 8.1 и iOS таким + устройств, поддерживаемых AD FS  
  
-   Для использования функции присоединения к рабочему месту схемы леса, серверы Служб федерации Active Directory, присоединены к должен быть Windows Server 2012 R2.  
  
-   Альтернативное имя субъекта сертификата SSL для службы AD FS должно содержать значение enterpriseregistration, за которым следуют суффикс имени участника-пользователя \(UPN\) вашей организации, например, enterpriseregistration.corp.contoso.com.  
  
## <a name="BKMK_12"></a>Требования шифрования  
Ниже приводится информация о дополнительных шифрования на токена AD FS, подписи функции encryption\ и расшифровки маркера:  
  
||||  
|-|-|-|  
|**Алгоритм**|**Длины ключей**|**Protocols\, Applications\ и примечания**|  
|TripleDES — по умолчанию 192 \ (поддерживаемые 192 — 256\) \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#tripledes\-cbc](http://www.w3.org/2001/04/xmlenc)|>\= 192|Поддерживается алгоритм для шифрования маркера безопасности.|  
|AES128 \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#aes128\-cbc|128|Поддерживается алгоритм для шифрования маркера безопасности.|  
|AES192 \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#aes192\-cbc|192|Поддерживается алгоритм для шифрования маркера безопасности.|  
|AES256 \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#aes256\-cbc](http://www.w3.org/2001/04/xmlenc)|256|**По умолчанию**. Поддерживается алгоритм для шифрования маркера безопасности.|  
|TripleDESKeyWrap \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-tripledes|Все размеры ключа, поддерживаемые .NET 4.0\+|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркера безопасности.|  
|AES128KeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-aes128](http://www.w3.org/2001/04/xmlenc)|128|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркера безопасности.|  
|AES192KeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-aes192](http://www.w3.org/2001/04/xmlenc)|192|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркера безопасности.|  
|AES256KeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#kw\-aes256](http://www.w3.org/2001/04/xmlenc)|256|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркера безопасности.|  
|RsaV15KeyWrap \-http:///\/ www.w3.org \/2001\/04\/xmlenc\#rsa\-1\_5|1024|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркера безопасности.|  
|RsaOaepKeyWrap \- [http:///\/ www.w3.org \/2001\/04\/xmlenc\#rsa\-oaep\-mgf1p](http://www.w3.org/2001/04/xmlenc)|1024|По умолчанию. Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркера безопасности.|  
|SHA1\ http: / / / \ / www.w3.org \/PICS\/DSig\/SHA1\_1\_0.html|N\/A|Используемые сервера AD FS в поколении SourceId артефактов: В этом сценарии STS использует SHA1 \ (для каждой рекомендации в standard\ SAML 2.0) позволяет создавать значение для sourceiD артефактов короткие 160 бит.<br /><br />Также используется веб-агент службы федерации Active Directory \ (устаревшие компоненты из WS2003 timeframe\) для определения изменений в течение времени «последнего обновления» значение, чтобы оно понимало, когда следует обновлять данные с STS.|  
|SHA1withRSA\-<br /><br />http:///\/ www.w3.org \/PICS\/DSig\/RSA\-SHA1\_1\_0.html|N\/A|Используется в случаях, когда сервера AD FS проверяет подпись SAML AuthenticationRequest, подписи в запросе на разрешение артефактов или ответ, создайте сертификат подписи token\.<br /><br />В этих случаях по умолчанию — SHA256 и SHA1 используется только в том случае, если не может поддерживать SHA256 \(relying party\) партнеров и необходимо использовать SHA1.|  
  
## <a name="BKMK_13"></a>Требования к разрешениям  
Администратор, который выполняет установки и начальной настройки Служб федерации Active Directory должны иметь права администратора домена в локальном домене \ (другими словами, домен, к которому присоединен сервер федерации к. \)  
  
## <a name="see-also"></a>См. также:  
[Руководство по разработке служб AD FS в Windows Server 2012 R2](AD-FS-Design-Guide-in-Windows-Server-2012-R2.md)  
  

