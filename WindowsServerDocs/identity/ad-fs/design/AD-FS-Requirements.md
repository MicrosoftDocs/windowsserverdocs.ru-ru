---
ms.assetid: 8ce6e7c4-cf8e-4b55-980c-048fea28d50f
title: Ферма серверов федерации с использованием SQL Server
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 1310792158995608e8f477b6df9d6cf7c0284571
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59822255"
---
# <a name="ad-fs-requirements"></a>Требования AD FS

>Область применения. Windows Server 2012 R2

Ниже приведены различные требования, которые необходимо учитывать при развертывании AD FS.  
  
-   [Требования к сертификатам](AD-FS-Requirements.md#BKMK_1)  
  
-   [Требования к оборудованию](AD-FS-Requirements.md#BKMK_2)  
  
-   [Требования к программному обеспечению](AD-FS-Requirements.md#BKMK_3)  
  
-   [Требования к AD DS](AD-FS-Requirements.md#BKMK_4)  
  
-   [Требования к базе данных конфигурации](AD-FS-Requirements.md#BKMK_5)  
  
-   [Требования к браузеру](AD-FS-Requirements.md#BKMK_6)  
  
-   [Требования к экстрасети](AD-FS-Requirements.md#BKMK_extranet)  
  
-   [Требования к сети](AD-FS-Requirements.md#BKMK_7)  
  
-   [Требования к хранилищу атрибутов](AD-FS-Requirements.md#BKMK_8)  
  
-   [Требования приложения](AD-FS-Requirements.md#BKMK_9)  
  
-   [Требования к проверке подлинности](AD-FS-Requirements.md#BKMK_10)  
  
-   [Требования к Workplace join](AD-FS-Requirements.md#BKMK_11)  
  
-   [Требования к криптографии](AD-FS-Requirements.md#BKMK_12)  
  
-   [Требования к разрешениям](AD-FS-Requirements.md#BKMK_13)  
  
## <a name="BKMK_1"></a>Требования к сертификатам  
Сертификаты играют ключевую роль в обеспечении безопасности связи между федерации утверждений серверы прокси веб-приложений,\-приложений и веб-клиентов. Требования к сертификатам, зависит ли вы настраиваете сервер федерации или компьютере прокси-сервера, как описано в этом разделе.  
  
**Сертификаты сервера федерации**  
  
|||  
|-|-|  
|**Тип сертификата**|**Требования, поддержка и что нужно знать**|  
|**Secure Sockets Layer \(SSL\) сертификата:** Это стандартный SSL-сертификат, который используется для защиты обмена данными между серверами федерации и клиентами.|— Этот сертификат должен быть общедоступный доверенный\* X509 сертификата версии 3.<br />-Все клиенты, которые обращаются к любой конечной точки службы федерации Active Directory должны доверять этому сертификату. Настоятельно рекомендуется использовать сертификаты, выданные публичным \(третий\-сторона\) сертификации \(ЦС\). Можно использовать самостоятельный\-автоматический серверы сертификатов на SSL федерации в тестовой лабораторной среде. Однако для рабочей среды рекомендуется получить сертификат из общедоступного центра сертификации.<br />-Поддержка ключа любого размера, поддерживаемого Windows Server 2012 R2 для SSL-сертификаты.<br />— Не поддерживает сертификаты ключей CNG.<br />-При совместном использовании присоединение к рабочему месту\/службы регистрации устройств, альтернативное имя субъекта SSL-сертификата служб AD FS должен содержать значение enterpriseregistration, за которой следует имя участника-пользователя \(Имени участника-пользователя\) суффикс вашей организации, например, enterpriseregistration.contoso.com.<br />-Групповые сертификаты поддерживаются. При создании фермы AD FS, вам будет предложено указать имя службы для службы AD FS \(к примеру, **adfs.contoso.com**.<br />-Настоятельно рекомендуется использовать один и тот же сертификат SSL для веб-прокси приложения. Однако это **требуется** должны совпадать, при поддержке конечных точек встроенную проверку подлинности Windows, через прокси веб-приложения и при включении расширенной защиты проверки подлинности \(поумолчанию\).<br />-Имя субъекта этого сертификата используется для представления имени службы федерации для каждого экземпляра AD FS, которая развертывается. По этой причине имеет смысл выбрать имя субъекта для любого нового центра сертификации может потребоваться\-выданных сертификатов, что лучше всего представляет имя вашей компании или организации для партнеров.<br />    Идентификатор сертификата должно совпадать с именем службы федерации \(например, fs.contoso.com\). Удостоверением является либо расширение альтернативного имени субъекта типа dnsname, или в случае операций альтернативное имя субъекта имя субъекта указывается в качестве общего имени. Несколько записей альтернативное имя субъекта могут присутствовать в сертификате, если одна из них соответствует имени службы федерации.<br />-   **Важно:** настоятельно рекомендуется использовать один и тот же сертификат SSL на всех узлах фермы AD FS, а также всех прокси-серверы веб-приложения в ферме AD FS.|  
|**Сертификат взаимодействия служб:** Этот сертификат обеспечивает безопасность сообщений WCF для обеспечения безопасного взаимодействия серверов федерации.|— По умолчанию используется SSL-сертификат в качестве сертификата взаимодействия служб.  Но вы также можете настроить другой сертификат как сертификат взаимодействия служб.<br />-   **Важно:** при использовании SSL-сертификат как сертификат взаимодействия служб, по истечении срока действия SSL-сертификат, убедитесь, что настройка обновленный сертификат SSL в качестве ваш сертификат взаимодействия служб. Это происходит автоматически.<br />— Это сертификату должны доверять клиенты AD FS, использующих безопасность сообщения WCF.<br />— Мы рекомендуем использовать сертификат проверки подлинности сервера, выданный публичным \(третий\-сторона\) сертификации \(ЦС\).<br />Сертификат взаимодействия служб не может быть сертификат, который использует ключи CNG.<br />-Этот сертификат можно управлять с помощью консоли управления AD FS.|  
|**Токен\-сертификат подписи:** Это стандартный сертификат X509, используемый для безопасного подписания всех токенов, издаваемых сервером федерации.|— По умолчанию AD FS создает самозаверяющий\-сертификат, подписанный с помощью ключей 2048 бит.<br />-Выдан центром сертификации сертификаты также поддерживаются и могут быть изменены с помощью оснастки управления AD FS\-в<br />-Сертификаты, выданные ЦС должен хранимой & через поставщик службы шифрования CSP.<br />-Сертификата для подписи маркера не может быть сертификат, который использует ключи CNG.<br />-AD FS не требует извне зарегистрированных сертификатов для подписи маркеров.<br />    AD FS автоматически обновляет эти self\-подписанных сертификатов до истечения срока действия, начинается с настройки конфигурации новые сертификаты как вторичные сертификаты для партнеров, использовать их, а затем переворот на основной в процессе называется автоматической Смена сертификатов. Мы рекомендуем использовать по умолчанию, автоматически создаваемых сертификатов для подписи маркера.<br />    Если ваша организация использует политики, которые требуют настроить различных сертификатов для подписи маркеров, сертификаты можно указать во время установки, с помощью Powershell \(используйте параметр – SigningCertificateThumbprint установки \-AdfsFarm командлет\).  После установки, можно просматривать и управлять сертификаты для подписи маркера с помощью консоли управления AD FS или командлеты Powershell набора\-AdfsCertificate и Get\-AdfsCertificate.<br />    При использовании извне зарегистрированных сертификатов для подписи маркера AD FS не выполняет автоматическое продление или смену.  Этот процесс должен выполняться администратором.<br />    Чтобы сделать возможной смену сертификатов, когда истекает срок действия одного сертификата, можно настроить дополнительный сертификат подписи токена в AD FS. По умолчанию публикуются все сертификаты для подписи токенов в метаданных федерации, однако только основной маркер\-сертификат для подписи используется службами AD FS для подписи токенов.|  
|**Токен\-расшифровки\/сертификат шифрования:** Это стандартный X509 сертификат, используемый для расшифровки\/шифрования входящих токенов. Он также публикуется в метаданных федерации.|— По умолчанию AD FS создает самозаверяющий\-сертификат, подписанный с помощью ключей 2048 бит.<br />-Выдан центром сертификации сертификаты также поддерживаются и могут быть изменены с помощью оснастки управления AD FS\-в<br />-Сертификаты, выданные ЦС должен хранимой & через поставщик службы шифрования CSP.<br />-Маркер\-расшифровки\/сертификат шифрования не может быть сертификат, который использует ключи CNG.<br />— По умолчанию AD FS создает и использует свой собственный, внутренне созданные и собственный\-сертификаты для расшифровки маркеров.  AD FS не требует извне зарегистрированных сертификатов для этой цели.<br />    Кроме того, службы федерации Active Directory автоматически обновляет эти self\-подписанных сертификатов до истечения срока действия.<br />    **Мы рекомендуем использовать по умолчанию, автоматически созданные сертификаты для расшифровки маркеров.**<br />    Если ваша организация использует политики, которые требуют различных сертификатов настраиваться для расшифровки маркеров, сертификаты можно указать во время установки, с помощью Powershell \(используйте параметр – DecryptionCertificateThumbprint Установка\-AdfsFarm командлет\).  После установки, можно просматривать и управлять сертификатами расшифровки маркеров, с помощью консоли управления AD FS или командлеты Powershell набора\-AdfsCertificate и Get\-AdfsCertificate.<br />    **При использовании извне зарегистрированных сертификатов для расшифровки маркеров AD FS не выполняет автоматическое продление.  Этот процесс должен выполняться администратором**.<br />-Учетная запись службы AD FS должен иметь доступ к токену\-подписи закрытый ключ сертификата в личном хранилище локального компьютера. Это происходит автоматически из программой установки. Также можно использовать оснастку управления AD FS\-in для обеспечения такой доступ, при изменении маркер\-сертификат для подписи.|  
  
> [!CAUTION]  
> Сертификаты, используемые для токена\-подписи и маркером\-расшифровки\/шифрования крайне важны для стабильности службы федерации. Пользователей, управляющих их собственный маркер\-подписи & маркера\-расшифровки\/шифрования сертификаты следует убедитесь, что эти сертификаты архивируются и доступны в независимо друг от друга во время события восстановления.  
  
> [!NOTE]  
> В AD FS вы можете изменить безопасного хэш-алгоритма \(SHA\) уровень, используемый для цифровых подписей для либо SHA\-1 или SHA\-256 \(безопаснее\). Службы федерации Active Directory не поддерживает использование сертификатов с другими хэш-методами, такими как MD5 \(хэш-алгоритм по умолчанию, который используется с командой Makecert.exe\-линия\). По соображениям безопасности рекомендуется использовать SHA\-256 \(которого имеет значение по умолчанию\) для всех подписей. SHA\-1 рекомендуется использовать только в сценариях, в которых требуется взаимодействие с продуктом, не поддерживает обмен данными по алгоритму SHA\-256, например непустой\-Microsoft продукта или устаревших версий AD FS.  
  
> [!NOTE]  
> После получения сертификата из центра сертификации необходимо убедиться, что все сертификаты импортированы в хранилище личных сертификатов на локальном компьютере. Можно импортировать сертификаты в личном хранилище с помощью оснастки MMC для сертификатов\-в.  
  
## <a name="BKMK_2"></a>Требования к оборудованию  
Следующие минимальные и рекомендуемые требования к серверам федерации AD FS в Windows Server 2012 R2.  
  
||||  
|-|-|-|  
|**Требования к оборудованию**|**Минимальное требование**|**Рекомендуемым требованиям**|  
|Скорость ЦП|1,4 ГГц 64\-разрядный процессор|Четырехъядерный\-ядра с частотой 2 ГГц|  
|ОЗУ|512 МБ|4 ГБ|  
|Место на диске|32 ГБ|100 ГБ|  
  
## <a name="BKMK_3"></a>Требования к программному обеспечению  
Предъявляются следующие требования AD FS для функциональных возможностей сервера, который встроен в операционную систему Windows Server® 2012 R2:  
  
-   Для доступа через экстрасеть, необходимо развернуть службы роли прокси веб-приложения \- частью роли сервера удаленного доступа Windows Server® 2012 R2. Предыдущие версии прокси-сервера федерации не поддерживаются с AD FS в Windows Server® 2012 R2.  
  
-   Сервера федерации и службы роли прокси веб-приложения не может устанавливаться на одном компьютере.  
  
## <a name="BKMK_4"></a>Требования к AD DS  
**Требования к контроллеру домена**  
  
Контроллеры домена в всех доменов пользователей и домен, к которому присоединены серверы AD FS должна быть запущена Windows Server 2008 или более поздней версии.  
  
> [!NOTE]  
> Поддержка сред с контроллерами домена Windows Server 2003 будет завершено после расширенной поддержки окончания даты для Windows Server 2003. Клиентам настоятельно рекомендуется как можно скорее обновление контроллеров домена. Посетите [эту страницу](https://support.microsoft.com/lifecycle/search/default.aspx?sort=PN&alpha=Windows+Server+2003&Filter=FilterNO) Дополнительные сведения о жизненном цикле поддержки Майкрософт. Для обнаруженных проблем, которые относятся к средах контроллера домена Windows Server 2003, исправления будут выдаваться только для обеспечения безопасности, и если исправление может выдаваться раньше окончания расширенной поддержки для Windows Server 2003.  
  
**Работы домена\-уровня требования**  
  
Все домены учетной записи пользователя и домен, к которому присоединены серверы AD FS должен работать на функциональном уровне домена Windows Server 2003 или более поздней версии.  
  
Большинство функций AD FS не требуют AD DS функциональной\-уровня изменения для успешной работы. Однако для успешной аутентификации клиентских сертификатов (если сертификат явно сопоставлен учетной записи пользователя в AD DS) требуется функциональный уровень домена Windows Server 2008 или выше.  
  
**Требования к схеме**  
  
-   AD FS не требует изменений схемы или функциональные\-уровня модификации в AD DS.  
  
-   Для использования функции присоединения к рабочему месту, схему леса, объединенные серверы AD FS должно быть присвоено значение Windows Server 2012 R2.  
  
**Требования к учетной записи службы**  
  
-   Любой учетной записи служб standard можно использовать в качестве учетной записи службы для AD FS. Также поддерживаются групповые учетные записи управляемой службы. Это требуется по крайней мере один контроллер домена \(рекомендуется развернуть два или более\) под управлением Windows Server 2012 или более поздней версии.  
  
-   Для проверки подлинности Kerberos для функции между доменами\-объединить клиентов и AD FS "узла\/< adfs\_службы\_имя >" должен быть зарегистрирован как SPN учетной записи службы. По умолчанию AD FS настроите это при создании новой фермы AD FS, если он имеет достаточные разрешения для выполнения этой операции.  
  
-   Учетная запись службы AD FS должен быть доверенным в каждом домене пользователя, содержащий прошедшие проверки подлинности для службы AD FS.  
  
**Требования к домену**  
  
-   Все серверы AD FS должны быть присоединенных к домену AD DS.  
  
-   Все серверы AD FS в ферме должны быть развернуты в одном домене.  
  
-   Домен, объединенные серверы AD FS должен доверять каждый домен учетной записи пользователя, содержащую пользователей, проверка подлинности в службе AD FS.  
  
**Несколько лесов требования**  
  
-   Домен, объединенные серверы AD FS должен доверять каждого пользователя учетной записи домена или леса, содержащего пользователей, проверка подлинности в службе AD FS.  
  
-   Учетная запись службы AD FS должен быть доверенным в каждом домене пользователя, содержащий прошедшие проверки подлинности для службы AD FS.  
  
## <a name="BKMK_5"></a>Требования к базе данных конфигурации  
Ниже приведены требования и ограничения, которые применяются в зависимости от типа хранилища конфигурации:  
  
**ВНУТРЕННЯЯ БАЗА ДАННЫХ WINDOWS**  
  
-   Фермы внутренней базы данных Windows имеет ограничение в 30 серверов федерации, при наличии 100 или меньше доверия с проверяющей стороной.  
  
-   Профиль разрешение артефактов SAML 2.0 не поддерживается в базе данных WID конфигурации.  Токен обнаружения воспроизведения не поддерживается в базе данных WID конфигурации. Только эта функция используется только в сценариях, где в качестве поставщика федерации AD FS и использование токенов безопасности от поставщиков внешних утверждений.  
  
-   Развертывание серверов AD FS в отдельные центры для отработки отказа или балансировки нагрузки географических поддерживается до тех пор, пока число серверов не превышает 30.  
  
Ниже представлена сводка по использованию ферме внутренней базы данных Windows.  Используйте для планирования реализации.  
  
||||  
|-|-|-|  
||1 \- 100 отношениями доверия RP|Более чем 100 отношениями доверия RP|  
|1 \- узлов 30 AD FS|Поддерживается внутренней базы данных Windows|Не поддерживается с использованием WID \- SQL требуется|  
|Узлы более чем 30 AD FS|Не поддерживается с использованием WID \- SQL требуется|Не поддерживается с использованием WID \- SQL требуется|  
  
**SQL Server**  
  
Для AD FS в Windows Server 2012 R2 можно использовать SQL Server 2008 и более поздней версии  
  
## <a name="BKMK_6"></a>Требования к браузеру  
При проверке подлинности AD FS с помощью браузера или элемента управления браузера, в браузере должны соответствовать следующим требованиям:  
  
-   Необходимо включить JavaScript  
  
-   Должны быть включены файлы cookie  
  
-   Указание имени сервера \(SNI\) должен поддерживаться  
  
-   Для пользователя устройства & сертификата проверки подлинности сертификата \(функциональные возможности присоединения к рабочему месту\), обозреватель должен поддерживать проверку подлинности сертификата клиента SSL  
  
Несколько ключевых браузеры и платформы претерпели проверки для отрисовки и функциональные возможности, сведения о котором перечислены ниже. Браузеры и устройства, которые не освещены в этой таблице по-прежнему поддерживаются, если они отвечают требованиям, перечисленным выше:  
  
|||  
|-|-|  
|**Браузеры**|**Платформы**|  
|IE 10.0|Windows 7, Windows 8.1, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2|  
|IE 11.0|Windows7, Windows 8.1, Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2|  
|Брокер веб-аутентификации Windows|Windows 8.1|  
|Firefox \[v21\]|Windows 7, Windows 8.1|  
|Safari \[v7\]|iOS 6, Mac OS\-X 10.7|  
|Chrome \[v27\]|Windows 7, Windows 8.1, Windows Server 2012, Windows Server 2012 R2, Mac OS\-X 10.7|  
  
> [!IMPORTANT]  
> Известная проблема \- Firefox: Workplace Join функциональность идентифицировать устройство, с помощью сертификата устройства не работает на платформах Windows. Firefox в настоящее время не поддерживает проверке подлинности сертификата клиента SSL, с использованием сертификатов, подготовить в хранилище сертификатов пользователя на клиентах Windows.  
  
**Файлы cookie**  
  
AD FS создает сеанс\-зависимости и постоянные файлы cookie, которые должны храниться на клиентских компьютерах для использования входа\-, подписать\-, единого входа\-на \(SSO\)и другие функциональные возможности. Следовательно, необходимо настроить клиентский браузер для приема файлов cookie. Файлы cookie, которые используются для проверки подлинности, всегда являются протокол \(HTTPS\) файлы cookie сеансов, которые записываются для исходного сервера. Если клиентский браузер не настроен для поддержки этих файлов cookie, AD FS не сможет функционировать правильно. Сохраняемые файлы cookie используются для сохранения выбранного пользователем поставщика утверждений. Их можно отключить с помощью параметра конфигурации в файле конфигурации для входа в AD FS\-на страницах. Поддержка протокола TLS\/протокол SSL необходим для по соображениям безопасности.  
  
## <a name="BKMK_extranet"></a>Требования к экстрасети  
Для предоставления доступа к экстрасети для служб AD FS, необходимо развернуть службы роли прокси веб-приложения как экстрасети с выходом роль, запросы на проверку подлинности прокси-серверы в безопасном режиме для службы AD FS. Это обеспечивает изоляцию конечных точек службы AD FS, а также изоляция всех ключей безопасности \(такие как сертификаты для подписи маркеров\) из запросов, поступающих из Интернета. Кроме того функции, такие как обратимо экстрасети учетной записи требуется использовать прокси веб-приложения. Дополнительные сведения о прокси веб-приложения, см. в разделе [прокси веб-приложения](https://technet.microsoft.com/library/dn584107.aspx).  
  
Если вы хотите использовать третий\-этом третьих сторон прокси-сервер для доступа к экстрасети,\-сторона прокси-сервер должен поддерживать протокол, определенный в [http:\/\/download.microsoft.com\/загрузить\/9\/5\/E\/95EF66AF\-9026\-4BB0\-A41D\-A4F81802D92C\/% 5bMS\-ADFSPIP%5d.pdf](https://download.microsoft.com/download/9/5/E/95EF66AF-9026-4BB0-A41D-A4F81802D92C/%5bMS-ADFSPIP%5d.pdf).  
  
## <a name="BKMK_7"></a>Требования к сети  
Настройка следующих сетевых служб соответствующим образом критически важна для успешного развертывания AD FS в вашей организации:  
  
**Настройка корпоративного брандмауэра**  
  
Брандмауэр, расположенный между прокси веб-приложения и фермы серверов федерации и брандмауэр между клиентами и прокси веб-приложения должен иметь TCP-порт 443 включен входящего трафика.  
  
Кроме того, если проверка сертификата пользователя клиента \(clientTLS проверки подлинности с помощью X509 сертификатов пользователей\) — необходимые, AD FS в Windows Server 2012 R2 требуется включенное TCP-порт 49443 входящего трафика на брандмауэр между Клиенты и прокси веб-приложения. Это не является обязательным в брандмауэре между прокси веб-приложения и серверами федерации\).  
  
**Настройка DNS**  
  
-   Для доступа к интрасети, все клиенты, доступ к AD FS службы в пределах внутренней корпоративной сети \(интрасети\) должен быть способен разрешить имя службы AD FS \(имя, предоставляемое по SSL-сертификат\) с загрузкой Подсистема балансировки для серверов AD FS или сервера AD FS.  
  
-   Для доступа к экстрасети, все клиенты, доступ к AD FS службы из вне корпоративной сети \(экстрасети\/internet\) должен быть способен разрешить имя службы AD FS \(имя, предоставляемоеSSL-сертификата\) в подсистему балансировки нагрузки для веб-приложения прокси-серверы или прокси веб-приложения сервера.  
  
-   Для доступа к экстрасети для правильного функционирования, каждого сервера прокси веб-приложения в сети Периметра должен быть способен разрешить имя службы AD FS \(имя, предоставляемое по SSL-сертификат\) в подсистему балансировки нагрузки для серверов AD FS или сервера AD FS. Это можно сделать с помощью Альтернативный DNS-сервер в сети Периметра сети или путем изменения разрешение локального сервера, с помощью файла HOSTS.  
  
-   Windows встроенную проверку подлинности для работы в сети и вне сети для подмножества конечных точек, предоставляемых через прокси веб-приложения, необходимо использовать записи A \(не CNAME\) для указания подсистем балансировки нагрузки.  
  
Сведения о настройке корпоративной DNS для службы федерации и службы регистрации устройств, см. в разделе [Настройка корпоративной DNS для службы федерации и DRS](https://technet.microsoft.com/library/dn486786.aspx).  
  
Сведения о настройке корпоративной DNS для прокси-серверы веб-приложение, см. в разделе «Настройка DNS» в [шаг 1: Настройка инфраструктуры прокси-сервера веб-приложений](https://technet.microsoft.com/library/dn383644.aspx).  
  
Сведения о настройке IP-адрес кластера или полного доменного ИМЕНИ с помощью балансировки сетевой Нагрузки кластера, см. в разделе Указание параметров кластера в [http:\/\/go.microsoft.com\/fwlink\/? LinkId\=75282](https://go.microsoft.com/fwlink/?LinkId=75282).  
  
## <a name="BKMK_8"></a>Требования к хранилищу атрибутов  
AD FS требует по крайней мере одного хранилища атрибутов, используемый для проверки подлинности пользователей и извлечения утверждений безопасности для этих пользователей. Список атрибутов, поддерживаемых AD FS хранилищ, см. в разделе [The Role of Attribute Stores](../../ad-fs/technical-reference/The-Role-of-Attribute-Stores.md).  
  
> [!NOTE]  
> AD FS автоматически создает хранилище атрибутов «Active Directory», по умолчанию. Требования к хранилищу атрибутов зависят от того, является ли ваша организация выступает в качестве партнера по учетным записям \(размещение федеративных пользователей\) или партнера по ресурсам \(размещение Федеративное приложение\).  
  
**Хранилища атрибутов LDAP**  
  
При работе с другими Lightweight Directory Access Protocol \(LDAP\)\-основе хранилищ атрибутов, необходимо подключиться к серверу LDAP, который поддерживает проверки подлинности Windows. Строка подключения LDAP должна записываться в формате URL-адреса LDAP в соответствии со стандартом RFC 2255.  
  
Также требуется учетная запись службы для службы AD FS имеет право получать сведения из хранилища атрибутов LDAP.  
  
**Хранилища атрибутов SQL Server**  
  
Для AD FS в Windows Server 2012 R2 для успешной работы компьютеры, на которых размещены хранилища атрибутов SQL Server должна быть запущена либо Microsoft SQL Server 2008 или более поздней версии. При работе с SQL\-основе хранилищ атрибутов, также необходимо настроить строку подключения.  
  
**Пользовательских хранилищ атрибутов**  
  
Хранилища настраиваемых атрибутов позволяют реализовывать более сложные сценарии.  
  
-   Язык политик, интегрированный в AD FS, может ссылаться на хранилища настраиваемых атрибутов, тем самым расширяя возможности перечисленных ниже сценариев.  
  
    -   Создание утверждений для прошедшего локальную аутентификацию пользователя  
  
    -   Добавление утверждений для прошедшего внешнюю аутентификацию пользователя  
  
    -   Авторизация пользователя на получение токена  
  
    -   Авторизация службы на получение токена для поведения пользователя  
  
    -   Выдача дополнительных данных в маркерах безопасности, выданное AD FS для проверяющих сторон.  
  
-   Все пользовательские хранилища атрибутов должны быть построены на основе .NET 4.0 или более поздней версии.  
  
При работе с хранилищем настраиваемых атрибутов, может также потребоваться настроить строку подключения. В этом случае можно ввести собственный код по своему усмотрению, обеспечивающий подключение к хранилищу настраиваемых атрибутов. Строку подключения в этой ситуации — это набор имя\/значение пары, которые интерпретируются как реализованные разработчиком хранилища настраиваемых атрибутов. Дополнительные сведения о разработке и использовании хранилищ настраиваемых атрибутов см. в разделе [Обзор Store атрибут](https://go.microsoft.com/fwlink/?LinkId=190782).  
  
## <a name="BKMK_9"></a>Требования приложения  
AD FS поддерживает утверждения\-совместимых приложений, использующих следующие протоколы:  
  
-   WS\-федерации  
  
-   WS\-доверия  
  
-   Протокол SAML 2.0, с помощью IDPLite, SPLite & eGov1.5 профилей.  
  
-   Профиль предоставления авторизации OAuth 2.0  
  
AD FS также поддерживает проверку подлинности и авторизации для любого не\-утверждений\-приложений, которые поддерживаются прокси веб-приложения.  
  
## <a name="BKMK_10"></a>Требования к проверке подлинности  
**Проверка подлинности AD DS \(основной проверки подлинности\)**  
  
Для доступа к интрасети поддерживаются следующие стандартные механизмы проверки подлинности для AD DS.  
  
-   Встроенная проверка подлинности Windows с помощью Negotiate для Kerberos и NTLM  
  
-   Формирует проверку подлинности с использованием имени пользователя\/пароли  
  
-   Сертификат проверки подлинности с использованием сертификатов, сопоставляется с учетными записями пользователей в Доменных службах Active Directory  
  
Для доступа к экстрасети поддерживаются следующие механизмы проверки подлинности:  
  
-   Формирует проверку подлинности с использованием имени пользователя\/пароли  
  
-   Сертификат проверки подлинности с использованием сертификатов, которые сопоставляются с учетными записями пользователей в Доменных службах Active Directory  
  
-   Встроенная проверка подлинности Windows с помощью Negotiate \(NTLM только\) для WS\-доверять конечным точкам, которые принимают встроенную проверку подлинности Windows.  
  
Для проверки подлинности сертификата:  
  
-   Распространяется на смарт-карты, могут быть защищены ПИН-код.  
  
-   Графический интерфейс пользователя пользователю ввести свой ПИН-код не предоставляется по AD FS и должен быть частью операционной системы клиента, который отображается при использовании клиента TLS.  
  
-   Средство чтения и поставщика служб шифрования \(CSP\) для смарт-карты должен работать на компьютере, где расположен браузер.  
  
-   Сертификат смарт-карты должен связываться по цепочке с доверенным корневым расположением на всех серверах AD FS и серверах прокси веб-приложения.  
  
-   Сертификат должен сопоставляться с учетной записью пользователя в AD DS одним из следующих методов.  
  
    -   Имя субъекта сертификата соответствует различающемуся имени LDAP учетной записи пользователя в AD DS.  
  
    -   Расширение altname субъекта сертификата имеет имя участника-пользователя \(имени участника-пользователя\) учетной записи пользователя в AD DS.  
  
Эффективная встроенная проверка подлинности Windows с помощью Kerberos в интрасети,  
  
-   Он необходим для имени службы как часть Надежные узлы или узлы интрасети.  
  
-   Кроме того, узел\/< adfs\_службы\_имя > имя участника-службы следует задавать в учетной записи службы, работающей в среде фермы AD FS.  
  
**С несколькими\-двухфакторная проверка подлинности**  
  
AD FS поддерживает дополнительную проверку подлинности \(за пределами основной проверки подлинности, поддерживаемых AD DS\) с помощью модели поставщика при котором поставщиков\/клиенты могут создавать свои собственные с несколькими\-адаптера фактор проверки подлинности что администратора можно зарегистрировать и использовать во время входа.  
  
Каждый адаптер многофакторной проверки Подлинности должны быть построены на основе .NET 4.5.  
  
Дополнительные сведения о многофакторной проверки Подлинности, см. в разделе [управление рисками с помощью дополнительной многофакторной проверки подлинности для уязвимых приложений](../../ad-fs/operations/Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md).  
  
**Проверка подлинности устройства**  
  
Службы федерации Active Directory поддерживает проверку подлинности устройства с помощью сертификатов, подготовленных с помощью службы регистрации устройств во время act workplace конечного пользователя, присоединении устройства.  
  
## <a name="BKMK_11"></a>Требования к Workplace join  
Конечные пользователи могут присоединение к рабочему месту свои устройства для организации с помощью AD FS. Это поддерживается службой регистрации устройств в AD FS. Таким образом конечные пользователи получают дополнительное преимущество единого входа в приложениях, поддерживаемые службами AD FS. Кроме того администраторы могут управлять рисками, ограничив доступ к приложениям только к устройствам, которые были к рабочему месту для организации. Ниже приведены следующие требования для реализации этого сценария.  
  
-   AD FS поддерживает присоединение к рабочему месту для Windows 8.1 и iOS 5\+ устройств  
  
-   Чтобы использовать функции присоединения к рабочему месту, схема леса, объединенные серверы AD FS должна быть Windows Server 2012 R2.  
  
-   Альтернативное имя субъекта SSL-сертификата служб AD FS должен содержать значение enterpriseregistration, за которой следует имя участника-пользователя \(имени участника-пользователя\) суффикс вашей организации, например, enterpriseregistration.corp.contoso.com.  
  
## <a name="BKMK_12"></a>Требования к криптографии  
Ниже приведены сведения о поддержке дополнительных криптография, в маркере AD FS, подписывание, шифрование маркеров\/функциональные возможности расшифровки:  
  
||||  
|-|-|-|  
|**алгоритм**|**Длина ключа**|**Протоколы\/приложений\/комментарии**|  
|TripleDES — по умолчанию, 192 \(поддерживается 192 до 256\) \- [http:\/\/www.w3.org\/2001\/04\/xmlenc\# TripleDES\-cbc](http://www.w3.org/2001/04/xmlenc)|>\= 192|Поддерживаемый алгоритм для расшифровки маркера безопасности. Маркер безопасности с помощью этого алгоритма шифрования не поддерживается.|  
|AES128 \- http:\/\/www.w3.org\/2001\/04\/xmlenc\#aes128\-cbc|128|Поддерживаемый алгоритм для расшифровки маркера безопасности. Маркер безопасности с помощью этого алгоритма шифрования не поддерживается.|  
|AES192 \- http:\/\/www.w3.org\/2001\/04\/xmlenc\#aes192\-cbc|192|Поддерживаемый алгоритм для расшифровки маркера безопасности. Маркер безопасности с помощью этого алгоритма шифрования не поддерживается.|  
|AES256 \- [http:\/\/www.w3.org\/2001\/04\/xmlenc\#aes256\-cbc](http://www.w3.org/2001/04/xmlenc)|256|**По умолчанию**. Поддерживаемый алгоритм для шифрования маркера безопасности.|  
|TripleDESKeyWrap \- http:\/\/www.w3.org\/2001\/04\/xmlenc\#кВт\-tripledes|Все размеры ключа, поддерживаемые .NET 4.0\+|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркер безопасности.|  
|AES128KeyWrap \- [http:\/\/www.w3.org\/2001\/04\/xmlenc\#кВт\-aes128](http://www.w3.org/2001/04/xmlenc)|128|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркер безопасности.|  
|AES192KeyWrap \- [http:\/\/www.w3.org\/2001\/04\/xmlenc\#kw\-aes192](http://www.w3.org/2001/04/xmlenc)|192|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркер безопасности.|  
|AES256KeyWrap \- [http:\/\/www.w3.org\/2001\/04\/xmlenc\#кВт\-aes256](http://www.w3.org/2001/04/xmlenc)|256|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркер безопасности.|  
|RsaV15KeyWrap \- http:\/\/www.w3.org\/2001\/04\/xmlenc\#rsa\-1\_5|1024|Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркер безопасности.|  
|RsaOaepKeyWrap \- [http:\/\/www.w3.org\/2001\/04\/xmlenc\#rsa\-oaep\-mgf1p](http://www.w3.org/2001/04/xmlenc)|1024|По умолчанию. Поддерживается алгоритм для шифрования симметричного ключа, который шифрует маркер безопасности.|  
|SHA1\-http:\/\/www.w3.org\/PICS\/DSig\/SHA1\_1\_0. html|N\/A|Используемый сервер AD FS в поколении SourceId артефакта:  В этом случае службы маркеров безопасности использует SHA1 \(на рекомендации в стандарте SAML 2.0\) требуется создать значение короткий 160 бит для sourceiD артефакта.<br /><br />Также используется веб-агента ADFS \(прежних версий компонента из Windows Server 2003 временных рамок\) для идентификации изменений в течение времени, «обновлено» значение таким образом, чтобы он знает, когда следует обновить данные из службы маркеров безопасности.|  
|SHA1withRSA\-<br /><br />http:\/\/www.w3.org\/PICS\/DSig\/RSA\-SHA1\_1\_0. html|N\/A|Используется в случаях, когда сервер AD FS проверяет подпись SAML AuthenticationRequest, выполните вход артефакта разрешение запроса или ответа, создание токена\-сертификат для подписи.<br /><br />В этом случае по умолчанию используется SHA256, а SHA1 используется только в том случае, если партнер \(проверяющая сторона\) не может поддерживать SHA256 и необходимо использовать SHA1.|  
  
## <a name="BKMK_13"></a>Требования к разрешениям  
Администратор, выполняющий установки и начальной конфигурации AD FS, должен иметь права администратора домена в локальном домене \(другими словами, к которому присоединен сервер федерации для домена.\)  
  
## <a name="see-also"></a>См. также  
[Руководство по разработке AD FS в Windows Server 2012 R2](AD-FS-Design-Guide-in-Windows-Server-2012-R2.md)  
  

