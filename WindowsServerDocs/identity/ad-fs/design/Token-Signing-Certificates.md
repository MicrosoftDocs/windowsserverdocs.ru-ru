---
description: Дополнительные сведения о сертификатах Token-Signing.
ms.assetid: 98c5ef45-2bcb-4f87-86c8-5ac6c16a6097
title: Сертификаты подписи токена
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: aed5fac9cf53ec41d79828ef94eb194b6dfb1d84
ms.sourcegitcommit: fb2ae5e6040cbe6dde3a87aee4a78b08f9a9ea7c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2021
ms.locfileid: "98716950"
---
# <a name="token-signing-certificates"></a>Сертификаты подписи токена

Серверы федерации нуждаются в \- сертификатах для подписи маркеров, чтобы предотвратить изменение или подделка маркеров безопасности злоумышленниками при попытке получить несанкционированный доступ к федеративным ресурсам. \/Связывание закрытого открытого ключа, используемое с \- сертификатами для подписи маркеров, является наиболее важным механизмом проверки любой Федеративной связи, так как эти ключи проверяют, был ли маркер безопасности выдан действительным сервером федерации партнера и что маркер не был изменен во время передачи.

## <a name="token-signing-certificate-requirements"></a>\-Требования к сертификату для подписи маркера
\-Сертификат для подписи маркера должен соответствовать следующим требованиям для работы с AD FS.

-   \-Чтобы сертификат подписи маркера успешно подписывать маркер безопасности, \- сертификат подписи маркера должен содержать закрытый ключ.

-   Учетная запись службы AD FS должна иметь доступ к \- закрытому ключу сертификата для подписи маркера в личном хранилище локального компьютера. Это выполняется программой установки. Вы также можете использовать оснастку управления AD FS \- в, чтобы обеспечить этот доступ, если впоследствии вы измените \- сертификат подписи маркера.

> [!NOTE]
> Инфраструктура открытых ключей не \( \) рекомендуется использовать закрытый ключ для нескольких целей. Поэтому не используйте сертификат связи служб, установленный на сервере федерации в качестве сертификата для подписи маркера \- .

## <a name="how-token-signing-certificates-are-used-across-partners"></a>\-Использование сертификатов для подписи маркеров на разных участниках
Каждый \- сертификат подписи маркера содержит криптографические закрытые ключи и открытые ключи, которые используются для цифровой подписи \( с помощью закрытого ключа \) маркера безопасности. Позже, после получения сервером федерации партнера, эти ключи проверяют подлинность \( с помощью открытого ключа \) зашифрованного маркера безопасности.

Так как каждый маркер безопасности имеет цифровую подпись партнера по учетным записям, партнер по ресурсам может проверить, что маркер безопасности на самом деле выдан партнером по учетной записи и что он не был изменен. Цифровые подписи проверяются частью открытого ключа сертификата для подписи маркера партнера \- . После проверки подписи сервер федерации ресурсов создает собственный маркер безопасности для своей организации и подписывает маркер безопасности с помощью собственного сертификата для подписи маркера \- .

Для партнерских сред Федерации, когда \- центр сертификации выдает сертификат для подписи маркера, убедитесь в том, что:

1.  Список отзыва сертификатов содержит списки \( отзыва сертификатов, \) Доступные для проверяющих сторон и веб-серверов, которые доверяют серверу федерации.

2.  Сертификат корневого ЦС является доверенным для проверяющих сторон и веб-серверов, которые доверяют серверу федерации.

Веб-сервер в партнере по ресурсам использует открытый ключ \- сертификата для подписи маркера, чтобы убедиться, что маркер безопасности подписан сервером федерации ресурсов. Затем веб-сервер обеспечивает соответствующий доступ к клиенту.

## <a name="deployment-considerations-for-token-signing-certificates"></a>Рекомендации по развертыванию \- сертификатов для подписи маркеров
При развертывании первого сервера федерации в новой установке AD FS необходимо получить \- сертификат подписи маркера и установить его в личное хранилище сертификатов локального компьютера на этом сервере федерации. Сертификат для подписи маркера можно получить \- , запросив его из центра сертификации предприятия или из общедоступного центра сертификации или создав самозаверяющий \- сертификат.

-   Закрытый ключ из одного \- сертификата подписи маркера является общим для всех серверов федерации в ферме.

    В среде фермы серверов федерации рекомендуется, чтобы все серверы федерации использовали один и тот \( \) же \- сертификат подписи маркера. Вы можете установить один \- сертификат подписи маркера из центра сертификации на сервере федерации, а затем экспортировать закрытый ключ, если выданный сертификат помечен как экспортируемый.

    Как показано на следующем рисунке, закрытый ключ из одного сертификата подписи маркера \- может быть общим для всех серверов федерации в ферме. Этот параметр — по сравнению с \- параметром "уникальный сертификат подписи маркера" — сокращает затраты, если вы планируете получить сертификат для подписи маркера \- из общедоступного ЦС.

    ![Иллюстрация, на которой показан закрытый ключ из одного \- сертификата для подписи маркера, может быть общим для всех серверов федерации в ферме.](media/adfs2_fedserver_certstory_3.gif)


Сведения об установке сертификата при использовании служб сертификации Майкрософт в качестве ЦС предприятия см. [в статье iis 7,0: создание сертификата сервера домена в iis 7,0](https://go.microsoft.com/fwlink/?LinkId=108548).

Сведения об установке сертификата из общедоступного ЦС см. в разделе [IIS 7,0: запрос сертификата Интернет-сервера](https://go.microsoft.com/fwlink/?LinkId=108549).

Сведения об установке самозаверяющего \- сертификата см. [в разделе IIS 7,0: Создание самозаверяющего \- сертификата сервера в IIS 7,0](https://go.microsoft.com/fwlink/?LinkID=108271).

## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
