---
ms.assetid: 39ecc468-77c5-4938-827e-48ce498a25ad
title: "Приложение А — Анализ требований AD FS"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: d5cfb5de77843eebfc152b9c79ac55bab1fa7727
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="appendix-a-reviewing-ad-fs-requirements"></a>Приложение a. Анализ требований AD FS

>Область применения: Windows Server 2012

Чтобы успешного взаимодействия партнеров организации в развертывании служб федерации Active Directory (AD FS), вам необходимо убедиться в том, что инфраструктура корпоративной сети настроена для поддержки требований AD FS для учетных записей, разрешения имен и сертификатов. AD FS имеет следующие типы требований.  
  
> [!TIP]  
> Можно найти дополнительные ссылки ресурсов AD FS в [Карта содержимого AD FS](https://social.technet.microsoft.com/wiki/contents/articles/2735.aspx) на вики-сайте Microsoft TechNet. Эту страницу ведут участники сообщества AD FS и отслеживается группы разработчиков AD FS на регулярной основе.  
  
## <a name="hardware-requirements"></a>Требования к оборудованию  
Применяются следующие минимальные и рекомендуемые аппаратные требования для сервера федерации и прокси-сервера федерации компьютеров.  
  
|Требования к оборудованию|Минимальные требования|Рекомендуемое требование|  
|------------------------|-----------------------|---------------------------|  
|Скорость ЦП|Одноядерный, 1 гигагерц (ГГц)|Четырехъядерный с частотой 2 ГГц|  
|ОЗУ|1 ГБ|4 ГБ|  
|На диске|50 МБ|100 МБ|  
  
## <a name="software-requirements"></a>Требования к программному обеспечению  
AD FS зависит от функциональности сервера, которая встроена в операционную систему Windows Server® 2012.  
  
> [!NOTE]  
> Службы роли службы федерации и прокси-агент службы федерации не могут сосуществовать на одном компьютере.  
  
## <a name="certificate-requirements"></a>Требования к сертификатам  
Сертификаты играют ключевую роль в обеспечении безопасности связи между серверами федерации, прокси-серверов федерации, приложениями с поддержкой утверждений и веб-клиентами. Требования к сертификатам различаются в зависимости от того, является ли настройке сервера федерации или прокси-серверов федерации, как описано в этом разделе.  
  
### <a name="federation-server-certificates"></a>Сертификаты сервера федерации  
Серверы федерации требуются сертификаты в следующей таблице.  
  
|Тип сертификата|Описание|Что необходимо знать до начала развертывания|  
|--------------------|---------------|------------------------------------------|  
|Secure Sockets Layer (SSL) сертификата|Это стандартный сертификат Secure Sockets Layer (SSL), который используется для защиты обмена данными между серверами федерации и клиентами.|Этот сертификат должен быть связан по умолчанию веб-сайт по в Internet Information Services (IIS) для сервера федерации или прокси-сервера федерации.  Для прокси-сервера федерации необходимо настроить привязки непосредственно в IIS, прежде чем запускать мастер настройки прокси-сервера федерации успешно.<br /><br />**Рекомендация:** поскольку этому сертификату должны доверять клиенты AD FS, используйте сертификат проверки подлинности сервера, выданный общедоступного (сторонним) центра сертификации (ЦС), например, VeriSign. **Совет:** имя субъекта этого сертификата используется для представления имя службы федерации для каждого экземпляра AD FS, которая развертывается. По этой причине может потребоваться смысл выбрать имя субъекта на вновь изданных ЦС сертификатах, наиболее полно отражающее имя компании или организации для партнеров.|  
|Сертификат взаимодействия служб|Этот сертификат обеспечивает безопасность сообщений WCF для обеспечения безопасности связи между серверами федерации.|По умолчанию SSL-сертификат используется в качестве сертификата взаимодействия служб.  Это можно изменить с помощью консоли управления AD FS.|  
|Сертификат для подписи маркера|Это стандартный X509 сертификат, используемый для безопасного подписания всех токенов, издаваемых сервером федерации.|Сертификат подписи токена должен содержать закрытый ключ и быть связанным по цепочке с доверенной корневой папкой службы федерации. По умолчанию AD FS создает самозаверяющий сертификат. Тем не менее можно впоследствии можно заменить на сертификат, выданный ЦС с помощью оснастки управления AD FS, в зависимости от потребностей вашей организации.|  
|Сертификат расшифровки токенов|Это стандартный SSL-сертификат, который используется для расшифровки входящих токенов, зашифрованных партнерским сервером федерации. Он также публикуется в метаданных федерации.|По умолчанию AD FS создает самозаверяющий сертификат. Тем не менее можно впоследствии можно заменить на сертификат, выданный ЦС с помощью оснастки управления AD FS, в зависимости от потребностей вашей организации.|  
  
> [!CAUTION]  
> Сертификаты, используемые для подписи маркера и расшифровки токенов крайне важную роль для стабильности службы федерации. Поскольку потеря или незапланированное удаление всех сертификатов, настроенных для этой цели могут нарушить работу службы, следует создать резервную копию всех сертификатов, настроенных для этой цели.  
  
Дополнительные сведения об используемых серверами федерации сертификатах см. в разделе [требования к сертификатам для серверов федерации](Certificate-Requirements-for-Federation-Servers.md).  
  
### <a name="federation-server-proxy-certificates"></a>Сертификаты прокси-сервера федерации  
Прокси-серверов федерации требуются сертификаты в следующей таблице.  
  
|Тип сертификата|Описание|Что необходимо знать до начала развертывания|  
|--------------------|---------------|------------------------------------------|  
|Сертификат проверки подлинности сервера|Это стандартный сертификат Secure Sockets Layer (SSL), который используется для защиты обмена данными между Интернет-клиентом и прокси-сервера федерации.|Этот сертификат должен быть связан по умолчанию веб-сайт по в Internet Information Services (IIS), прежде чем запускать мастер настройки прокси-сервера сервера AD FS федерации успешно.<br /><br />**Рекомендация:** поскольку этому сертификату должны доверять клиенты AD FS, используйте сертификат проверки подлинности сервера, выданный общедоступного (сторонним) центра сертификации (ЦС), например, VeriSign.<br /><br />**Совет:** имя субъекта этого сертификата используется для представления имя службы федерации для каждого экземпляра AD FS, которая развертывается. По этой причине может потребоваться смысл выбрать имя субъекта, наиболее полно отражающее имя компании или организации для партнеров.|  
  
Дополнительные сведения о сертификатах, используемых прокси-сервера федерации см. в разделе [требования к сертификатам для прокси-серверов федерации](Certificate-Requirements-for-Federation-Server-Proxies.md).  
  
## <a name="browser-requirements"></a>Требования к браузерам  
Несмотря на то, что любой текущий веб-браузер с поддержкой JavaScript можно сделать для работы в качестве клиента AD FS, веб-страниц, которые предоставляются по умолчанию протестированы только для версий Internet Explorer 7.0, 8.0 и 9.0, Mozilla Firefox 3.0 и Safari 3.1 в Windows. Необходимо включить JavaScript и файлы cookie должен быть включен на основе браузера вход в систему и выхода из системы для правильной работы.  
  
Группы разработчиков AD FS в корпорации Майкрософт успешно протестировала конфигурации браузера и операционной системы в таблице ниже.  
  
|Обозреватель|Windows 7|Windows Vista|  
|-----------|-------------|-----------------|  
|Internet Explorer 7.0|X|X|  
|Internet Explorer 8.0|X|X|  
|Internet Explorer 9.0|X|Не тестировалось|  
|FireFox 3.0|X|X|  
|Safari 3.1|X|X|  
  
> [!NOTE]  
> AD FS поддерживает 32- и 64-разрядные версии всех браузеров в приведенной выше таблице.  
  
### <a name="cookies"></a>Файлы cookie  
AD FS создает на основе сеансов и сохраняемые файлы cookie, которые должны храниться на клиентских компьютерах для обеспечения входа, выхода, единого входа (SSO) и другие функциональные возможности. Таким образом необходимо настроить клиентский браузер для приема файлов cookie. Файлы cookie, используемые для проверки подлинности всегда являются Secure Hypertext передачи протоколом HTTPS файлы cookie сеансов, которые записываются для исходного сервера. Если клиентский браузер не настроен для поддержки этих файлов cookie, AD FS не сможет функционировать правильно. Сохраняемые файлы cookie используются для сохранения выбранного пользователем поставщика утверждений. Их можно отключить, воспользовавшись параметром конфигурации в файл конфигурации для страниц входа AD FS.  
  
По соображениям безопасности требуется поддержка TLS/SSL.  
  
## <a name="network-requirements"></a>Требования к сети  
Правильная настройка следующих сетевых служб для успешного развертывания AD FS в вашей организации.  
  
### <a name="tcpip-network-connectivity"></a>Сетевое подключение TCP/IP  
AD FS функции должен существовать сетевое подключение TCP/IP между клиентом; контроллер домена. и компьютеров, на которых размещена служба федерации, прокси-службы федерации (если он используется) и веб-агент AD FS.  
  
### <a name="dns"></a>DNS-СЕРВЕРА  
Это основная сетевая служба, обеспечивающая работу службы федерации Active Directory, отличном от доменных служб Active Directory (AD DS), — доменных имен (DNS). Если развернута служба DNS, пользователи могут использовать удобные имена компьютеров, который легко запомнить, для подключения к компьютерам и другим ресурсам в IP-сетях.  
  
 Windows Server 2008 использует DNS-сервера для разрешения имен вместо разрешения имен NetBIOS Windows Internet Name Service (WINS), который использовался в сетях на базе Windows NT 4.0. Это по-прежнему можно использовать WINS для приложений, которым он необходим. Однако AD DS и AD FS, требуются разрешения DNS-имен.  
  
Процедура настройки DNS для поддержки службы федерации Active Directory варьируется в зависимости:  
  
-   У организации уже есть имеющуюся инфраструктуру DNS. В большинстве сценариев DNS уже настроена для всей сети так что клиенты веб-браузера в корпоративной сети имеют доступ к Интернету. Поскольку Internet доступ и разрешение имен являются требованиями AD FS, эта инфраструктура предполагается, что это выполняться для развертывания Служб федерации Active Directory.  
  
-   Планируется добавление федеративного сервера в корпоративную сеть. В целях аутентификации пользователей в корпоративной сети, необходимо настроить внутренние DNS-серверы в лесу корпоративной сети для возвращения имени CNAME внутреннего сервера, на котором выполняется служба федерации. Дополнительные сведения см. в разделе [требования к разрешению имен для серверов федерации](Name-Resolution-Requirements-for-Federation-Servers.md).  
  
-   Планируется добавление федеративного сервера прокси-сервера в сети периметра. Если требуется выполнить аутентификацию учетных записей пользователей, которые находятся в корпоративной сети партнерской организации по удостоверениям, необходимо настроить внутренние DNS-серверы в лесу корпоративной сети для возвращения имени CNAME внутренней федерации прокси-сервера. Сведения о настройке DNS для реализации возможности добавления прокси-сервера федерации см. в разделе [требования к разрешению имен для прокси-серверов федерации](Name-Resolution-Requirements-for-Federation-Server-Proxies.md).  
  
-   DNS настраивается для тестовой лабораторной среде. Если вы планируете использовать службы федерации Active Directory в тестовой лабораторной среде, где ни один корневой сервер DNS не является полномочным, вполне вероятно, что вам необходимо будет настроить серверы пересылки DNS, чтобы запросы имен между двумя и более лесами пересылались соответственно. Общие сведения о настройке тестовой лабораторной среде AD FS см. в разделе [AD FS пошаговые и практические руководства по](https://go.microsoft.com/fwlink/?LinkId=180357).  
  
## <a name="attribute-store-requirements"></a>Требования к хранилищу атрибутов  
Службы федерации Active Directory требуется по крайней мере одного хранилища атрибутов, используемый для проверки подлинности пользователей и извлечения утверждений безопасности для этих пользователей. Список атрибутов хранилищ, поддерживаемых AD FS см. в разделе [роль хранилищ атрибутов](../../ad-fs/technical-reference/The-Role-of-Attribute-Stores.md) в руководстве по проектированию AD FS.  
  
> [!NOTE]  
> AD FS автоматически создает хранилище атрибутов Active Directory по умолчанию.  
  
Требования к хранилищу атрибутов зависят от того, является ли ваша организация выступает в качестве партнера по учетным записям (где размещены федеративные пользователи) или партнер по ресурсам (где размещено Федеративное приложение).  
  
### <a name="ad-ds"></a>AD DS  
AD FS для успешной работы контроллеры домена в организации партнера по учетным записям или в организации партнера по ресурсам необходимо под управлением Windows Server 2003 с пакетом обновления 1, Windows Server 2003 R2, Windows Server 2008 или Windows Server 2012.  
  
Если AD FS устанавливается и настраивается на компьютере, присоединенном к домену, хранилище учетных записей пользователей Active Directory для этого домена предоставляется как хранилище выбираемые атрибутов.  
  
> [!IMPORTANT]  
> Службы федерации Active Directory необходимо установить Internet Information Services (IIS), поэтому рекомендуется не установить программное обеспечение службы федерации Active Directory на контроллере домена в рабочей среде, в целях безопасности. Однако эта конфигурация поддерживается службой технической поддержки клиентов Майкрософт.  
  
#### <a name="schema-requirements"></a>Требования к схеме  
Службы федерации Active Directory не требуется вносить изменения в схему или модификации функционального уровня в AD DS.  
  
#### <a name="functional-level-requirements"></a>Требования функционального уровня  
Большинства функций AD FS не требуются модификации функционального уровня AD DS для успешной работы. Тем не менее, режим работы домена Windows Server 2008 уровне или выше, не требуется для проверки подлинности сертификата клиента для успешной работы, если сертификат явно сопоставлен учетной записи пользователя в Доменных службах Active Directory.  
  
#### <a name="service-account-requirements"></a>Требования к учетной записи службы  
При создании фермы серверов федерации, сначала необходимо создать на основе домена выделенную учетную запись в Доменных службах Active Directory, можно использовать службы федерации. Впоследствии можно настроить каждый сервер федерации в ферме, чтобы использовать эту учетную запись. Дополнительные сведения о том, как это сделать см. в разделе [вручную настроить учетную запись службы для фермы серверов федерации](../../ad-fs/deployment/Manually-Configure-a-Service-Account-for-a-Federation-Server-Farm.md) в руководстве по развертыванию AD FS.  
  
### <a name="ldap"></a>LDAP  
При работе с другими хранилищами атрибутов на основе облегченного протокола доступа к каталогу LDAP, необходимо подключиться к LDAP-серверу, поддерживающему интегрированную аутентификацию Windows. Строка подключения LDAP должна записываться в формате URL-адреса LDAP, как описано в стандарте RFC 2255.  
  
### <a name="sql-server"></a>SQL Server  
AD FS для успешной работы компьютеры, на которых размещено хранилище атрибутов структурированных запросов языка SQL Server должна быть запущена Microsoft SQL Server 2005 или SQL Server 2008. При работе с хранилищами атрибутов на базе SQL необходимо также настроить строку подключения.  
  
### <a name="custom-attribute-stores"></a>Хранилища настраиваемых атрибутов  
Можно разработать пользовательские хранилища атрибутов для включения расширенных сценариев. Язык политик, интегрированный в AD FS может ссылаться на хранилища настраиваемых атрибутов, так что любой из следующих сценариев могут быть усовершенствованы:  
  
-   Создание утверждений для прошедшего локальную аутентификацию пользователя  
  
-   Добавление утверждений для прошедшего внешнюю аутентификацию пользователя  
  
-   Авторизация пользователя на получение токена  
  
-   Авторизация службы на получение токена для поведения пользователя  
  
При работе с хранилищем настраиваемых атрибутов может также потребоваться настроить строку подключения. В этой ситуации можно ввести любой пользовательский код, вам нравится, позволяющий подключение к хранилищу настраиваемых атрибутов. Строки подключения в этом случае — это набор пар имя значение, которые интерпретируются как реализованные разработчиком хранилища настраиваемых атрибутов.  
  
Дополнительные сведения о разработке и использовании хранилищ настраиваемых атрибутов см. в разделе [Общие сведения о хранилище атрибутов](https://go.microsoft.com/fwlink/?LinkId=190782).  
  
## <a name="application-requirements"></a>Требования к приложениям  
Серверы федерации можно взаимодействовать с и обеспечивать защиту приложений федерации, например, приложения, поддерживающие утверждения.  
  
## <a name="authentication-requirements"></a>Требования к проверке подлинности  
AD FS естественно интегрируется с существующими механизмами аутентификации Windows, например, проверка подлинности Kerberos, NTLM, смарт-картам и клиентским сертификатам X.509 v3. Серверы федерации используют стандартную аутентификацию Kerberos для проверки подлинности пользователя в домене. Клиенты могут проходить проверку подлинности с помощью проверки подлинности на основе форм, смарт-карты и встроенной проверки подлинности Windows, в зависимости от того, как настроить проверку подлинности.  
  
Роль прокси-сервера федерации AD FS делает возможным сценарий, в котором пользователь проходит проверку извне с помощью проверки подлинности клиента SSL. Можно также настроить роль сервера федерации для требования SSL-аутентификации клиента, хотя наивысшее пользователю удобство обеспечивается настройкой сервера федерации учетных записей для встроенной проверки подлинности Windows. В этом случае AD FS имеет не контролирует, какие учетные данные пользователь использует для входа на рабочий стол Windows.  
  
### <a name="smart-card-logon"></a>Вход по смарт-карт  
Несмотря на то, что службы федерации Active Directory может принудительно реализовывать тип учетных данных, используемый для аутентификации (пароли, SSL-аутентификации клиента или Интегрированная аутентификация Windows), не реализуется напрямую проверку подлинности с помощью смарт-карты. Таким образом службы федерации Active Directory не поддерживает клиентский пользовательский интерфейс (UI) для получения смарт карт персональный идентификационный номер (PIN) учетные данные. Это так, как клиенты Windows намеренно не предоставляют сведения учетных данных пользователя для серверов федерации или веб-серверов.  
  
### <a name="smart-card-authentication"></a>Проверка подлинности смарт-карты  
Проверка подлинности смарт-карты использует протокол Kerberos для проверки подлинности сервера федерации учетных записей. Службы федерации Active Directory невозможно расширить для добавления новых методов проверки подлинности. Сертификат в смарт-карт не является обязательным в цепочку с доверенным корневым расположением на клиентском компьютере. Использование сертификата на базе смарт карты с помощью AD FS необходимо выполнение следующих условий:  
  
-   Считывающий механизм и поставщик служб шифрования (CSP) для смарт-карты должен работать на компьютере, где расположен браузер.  
  
-   Сертификат смарт-карты должен связываться по цепочке с доверенным корневым расположением на сервер федерации учетных записей и прокси-сервера федерации учетных записей.  
  
-   Сертификат должен сопоставляться с записью пользователя в AD DS одним из следующих методов:  
  
    -   Имя субъекта сертификата соответствует различающемуся имени LDAP учетной записи пользователя в Доменных службах Active Directory.  
  
    -   Расширение altname субъекта сертификата имеет имя участника-пользователя (UPN) учетной записи пользователя в Доменных службах Active Directory.  
  
Для удовлетворения определенных требований в отношении строгости аутентификации в некоторых сценариях, это также возможно настроить AD FS для создания утверждения, указывающего на способ аутентификации пользователя. Затем проверяющая сторона может использовать это утверждение для принятия решения об авторизации.  
  
## <a name="see-also"></a>См. также:
[Руководство по разработке служб AD FS в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
