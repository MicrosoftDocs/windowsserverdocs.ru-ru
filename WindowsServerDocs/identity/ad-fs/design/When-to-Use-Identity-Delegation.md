---
ms.assetid: 6e711a96-9055-4508-b6d4-318d6aa95fd1
title: Использование делегирования удостоверений
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 7a594332900c8b3afb95c139bcde8458a10f186b
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80858467"
---
# <a name="when-to-use-identity-delegation"></a>Использование делегирования удостоверений
  
## <a name="what-is-identity-delegation"></a>Что такое делегирование удостоверений?  
Делегирование удостоверений — это функция службы федерации Active Directory (AD FS) \(AD FS\), которая позволяет администратору\-указанным учетным записям для олицетворения пользователей. Учетная запись, которая олицетворяет пользователя, называется *делегатом*. Делегирование имеет важное значение для многих распределенных приложений с рядом проверок контроля доступа, которые должны выполняться последовательно для каждого приложения, базы данных или службы, находящейся в цепочке авторизации для исходящего запроса. Существует множество реальных\-реальных сценариев, в которых веб-приложение "внешний интерфейс" должно получать данные из более безопасной "серверной части", например веб-службы, подключенной к базе данных Microsoft SQL Server.  
  
Например, существующие части\-веб-сайт заказа можно улучшить программным способом, чтобы предоставить партнерским организациям возможность просматривать свой журнал покупок и состояние учетной записи. По соображениям безопасности все финансовые данные партнера хранятся в защищенной базе данных на выделенном язык SQL \(SQL\) Server. В этом случае код в интерфейсном приложении\-конечного приложения ничего не знает о финансовых данных партнерской организации. Поэтому он должен получить эти данные с другого компьютера в другом расположении в сети, где \(в этом случае\) веб-службу для базы данных частей \(серверной части\).  
  
Чтобы процесс извлечения\-данных был успешным, может потребоваться выполнить проверку подлинности "руки\-встряхиваний" между веб-приложением и веб-службой для базы данных частей, как показано на следующем рисунке.  
  
![Делегирование удостоверений](media/adfs2_identitydelegationconcept.gif)  
  
Так как исходный запрос был отправлен к самому веб-серверу, который может находиться в совершенно другой организации, отличной от организации пользователя, пытающегося получить доступ к веб-серверу, маркер безопасности, который отправляется вместе с запросом, не соответствует критериям авторизации, необходимым для доступа к любому другому компьютеру, кроме веб-сервера. Таким образом, единственным способом выполнения исходного запроса пользователя является размещение промежуточного сервера в организации партнера по ресурсам для повторного выпуска маркера безопасности с соответствующими правами доступа.  
  
## <a name="how-does-identity-delegation-work"></a>Как работает делегирование удостоверений?  
Веб-приложения в многоуровневых архитектурах приложений часто вызывают веб-службы для доступа к общим данным или функциональным возможностям. Этим веб-службам должно быть известно удостоверение исходного пользователя, чтобы они могли принимать решения об авторизации и упрощать процедуры проверки. В этом случае веб-приложение переднего\-End представляет пользователя веб-службы в качестве делегата. AD FS упрощает этот сценарий, позволяя учетным записям Active Directory работать в качестве пользователя с другой проверяющей стороной. На следующем рисунке показан сценарий делегирования удостоверения.  
  
![Делегирование удостоверений](media/adfs2_identitydelegationsteps.gif)  
  
1.  Федор пытается получить доступ к части журнала заказа\-из веб-приложения в другой организации. Его клиентский компьютер запрашивает и получает маркер из AD FS для первой\-конечной части,\-упорядочения веб-приложения.  
  
2.  Клиентский компьютер отправляет запрос веб-приложению, включая маркер, полученный на шаге 1, для подтверждения удостоверения клиента.  
  
3.  Веб-приложение должно связаться с веб-службой, чтобы завершить транзакцию для клиента. Веб-приложение обращается AD FS, чтобы получить маркер делегирования для взаимодействия с веб-службой. Маркеры делегирования являются маркерами безопасности, которые выдаются делегату для работы в качестве пользователя. AD FS возвращает маркер делегирования с утверждениями о клиенте, предназначенном для веб-службы.  
  
4.  Веб-приложение использует маркер, полученный из AD FS на шаге 3 для доступа к веб-службе, действующей в качестве клиента. При изучении маркера делегирования веб-служба может определить, что веб-приложение работает в качестве клиента. Веб-служба выполняет политику авторизации, регистрирует запроса и предоставляет необходимые данные журнала заказов, первоначально запрошенные пользователем, в веб-приложение, и, следовательно, данному пользователю.  
  
Для конкретного делегата AD FS может ограничивать веб-службы, для которых веб-приложение может запросить маркер делегирования. Клиентский компьютер не имеет учетной записи Active Directory для выполнения данной операции. И, наконец, как было отмечено ранее, веб-служба может легко определить удостоверение делегата, который выступает в качестве пользователя. Поведение веб-служб зависит от того, взаимодействуют ли они с клиентским компьютером напрямую или через делегата.  
  
## <a name="configuring-ad-fs-for-identity-delegation"></a>Настройка службы федерации Active Directory для делегирования удостоверений  
Вы можете использовать\-оснастки управления AD FS в, чтобы настроить AD FS для делегирования удостоверений, когда необходимо упростить процесс получения данных. После настройки AD FS может создать новые маркеры безопасности, которые будут включать контекст авторизации, который может потребоваться службе End\-, прежде чем он сможет предоставить доступ к защищенным данным.  
  
AD FS не ограничивает, какие пользователи могут олицетворять. После настройки AD FS для делегирования удостоверений выполняет следующие действия:  
  
-   Определение серверов, которым можно делегировать полномочия для запроса маркеров на олицетворение пользователей.  
  
-   Формирование и изолированное хранение контекста удостоверения для учетной записи клиента, которая является делегированной, и сервера, который выступает в качестве делегата.  
  
Делегирование удостоверений можно настроить, добавив правила авторизации делегирования к отношениям доверия проверяющей стороны в оснастке управления AD FS\-в. Дополнительные инструкции по решению этой задачи см. в разделе [Checklist: Creating Claim Rules for a Relying Party Trust](../../ad-fs/deployment/Checklist--Creating-Claim-Rules-for-a-Relying-Party-Trust.md).  
  
## <a name="configuring-the-front-end-web-application-for-identity-delegation"></a>Настройка внешнего\-веб-приложения для делегирования удостоверений  
У разработчиков есть несколько вариантов, которые можно использовать для правильной программирования веб-интерфейса\-приложения или службы для перенаправления запросов на делегирование на компьютер AD FS. Дополнительные сведения о настройке веб-приложения для работы с делегированием удостоверений см. в разделе [Пакет SDK Windows Identity Foundation](https://go.microsoft.com/fwlink/?LinkId=122266).  
  
## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
