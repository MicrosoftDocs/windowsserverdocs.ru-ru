---
ms.assetid: 6e711a96-9055-4508-b6d4-318d6aa95fd1
title: Использование делегирования удостоверений
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 0d69c92209a2998cf2c249b865ad8d16424735ca
ms.sourcegitcommit: f6490192d686f0a1e0c2ebe471f98e30105c0844
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2019
ms.locfileid: "70867582"
---
# <a name="when-to-use-identity-delegation"></a>Использование делегирования удостоверений
  
## <a name="what-is-identity-delegation"></a>Что такое делегирование удостоверений?  
Делегирование удостоверения — это функция службы федерации Active Directory (AD FS) \(AD FS\) , которая позволяет\-администратору указать учетные записи для олицетворения пользователей. Учетная запись, которая олицетворяет пользователя, называется *делегатом*. Делегирование имеет важное значение для многих распределенных приложений с рядом проверок контроля доступа, которые должны выполняться последовательно для каждого приложения, базы данных или службы, находящейся в цепочке авторизации для исходящего запроса. Существует множество\-реальных сценариев, в которых веб-приложение "внешний интерфейс" должно получать данные из более безопасной "серверной части", например веб-службу, подключенную к Microsoft SQL Server базе данных.  
  
Например, существующий веб-сайт\-заказа частей можно улучшить программным способом, чтобы предоставить партнерским организациям возможность просматривать свой журнал покупок и состояние учетной записи. По соображениям безопасности все финансовые данные партнера хранятся в защищенной базе данных на выделенном язык SQL \(SQL\) Server. В этом случае код в приложении внешнего\-интерфейса ничего не знает о финансовых данных партнерской организации. Поэтому он должен получить эти данные с другого компьютера в другом расположении в сети, \(в которой в\) этом случае используется веб-служба для \(баз данных\)частей серверной части.  
  
Для успешного выполнения\-этого процесса извлечения данных может потребоваться выполнить проверку подлинности "руки\-встряхиваний", которая должна выполняться между веб-приложением и веб-службой для базы данных частей, как показано на следующем рисунке.  
  
![Делегирование удостоверений](media/adfs2_identitydelegationconcept.gif)  
  
Так как исходный запрос был отправлен к самому веб-серверу, который может находиться в совершенно другой организации, отличной от организации пользователя, пытающегося получить доступ к веб-серверу, маркер безопасности, который отправляется вместе с запросом, не соответствует критериям авторизации, необходимым для доступа к любому другому компьютеру, кроме веб-сервера. Таким образом, единственным способом выполнения исходного запроса пользователя является размещение промежуточного сервера в организации партнера по ресурсам для повторного выпуска маркера безопасности с соответствующими правами доступа.  
  
## <a name="how-does-identity-delegation-work"></a>Как работает делегирование удостоверений?  
Веб-приложения в многоуровневых архитектурах приложений часто вызывают веб-службы для доступа к общим данным или функциональным возможностям. Этим веб-службам должно быть известно удостоверение исходного пользователя, чтобы они могли принимать решения об авторизации и упрощать процедуры проверки. В этом случае интерфейсное\-веб-приложение представляет пользователя веб-службы в качестве делегата. AD FS упрощает этот сценарий, позволяя учетным записям Active Directory работать в качестве пользователя с другой проверяющей стороной. На следующем рисунке показан сценарий делегирования удостоверения.  
  
![Делегирование удостоверений](media/adfs2_identitydelegationsteps.gif)  
  
1.  Федор пытается получить доступ\-к журналу заказа частей из веб-приложения в другой организации. Его клиентский компьютер запрашивает и получает маркер из AD FS для веб\--приложения\-упорядочивания частей внешнего интерфейса.  
  
2.  Клиентский компьютер отправляет запрос веб-приложению, включая маркер, полученный на шаге 1, для подтверждения удостоверения клиента.  
  
3.  Веб-приложение должно связаться с веб-службой, чтобы завершить транзакцию для клиента. Веб-приложение обращается AD FS, чтобы получить маркер делегирования для взаимодействия с веб-службой. Маркеры делегирования являются маркерами безопасности, которые выдаются делегату для работы в качестве пользователя. AD FS возвращает маркер делегирования с утверждениями о клиенте, предназначенном для веб-службы.  
  
4.  Веб-приложение использует маркер, полученный из AD FS на шаге 3 для доступа к веб-службе, действующей в качестве клиента. При изучении маркера делегирования веб-служба может определить, что веб-приложение работает в качестве клиента. Веб-служба выполняет политику авторизации, регистрирует запроса и предоставляет необходимые данные журнала заказов, первоначально запрошенные пользователем, в веб-приложение, и, следовательно, данному пользователю.  
  
Для конкретного делегата AD FS может ограничивать веб-службы, для которых веб-приложение может запросить маркер делегирования. Клиентский компьютер не имеет учетной записи Active Directory для выполнения данной операции. И, наконец, как было отмечено ранее, веб-служба может легко определить удостоверение делегата, который выступает в качестве пользователя. Поведение веб-служб зависит от того, взаимодействуют ли они с клиентским компьютером напрямую или через делегата.  
  
## <a name="configuring-ad-fs-for-identity-delegation"></a>Настройка службы федерации Active Directory для делегирования удостоверений  
Можно использовать оснастку\-управления AD FS в, чтобы настроить AD FS для делегирования удостоверений, когда необходимо упростить процесс получения данных. После настройки AD FS может создать новые маркеры безопасности, которые будут включать контекст авторизации, который может потребоваться службе серверной\-части, прежде чем он сможет предоставить доступ к защищенным данным.  
  
AD FS не ограничивает, какие пользователи могут олицетворять. После настройки AD FS для делегирования удостоверений выполняет следующие действия:  
  
-   Определение серверов, которым можно делегировать полномочия для запроса маркеров на олицетворение пользователей.  
  
-   Формирование и изолированное хранение контекста удостоверения для учетной записи клиента, которая является делегированной, и сервера, который выступает в качестве делегата.  
  
Делегирование удостоверений можно настроить, добавив правила авторизации делегирования к отношениям доверия проверяющей стороны в\-оснастке управления AD FS в. Дополнительные сведения о том, как это сделать, см [. в разделе Контрольный список: Создание правил утверждений для отношения доверия](../../ad-fs/deployment/Checklist--Creating-Claim-Rules-for-a-Relying-Party-Trust.md)с проверяющей стороной.  
  
## <a name="configuring-the-front-end-web-application-for-identity-delegation"></a>Настройка интерфейсного\-веб-приложения для делегирования удостоверений  
У разработчиков есть несколько вариантов, которые можно использовать для правильной программирования приложения или службы\-веб-интерфейса для перенаправления запросов на делегирование на AD FS компьютер. Дополнительные сведения о настройке веб-приложения для работы с делегированием удостоверений см. в разделе [Пакет SDK Windows Identity Foundation](https://go.microsoft.com/fwlink/?LinkId=122266).  
  
## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
