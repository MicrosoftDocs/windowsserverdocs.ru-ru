---
ms.assetid: 9831b421-8fb7-4e15-ac27-c013cbca6d05
title: "Требования к сертификатам для серверов федерации"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 369c0e9e7ab1ef25baee1c35379cc66b886f20d8
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="certificate-requirements-for-federation-servers"></a>Требования к сертификатам для серверов федерации

>Область применения: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

В \(AD FS\) проектирования любой служб федерации Active Directory необходимо использовать различные сертификаты для обеспечения безопасности коммуникаций и обеспечения проверки подлинности пользователей между Интернет-клиентами и серверами федерации. Каждый сервер федерации должен иметь сертификат взаимодействия служб и сертификат подписи token\ до начала участия в связи с AD FS. В следующей таблице описаны типы сертификатов, которые связаны с сервером федерации.  
  
|Тип сертификата|Описание|  
|--------------------|---------------|  
|Сертификат подписи Token\|Сертификат подписи token\ является X509 сертификата. Серверы федерации используют соответствующие пары public\ и закрытых ключей для цифровой подписи всех маркеров безопасности, которые они создают. Сюда относится подписывание запросов на разрешение артефактов и метаданных федерации, опубликованных.<br /><br />Может иметь несколько сертификатов подписи token\, настроенные в управления AD FS оснастка чтобы обеспечить замену сертификата подходит к концу. По умолчанию публикуются все сертификаты в списке, однако только основной token\ сертификат подписи используется AD FS для подписи токенов. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.<br /><br />Дополнительные сведения см. в разделе [сертификаты для подписи маркеров](Token-Signing-Certificates.md) и [добавить сертификат подписи токена](../../ad-fs/deployment/Add-a-Token-Signing-Certificate.md).|  
|Сертификат взаимодействия служб|Серверы федерации используют сертификат аутентификации сервера, также известные как сертификат взаимодействия служб для \(WCF\) Windows Communication Foundation безопасности сообщений. По умолчанию это тот же сертификат, который сервер федерации использует в качестве сертификата \(SSL\) протокола SSL в службах IIS \(IIS\). **Примечание:** управления AD FS оснастка расценивает сертификаты проверки подлинности для серверов федерации как сертификаты связи служб.<br /><br />Дополнительные сведения см. в разделе [сертификаты взаимодействия служб](Service-Communications-Certificates.md) и [задание сертификата связи со службой](../../ad-fs/deployment/Set-a-Service-Communications-Certificate.md).<br /><br />Так как сертификат взаимодействия служб должны доверять клиентские компьютеры, рекомендуется использовать сертификат, подписанный доверенным центром сертификации \(CA\). Все выбранные сертификаты должны иметь соответствующий закрытый ключ.|  
|Secure Sockets Layer \(SSL\) сертификата|Серверы федерации используют сертификат SSL для обеспечения безопасности трафика веб-служб в обмене данными SSL с веб-клиентами и прокси-серверов федерации.<br /><br />Поскольку сертификату SSL должны доверять клиентские компьютеры, мы рекомендуем использовать сертификат, подписанный доверенным центром сертификации. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.|  
|Сертификат расшифровки Token\|Этот сертификат используется для расшифровки токенов, полученных сервером федерации.<br /><br />Можно использовать несколько сертификатов расшифровки. Это позволяет сервер федерации ресурсов не может расшифровывать токены, выданные с более старым сертификатом после нового сертификата в качестве основного сертификата расшифровки. Все сертификаты можно использовать для расшифровки, но только основной сертификат для расшифровки token\ сертификат фактически публикуется в метаданных федерации. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.<br /><br />Дополнительные сведения см. в разделе [Добавление сертификата расшифровки токенов ](../../ad-fs/deployment/Add-a-Token-Decrypting-Certificate.md).|  
  
Можно запросить и установить сертификат SSL или сертификат взаимодействия служб, отправив запрос сертификата взаимодействия служб осуществляется через Microsoft Management Console \(MMC\) snap\-в службы IIS. Дополнительные общие сведения об использовании SSL-сертификатов см. в разделе [IIS 7.0: Настройка протокола SSL в IIS 7.0](https://go.microsoft.com/fwlink/?LinkID=108544) и [IIS 7.0: Настройка сертификатов сервера в IIS 7.0](https://go.microsoft.com/fwlink/?LinkID=108545).  
  
> [!NOTE]  
> В AD FS можно изменить уровень \(SHA\) безопасной хэш-алгоритм, используемый для цифровых подписей для \(more secure\) SHA\-1 или SHA\-256. AD FSdoes поддерживает использование сертификатов с другими хэш-методами, такими как MD5 \ (по умолчанию алгоритм хеширования, используемый с tool\ командной строки Makecert.exe). По соображениям безопасности рекомендуется использовать SHA\ 256 \ (который задается default\) для всех подписей. SHA\-1 рекомендуется использовать только в сценариях, в которых требуется взаимодействие с продуктом, не поддерживающим обмен данными по алгоритму SHA\-256, например, отличное продуктом или AD FS 1. *x *.  
  
## <a name="determining-your-ca-strategy"></a>Определение стратегии центра сертификации  
Службы федерации Active Directory не требует издания сертификатов центром сертификации. Однако сертификат SSL \ (сертификат, который также используется по умолчанию в качестве certificate\ обмен данными службы) должны доверять клиенты AD FS. Рекомендуется не использовать многоразовый подписанные сертификаты для этих типов сертификатов.  
  
> [!IMPORTANT]  
> Использование подписи многоразовый сертификатов SSL в рабочей среде позволит пользователю-злоумышленнику в организации партнера по учетным записям получить контроль над серверами федерации в организации партнера по ресурсам. Риск безопасности существует, поскольку подписанные многоразовый сертификаты являются корневыми. Они должны быть добавлены в хранилище доверенных корневых другой сервер федерации \ (например, ресурс федерации сервере), что этот сервер может стать уязвимым для атак.  
  
После получения сертификата из ЦС, убедитесь, что все сертификаты импортированы в хранилище личных сертификатов на локальном компьютере. Можно импортировать сертификаты в личное хранилище с помощью консоли MMC "Сертификаты" оснастка.  
  
В качестве альтернативы с помощью сертификатов оснастка можно также импортировать сертификат SSL с помощью диспетчера служб IIS оснастка во время назначении сертификата SSL на веб-сайт по умолчанию. Дополнительные сведения см. в разделе [Импорт сертификата проверки подлинности сервера на веб-сайт по умолчанию ](../../ad-fs/deployment/Import-a-Server-Authentication-Certificate-to-the-Default-Web-Site.md).  
  
> [!NOTE]  
> Перед установкой программного обеспечения AD FS на компьютере, который должен стать сервером федерации, убедитесь, что оба сертификата находятся в хранилище личных сертификатов на локальном компьютере и что сертификат SSL назначен веб-сайт по умолчанию. Дополнительные сведения о порядке задач, которые требуются для настройки сервера федерации см. в разделе [Checklist: Setting Up a Federation Server ](../../ad-fs/deployment/Checklist--Setting-Up-a-Federation-Server.md).  
  
В зависимости от требований безопасности и бюджетных тщательно продумать, какие из сертификатов будут присваиваться публичным или корпоративным центром сертификации. Рекомендуемые поставщики ЦС для определенных типов сертификатов на следующем рисунке. В этих рекомендациях отражен best\ подход с точки зрения безопасности и затрат.  
  
![требования сертификатов](media/adfs2_fedserver_certstory_1.png)  
  
## <a name="certificate-revocation-lists"></a>Списки отзыва сертификатов  
Если любого используемого сертификата есть списки отзыва сертификатов, сервер с настроенным сертификатом должен иметь возможность связаться с сервером, распространяющим CRL.  
  
## <a name="see-also"></a>См. также:
[Руководство по разработке служб AD FS в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
