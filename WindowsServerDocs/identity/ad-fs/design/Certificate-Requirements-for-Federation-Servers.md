---
ms.assetid: 9831b421-8fb7-4e15-ac27-c013cbca6d05
title: Требования к сертификатам для серверов федерации
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 7eeff82ef3311f18c8252c44c96310fcf3c18217
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71359182"
---
# <a name="certificate-requirements-for-federation-servers"></a>Требования к сертификатам для серверов федерации

В любом проекте службы федерации Active Directory (AD FS) \(AD FS @ no__t-1 для обеспечения безопасности связи и упрощения проверки подлинности пользователей между интернет-клиентами и серверами федерации необходимо использовать различные сертификаты. Каждый сервер федерации должен иметь сертификат связи службы и сертификат Token @ no__t-0signing, прежде чем он сможет участвовать в AD FS связи. В следующей таблице описаны типы сертификатов, связанные с сервером федерации.  
  
|Тип сертификата|Описание|  
|--------------------|---------------|  
|Сертификат токена @ no__t-0signing|Сертификат Token @ no__t-0signing является сертификатом X509. Серверы федерации используют связанные пары ключей @ no__t-0private для цифровой подписи всех выдающихся маркеров безопасности. Сюда относится подписывание опубликованных метаданных федерации и запросов на разрешение артефактов.<br /><br />Вы можете использовать несколько сертификатов Token @ no__t-0signing, настроенных в оснастке управления AD FS @ no__t-1in, чтобы разрешить смену сертификатов, когда срок действия одного из сертификатов заканчивается. По умолчанию все сертификаты в списке публикуются, но AD FS для фактического подписывания используются только сертификаты основного маркера @ no__t-0signing. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.<br /><br />Дополнительные сведения см. в статьях [Token-Signing Certificates](Token-Signing-Certificates.md) и [Add a Token-Signing Certificate](../../ad-fs/deployment/Add-a-Token-Signing-Certificate.md).|  
|Сертификат взаимодействия служб|Серверы федерации используют сертификат проверки подлинности сервера, также называемый обменом данными службы для Windows Communication Foundation безопасности сообщений \(WCF @ no__t-1. По умолчанию это тот же сертификат, который используется сервером федерации в качестве сертификата SSL \(SSL @ no__t-1 в службы IIS \(IIS @ no__t-3. **Примечание.** Оснастка управления AD FS @ no__t-0in относится к сертификатам проверки подлинности сервера для серверов федерации в качестве сертификатов связи служб.<br /><br />Дополнительные сведения см. в разделе [сертификаты связи служб](Service-Communications-Certificates.md) и [Настройка сертификата связи службы](../../ad-fs/deployment/Set-a-Service-Communications-Certificate.md).<br /><br />Так как сертификат связи служб должен быть доверенным для клиентских компьютеров, рекомендуется использовать сертификат, подписанный доверенным центром сертификации \(CA @ no__t-1. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.|  
|SSL сертификат \(SSL @ no__t-1|Серверы федерации используют сертификат SSL для обеспечения безопасности трафика веб-служб при обмене данными SSL с веб-клиентами и прокси-серверами федерации.<br /><br />Поскольку сертификату SSL должны доверять клиентские компьютеры, рекомендуется использовать сертификат, подписанный доверенным центром сертификации. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.|  
|Сертификат токена @ no__t-0decryption|Этот сертификат используется для расшифровки токенов, полученных этим сервером федерации.<br /><br />Можно использовать несколько сертификатов расшифровки. Это позволяет серверу федерации ресурсов расшифровывать маркеры, выпущенные с помощью старого сертификата, после того как новый сертификат будет установлен в качестве основного сертификата расшифровки. Для расшифровки можно использовать все сертификаты, но в метаданных федерации фактически публикуется только сертификат основного маркера @ no__t-0decrypting. Все выбранные сертификаты должны иметь соответствующий закрытый ключ.<br /><br />Дополнительные сведения см. [в разделе Добавление сертификата для расшифровки маркера](../../ad-fs/deployment/Add-a-Token-Decrypting-Certificate.md).|  
  
Вы можете запросить и установить сертификат SSL или сертификат связи службы, запросив сертификат связи службы через консоль управления (Майкрософт) \(MMC @ no__t-1 Snap @ no__t-2in для служб IIS. Дополнительные общие сведения об использовании SSL-сертификатов см. в статье @no__t 0IIS 7,0: Настройка SSL в IIS 7.0 @ no__t-0 и [IIS 7,0: Настройка сертификатов сервера в IIS 7.0 @ no__t-0.  
  
> [!NOTE]  
> В AD FS можно изменить \(уровень SHA\) для алгоритма безопасного хэширования, который используется для цифровых подписей:\-SHA 1 или\-SHA \(256\). AD Фсдоес не поддерживает использование сертификатов с другими методами хэширования, например MD5 \(the по умолчанию хэш-алгоритм, используемый с командой Makecert. exe @ no__t-1line Tool @ no__t-2. По соображениям безопасности рекомендуется использовать SHA\-256 \(, который по умолчанию\) задан для всех подписей. SHA @ no__t-01 рекомендуется использовать только в сценариях, в которых необходимо взаимодействовать с продуктом, который не поддерживает обмен данными с помощью SHA @ no__t-1256, например, не с @ no__t-2Microsoft Product или AD FS 1. *x*.  
  
## <a name="determining-your-ca-strategy"></a>Определение стратегии центра сертификации  
AD FS не требует, чтобы сертификаты выдавались центром сертификации. Однако сертификат SSL \(the, который также используется по умолчанию, так как сертификат связи службы @ no__t-1 должен быть доверенным для клиентов AD FS. Для этих типов сертификатов не рекомендуется использовать собственные сертификаты @ no__t-0signed.  
  
> [!IMPORTANT]  
> Использование самоno__t-0signed сертификатов SSL в рабочей среде может позволить злонамеренному пользователю в организации партнера по учетным записям получить контроль над серверами федерации в организации партнера по ресурсам. Такая угроза безопасности существует, поскольку сертификаты Self @ no__t-0signed являются корневыми сертификатами. Они должны быть добавлены в доверенное корневое хранилище другого сервера федерации \(for, например, на сервере федерации ресурсов @ no__t-1, который может оставить этот сервер уязвимым для атак.  
  
После получения сертификата из центра сертификации необходимо убедиться, что все сертификаты импортированы в хранилище личных сертификатов на локальном компьютере. Сертификаты можно импортировать в личное хранилище с помощью оснастки\-MMC "сертификаты" в.  
  
В качестве альтернативы использованию сертификатов, применяя @ no__t-0in, можно также импортировать SSL-сертификат с помощью диспетчера IIS Snap @ no__t-1in во время назначения сертификата SSL веб сайту по умолчанию. Дополнительные сведения см. в разделе [Импорт сертификата проверки подлинности сервера на веб-сайт по умолчанию](../../ad-fs/deployment/Import-a-Server-Authentication-Certificate-to-the-Default-Web-Site.md).  
  
> [!NOTE]  
> Перед установкой AD FS программного обеспечения на компьютер, который станет сервером федерации, убедитесь, что оба сертификата находятся в хранилище личных сертификатов локального компьютера и что сертификат SSL назначен веб-сайту по умолчанию. Дополнительные сведения о порядке задач, необходимых для настройки сервера федерации, см. в разделе [Checklist: Настройка сервера федерации @ no__t-0.  
  
В зависимости от требований безопасности и бюджетных ограничений необходимо тщательно продумать, какие из сертификатов будут присваиваться публичным или корпоративным центром сертификации. На рисунке ниже показаны рекомендованные издатели (центры сертификации) определенных типов сертификатов. Эта рекомендация отражает лучший подход @ no__t-0practice в отношении безопасности и затрат.  
  
![требования к сертификатам](media/adfs2_fedserver_certstory_1.png)  
  
## <a name="certificate-revocation-lists"></a>Списки отзыва сертификатов  
Если у какого-либо используемого сертификата есть списки отзыва сертификатов (CRL), сервер с настроенным сертификатом должен иметь возможность связаться с сервером, распространяющим CRL.  
  
## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
