---
ms.assetid: 4ef052f0-61a9-4912-b780-5c96187c850f
title: Некоторые аспекты топологии развертывания AD FS
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 42db104691bce75c37adf19eb97abba3bf579cf8
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80855877"
---
# <a name="ad-fs-deployment-topology-considerations"></a>Некоторые аспекты топологии развертывания AD FS

В этом разделе описываются важные моменты, которые помогут вам спланировать и спроектировать службы федерации Active Directory (AD FS) \(AD FS\) топологии развертывания для использования в рабочей среде. Этот раздел является отправной точкой для просмотра и оценки вопросов, влияющих на то, какие функции или возможности будут доступны после развертывания AD FS. Например, в зависимости от того, какой тип базы данных выбран для хранения AD FS база данных конфигурации, в конечном итоге определит, можно ли реализовать определенные язык разметки зявлений системы безопасности (SAML) \(функции SAML\), требующие SQL Server.  

## <a name="determining-which-type-of-ad-fs-configuration-database-to-use"></a>Определение типа базы данных конфигурации AD FS для использования  
AD FS использует базу данных для хранения конфигурации и, в некоторых случаях, данные о транзакциях, связанные с служба федерации. AD FS программное обеспечение можно использовать для выбора встроенных\-во внутренней базе данных Windows \(WID\) или Microsoft SQL Server 2005 или более поздней версии для хранения данных в служба федерации.  

Для большинства целей эти два типа баз данных относительно эквивалентны. Тем не менее, прежде чем приступить к ознакомлению с различными топологиями развертывания, которые можно использовать с AD FS, необходимо помнить о некоторых различиях. В следующей таблице описаны различия в поддерживаемых возможностях между базой данных WID и базой данных SQL Server.  

AD FS функции  

|Функция|Поддерживается внутренней базой данных Windows?|Поддерживается SQL Server?|Дополнительные сведения об этой функции|  
|-----------|---------------------|----------------------------|---------------------------------------|  
|Развертывание фермы серверов федерации|Да, с ограничением в 30 серверов федерации для каждой фермы|Да. Действующих ограничений на число серверов федерации, которые можно развернуть на одной ферме, не существует|[Определение топологии развертывания для служб федерации Active Directory](Determine-Your-AD-FS-Deployment-Topology.md)|  
|Разрешение артефактов SAML **Примечание.** эта функция не требуется для служб Microsoft Online Services, Microsoft Office 365, Microsoft Exchange или Microsoft Office сценариев SharePoint.|Нет|Да|[Роль базы данных конфигурации AD FS](../../ad-fs/technical-reference/The-Role-of-the-AD-FS-Configuration-Database.md).<p>[Рекомендации по безопасному планированию и развертыванию AD FS](Best-Practices-for-Secure-Planning-and-Deployment-of-AD-FS.md)|  
|Обнаружение воспроизведения токенов Федерации SAML\/WS\-|Нет|Да|[Роль базы данных конфигурации AD FS](../../ad-fs/technical-reference/The-Role-of-the-AD-FS-Configuration-Database.md).<p>[Рекомендации по безопасному планированию и развертыванию AD FS](Best-Practices-for-Secure-Planning-and-Deployment-of-AD-FS.md)|  

Функции базы данных  

|Функция|Поддерживается внутренней базой данных Windows?|Поддерживается SQL Server?|Дополнительные сведения об этой функции|  
|-----------|---------------------|----------------------------|---------------------------------------|  
|Базовая избыточность базы данных с использованием опрашивающей репликации, где один или несколько серверов, на которых размещается чтение\-только копии запросов к базе данных, которые были сделаны на исходном сервере, на котором размещается чтение\/запись копии базы данных.|Да|Нет|[Роль базы данных конфигурации AD FS](../../ad-fs/technical-reference/The-Role-of-the-AD-FS-Configuration-Database.md).|  
|Избыточность базы данных с использованием высоко\-ных решений доступности, таких как отказоустойчивая кластеризация или зеркальное отображение \(на уровне базы данных\) **Примечание.** все топологии развертывания AD FS поддерживают кластеризацию на уровне AD FS служб.|Нет|Да|[Роль базы данных конфигурации AD FS](../../ad-fs/technical-reference/The-Role-of-the-AD-FS-Configuration-Database.md).<p>[Общие сведения о решениях высокого уровня доступности](https://go.microsoft.com/fwlink/?LinkId=179853)|  

### <a name="sql-server-considerations"></a>Особенности SQL Server  
При выборе SQL Server в качестве базы данных конфигурации для развертывания AD FS следует учитывать следующие факты развертывания.  

-   **Функции SAML и их влияние на размер и рост базы данных**. Если включены функции обнаружения артефактов SAML или средства определения воспроизведения маркеров SAML, AD FS сохраняет сведения в базе данных конфигурации SQL Server для каждого выданного маркера AD FS. Рост базы данных SQL Server в результате этого действия не считается существенным и зависит от настроенного срока хранения токена. Размер каждой записи артефакта составляет примерно 30 КБ \(КБ\).  

-   **Число необходимых для развертывания серверов**. Необходимо добавить по крайней мере один дополнительный сервер \(к общему числу серверов, необходимых для развертывания\) инфраструктуры AD FS, которая будет служить выделенным узлом экземпляра SQL Server. Если вы планируете использовать отказоустойчивую кластеризацию или зеркальное отображение, чтобы обеспечить отказоустойчивость и масштабируемость для базы данных конфигурации SQL Server, требуется минимум два сервера SQL Server.  

### <a name="how-the-configuration-database-type-you-select-may-impact-hardware-resources"></a>Влияние выбранного типа базы данных конфигурации на аппаратные ресурсы  
Влияние на аппаратные ресурсы на сервере федерации, развернутом в ферме с помощью WID, в отличие от сервера федерации, развернутого в ферме с использованием базы данных SQL Server, не имеет значения. Однако важно учитывать, что при использовании WID для фермы каждый сервер федерации в этой ферме должен хранить, администрировать и обслуживать изменения репликации для своей локальной копии базы данных конфигурации AD FS, а также продолжать предоставлять нормальные операции, необходимые для служба федерации.  

В сравнении серверы федерации, развернутые в ферме, использующей базу данных SQL Server, не обязательно должны содержать локальный экземпляр базы данных конфигурации AD FS. Следовательно, требования к аппаратным ресурсам в этом случае несколько ниже.  

## <a name="verifying-that-your-production-environment-can-support-an-ad-fs-deployment"></a>Проверка возможности поддержки развертывания служб AD FS в рабочей среде  
Помимо серверов федерации, которые будут развернуты, и в зависимости от того, как настроена существующая Рабочая среда, для обеспечения необходимой инфраструктуры для поддержки нового развертывания AD FS могут потребоваться следующие дополнительные серверы:  

-   Контроллер домена Active Directory  

-   Центр сертификации \(ЦС\)  

-   веб-сервер для размещения метаданных федерации;  

-   Балансировка сетевой нагрузки \(NLB\)  

## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
