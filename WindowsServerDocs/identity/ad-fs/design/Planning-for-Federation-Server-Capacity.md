---
description: Дополнительные сведения о планировании емкости сервера федерации
ms.assetid: 7013fc21-9ced-4f9d-9588-cb04d6d60924
title: Планирование емкости сервера федерации
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.openlocfilehash: c81c589feb940fb686aa865c8368f126ab20562d
ms.sourcegitcommit: 65b6de6b44d41f1180c45db11cdd60cb2a093b46
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "97044642"
---
# <a name="planning-for-federation-server-capacity"></a>Планирование емкости сервера федерации

Планирование емкости для серверов федерации помогает оценить следующее:

-   Какие факторы увеличивают размер базы данных конфигурации AD FS.

-   Соответствующие требования к оборудованию для каждого сервера федерации.

-   Количество серверов федерации, помещаемых в каждую организацию.

Серверы федерации выдают токены безопасности пользователям. Эти маркеры представляются проверяющей стороне для использования. Серверы федерации выдают маркеры безопасности после проверки подлинности пользователя или после получения маркера безопасности, который ранее был выдан партнером служба федерации. Маркер безопасности запрашивается от служба федерации при первом входе пользователей в Федеративные приложения или при истечении срока действия маркеров безопасности, когда они обращаются к федеративным приложениям.

Серверы федерации предназначены для поддержки \- конфигураций фермы серверов высокого уровня доступности, использующих технологию балансировки сетевой нагрузки Майкрософт \( \) . Серверы федерации в конфигурации фермы могут обслуживать запросы независимо, не обращаясь к общим компонентам фермы для каждого запроса. Поэтому при масштабировании развертывания сервера федерации возникают небольшие издержки.

**Проектирован**

-   Для \- критически важных или \- высокодоступных развертываний рекомендуется создать небольшую ферму серверов федерации в каждой партнерской организации, по крайней мере два сервера федерации на ферму, чтобы обеспечить отказоустойчивость.

-   С высокой доступностью и простотой масштабирования серверов федерации рекомендуется использовать горизонтальное масштабирование для обработки большого количества запросов в секунду для конкретного служба федерации. Увеличение масштаба, превышающее базовую конфигурацию в этом разделе, вряд ли приведет к увеличению объема работ по обработке емкости.

## <a name="ad-fs-configuration-database-size-and-growth"></a>Размер и рост базы данных конфигурации AD FS
Размер базы данных конфигурации AD FS, как правило, считается небольшим, а размер базы данных не является главным фактором в развертывании AD FS.  Точный размер базы данных конфигурации AD FS может сильно зависеть от количества отношений доверия и связанных метаданных доверия, \- таких как утверждения, правила утверждений и параметры мониторинга, настроенные для каждого доверия. По мере увеличения количества записей о доверии в базе данных конфигурации увеличивается необходимость в увеличении места на диске.

Дополнительные сведения о развертывании базы данных конфигурации AD FS см. в статье [рекомендации по топологии развертывания AD FS](AD-FS-Deployment-Topology-Considerations.md).

## <a name="memory-cpu-and-disk-space-requirements"></a>Требования к памяти, ЦП и пространству на диске
К счастью, требования к памяти, ЦП и пространству на диске для серверов федерации невелики, и они, скорее всего, не являются решающим фактором в принятии решений об оборудовании. Дополнительные сведения о требованиях к оборудованию см. [в приложении а. Проверка требований AD FS](Appendix-A--Reviewing-AD-FS-Requirements.md).

> [!NOTE]
> В тестах, выполненных командой AD FS разработчиков с использованием фермы серверов федерации, настроенной с выделенной SQL Server для хранения базы данных конфигурации AD FS, Общая нагрузка на SQL Server была вызвана низкой. В одном тесте с использованием \- четырех \- ферм серверов федерации, настроенных на использование одного SQL Server, загрузка ЦП не превышала 10%, несмотря на тестирование, в котором серверы федерации были предоставлены для использования.

## <a name="estimate-the-number-of-federation-servers-for-your-organization"></a><a name="bk_estimatefs"></a>Рассчитайте необходимое количество серверов федерации для вашей организации
Чтобы упростить процесс планирования оборудования для серверов федерации, Группа разработки AD FS разработчиков разработала электронную таблицу по планированию размера AD FSных ресурсов. Эта электронная таблица Excel включает калькулятор \- , такой как функции, которые принимают ожидаемые данные об использовании, предоставляемые пользователями организации, и возвращают рекомендованное оптимальное количество серверов федерации для вашей AD FS рабочей среды.

> [!NOTE]
> Количество серверов федерации, которое будет рекомендовано этой электронной таблицей, зависит от характеристик оборудования и сети, которые AD FS команда разработчиков, используемая при тестировании. Таким образом, количество серверов федерации, которое будет рекомендовано электронной таблицей, должно быть понятно в этом контексте.  Дополнительные сведения о спецификациях, используемых во время тестирования, см. в разделе [планирование AD FS емкости сервера](Planning-for-AD-FS-Server-Capacity.md).

### <a name="using-the-ad-fs-capacity-planning-sizing-spreadsheet"></a>Использование электронной таблицы для изменения размера AD FS емкости
При использовании этой электронной таблицы необходимо выбрать значение \( **40%**, **60%** или **80%** , \) которое лучше всего соответствует процентному значению от общего числа пользователей, которые будут отсылать запросы проверки подлинности на серверы федерации во время пиковых периодов использования.

Затем необходимо выбрать значение \( **1 минуты**, **15 минут** или **1 час** , \) что лучше всего соответствует времени, в течение которого период пикового использования будет последним. Например, вы можете оценить 40% в качестве значения общего числа пользователей, которые будут входить в систему в течение 15 минут, или что 60% пользователей будет входить в течение одного часа. Вместе эти значения определяют пиковый профиль нагрузки, по которому будет рассчитываться рекомендация по выбору размера.

Далее необходимо указать общее число пользователей, которым потребуется единый вход \- для доступа к целевому \- приложению, поддерживающему утверждения, в зависимости от того, являются ли пользователи:

-   Вход в Active Directory с локального компьютера, физически подключенного к корпоративной сети с \( помощью встроенной проверки подлинности Windows\)

-   Удаленный вход Active Directory с компьютера, который физически не подключен к корпоративной сети \( с помощью встроенной проверки подлинности Windows или имени пользователя и пароля.\)

-   Из другой организации и пытается получить доступ к целевому \- приложению с поддержкой утверждений от доверенного партнера

-   От поставщика удостоверений SAML 2,0 и пытается получить доступ к целевому \- приложению, поддерживающему утверждения

#### <a name="how-to-use-this-spreadsheet"></a>Как использовать эту электронную таблицу
Для каждого экземпляра фермы серверов федерации, который планируется развернуть, можно выполнить следующие действия, чтобы определить рекомендуемое количество серверов федерации.

1.  Скачайте и откройте [электронную таблицу размера планирования AD FS емкости для Windows server 2012 R2](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacityPlanning.xlsx) или [электронную таблицу изменения размера AD FS емкости для Windows Server 2016](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx).

2.  В ячейке справа от в **течение пикового периода использования системы я хотел, чтобы этот процент моих пользователей прошел проверку подлинности** ячейки, щелкнул ячейку, а затем с помощью стрелок раскрывающегося списка \- выбрать предполагаемый уровень использования системы: **40%**, **60%** или **80%** для развертывания.

3.  В ячейке справа от ячейки в **течение следующего периода времени** щелкните ячейку, а затем с помощью стрелок раскрывающихся меню \- выберите **1 минуту**, **15 минут** или **1 час** , чтобы выбрать продолжительность пиковой нагрузки.

4.  В ячейке справа от параметра **введите предполагаемое количество внутренних приложений, \( например SharePoint \( 2007 или 2010 или ячейку \) веб-приложений \) с поддержкой утверждений** , введите число внутренних приложений, которые будут использоваться в Организации.

5.  В ячейке справа от параметра **введите предполагаемое количество веб-приложений, \( например Office 365 Exchange Online, SharePoint Online или Lync Online \)** , введите число интерактивных приложений или служб, которые будут использоваться в Организации.

6.  В ячейке с заголовком **число пользователей** введите номер в каждой строке, которая относится к примеру приложения, для которого пользователям потребуется единый вход \- . Этот столбец должен содержать число определенных пользователей, а не пиковых пользователей в секунду. Если попытки доступа к приложению должны пройти через страницу обнаружения домашней области, введите **Y**. Если вы не уверены в этом выборе, введите **Y**.

7.  Проверьте указанные ниже Рекомендуемые значения.

    1.  Общее число рекомендуемых серверов федерации см. в нижней правой ячейке, выделенной серым цветом.

    2.  Сведения о количестве серверов, рекомендуемых для каждого сценария примера приложения, см. в ячейке строки, выделенной серым цветом.

> [!NOTE]
> Значение, которое будет автоматически вычисляться в ячейке справа от ячейки с заголовком **Общее число серверов федерации, рекомендуемых** в нижней части электронной таблицы, содержит формулу, которая добавляет дополнительный буфер 20% к сумме всех значений в каждой из отдельных строк, предшествующих ей. Формула, добавленная к **общему числу серверов федерации, рекомендованных** для создания ячеек в этом буфере, до общего числа развернутых серверов федерации, чтобы сделать общую нагрузку на ферму в момент попадания в точку насыщенности.

## <a name="see-also"></a>См. также:
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
