---
ms.assetid: 7013fc21-9ced-4f9d-9588-cb04d6d60924
title: Планирование емкости сервера федерации
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 418bc5d53a2bd11afa8563b07bbff76c89495715
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71407970"
---
# <a name="planning-for-federation-server-capacity"></a>Планирование емкости сервера федерации

Планирование емкости для серверов федерации помогает оценить следующее:  
  
-   Какие факторы увеличивают размер базы данных конфигурации AD FS.  
  
-   Соответствующие требования к оборудованию для каждого сервера федерации.  
  
-   Количество серверов федерации, помещаемых в каждую организацию.  
  
Серверы федерации выдают токены безопасности пользователям. Эти маркеры представляются проверяющей стороне для использования. Серверы федерации выдают маркеры безопасности после проверки подлинности пользователя или после получения маркера безопасности, который ранее был выдан партнером служба федерации. Маркер безопасности запрашивается от служба федерации при первом входе пользователей в Федеративные приложения или при истечении срока действия маркеров безопасности, когда они обращаются к федеративным приложениям.  
  
Серверы федерации предназначены для поддержки конфигураций фермы серверов высокой доступности\-, использующих балансировку сетевой нагрузки Майкрософт \(\) технологии балансировки сетевых нагрузок. Серверы федерации в конфигурации фермы могут обслуживать запросы независимо, не обращаясь к общим компонентам фермы для каждого запроса. Поэтому при масштабировании развертывания сервера федерации возникают небольшие издержки.  
  
**Проектирован**  
  
-   Для обеспечения отказоустойчивости\-критические или высокие\-е развертывания рекомендуется создать ферму серверов небольшой Федерации в каждой партнерской организации по крайней мере с двумя серверами федерации на ферму, чтобы обеспечить устойчивость к сбоям.  
  
-   С высокой доступностью и простотой масштабирования серверов федерации рекомендуется использовать горизонтальное масштабирование для обработки большого количества запросов в секунду для конкретного служба федерации. Увеличение масштаба, превышающее базовую конфигурацию в этом разделе, вряд ли приведет к увеличению объема работ по обработке емкости.  
  
## <a name="ad-fs-configuration-database-size-and-growth"></a>Размер и рост базы данных конфигурации AD FS  
Размер базы данных конфигурации AD FS, как правило, считается небольшим, а размер базы данных не является главным фактором в развертывании AD FS.  Точный размер базы данных конфигурации AD FS может сильно зависеть от количества доверительных отношений и связанного отношения доверия\-связанных метаданных, таких как утверждения, правила утверждений и параметры мониторинга, настроенные для каждого доверия. По мере увеличения количества записей о доверии в базе данных конфигурации увеличивается необходимость в увеличении места на диске.  
  
Дополнительные сведения о развертывании базы данных конфигурации AD FS см. в статье [рекомендации по топологии развертывания AD FS](AD-FS-Deployment-Topology-Considerations.md).  
  
## <a name="memory-cpu-and-disk-space-requirements"></a>Требования к памяти, ЦП и пространству на диске  
К счастью, требования к памяти, ЦП и пространству на диске для серверов федерации невелики, и они, скорее всего, не являются решающим фактором в принятии решений об оборудовании. Дополнительные сведения о требованиях к оборудованию см. [в приложении а. Проверка требований AD FS](Appendix-A--Reviewing-AD-FS-Requirements.md).  
  
> [!NOTE]  
> В тестах, выполненных командой AD FS разработчиков с использованием фермы серверов федерации, настроенной с выделенной SQL Server для хранения базы данных конфигурации AD FS, Общая нагрузка на SQL Server была вызвана низкой. В одном тесте, использующем четыре\-фермы серверов\-Федерации, настроенной на использование одного SQL Server, загрузка ЦП не превышала 10%, несмотря на тестирование, которое применяло серверы федерации к целевому использованию.  
  
## <a name="bk_estimatefs"></a>Оценка количества серверов федерации для Организации  
Чтобы упростить процесс планирования оборудования для серверов федерации, Группа разработки AD FS разработчиков разработала электронную таблицу по планированию размера AD FSных ресурсов. Эта электронная таблица Excel включает калькулятор\-такие функции, которые принимают ожидаемые данные об использовании, предоставляемые пользователями организации, и возвращают рекомендованное оптимальное количество серверов федерации для рабочей среды AD FS.  
  
> [!NOTE]  
> Количество серверов федерации, которое будет рекомендовано этой электронной таблицей, зависит от характеристик оборудования и сети, которые AD FS команда разработчиков, используемая при тестировании. Таким образом, количество серверов федерации, которое будет рекомендовано электронной таблицей, должно быть понятно в этом контексте.  Дополнительные сведения о спецификациях, используемых во время тестирования, см. в разделе [планирование AD FS емкости сервера](Planning-for-AD-FS-Server-Capacity.md).  
  
### <a name="using-the-ad-fs-capacity-planning-sizing-spreadsheet"></a>Использование электронной таблицы для изменения размера AD FS емкости  
При использовании этой электронной таблицы необходимо выбрать значение \(**40%** , **60%** или **80%** \), которое лучше всего соответствует процентному значению от общего числа пользователей, которые будут отсылать запросы проверки подлинности на серверы федерации во время пиковых периодов использования.  
  
Затем необходимо выбрать значение \(**1 минута**, **15 минут**или **1 час**\), который лучше всего соответствует времени, в течение которого период пикового использования будет минимальным. Например, вы можете оценить 40% в качестве значения общего числа пользователей, которые будут входить в систему в течение 15 минут, или что 60% пользователей будет входить в течение одного часа. Вместе эти значения определяют пиковый профиль нагрузки, по которому будет рассчитываться рекомендация по выбору размера.  
  
Далее необходимо указать общее число пользователей, которым потребуется единый вход\-для доступа к целевому приложению утверждений\-, в зависимости от того, являются ли пользователи:  
  
-   Вход в Active Directory с локального компьютера, физически подключенного к корпоративной сети \(с помощью встроенной проверки подлинности Windows\)  
  
-   Удаленный вход Active Directory с компьютера, который физически не подключен к корпоративной сети \(с помощью встроенной проверки подлинности Windows или имени пользователя и пароля\)  
  
-   Из другой организации и пытается получить доступ к целевым утверждениям\-, поддерживающим приложение, от доверенного партнера  
  
-   От поставщика удостоверений SAML 2,0 и пытается получить доступ к целевому приложению утверждений\-  
  
#### <a name="how-to-use-this-spreadsheet"></a>Как использовать эту электронную таблицу  
Для каждого экземпляра фермы серверов федерации, который планируется развернуть, можно выполнить следующие действия, чтобы определить рекомендуемое количество серверов федерации.  
  
1.  Скачайте и откройте [электронную таблицу размера планирования AD FS емкости для Windows server 2012 R2](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacityPlanning.xlsx) или [электронную таблицу изменения размера AD FS емкости для Windows Server 2016](https://adfsdocs.blob.core.windows.net/adfs/ADFSCapacity2016.xlsx).
  
2.  В ячейке справа от в **течение пикового периода использования системы я хотел, чтобы этот процент моих пользователей прошел проверку подлинности** ячейки, щелкнул ячейку, а затем с помощью стрелок\-вниз выбрать предполагаемый уровень использования системы: **40%** , **60%** или **80%** для развертывания.  
  
3.  В ячейке справа от ячейки в **течение следующего периода времени** щелкните ячейку, а затем с помощью стрелок\-вниз выберите **1 минуту**, **15 минут**или **1 час** , чтобы выбрать продолжительность пиковой нагрузки.  
  
4.  В ячейке справа от параметра **введите предполагаемое количество внутренних приложений \(например SharePoint \(2007 или 2010\) или веб-приложений, поддерживающих утверждения\)** ячейку, введите число внутренних приложений, которые будут использоваться в Организации.  
  
5.  В ячейке справа от параметра **введите ожидаемое число интерактивных приложений \(например Office 365 Exchange Online, SharePoint Online или Lync online\)** ячейку, введите число интерактивных приложений или служб, которые будут использоваться в Организации.  
  
6.  В ячейке с заголовком **число пользователей**введите номер в каждой строке, которая относится к примеру приложения, для которого пользователям потребуется единый вход\-доступа к. Этот столбец должен содержать число определенных пользователей, а не пиковых пользователей в секунду. Если попытки доступа к приложению должны пройти через страницу обнаружения домашней области, введите **Y**. Если вы не уверены в этом выборе, введите **Y**.  
  
7.  Проверьте указанные ниже Рекомендуемые значения.  
  
    1.  Общее число рекомендуемых серверов федерации см. в нижней правой ячейке, выделенной серым цветом.  
  
    2.  Сведения о количестве серверов, рекомендуемых для каждого сценария примера приложения, см. в ячейке строки, выделенной серым цветом.  
  
> [!NOTE]  
> Значение, которое будет автоматически вычисляться в ячейке справа от ячейки с заголовком **Общее число серверов федерации, рекомендуемых** в нижней части электронной таблицы, содержит формулу, которая добавляет дополнительный буфер 20% к сумме всех значений в каждой из отдельных строк, предшествующих ей. Формула, добавленная к **общему числу серверов федерации, рекомендованных** для создания ячеек в этом буфере, до общего числа развернутых серверов федерации, чтобы сделать общую нагрузку на ферму в момент попадания в точку насыщенности.  
  
## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
