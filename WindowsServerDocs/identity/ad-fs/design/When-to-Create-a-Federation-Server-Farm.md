---
ms.assetid: 02580b2f-a339-4470-947c-d700b2d55f3f
title: Когда следует создавать ферму серверов федерации
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: 2e7c991cf87bc0e6914e158f0878bcadbede3c22
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59816235"
---
# <a name="when-to-create-a-federation-server-farm"></a>Когда следует создавать ферму серверов федерации

>Область применения. Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Рассмотрите возможность создания фермы серверов федерации в службах федерации Active Directory \(AD FS\) , если более широкого развертывания AD FS и вы хотите обеспечить устойчивость к сбоям, загружать\-балансировки или масштабируемости для вашей Службы федерации организации. Процесс создания двух или более серверов федерации в той же сети, настройка каждого из них для использования той же службы федерации и добавление маркеру открытого ключа каждого сервера\-сертификаты подписи для оснастки управления AD FS\-в Создает ферму серверов федерации.  
  
Можно создать ферму серверов федерации или установить дополнительные серверы федерации в существующую ферму, используя мастер настройки сервера AD FS федерации. Дополнительные сведения см. в разделе [When to Create a Federation Server](When-to-Create-a-Federation-Server.md).  
  
> [!NOTE]  
> Если выбран вариант создания **новой фермы серверов федерации** с помощью мастера конфигурации сервера AD FS федерации, мастер попытается создать объект-контейнер \(для совместного использования сертификатов\) в Active Directory. Таким образом, важно при первом входе на компьютер, где настраивается роль сервера федерации, использовать учетную запись, которая имеет достаточные разрешения в Active Directory, чтобы создать этот объект-контейнер.  
  
Прежде чем серверы федерации может быть сгруппированы в ферму, их необходимо кластеризовать, таким образом, чтобы запросы, поступающие по одному адресу полное доменное имя \(полное доменное имя\) направляются на различных серверах федерации в ферме серверов. Можно создать кластер серверов, развернув балансировку сетевой нагрузки \(балансировки сетевой Нагрузки\) внутри корпоративной сети. В этом руководстве предполагается, что балансировки сетевой Нагрузки настроен соответствующим образом для кластеризации каждого из серверов федерации в ферме.  
  
Дополнительные сведения о настройке FQDN кластера с помощью технологии Microsoft NLB см. в разделе [Указание параметров кластера](https://go.microsoft.com/fwlink/?LinkID=74651).  
  
## <a name="best-practices-for-deploying-a-federation-server-farm"></a>Рекомендации по развертыванию фермы серверов федерации  
Мы рекомендуем следующие рекомендации по развертыванию сервера федерации в рабочей среде:  
  
-   Если вы будете развертывать несколько серверов федерации в то же время, или вы знаете, что будут добавлены дополнительные серверы к ферме со временем, рассмотрите возможность создания образа существующего сервера федерации в ферме и последующая установка на основе этого образа, при необходимости cr создать дополнительные серверы федерации быстро.  
  
    > [!NOTE]  
    > Если вы решили использовать метод образа сервера для развертывания дополнительные серверы федерации, у вас нет для выполнения задач в [контрольный список: Setting Up a Federation Server](../../ad-fs/deployment/Checklist--Setting-Up-a-Federation-Server.md) каждый раз, в который требуется добавить новый сервер к ферме.  
  
-   Использование балансировки сетевой Нагрузки или другие формы кластеризации выделить один IP-адрес для многих компьютеры серверов федерации.  
  
-   Зарезервировать статический IP-адрес для каждого сервера федерации в ферме и, в зависимости от вашей доменных имен \(DNS\) конфигурации, вставки, исключение для каждого IP-адрес в Dynamic Host Configuration Protocol \(DHCP\). Технология балансировки сетевой нагрузки Майкрософт требует, чтобы каждому серверу, входящему в кластер NLB, был назначен статический IP-адрес.  
  
-   Если база данных конфигурации AD FS будет храниться в базе данных SQL, избегайте изменения базы данных SQL из нескольких серверов федерации в то же время.  
  
## <a name="configuring-federation-servers-for-a-farm"></a>Настройка серверов федерации для фермы  
В следующей таблице описаны задачи, которые необходимо выполнить, чтобы каждый сервер федерации может участвовать в среде с фермой.  
  
|Задача|Описание|  
|--------|---------------|  
|При использовании SQL Server для хранения базы данных конфигурации AD FS|Ферма серверов федерации состоит из двух или более серверов федерации, которые совместно используют те же базы данных конфигурации AD FS и токен\-сертификаты для подписи. База данных конфигурации может храниться в любой внутренней базе данных Windows или в базе данных SQL Server. Если вы планируете хранить базу данных конфигурации в базе данных SQL, убедитесь, что база данных конфигурации доступна, таким образом, чтобы он доступен, все новые серверы федерации, участвующих в ферме. **Примечание.** Для сценариев фермы очень важно, что база данных конфигурации находилась на компьютере, который не участвует в качестве сервера федерации в ферме. Microsoft NLB не допускает взаимодействие друг с другом компьютеров, участвующих в ферме. **Примечание.** Убедитесь, что удостоверение AppPool AD FS в службах IIS \(IIS\) \) на каждый федерации сервер, который участвует в ферме имеет доступ на чтение к базе данных конфигурации.|  
|Получение и совместное использование сертификатов|Сертификат можно получить один сервер проверки подлинности из общедоступного центра сертификации \(ЦС\)— например, VeriSign. Затем можно настроить сертификат, таким образом, все серверы федерации же часть закрытого ключа сертификата. Дополнительные сведения о совместном использовании сертификатов см. в разделе [контрольный список: Настройка сервера федерации](../../ad-fs/deployment/Checklist--Setting-Up-a-Federation-Server.md). **Примечание.** Оснастка управления AD FS\-в расценивает сертификаты проверки подлинности серверов для серверов федерации как сертификаты взаимодействия служб.<br /><br />Дополнительные сведения см. в разделе [Certificate Requirements for Federation Servers](Certificate-Requirements-for-Federation-Servers.md).|  
|Указание одного и того же экземпляра SQL Server|Если база данных конфигурации AD FS будет храниться в базе данных SQL, новый сервер федерации должен указывать на тот же экземпляр SQL Server, который используется другими серверами федерации в ферме, чтобы новый сервер мог участвовать в ферме.|  
  
## <a name="see-also"></a>См. также
[Руководство по разработке AD FS в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
