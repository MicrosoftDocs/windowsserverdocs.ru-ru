---
ms.assetid: 02580b2f-a339-4470-947c-d700b2d55f3f
title: Когда следует создавать ферму серверов федерации
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: fcfc7d640d3688bf0e23557af9bd56082418ef37
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/27/2019
ms.locfileid: "71358942"
---
# <a name="when-to-create-a-federation-server-farm"></a>Когда следует создавать ферму серверов федерации

Рассмотрите возможность создания фермы серверов федерации в службы федерации Active Directory (AD FS) \(AD FS\) при наличии более крупного AD FS развертывания и необходимости обеспечения отказоустойчивости, балансировки нагрузки\-или масштабируемости служба федерации организации. Процесс создания двух или более серверов федерации в одной сети, настройка каждого из них для использования одного и того же служба федерации и Добавление открытого ключа маркера каждого сервера\-подписи сертификатов в оснастку управления AD FS\-в создает ферму серверов федерации.  
  
Можно создать ферму серверов федерации или установить дополнительные серверы федерации в существующую ферму с помощью мастера настройки сервера AD FS Федерации. Дополнительные сведения см. в разделе [When to Create a Federation Server](When-to-Create-a-Federation-Server.md).  
  
> [!NOTE]  
> При выборе варианта создания **новой фермы серверов федерации** с помощью мастера настройки сервера AD FS Федерации мастер попытается создать объект контейнера \(для совместного использования сертификатов\) в Active Directory. Таким образом, важно при первом входе на компьютер, где настраивается роль сервера федерации, использовать учетную запись, которая имеет достаточные разрешения в Active Directory, чтобы создать этот объект-контейнер.  
  
Прежде чем серверы федерации можно будет сгруппировать в качестве фермы, их необходимо сначала объединить в кластер, чтобы запросы, поступающие в одно полное доменное имя \(FQDN\), направляются на различные серверы федерации в ферме серверов. Кластер серверов можно создать, развернув балансировку сетевой нагрузки \(NLB\) в корпоративной сети. В этом учебнике предполагается, что балансировка сетевой нагрузки настроена соответствующим образом для кластеризации всех серверов федерации в ферме.  
  
Дополнительные сведения о настройке полного доменного имени кластера с помощью технологии балансировки сетевой нагрузки Майкрософт см. [в разделе Указание параметров кластера](https://go.microsoft.com/fwlink/?LinkID=74651).  
  
## <a name="best-practices-for-deploying-a-federation-server-farm"></a>Рекомендации по развертыванию фермы серверов федерации  
Для развертывания сервера федерации в рабочей среде рекомендуются следующие рекомендации.  
  
-   Если планируется одновременное развертывание нескольких серверов федерации или известно, что в ферму будут добавляться дополнительные серверы, рассмотрите возможность создания образа сервера существующего сервера федерации в ферме и последующей установки из этого образа, если требуется выполнить CR. быстро здавать дополнительные серверы федерации.  
  
    > [!NOTE]  
    > Если вы решили использовать метод образа сервера для развертывания дополнительных серверов федерации, вам не нужно выполнять задачи в [контрольном списке: Настройка сервера федерации](../../ad-fs/deployment/Checklist--Setting-Up-a-Federation-Server.md) при каждом добавлении нового сервера в ферму.  
  
-   Используйте балансировку сетевой нагрузки или другую форму кластеризации, чтобы выделить один IP-адрес для многих серверов федерации.  
  
-   Зарезервируйте статический IP-адрес для каждого сервера федерации в ферме и, в зависимости от системы доменных имен \(конфигурации DNS\), вставьте исключение для каждого IP-адреса в протоколе динамической настройки узла \(\)DHCP. Технология балансировки сетевой нагрузки Майкрософт требует, чтобы каждому серверу, входящему в кластер NLB, был назначен статический IP-адрес.  
  
-   Если база данных конфигурации AD FS будет храниться в базе данных SQL, избегайте одновременного изменения базы данных SQL с нескольких серверов федерации.  
  
## <a name="configuring-federation-servers-for-a-farm"></a>Настройка серверов федерации для фермы  
В следующей таблице описаны задачи, которые необходимо выполнить, чтобы каждый сервер федерации мог участвовать в среде фермы.  
  
|Задача|Описание|  
|--------|---------------|  
|При использовании SQL Server для хранения базы данных конфигурации AD FS|Ферма серверов федерации состоит из двух или более серверов федерации, использующих одну и ту же базу данных конфигурации AD FS и маркер\-сертификаты подписи. База данных конфигурации может храниться в любой внутренней базе данных Windows или в базе данных SQL Server. Если вы планируете хранить базу данных конфигурации в базе данных SQL, убедитесь, что база данных конфигурации доступна, чтобы к ней могли обращаться все новые серверы федерации, участвующие в ферме. **Примечание.** Для сценариев фермы важно, чтобы база данных конфигурации находилась на компьютере, который также не участвует в роли сервера федерации в этой ферме. Microsoft NLB не допускает взаимодействие друг с другом компьютеров, участвующих в ферме. **Примечание.** Убедитесь, что удостоверение AD FS AppPool в службы IIS \(IIS\)\) на каждом сервере федерации, участвующем в ферме, имеет доступ на чтение к базе данных конфигурации.|  
|Получение и совместное использование сертификатов|Сертификат проверки подлинности одного сервера можно получить из общедоступного центра сертификации \(CA\)— например, VeriSign. Затем можно настроить сертификат таким образом, чтобы все серверы федерации совместно используют одну и ту же часть закрытого ключа сертификата. Дополнительные сведения о совместном использовании сертификатов см. в статье [Checklist: Setting Up a Federation Server](../../ad-fs/deployment/Checklist--Setting-Up-a-Federation-Server.md). **Примечание.** \-оснастки управления AD FS в относится к сертификатам проверки подлинности сервера для серверов федерации в качестве сертификатов связи служб.<br /><br />Дополнительные сведения см. в разделе [Certificate Requirements for Federation Servers](Certificate-Requirements-for-Federation-Servers.md).|  
|Указание одного и того же экземпляра SQL Server|Если база данных конфигурации AD FS будет храниться в базе данных SQL, новый сервер федерации должен указывать на тот же экземпляр SQL Server, который используется другими серверами федерации в ферме, чтобы новый сервер мог участвовать в ферме.|  
  
## <a name="see-also"></a>См. также
[Руководство по разработке служб федерации Active Directory в Windows Server 2012](AD-FS-Design-Guide-in-Windows-Server-2012.md)
