---
ms.assetid: 1a443181-7ded-4912-8e40-5aa447faf00c
title: "AD FS 2016 параметры единого входа"
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 08/17/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: e8c24399949efc1b8d0b1782e299593c02374c62
ms.sourcegitcommit: db290fa07e9d50686667bfba3969e20377548504
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2017
---
# <a name="ad-fs-single-sign-on-settings"></a>Параметры единого входа AD FS одним

>Область применения: Windows Server 2016, Windows Server 2012 R2

Единого входа (SSO) позволяет пользователям выполнять проверку подлинности один раз и доступ к нескольким ресурсам без необходимости вводить дополнительные учетные данные.  В этой статье описаны AD FS поведение по умолчанию для единого входа, а также параметры конфигурации, которые позволяют настраивать это поведение.  

## <a name="supported-types-of-single-sign-on"></a>Поддерживаемые типы из единого входа

Службы федерации Active Directory поддерживает несколько типов взаимодействия единого входа:  
  
-   **Сеанса единого входа**  
  
     Файлы cookie сеансов единого входа написаны для прошедших проверку подлинности пользователя, что исключает дальнейшие запросы при переключении приложений во время сеанса. Тем не менее при завершении сеанса, пользователь будет запрашиваться свои учетные данные еще раз.  
  
     Службы федерации Active Directory будет устанавливать сеанс файлы cookie для единого входа по умолчанию если устройствах пользователей не зарегистрированы. Если для завершения сеанса браузера и перезапуска этот файл cookie сеанса удаляется, а не поддерживается больше.  
  
-   **Единый вход постоянно**  
  
     Сохраняемые файлы cookie для единого входа написаны для пользователя, тем самым устраняет дополнительные запросы при переключении приложений для до тех пор, пока постоянного файла cookie единого входа является допустимым. Различие между постоянного единого входа и сеанса единого входа заключается в том, что единый вход постоянно может осуществляться в разных сеансах.  
  
     Службы федерации Active Directory будет устанавливать сохраняемые файлы cookie для единого входа, если устройство зарегистрировано. Службы федерации Active Directory также задаст постоянного файла cookie единого входа, если пользователь выбирает «оставаться вошел в систему». Если постоянного файла cookie единого входа больше не работает, он будет отклонен и удален.  
  
-   **Единый вход для конкретного приложения**  
  
     В этом сценарии OAuth токен обновления используется для обслуживания состояний единого входа пользователя в пределах определенного приложения.  
  
     При регистрации устройства AD FS будет задать срок действия токена обновления основании постоянного срок жизни файлы cookie единого входа для зарегистрированных устройств, которое составляет 7 дней по умолчанию. Если пользователь выбирает параметр «оставаться вошел в систему», срок действия токена обновления будут равны постоянного срок жизни файлы cookie единого входа для «сохранение мне вошел в систему» которого составляет 1 день по умолчанию более 7 дней. В противном случае — обновите время существования маркера равно SSO cookie существования сеанса — по умолчанию — 8 часов  
  
 Как упоминалось выше, пользователи на зарегистрированные устройства всегда получают единый вход постоянно, только если отключается единый вход постоянно. Отмена регистрации устройств, единый вход постоянно может быть достигнута путем включения «оставаться мне вошел в систему» функция (KMSI). 
 
 Для Windows Server 2012 R2 для включения PSSO для сценария «Оставаться вошел в систему», необходимо установить это [исправление](https://support.microsoft.com/en-us/kb/2958298/) который также является частью из [августа 2014 накопительный пакет обновления для Windows RT 8.1, Windows 8.1 и Windows Server 2012 R2](https://support.microsoft.com/en-us/kb/2975719).   
 
  
## <a name="single-sign-on-and-authenticated-devices"></a>Единый вход и проверкой подлинности устройств  
После предоставления учетных данных в первый раз, по умолчанию пользователи зарегистрированных устройств получить единого входа для максимальный период 90 дней, если они используют устройство для доступа к ресурсам Служб федерации Active Directory хотя бы один раз каждые 14 дней.  Если они подождите 15 дней после предоставления учетных данных, пользователям будет запрашиваться учетные данные снова.  

Единый вход постоянно включена по умолчанию. Если она отключена, не PSSO cookie будет записан. |  

``` powershell
Set-AdfsProperties –EnablePersistentSso <Boolean\>
```     
  
Окно использования устройства (по умолчанию 14 дней), регулируется свойства службы федерации Active Directory **DeviceUsageWindowInDays**.

``` powershell
Set-AdfsProperties -DeviceUsageWindowInDays
```   
Максимальный единого входа период (по умолчанию 90 дней), регулируется свойства службы федерации Active Directory **PersistentSsoLifetimeMins**.

``` powershell
Set-AdfsProperties -PersistentSsoLifetimeMins
```    

## <a name="keep-me-signed-in-for-unauthenticated-devices"></a>Оставаться вход для устройств, не прошедших проверку подлинности 
Точка входа не зарегистрированные устройства, определяется по **Keep мне войти в (KMSI)** функций настройки.  KMSI отключена по умолчанию и можно включить, установив для свойства службы федерации Active Directory KmsiEnabled значение True.

``` powershell
Set-AdfsProperties -EnableKmsi $true  
```    

С KMSI отключена единого входа периода времени по умолчанию — 8 часов.  Это можно настроить с помощью свойства SsoLifetime.  Свойство измеряется в минутах, поэтому его значение по умолчанию — 480.  

``` powershell
Set-AdfsProperties –SsoLifetime <Int32\> 
```   

С KMSI включен по умолчанию единого входа период составляет 24 часа.  Это можно настроить с помощью свойства KmsiLifetimeMins.  Свойство измеряется в минутах, 1440, поэтому его значение по умолчанию.

``` powershell
Set-AdfsProperties –KmsiLifetimeMins <Int32\> 
```   

## <a name="multi-factor-authentication-mfa-behavior"></a>Поведение многофакторной проверки подлинности (MFA)  
Важно Обратите внимание, что во время предоставляя относительно длительного единого входа, AD FS будет запрашивать дополнительные) проверки подлинности (несколькими коэффициент при предыдущем входа зависит от основных учетных данных и не многофакторной проверки Подлинности, но вход текущего требует многофакторной проверки Подлинности.  Это происходит независимо от конфигурации единого входа. AD FS, когда он получает запрос на проверку подлинности, сначала определяет, существует ли в контексте единого входа (например, файл cookie) и затем, если обязательна (например, если запрос поступает с за пределами) оценивает ли контекст SSO содержит многофакторной проверки Подлинности.  В противном случае запрос многофакторной проверки Подлинности.  


  
## <a name="psso-revocation"></a>PSSO отзыва  
 Для обеспечения безопасности, службы федерации Active Directory будет отклонять все предыдущие при соблюдении следующих условий постоянные cookie для единого входа. Эта процедура потребует от пользователя предоставления свои учетные данные для проверки подлинности с помощью AD FS. 
  
-   Изменения пароля пользователя  
  
-   Постоянное единый вход отключен в AD FS  
  
-   Устройство отключено администратором в случае потери или кражи  
  
-   AD FS получает постоянного файла cookie единого входа, в котором выдается для зарегистрированного пользователя, но пользователь или устройство больше не зарегистрирован  
  
-   AD FS получает постоянного файла cookie единого входа для зарегистрированного пользователя, но пользователь повторно зарегистрированы  
  
-   AD FS получает постоянного файла cookie единого входа, в котором выдается в результате «оставаться вошел в систему», но «оставаться вошел в систему» отключен в AD FS  
  
-   AD FS получает постоянного файла cookie единого входа, в котором выдается для зарегистрированного пользователя, но сертификат устройства, отсутствует или изменены во время проверки подлинности  
  
-   Администратор AD FS установил Обрезка времени для постоянного единого входа. Если этот параметр настроен, AD FS будет отклонять все выданные до истечения этого времени постоянных cookie для единого входа  
  
 Чтобы задать время обрезка, выполните следующий командлет PowerShell:  
  

``` powershell
Set-AdfsProperties -PersistentSsoCutoffTime <DateTime>
```
  
## <a name="enable-psso-for-office-365-users-to-access-sharepoint-online"></a>Включить PSSO для пользователей Office 365 для доступа к SharePoint Online  
 После включения и настройки в AD FS PSSO AD FS будет записывать постоянного файла cookie, после проверка подлинности пользователя. При очередном поступлении пользователя, если постоянный файл cookie является допустимой, пользователю необходимо ввести учетные данные для проверки подлинности снова. Также можно избежать, дополнительные запросы проверки подлинности для Office 365 и SharePoint Online пользователей, настроив следующие два правила в AD FS для сохранения состояния триггер в Microsoft Azure AD и SharePoint Online утверждений.  Чтобы включить PSSO для пользователей Office 365 для получения доступа к SharePoint online, необходимо установить это [исправление](https://support.microsoft.com/en-us/kb/2958298/) который также является частью из [августа 2014 накопительный пакет обновления для Windows RT 8.1, Windows 8.1 и Windows Server 2012 R2](https://support.microsoft.com/en-us/kb/2975719).  
  
 Правила преобразования выдачи для пропуска InsideCorporateNetwork утверждений  
  
```  
@RuleTemplate = "PassThroughClaims"  
@RuleName = "Pass through claim - InsideCorporateNetwork"  
c:[Type == "https://schemas.microsoft.com/ws/2012/01/insidecorporatenetwork"]  
=> issue(claim = c);   
A custom Issuance Transform rule to pass through the persistent SSO claim  
@RuleName = "Pass Through Claim - Psso"  
c:[Type == "https://schemas.microsoft.com/2014/03/psso"]  
=> issue(claim = c);  
  
```
  
  
    


