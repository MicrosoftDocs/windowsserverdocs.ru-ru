---
ms.assetid: 96b9f4e6-f01c-4517-8299-017d187d447e
title: Создание правила для отправки утверждения методов проверки подлинности
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server
ms.technology: identity-adfs
ms.openlocfilehash: 2c011c3b15f6223a6cea2f9c7226d9319641a693
ms.sourcegitcommit: b00d7c8968c4adc8f699dbee694afe6ed36bc9de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80816587"
---
# <a name="create-a-rule-to-send-an-authentication-method-claim"></a>Создание правила для отправки утверждения методов проверки подлинности


Для отправки утверждения метода проверки подлинности можно использовать шаблон правила **отправки членства в группе как утверждений** или шаблон **преобразовать входящее правило утверждения** . Проверяющая сторона может использовать утверждение метода проверки подлинности для определения механизма входа в систему, который пользователь использует для проверки подлинности и получения утверждений от службы федерации Active Directory (AD FS) \(AD FS\). Кроме того, можно использовать механизм проверки подлинности в службы федерации Active Directory (AD FS) \(AD FS\) в Windows Server 2012 R2 в качестве входных данных для создания утверждений методов проверки подлинности в ситуациях, когда проверяющая сторона хочет определить уровень доступа, основанный на входах с помощью смарт-карты. Например, разработчик может назначить различные уровни доступа федеративным пользователям приложения проверяющей стороны. Уровень доступа зависит от того, входят ли пользователи в систему с учетными данными пользователя и пароля, в отличие от смарт-карт.  

В зависимости от требований организации используйте одну из следующих процедур.  

-   Создайте это правило с помощью шаблона правила " **Отправить членство в группе как утверждения** " \- вы можете использовать этот шаблон правила, если хотите, чтобы группа, указанная в этом шаблоне, в конечном итоге определила, какой метод проверки подлинности следует выдавать.  

-   Создайте это правило с помощью шаблона **преобразования "Преобразование входящего утверждения** " \- можно использовать этот шаблон правила, если вы хотите изменить существующий метод проверки подлинности на новый метод проверки подлинности, который работает с продуктом, который не распознает стандартные AD FS утверждениями метода проверки подлинности.  



## <a name="to-create-by-using-the-send-group-membership-as-claims-rule-template-on-a-relying-party-trust-in-windows-server-2016"></a>Создание с помощью шаблона правила "Отправка членства в группе как утверждений" для отношения доверия с проверяющей стороной в Windows Server 2016 

1.  В диспетчер сервера щелкните **Сервис**, а затем выберите **AD FS управление**.  

2.  В дереве консоли в разделе **AD FS**щелкните **отношения доверия с проверяющей стороной**. 
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule9.PNG) ![создания правила  

3.  Справа\-щелкните выбранное отношение доверия, а затем щелкните **изменить политику выдачи утверждений**.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule10.PNG) ![создания правила   

4.  В диалоговом окне **изменение политики выдачи утверждений** в разделе **правила преобразования выдачи** щелкните **Добавить правило** , чтобы запустить мастер правил. 
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule11.PNG) ![создания правила    

5.  На странице **Выбор шаблона правила** в разделе **шаблон правила утверждения**выберите **Отправить членство в группе как утверждение** из списка, а затем нажмите кнопку **Далее**.  
](media/Create-a-Rule-to-Send-Group-Membership-as-a-Claim/group3.PNG) ![создания правила      

6.  На странице **Настройка правила** введите имя правила утверждения.  

7.  Нажмите кнопку **Обзор**, выберите группу, члены которой должны получить это утверждение метода проверки подлинности, а затем нажмите кнопку **ОК**.  

8.  В поле **Тип исходящего утверждения**выберите **метод проверки подлинности** в списке.  

9. В поле **значение исходящего утверждения**введите один из универсальных идентификаторов ресурса по умолчанию \(URI\) значения в следующей таблице в зависимости от предпочтительного метода проверки подлинности, нажмите кнопку **Готово**, а затем кнопку **ОК** , чтобы сохранить правило.  

|                            Фактический метод проверки подлинности                             |                                Соответствующий код URI                                 |
|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|                        Проверка подлинности с помощью имени пользователя и пароля                        | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/password  |
|                               Проверка подлинности Windows                                |  https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows  |
| Безопасность транспортного уровня \(TLS\) взаимной проверки подлинности, использующей сертификаты X. 509. | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/tlsclient |
|                  Проверка подлинности на основе X. 509\-, которая не использует TLS                  |   https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/x509    |

![создать правило](media/Create-a-Rule-to-Send-an-Authentication-Method-Claim/auth2.PNG)

## <a name="to-create-by-using-the-send-group-membership-as-claims-rule-template-on-a-claims-provider-trust-in-windows-server-2016"></a>Создание с помощью шаблона правила "Отправить членство в группе как утверждения" для отношения доверия поставщика утверждений в Windows Server 2016 

1.  В диспетчер сервера щелкните **Сервис**, а затем выберите **AD FS управление**.  

2.  В дереве консоли в разделе **AD FS**щелкните **отношения доверия поставщиков утверждений**. 
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule1.PNG) ![создания правила  

3.  Справа\-щелкните выбранное отношение доверия, а затем щелкните **изменить правила утверждений**.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule2.PNG) ![создания правила   

4.  В диалоговом окне **изменение правил утверждений** в разделе **правила преобразования принятия** нажмите кнопку **Добавить правило** , чтобы запустить мастер правил.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule3.PNG) ![создания правила    

5.  На странице **Выбор шаблона правила** в разделе **шаблон правила утверждения**выберите **Отправить членство в группе как утверждение** из списка, а затем нажмите кнопку **Далее**.  
](media/Create-a-Rule-to-Send-Group-Membership-as-a-Claim/group3.PNG) ![создания правила     

6.  На странице **Настройка правила** введите имя правила утверждения.  

7.  Нажмите кнопку **Обзор**, выберите группу, члены которой должны получить это утверждение метода проверки подлинности, а затем нажмите кнопку **ОК**.  

8.  В поле **Тип исходящего утверждения**выберите **метод проверки подлинности** в списке.  

9. В поле **значение исходящего утверждения**введите один из универсальных идентификаторов ресурса по умолчанию \(URI\) значения в следующей таблице в зависимости от предпочтительного метода проверки подлинности, нажмите кнопку **Готово**, а затем кнопку **ОК** , чтобы сохранить правило.  

|                            Фактический метод проверки подлинности                             |                                Соответствующий код URI                                 |
|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|                        Проверка подлинности с помощью имени пользователя и пароля                        | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/password  |
|                               Проверка подлинности Windows                                |  https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows  |
| Безопасность транспортного уровня \(TLS\) взаимной проверки подлинности, использующей сертификаты X. 509. | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/tlsclient |
|                  Проверка подлинности на основе X. 509\-, которая не использует TLS                  |   https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/x509    |

![создать правило](media/Create-a-Rule-to-Send-an-Authentication-Method-Claim/auth2.PNG)


## <a name="to-create-this-rule-by-using-the-transform-an-incoming-claim-rule-template-on-a-relying-party-trust-in-windows-server-2016"></a>Чтобы создать это правило с помощью шаблона преобразования входящего утверждения на основе утвержденной проверяющей стороны в Windows Server 2016 

1.  В диспетчер сервера щелкните **Сервис**, а затем выберите **AD FS управление**.  

2.  В дереве консоли в разделе **AD FS**щелкните **отношения доверия с проверяющей стороной**. 
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule9.PNG) ![создания правила  

3.  Справа\-щелкните выбранное отношение доверия, а затем щелкните **изменить политику выдачи утверждений**.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule10.PNG) ![создания правила   

4.  В диалоговом окне **изменение политики выдачи утверждений** в разделе **правила преобразования выдачи** щелкните **Добавить правило** , чтобы запустить мастер правил. 
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule11.PNG) ![создания правила    

5.  На странице **Выбор шаблона правила** в разделе **шаблон правила утверждения**выберите **преобразовать входящее утверждение** в список, а затем нажмите кнопку **Далее**.  
](media/Create-a-Rule-to-Transform-an-Incoming-Claim/transform3.PNG) ![создания правила      

6.  На странице **Настройка правила** введите имя правила утверждения.  

7.  В поле **тип входящего утверждения**выберите **метод проверки подлинности** в списке.  

8.  В поле **Тип исходящего утверждения**выберите **метод проверки подлинности** в списке.  

9. Выберите **заменить входящее значение утверждения на другое значение исходящего утверждения**, а затем выполните следующие действия.  

    1.  В поле **значение входящего утверждения**введите одно из следующих значений URI, основанное на фактическом коде URI метода проверки подлинности, который использовался изначально, нажмите кнопку **Готово**, а затем нажмите кнопку **ОК** , чтобы сохранить правило.  

    2.  В поле **значение исходящего утверждения**введите одно из значений URI по умолчанию в следующей таблице, которое зависит от нового предпочтительного метода проверки подлинности, нажмите кнопку **Готово**, а затем нажмите кнопку **ОК** , чтобы сохранить правило.  

|              Фактический метод проверки подлинности              |                                Соответствующий код URI                                 |
|--------------------------------------------------------|----------------------------------------------------------------------------------|
|         Проверка подлинности с помощью имени пользователя и пароля          | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/password  |
|                 Проверка подлинности Windows                 |  https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows  |
| Взаимная проверка подлинности TLS, использующая сертификаты X. 509 | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/tlsclient |
|   Проверка подлинности на основе X. 509\-, которая не использует TLS    |   https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/x509    |

![создать правило](media/Create-a-Rule-to-Send-an-Authentication-Method-Claim/auth4.PNG)

> [!NOTE]  
> Другие значения URI можно использовать в дополнение к значениям в таблице. Значения URI, которые отображаются в предыдущей таблице, соответствуют кодам URI, принимаемым по умолчанию проверяющей стороной.  

## <a name="to-create-this-rule-by-using-the-transform-an-incoming-claim-rule-template-on-a-claims-provider-trust-in-windows-server-2016"></a>Создание этого правила с помощью шаблона преобразования входящего утверждения на основе поставщика утверждений в Windows Server 2016 

1.  В диспетчер сервера щелкните **Сервис**, а затем выберите **AD FS управление**.  

2.  В дереве консоли в разделе **AD FS**щелкните **отношения доверия поставщиков утверждений**. 
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule1.PNG) ![создания правила  

3.  Справа\-щелкните выбранное отношение доверия, а затем щелкните **изменить правила утверждений**.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule2.PNG) ![создания правила   

4.  В диалоговом окне **изменение правил утверждений** в разделе **правила преобразования принятия** нажмите кнопку **Добавить правило** , чтобы запустить мастер правил.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule3.PNG) ![создания правила    

5.  На странице **Выбор шаблона правила** в разделе **шаблон правила утверждения**выберите **преобразовать входящее утверждение** в список, а затем нажмите кнопку **Далее**.  
](media/Create-a-Rule-to-Transform-an-Incoming-Claim/transform3.PNG) ![создания правила      

6.  На странице **Настройка правила** введите имя правила утверждения.  

7.  В поле **тип входящего утверждения**выберите **метод проверки подлинности** в списке.  

8.  В поле **Тип исходящего утверждения**выберите **метод проверки подлинности** в списке.  

9. Выберите **заменить входящее значение утверждения на другое значение исходящего утверждения**, а затем выполните следующие действия.  

    1.  В поле **значение входящего утверждения**введите одно из следующих значений URI, основанное на фактическом коде URI метода проверки подлинности, который использовался изначально, нажмите кнопку **Готово**, а затем нажмите кнопку **ОК** , чтобы сохранить правило.  

    2.  В поле **значение исходящего утверждения**введите одно из значений URI по умолчанию в следующей таблице, которое зависит от нового предпочтительного метода проверки подлинности, нажмите кнопку **Готово**, а затем нажмите кнопку **ОК** , чтобы сохранить правило.  

|              Фактический метод проверки подлинности              |                                Соответствующий код URI                                 |
|--------------------------------------------------------|----------------------------------------------------------------------------------|
|         Проверка подлинности с помощью имени пользователя и пароля          | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/password  |
|                 Проверка подлинности Windows                 |  https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows  |
| Взаимная проверка подлинности TLS, использующая сертификаты X. 509 | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/tlsclient |
|   Проверка подлинности на основе X. 509\-, которая не использует TLS    |   https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/x509    |

![создать правило](media/Create-a-Rule-to-Send-an-Authentication-Method-Claim/auth4.PNG)























## <a name="to-create-this-rule-by-using-the-send-group-membership-as-claims-rule-template-in-windows-server-2012-r2"></a>Создание этого правила с помощью шаблона правила "Отправить членство в группе как утверждения" в Windows Server 2012 R2  

1.  В диспетчер сервера щелкните **Сервис**, а затем выберите **AD FS управление**.  

2.  В дереве консоли в разделе **AD FS\\доверительных отношений**выберите **отношения доверия поставщика утверждений** или **отношения доверия с проверяющей стороной**, а затем щелкните определенное отношение доверия в списке, в котором вы хотите создать это правило.  

3.  Справа\-щелкните выбранное отношение доверия, а затем щелкните **изменить правила утверждений**.
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule6.PNG) ![создания правила  

4.  В диалоговом окне **изменение правил утверждений** выберите одну из следующих вкладок в зависимости от редактируемого отношения доверия и набора правил, в котором необходимо создать это правило, а затем нажмите кнопку **Добавить правило** , чтобы запустить мастер правил, связанный с этим набором правил:  

    -   **Правила преобразования принятия**  

    -   **Правила преобразования выдачи**  

    -   **Правила авторизации выдачи**  

    -   **Правила авторизации делегирования**  
](media/Create-a-Rule-to-Permit-All-Users/permitall5.PNG) ![создания правила

5.  На странице **Выбор шаблона правила** в разделе **шаблон правила утверждения**выберите **Отправить членство в группе как утверждение** из списка, а затем нажмите кнопку **Далее**.  
](media/Create-a-Rule-to-Send-Group-Membership-as-a-Claim/group1.PNG) ![создания правила

6.  На странице **Настройка правила** введите имя правила утверждения.  

7.  Нажмите кнопку **Обзор**, выберите группу, члены которой должны получить это утверждение метода проверки подлинности, а затем нажмите кнопку **ОК**.  

8.  В поле **Тип исходящего утверждения**выберите **метод проверки подлинности** в списке.  

9. В поле **значение исходящего утверждения**введите один из универсальных идентификаторов ресурса по умолчанию \(URI\) значения в следующей таблице в зависимости от предпочтительного метода проверки подлинности, нажмите кнопку **Готово**, а затем кнопку **ОК** , чтобы сохранить правило.  

|                            Фактический метод проверки подлинности                             |                                Соответствующий код URI                                 |
|-------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|                        Проверка подлинности с помощью имени пользователя и пароля                        | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/password  |
|                               Проверка подлинности Windows                                |  https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows  |
| Безопасность транспортного уровня \(TLS\) взаимной проверки подлинности, использующей сертификаты X. 509. | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/tlsclient |
|                  Проверка подлинности на основе X. 509\-, которая не использует TLS                  |   https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/x509    |

![создать правило](media/Create-a-Rule-to-Send-an-Authentication-Method-Claim/auth1.PNG)

> [!NOTE]  
> Другие значения URI можно использовать в дополнение к значениям в таблице. Значения URI, показанные в предыдущей таблице, отображают URI, принимаемые проверяющей стороной по умолчанию.  

## <a name="to-create-this-rule-by-using-the-transform-an-incoming-claim-rule-template-in-windows-server-2012-r2"></a>Создание этого правила с помощью шаблона преобразования входящего утверждения в Windows Server 2012 R2  



1.  В диспетчер сервера выберите **Сервис**, а затем — **Управление AD FS**.  

2.  В дереве консоли в разделе **AD FS\\доверительных отношений**выберите **отношения доверия поставщика утверждений** или **отношения доверия с проверяющей стороной**, а затем щелкните определенное отношение доверия в списке, в котором вы хотите создать это правило.  

3.  Справа\-щелкните выбранное отношение доверия, а затем щелкните **изменить правила утверждений**.  
](media/Create-a-Rule-to-Pass-Through-or-Filter-an-Incoming-Claim/claimrule6.PNG) ![создания правила 

4.  В диалоговом окне **изменение правил утверждений** выберите одну из следующих вкладок, которые зависят от редактируемого отношения доверия и набора правил, для которого необходимо создать это правило, а затем нажмите кнопку **Добавить правило** , чтобы запустить мастер правил, связанный с этим набором правил:  

    -   **Правила преобразования принятия**  

    -   **Правила преобразования выдачи**  

    -   **Правила авторизации выдачи**  

    -   **Правила авторизации делегирования**  
](media/Create-a-Rule-to-Permit-All-Users/permitall5.PNG) ![создания правила

5.  На странице **Выбор шаблона правила** в разделе **шаблон правила утверждения**выберите **преобразовать входящее утверждение** в список, а затем нажмите кнопку **Далее**.  
](media/Create-a-Rule-to-Transform-an-Incoming-Claim/transform1.PNG) ![создания правила    

6.  На странице **Настройка правила** введите имя правила утверждения.  

7.  В поле **тип входящего утверждения**выберите **метод проверки подлинности** в списке.  

8.  В поле **Тип исходящего утверждения**выберите **метод проверки подлинности** в списке.  

9. Выберите **заменить входящее значение утверждения на другое значение исходящего утверждения**, а затем выполните следующие действия.  

    1.  В поле **значение входящего утверждения**введите одно из следующих значений URI, основанное на фактическом коде URI метода проверки подлинности, который использовался изначально, нажмите кнопку **Готово**, а затем нажмите кнопку **ОК** , чтобы сохранить правило.  

    2.  В поле **значение исходящего утверждения**введите одно из значений URI по умолчанию в следующей таблице, которое зависит от нового предпочтительного метода проверки подлинности, нажмите кнопку **Готово**, а затем нажмите кнопку **ОК** , чтобы сохранить правило.  

|              Фактический метод проверки подлинности              |                                Соответствующий код URI                                 |
|--------------------------------------------------------|----------------------------------------------------------------------------------|
|         Проверка подлинности с помощью имени пользователя и пароля          | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/password  |
|                 Проверка подлинности Windows                 |  https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/windows  |
| Взаимная проверка подлинности TLS, использующая сертификаты X. 509 | https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/tlsclient |
|   Проверка подлинности на основе X. 509\-, которая не использует TLS    |   https://schemas.microsoft.com/ws/2008/06/identity/authenticationmethod/x509    |

![создать правило](media/Create-a-Rule-to-Send-an-Authentication-Method-Claim/auth3.PNG)

> [!NOTE]  
> Другие значения URI можно использовать в дополнение к значениям в таблице. Значения URI, которые отображаются в предыдущей таблице, соответствуют кодам URI, принимаемым по умолчанию проверяющей стороной.  

## <a name="additional-references"></a>Дополнительная справка 
[Настройка правил для утверждения](Configure-Claim-Rules.md)  

[Контрольный список: создание правил утверждений для отношения доверия с проверяющей стороной](https://technet.microsoft.com/library/ee913578.aspx)  

[Контрольный список: создание правил утверждений для отношения доверия поставщика утверждений](https://technet.microsoft.com/library/ee913564.aspx)  

[Когда следует использовать правило утверждения авторизации](../../ad-fs/technical-reference/When-to-Use-an-Authorization-Claim-Rule.md)  

[Роль утверждений](../../ad-fs/technical-reference/The-Role-of-Claims.md)  

[Роль правил утверждений](../../ad-fs/technical-reference/The-Role-of-Claim-Rules.md) 
