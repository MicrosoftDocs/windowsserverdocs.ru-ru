---
ms.assetid: 934ac796-e2ee-490d-8265-6a818be5ee79
title: управление рисками для уязвимых приложений с помощью дополнительной многофакторной проверки подлинности
description: ''
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adfs
ms.openlocfilehash: a37c0b0a1de06b65e0cb867ec4d160bbb0373a15
ms.sourcegitcommit: 0b5fd4dc4148b92480db04e4dc22e139dcff8582
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/24/2019
ms.locfileid: "66189074"
---
# <a name="manage-risk-with-additional-multi-factor-authentication-for-sensitive-applications"></a>управление рисками для уязвимых приложений с помощью дополнительной многофакторной проверки подлинности




-   [Настройка лабораторной среды для служб федерации Active Directory в Windows Server 2012 R2](../../ad-fs/deployment/Set-up-the-lab-environment-for-AD-FS-in-Windows-Server-2012-R2.md)

-   [Пошаговое руководство. Управление рисками с помощью дополнительной многофакторной проверки подлинности для уязвимых приложений](../../ad-fs/operations/Walkthrough-Guide--Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md)

-   [Настройка дополнительных методов проверки подлинности для AD FS](../../ad-fs/operations/Configure-Additional-Authentication-Methods-for-AD-FS.md)

## <a name="in-this-guide"></a>В данном руководстве
Это руководство содержит следующую информацию:

-   [Способы проверки подлинности в AD FS](../../ad-fs/operations/Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md#BKMK_1) — Описание способов проверки подлинности, доступных в федерации служб Active Directory (AD FS) в Windows Server 2012 R2

-   [Обзор сценария](../../ad-fs/operations/Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md#BKMK_2) -описание ситуацию, когда вы используете службы федерации Active Directory (AD FS) для включения многофакторной проверки подлинности (MFA) на основании членства в группах.

    > [!NOTE]
    > В AD FS в Windows Server 2012 R2 можно включить многофакторной проверки Подлинности на основе сетевого расположения, удостоверения устройства и пользователя удостоверения или членство в группах.

    Подробные пошаговые инструкции по настройке и проверке этого сценария, см. в разделе [Пошаговое руководство: Управление рисками с помощью дополнительной многофакторной проверки подлинности для уязвимых приложений](../../ad-fs/operations/Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md).

## <a name="BKMK_1"></a>Основные понятия - механизмов проверки подлинности в AD FS

### <a name="benefits-of-authentication-mechanisms-in-ad---fs"></a>Преимущества способов проверки подлинности в AD FS
Федерации служб Active Directory (AD FS) в Windows Server 2012 R2 предоставляет ИТ-администраторам более богатый и гибкий набор средств для проверки подлинности пользователей, которым требуется доступ к корпоративным ресурсам. Предоставляют администраторам гибкий контроль над основными и дополнительными методами проверки подлинности, предоставляет полнофункциональный механизм управления для настройки проверки подлинности политик (через пользовательский интерфейс и Windows PowerShell) и расширяет возможности возможности для конечных пользователей, которые обращаются к приложениям и службам, защищенным AD FS. Ниже приведены некоторые преимущества защиты приложений и служб с помощью AD FS в Windows Server 2012 R2.

-   Глобальная политика проверки подлинности — центральная функция управления, из которого ИТ-администратор может выбрать, какие методы проверки подлинности используются для проверки подлинности пользователей, в зависимости от сетевого расположения, из которого они доступ к защищенным ресурсам. Это позволяет администраторам выполнять следующие задачи:

    -   Принудительно использовать более безопасные методы проверки подлинности для запросов на доступ из экстрасети.

    -   Настраивать проверку подлинности устройств для комплексной двухфакторной проверки подлинности. Этот способ привязывает удостоверение пользователя к зарегистрированному устройству, которое будет использоваться для доступа к ресурсу, тем самым обеспечивая более безопасную составную проверку удостоверения перед доступа к защищенным ресурсам.

        > [!NOTE]
        > Дополнительные сведения о объект устройства, службе регистрации устройств, присоединение к рабочему месту и устройство как прозрачную двухфакторную проверку подлинности и единого входа, см. в разделе [присоединение к рабочему месту с любого устройства для единого входа и простой двухфакторной проверки подлинности В приложениях компании](Join-to-Workplace-from-Any-Device-for-SSO-and-Seamless-Second-Factor-Authentication-Across-Company-Applications.md).

    -   Задать требование многофакторной проверки Подлинности для всех доступа к экстрасети или условно на основе удостоверения пользователя, сетевого расположения или устройства, который используется для доступа к защищенным ресурсам.

-   Гибкость в настройке политики проверки подлинности: можно настроить пользовательские политики проверки подлинности для AD FS защищенных ресурсов с различным значением для бизнеса. Например, можно требовать принудительного применения многофакторной проверки подлинности для доступа к приложениям с высокой степенью важности для бизнеса.

-   Простота в использовании: простые и интуитивно понятные средства, такие как оснастки управления MMC на основе графического интерфейса пользователя в AD FS и командлеты Windows PowerShell включить ИТ-администраторам с относительной легкостью настраивать политики проверки подлинности. С помощью Windows PowerShell можно создать из решения сценарий для использования в масштабе предприятия и автоматизации повседневных задач администрирования.

-   Больший контроль над корпоративными ресурсами: так как администратор AD FS можно использовать для настройки политики проверки подлинности, которая применяется к определенному ресурсу, у вас есть больше, управлять контролирует как корпоративным ресурсам защиты. Приложения не могут отменить политики проверки подлинности, определенные ИТ-администраторами. Для уязвимых приложений и служб можно включить требование многофакторной проверки подлинности, проверки подлинности устройства и дополнительной проверки подлинности при каждом доступе к ресурсу.

-   Поддержка пользовательских поставщиков многофакторной проверки Подлинности: для организаций, использующих методы многофакторной проверки Подлинности сторонних, службы федерации Active Directory предоставляет возможность внедрить и использовать эти методы проверки подлинности без проблем.

### <a name="authentication-scope"></a>Область проверки подлинности
В AD FS в Windows Server 2012 R2 можно указать политику проверки подлинности в глобальной области, которая будет применяться ко всем приложениям и службам, защищенным службами AD FS.  Можно также задать политики проверки подлинности для определенных приложений и служб (отношения доверия с проверяющей), которые защищены с помощью AD FS. Определение политики проверки подлинности для конкретного приложения (на основе отношения доверия с проверяющей стороной) не отменяет глобальную политику проверки подлинности. Если глобальная политика проверки подлинности или политика проверки подлинности на основе отношений доверия с проверяющей стороной требует многофакторной проверки подлинности, то при попытке пользователя пройти проверку подлинности на основе указанного отношения доверия с проверяющей стороной будет инициирована многофакторная проверка подлинности.  Глобальная политика проверки подлинности представляет собой резервный вариант для политики на основе отношений доверия с проверяющей стороной (для приложений и служб), для которых не настроена определенная политика проверки подлинности.

Глобальная политика проверки подлинности применяется ко всем проверяющим сторонам, защищенным AD FS. При настройке глобальной политики проверки подлинности можно настроить следующие параметры:

-   Метод проверки подлинности, который будет использоваться в качестве основного.

-   Параметры и методы многофакторной проверки подлинности.

-   Включение или отключение проверки подлинности. Дополнительные сведения см. в разделе [присоединение к рабочему месту с любого устройства для единого входа и эффективная двухфакторная проверка подлинности между компании приложениях](../../ad-fs/operations/Join-to-Workplace-from-Any-Device-for-SSO-and-Seamless-Second-Factor-Authentication-Across-Company-Applications.md).

Политики проверки подлинности на основе отношения доверия с проверяющей стороной применяются, в частности, при попытке доступа к этому отношению доверия с проверяющей стороной (приложению или службе). При настройке политики проверки подлинности на основе отношения доверия с проверяющей стороной можно настроить следующие параметры:

-   Будут ли запрашиваться учетные данные при каждом входе пользователя в систему

-   Параметры многофакторной проверки подлинности на основе учетной записи пользователя или группы, регистрации устройства и данных расположения, из которого запрашивается доступ к данным

### <a name="primary-and-additional-authentication-methods"></a>Основные и дополнительные методы проверки подлинности
С AD FS в Windows Server 2012 R2, помимо механизм основной проверки подлинности администраторы могут настроить дополнительные методы проверки подлинности. Основных способов проверки подлинности являются встроенными и предназначены для проверки удостоверения пользователя. Можно настроить дополнительные факторы проверки подлинности для запроса, что предоставляются дополнительные сведения об удостоверении пользователя и следовательно, обеспечить более надежную проверку подлинности.

С основной проверкой подлинности в AD FS в Windows Server 2012 R2 у вас есть следующие параметры:

-   Для ресурсов, которые опубликованы для доступа из корпоративной сети, по умолчанию выбрана проверка подлинности на основе форм. Кроме того, можно включить проверку подлинности сертификата (другими словами, проверку подлинности с использованием смарт-карты или проверку подлинности сертификата клиента, которая работает с доменными службами Active Directory).

-   Для ресурсов интрасети по умолчанию выбрана проверка подлинности Windows. Дополнительно можно выбрать проверку подлинности на основе форм или проверку подлинности сертификата.

Выбирая более одного метода проверки подлинности, администратор предоставляет пользователям возможность выбора метода проверки подлинности на странице входа приложения или службы.

Можно также включить проверку подлинности устройств для комплексной двухфакторной проверки подлинности. Этот способ привязывает удостоверение пользователя к зарегистрированному устройству, которое будет использоваться для доступа к ресурсу, тем самым обеспечивая более безопасную составную проверку удостоверения перед доступа к защищенным ресурсам.

> [!NOTE]
> Дополнительные сведения о объект устройства, службе регистрации устройств, присоединение к рабочему месту и устройство как прозрачную двухфакторную проверку подлинности и единого входа, см. в разделе [присоединение к рабочему месту с любого устройства для единого входа и простой двухфакторной проверки подлинности В приложениях компании](../../ad-fs/operations/Join-to-Workplace-from-Any-Device-for-SSO-and-Seamless-Second-Factor-Authentication-Across-Company-Applications.md).

При выборе для ресурсов интрасети метода проверки подлинности Windows (задан по умолчанию) проверка подлинности пройдет без проблем в браузерах, которые поддерживают проверку подлинности Windows.

> [!NOTE]
> Проверка подлинности Windows поддерживается не всеми браузерами. Механизм проверки подлинности в AD FS в Windows Server 2012 R2 определяет агент пользователя браузера пользователя и использует настраиваемые параметры, чтобы определить, поддерживает ли этот агент пользователя проверку подлинности Windows. Администраторы могут добавлять элементы к этому списку агентов пользователя (с помощью команды Windows PowerShell `Set-AdfsProperties -WIASupportedUserAgents`), чтобы указать альтернативную строку агента пользователя для браузеров, которые поддерживают проверку подлинности Windows. Если агент пользователя клиента не поддерживает проверку подлинности Windows, в качестве резервного метода используется проверка подлинности форм.

### <a name="configuring-mfa"></a>Настройка многофакторной проверки подлинности
Настройка многофакторной проверки Подлинности в AD FS в Windows Server 2012 R2 состоит из двух частей: указание условий, при которых обязательна многофакторная проверка Подлинности и Выбор дополнительного метода проверки подлинности. Дополнительные сведения о дополнительных методов проверки подлинности, см. в разделе [Настройка дополнительных методов проверки подлинности для AD FS](../../ad-fs/operations/Configure-Additional-Authentication-Methods-for-AD-FS.md).

**Параметры многофакторной проверки Подлинности**

Для параметров многофакторной проверки подлинности доступны следующие варианты (условия, при которых обязательно применение многофакторной проверки подлинности):

-   Можно сделать многофакторную проверку подлинности обязательной для определенных пользователей и групп в домене Active Directory, к которому присоединен ваш сервер федерации.

-   Можно сделать многофакторную проверку подлинности обязательной для зарегистрированных (присоединенных к рабочему месту) или незарегистрированных (не присоединенных к рабочему месту) устройств.

    Windows Server 2012 R2 использует ориентированный на пользователя подход к современным устройствам, в которых объект устройства представляет отношение между user@device и компанией. Объекты устройств — это новый класс в AD в Windows Server 2012 R2, который может использоваться для предоставления составного удостоверения в процессе предоставления доступа к приложениям и службам. Новый компонент AD FS — служба регистрации устройств (DRS) — предоставляет удостоверение устройства в Active Directory и настраивает сертификат для пользовательского устройства, который будет использоваться для представления удостоверения устройства. Затем это удостоверение устройства можно использовать для присоединения устройства к рабочему месту; иначе говоря, для подключения вашего личного устройства к Active Directory на вашем рабочем месте. После подключения личного устройства к вашему рабочему месту оно становится известным устройством и будет служить дополнительным фактором проверки подлинности для доступа к защищенным ресурсам и приложениям. Другими словами после присоединения устройства к рабочему месту, удостоверение пользователя привязывается к этому устройству и может использоваться для составной проверки удостоверения перед доступом к защищенному ресурсу.

    Дополнительные сведения о месту и отключении см. в разделе [соединения к рабочему месту с любого устройства для единого входа и эффективная двухфакторная проверка подлинности между компании приложениях](../../ad-fs/operations/Join-to-Workplace-from-Any-Device-for-SSO-and-Seamless-Second-Factor-Authentication-Across-Company-Applications.md).

-   Многофакторную проверку подлинности можно сделать обязательной при запросе разрешения на доступ к защищенным ресурсам из экстрасети или интрасети.

## <a name="BKMK_2"></a>Обзор сценария
В этом сценарии включения многофакторной проверки Подлинности на основе данных членства в группах пользователя для конкретного приложения. Иначе говоря, вы настроите политику проверки подлинности на сервере федерации таким образом, чтобы при получении запроса на доступ к определенному приложению, размещенному на веб-сервере, от пользователей, принадлежащих к определенной группе, обязательно применялась многофакторная проверка подлинности.

Более частная задача этого сценария заключается в настройке политики проверки подлинности для тестового приложения на основе утверждений **claimapp**, в соответствии с которой пользователь AD **Роберт Хатли** должен будет пройти многофакторную проверку подлинности, так как он принадлежит к группе AD **Финансы**.

Шаг-пошаговые инструкции по настройке и проверке этого сценария приведены в [Пошаговое руководство: Управление рисками с помощью дополнительной многофакторной проверки подлинности для уязвимых приложений](../../ad-fs/operations/Walkthrough-Guide--Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md). Чтобы выполнить действия, описанные в этом пошаговом руководстве, необходимо настроить лабораторную среду и выполните действия, описанные в [Настройка лабораторной среды для AD FS в Windows Server 2012 R2](../../ad-fs/deployment/Set-up-the-lab-environment-for-AD-FS-in-Windows-Server-2012-R2.md).

Ниже приведены другие сценарии включения многофакторной проверки Подлинности в AD FS:

-   Включение многофакторной проверки подлинности при поступлении запроса на доступ из экстрасети. Можно изменить код, представленный в разделе «Настройка многофакторной проверки Подлинности политики» [Пошаговое руководство: Управление рисками для уязвимых приложений с помощью дополнительной многофакторной проверки подлинности](../../ad-fs/operations/Walkthrough-Guide--Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md) на следующий:

    ```
    'c:[type == "https://schemas.microsoft.com/ws/2012/01/insidecorporatenetwork", value == "false"] => issue(type="https://schemas.microsoft.com/ws/2008/06/identity/claims/authenticationmethod", value = "https://schemas.microsoft.com/claims/multipleauthn" );'
    ```

-   Включение многофакторной проверки подлинности при поступлении запроса на доступ с устройства, не присоединенного к рабочем месту.  Можно изменить код, представленный в разделе «Настройка многофакторной проверки Подлинности политики» [Пошаговое руководство: Управление рисками для уязвимых приложений с помощью дополнительной многофакторной проверки подлинности](../../ad-fs/operations/Walkthrough-Guide--Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md) на следующий:

    ```
    'NOT EXISTS([type=="https://schemas.microsoft.com/2012/01/devicecontext/claims/registrationid"]) => issue (type="https://schemas.microsoft.com/ws/2008/06/identity/claims/authenticationmethod", value = "https://schemas.microsoft.com/claims/multipleauthn");'

    ```

-   Включение многофакторной проверки подлинности при поступлении запроса на доступ от пользователя устройства, присоединенного к рабочему месту, но не зарегистрированного для данного пользователя. Можно изменить код, представленный в разделе «Настройка многофакторной проверки Подлинности политики» [Пошаговое руководство: Управление рисками для уязвимых приложений с помощью дополнительной многофакторной проверки подлинности](../../ad-fs/operations/Walkthrough-Guide--Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md) на следующий:

    ```
    'c:[type=="https://schemas.microsoft.com/2012/01/devicecontext/claims/isregistereduser", value == "false"] => issue (type="https://schemas.microsoft.com/ws/2008/06/identity/claims/authenticationmethod", value = "https://schemas.microsoft.com/claims/multipleauthn");'

    ```

## <a name="see-also"></a>См. также
[Пошаговое руководство. Управление рисками для уязвимых приложений с помощью дополнительной многофакторной проверки подлинности](../../ad-fs/operations/Walkthrough-Guide--Manage-Risk-with-Additional-Multi-Factor-Authentication-for-Sensitive-Applications.md)
[Настройка лабораторной среды для AD FS в Windows Server 2012 R2](../../ad-fs/deployment/Set-up-the-lab-environment-for-AD-FS-in-Windows-Server-2012-R2.md)



